{"version":3,"file":"static/js/71004.9f161abf.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/views/interactive/snapping/SnappingContext.js","../node_modules/@arcgis/core/views/interactive/snapping/SnappingDragPipelineStep.js","../node_modules/@arcgis/core/views/interactive/snapping/SnappingOperation.js","../node_modules/@arcgis/core/views/interactive/snapping/SnappingVisualizer.js","../node_modules/@arcgis/core/views/interactive/snapping/hints/PointSnappingHint.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nclass e{constructor(e){this.vertexHandle=null,this.excludeFeature=null,this.visualizer=null,this.selfSnappingZ=null,this.editGeometryOperations=e.editGeometryOperations,this.elevationInfo=e.elevationInfo,this.pointer=e.pointer,this.vertexHandle=e.vertexHandle,this.excludeFeature=e.excludeFeature,this.visualizer=e.visualizer,this.selfSnappingZ=e.selfSnappingZ}get coordinateHelper(){return this.editGeometryOperations.data.coordinateHelper}get spatialReference(){return this.coordinateHelper.spatialReference}}export{e as SnappingContext};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{isNone as e,abortMaybe as n,isSome as t,removeMaybe as o,unwrap as i}from\"../../../core/maybe.js\";import{ignoreAbortErrors as r,debounce as a}from\"../../../core/promiseUtils.js\";import{watch as s}from\"../../../core/reactiveUtils.js\";import{pointEquals as c}from\"../../../layers/graphics/dehydratedFeatureComparison.js\";import{clonePoint as l}from\"../../../layers/graphics/hydratedFeatures.js\";import{EventPipeline as p}from\"../dragEventPipeline.js\";import{SnappingContext as u}from\"./SnappingContext.js\";import{TaskPriority as f,ImmediateTask as d}from\"../../support/Scheduler.js\";function m({predicate:a=(()=>!0),snappingManager:c,snappingContext:l,updatingHandles:u,useZ:f=!0}){const d=new p;if(e(c))return{snappingStep:[j,d],cancelSnapping:j};let m,z=null,T=null,k=null;const w=()=>{z=n(z),c.doneSnapping(),t(T)&&T.frameTask.remove(),T=null,m=o(m),k=null},C=g(c,f,d);let E=null,I=null,U=null;return{snappingStep:[n=>{if(!a(n))return n;const{action:o}=n;if(\"start\"===o){const{info:e}=n,o=x(c.view);if(T=P(l,n,o),T.context.selfSnappingZ=null,!f&&t(e)){const n=Z(l.coordinateHelper,e.handle.component);t(n)&&(T.context.selfSnappingZ={value:n,elevationInfo:l.elevationInfo})}}if(t(T)){const{context:t,originalScenePos:a,originalPos:l}=T,{mapEnd:p,mapStart:d,scenePoints:g}=n,x=h(l,S(p,d)),P=S(d,l),Z={...n,action:\"update\"},j=T.context,w=v(a,g),b=c.update({point:x,scenePoint:w,context:t});if(U=b,y(p,b,P,f),E=x,I=w,\"end\"!==o){const{frameTask:n}=T;e(z)&&(z=new AbortController),k=e=>{u.addPromise(r(C({frameTask:n,event:Z,context:j,point:x,scenePoint:w,delta:P,getLastState:()=>({point:E,scenePoint:I,updatePoint:e.forceUpdate?null:U})},i(z).signal)))},k({forceUpdate:!1}),e(m)&&(m=s((()=>c.options.effectiveEnabled),(()=>k?.({forceUpdate:!0}))))}}return\"end\"===o&&w(),n},d],cancelSnapping:e=>(w(),e)}}function g(n,o,i){return a((async({frameTask:r,point:a,scenePoint:s,context:l,event:p,delta:u,getLastState:f},d)=>{const m=await r.schedule((()=>n.snap({point:a,scenePoint:s,context:l,signal:d})),d);if(m.valid){let s=await r.schedule((()=>m.apply()),d);const g=f();t(g.point)&&a!==g.point&&(s=n.update({point:g.point,scenePoint:g.scenePoint,context:l})),!e(g.updatePoint)&&c(s,g.updatePoint)||(y(p.mapEnd,s,u,o),i.execute(p))}}))}function x(e){return\"3d\"===e.type?e.resourceController.scheduler.registerTask(f.SNAPPING):d}function P(e,n,o){return{context:new u({editGeometryOperations:e.editGeometryOperations,elevationInfo:e.elevationInfo,pointer:e.pointer,vertexHandle:t(n.info)?n.info.handle:null,excludeFeature:e.excludeFeature,visualizer:e.visualizer}),originalPos:t(n.snapOrigin)?e.coordinateHelper.vectorToDehydratedPoint(n.snapOrigin):n.mapStart,originalScenePos:t(n.scenePoints)?n.scenePoints.sceneStart:null,frameTask:o}}function h(e,[n,t,o]){const i=l(e);return i.x+=n,i.y+=t,i.hasZ&&(i.z+=o),i}function v(n,t){return e(n)||e(t)?null:h(n,S(t.sceneEnd,t.sceneStart))}function S(e,n){const t=e.hasZ&&n.hasZ?e.z-n.z:0;return[e.x-n.x,e.y-n.y,t]}function y(e,n,[t,o,i],r){e.x=n.x+t,e.y=n.y+o,r&&e.hasZ&&n.hasZ&&(e.z=n.z+i)}function Z(n,o){if(!n.hasZ())return null;const i=o.vertices;let r=null;for(const a of i){const o=n.getZ(a.pos);if(t(r)&&t(o)&&Math.abs(o-r)>1e-6)return null;e(r)&&(r=o)}return r}function j(e){return e}export{m as createSnapDragEventPipelineStep};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../chunks/tslib.es6.js\";import s from\"../../../core/Accessor.js\";import{isSome as o,abortMaybe as r,removeMaybe as e,isNone as i}from\"../../../core/maybe.js\";import{debounce as n}from\"../../../core/promiseUtils.js\";import{property as a}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import{subclass as p}from\"../../../core/accessorSupport/decorators/subclass.js\";import{TaskPriority as l,ImmediateTask as c}from\"../../support/Scheduler.js\";let h=class extends s{constructor(t){super(t),this.constrainResult=t=>t,this._snapPoints=null,this._frameTask=null,this._abortController=null,this._stagedPoint=null,this._snap=n((async(t,s,r,e)=>{const n=this._frameTask;if(i(n))return;const a=await n.schedule((()=>s.snap({...t,context:r,signal:e})),e);a.valid&&await n.schedule((()=>{this.stagedPoint=a.apply(),t!==this._snapPoints&&o(this._snapPoints)&&(this.stagedPoint=s.update({...this._snapPoints,context:r}))}),e)}))}get stagedPoint(){return this._stagedPoint}set stagedPoint(t){this._stagedPoint=this.constrainResult(t)}initialize(){const t=\"3d\"===this.view.type?this.view?.resourceController?.scheduler:null;this._frameTask=o(t)?t.registerTask(l.SNAPPING):c}destroy(){this._abortController=r(this._abortController),this._frameTask=e(this._frameTask)}update(t,s,o){this._snapPoints=t;const{point:r,scenePoint:e}=t,i=s.update({point:r,scenePoint:e,context:o});return this.stagedPoint=i,i}async snap(t,s,o){const{point:r,scenePoint:e}=t;return this.stagedPoint=s.update({point:r,scenePoint:e,context:o}),this._snapPoints=t,i(this._abortController)&&(this._abortController=new AbortController),this._snap(t,s,o,this._abortController.signal)}async resnap(t,s){i(this._snapPoints)||await this.snap(this._snapPoints,t,s)}abort(){this._abortController=r(this._abortController),this._snapPoints=null}};t([a({constructOnly:!0})],h.prototype,\"view\",void 0),t([a()],h.prototype,\"stagedPoint\",null),t([a()],h.prototype,\"constrainResult\",void 0),t([a()],h.prototype,\"_stagedPoint\",void 0),h=t([p(\"esri.views.interactive.snapping.SnappingOperation\")],h);export{h as SnappingOperation};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{handlesGroup as i}from\"../../../core/handleUtils.js\";import{IntersectionSnappingHint as n}from\"./hints/IntersectionSnappingHint.js\";import{LineSnappingHint as t}from\"./hints/LineSnappingHint.js\";import{ParallelSnappingHint as s}from\"./hints/ParallelSnappingHint.js\";import{PointSnappingHint as o}from\"./hints/PointSnappingHint.js\";import{RightAngleSnappingHint as e}from\"./hints/RightAngleSnappingHint.js\";class r{draw(r,a){const p=this._getUniqueHints(r),h=this.sortUniqueHints(p),u=[];for(const i of h)i instanceof n&&u.push(this.visualizeIntersectionPoint(i,a)),i instanceof t&&u.push(this.visualizeLine(i,a)),i instanceof s&&u.push(this.visualizeParallelSign(i,a)),i instanceof e&&u.push(this.visualizeRightAngleQuad(i,a)),i instanceof o&&u.push(this.visualizePoint(i,a));return i(u)}sortUniqueHints(i){return i}_getUniqueHints(i){const n=[];for(const t of i){let i=!0;for(const s of n)if(t.equals(s)){i=!1;break}i&&n.push(t)}return n}}export{r as SnappingVisualizer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{k as t}from\"../../../../chunks/vec3.js\";import{SnappingHint as s}from\"./SnappingHint.js\";class n extends s{constructor(t,s,n){super(s,n),this.point=t}equals(s){return s instanceof n&&t(this.point,s.point)}}export{n as PointSnappingHint};\n"],"names":["e","this","vertexHandle","excludeFeature","visualizer","selfSnappingZ","editGeometryOperations","elevationInfo","pointer","get","data","coordinateHelper","spatialReference","m","predicate","a","c","snappingManager","l","snappingContext","u","updatingHandles","useZ","f","d","p","snappingStep","j","cancelSnapping","n","o","i","z","T","k","w","doneSnapping","t","frameTask","remove","C","r","point","s","scenePoint","context","event","delta","getLastState","schedule","snap","signal","valid","apply","g","update","updatePoint","y","mapEnd","execute","E","I","U","action","info","view","type","resourceController","scheduler","registerTask","handle","originalPos","snapOrigin","vectorToDehydratedPoint","mapStart","originalScenePos","scenePoints","sceneStart","P","hasZ","vertices","getZ","pos","Math","abs","Z","component","value","x","h","S","sceneEnd","v","b","AbortController","addPromise","forceUpdate","options","effectiveEnabled","constrainResult","_snapPoints","_frameTask","_abortController","_stagedPoint","_snap","stagedPoint","set","constructOnly","prototype","_getUniqueHints","sortUniqueHints","push","visualizeIntersectionPoint","visualizeLine","visualizeParallelSign","visualizeRightAngleQuad","visualizePoint","equals"],"sourceRoot":""}