"use strict";(self.webpackChunkhub_layout_versioning=self.webpackChunkhub_layout_versioning||[]).push([[42097],{42097:function(e,t,n){n.r(t),n.d(t,{arcgis_hub_entity_editor:function(){return O}});var r=n(74165),i=n(15671),a=n(43144),s=n(15861),c=n(72585),u=n(32836),o=n(12868),p=n(29505),h=n(25434),f=n(49799),l=n(66287),d=n(84744),v=n(36067),g=n(63697);n(84371),n(77843),n(91466),n(90251),n(80046),n(77699),n(69207),n(34601),n(21923),n(42016);function m(e,t,n,r,i){return y.apply(this,arguments)}function y(){return y=(0,s.Z)((0,r.Z)().mark((function e(t,n,i,a,s){var c,u,o=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=o.length>5&&void 0!==o[5]?o[5]:"",e.prev=1,e.next=4,(0,l.a)(Object.assign({id:t,owner:n,resource:i,name:a,prefix:c},s));case 4:if(e.sent.success){e.next=7;break}throw new l.H("Set Item Featured Image","Unknown error setting featured image.");case 7:return u=(0,d.a)(s.portal),c&&(c="".concat(c,"/")),e.abrupt("return","".concat(u,"/content/items/").concat(t,"/resources/").concat(c).concat(a));case 12:if(e.prev=12,e.t0=e.catch(1),!(e.t0 instanceof Error)){e.next=18;break}throw new l.H("Set Item Featured Image",e.t0.message,e.t0);case 18:throw new l.H("Set Item Featured Image","Unknown error setting featured image.");case 19:case"end":return e.stop()}}),e,null,[[1,12]])}))),y.apply(this,arguments)}function b(){return w.apply(this,arguments)}function w(){return w=(0,s.Z)((0,r.Z)().mark((function e(){var t,n,i,a,s,c,u,o=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:{},n=o.length>1?o[1]:void 0,s=(new Date).getTime(),c=!!(null===(i=t.extent)||void 0===i?void 0:i.length),e.next=6,I(t,n);case 6:return u=e.sent,e.abrupt("return",[{scope:"/properties/extent",options:{sources:[{value:"none",selected:!c},{selected:c,value:"item",labelKey:c?"{{i18nScope}}.fields.extent.project":"{{i18nScope}}.fields.extent.org",graphic:{geometry:Object.assign({type:"extent"},u)}}]}},{scope:"/properties/view/properties/featuredImage",options:{imgSrc:(null===(a=t.view)||void 0===a?void 0:a.featuredImageUrl)&&"".concat(t.view.featuredImageUrl,"?token=").concat(n.session.token,"&v=").concat(s)}}]);case 8:case"end":return e.stop()}}),e)}))),w.apply(this,arguments)}function x(e,t){return k.apply(this,arguments)}function k(){return(k=(0,s.Z)((0,r.Z)().mark((function e(t,n){var i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(0,h.c)(t),e.next=3,I(t,n);case 3:return i.extent=e.sent,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(e,t){return E.apply(this,arguments)}function E(){return(E=(0,s.Z)((0,r.Z)().mark((function e(t,n){var i,a,s,c;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=(0,h.c)(t)).extent=(0,f.a)(a.extent),!(null===(i=a.view)||void 0===i?void 0:i.featuredImage)){e.next=15;break}if(c=a.view.featuredImage,delete a.view.featuredImage,!c.blob){e.next=11;break}return e.next=8,m(t.id,t.owner,c.blob,"featuredImage.png",n.userRequestOptions);case 8:s=e.sent,e.next=14;break;case 11:return s=null,e.next=14,(0,v.r)(Object.assign({id:t.id,owner:t.owner,resource:"featuredImage.png"},n.userRequestOptions));case 14:a.view.featuredImageUrl=s;case 15:return e.abrupt("return",(0,g.u)(a,n.userRequestOptions));case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(e,t){return S.apply(this,arguments)}function S(){return(S=(0,s.Z)((0,r.Z)().mark((function e(t,n){var i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(i=t.extent)||void 0===i?void 0:i.length)){e.next=5;break}e.t0=(0,f.b)(t.extent),e.next=8;break;case 5:return e.next=7,(0,f.c)(n.hubRequestOptions);case 7:e.t0=e.sent;case 8:return e.abrupt("return",e.t0);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e,t){return H.apply(this,arguments)}function H(){return(H=(0,s.Z)((0,r.Z)().mark((function e(t,n){var i,a,s,c;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(0,p.g)(t),a={project:{config:g.g,options:b}},s=a[i]||{},e.next=5,s.options(t,n);case 5:return c=e.sent,e.abrupt("return",s.config(i,"edit",c));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e,t){return F.apply(this,arguments)}function F(){return(F=(0,s.Z)((0,r.Z)().mark((function e(t,n){var i,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(0,p.g)(t),a={project:x},e.abrupt("return",a[i](t,n));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e,t){return A.apply(this,arguments)}function A(){return(A=(0,s.Z)((0,r.Z)().mark((function e(t,n){var i,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(0,p.g)(t),a={project:Z},e.abrupt("return",a[i](t,n));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var O=function(){function e(t){(0,i.Z)(this,e),(0,c.r)(this,t),this.arcgisHubWorkspaceEntityChange=(0,c.c)(this,"arcgisHubWorkspaceEntityChange",7),(0,u.b)(this,"translationFunc","handleEntityEditorSave","handleEntityEditorChange")}return(0,a.Z)(e,[{key:"componentWillLoad",value:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(){var t,n,i,a,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.i.loadIntlForComponent(this.element);case 2:return this.intl=e.sent,e.prev=3,e.next=6,C(this.entity,this.context);case 6:t=e.sent,n=t.schema,i=t.uiSchema,this.schema=n,this.uiSchema=i,e.next=17;break;case 13:e.prev=13,e.t0=e.catch(3),a=(0,p.g)(this.entity),console.error("Could not fetch the editor config - verify the get".concat(a,"EditorConfig function is supported"));case 17:return e.next=19,j(this.entity,this.context);case 19:s=e.sent,this.values=s;case 21:case"end":return e.stop()}}),e,this,[[3,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"translationFunc",value:function(e,t,n){return this.intl.t(e,t,n)}},{key:"handleEntityEditorChange",value:function(){this.arcgisHubWorkspaceEntityChange.emit({isDirty:!0,entity:this.entity})}},{key:"handleEntityEditorSave",value:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.entity,e.prev=1,e.next=4,_(t.detail,this.context);case 4:n=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.error("Unable to save entity changes:",e.t0);case 10:return e.prev=10,this.arcgisHubWorkspaceEntityChange.emit({isDirty:!1,entity:n}),e.finish(10);case 13:case"end":return e.stop()}}),e,this,[[1,7,10,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){return(0,c.h)(c.H,{"data-element":"entity-editor"},(0,c.h)("h2",null,this.intl.t("details")),(0,c.h)("arcgis-configuration-form",{onArcgisConfigurationFormChanged:this.handleEntityEditorChange,onArcgisConfigurationFormSaved:this.handleEntityEditorSave,schema:this.schema,t:this.translationFunc,uiSchema:this.uiSchema,values:this.values}))}},{key:"element",get:function(){return(0,c.g)(this)}}],[{key:"assetsDirs",get:function(){return["locales"]}}]),e}();O.style=".sc-arcgis-hub-entity-editor-h{display:block}"},32836:function(e,t,n){n.d(t,{b:function(){return r}});var r=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n.forEach((function(t){if("function"!==typeof e[t])throw new Error("Cannot bind context. ".concat(t," must be a function"));e[t]=e[t].bind(e)}))}},36067:function(e,t,n){n.d(t,{a:function(){return c},r:function(){return u}});var r=n(63613),i=n(98825),a=n(69207),s=n(77843);function c(e){return(0,a.d)(e).then((function(t){var n=(0,i.g)(e)+"/content/users/"+t+"/items/"+e.id+"/delete";return(0,s.r)(n,e)}))}function u(e){return(0,a.d)(e).then((function(t){var n=(0,i.g)(e)+"/content/users/"+t+"/items/"+e.id+"/removeResources";return e.params=(0,r._)((0,r._)({},e.params),{resource:e.resource}),"undefined"!==typeof e.deleteAll&&(e.params.deleteAll=e.deleteAll),(0,s.r)(n,e)}))}},29505:function(e,t,n){function r(e){var t;switch(e.type){case"Hub Site Application":case"Site Application":t="site";break;case"Hub Page":case"Site Page":t="page";break;case"Hub Project":t="project";break;case"Hub Initiative":t="initiative"}return t}var i;n.d(t,{P:function(){return i},g:function(){return r}}),function(e){e.overview="home",e.details="edit-attributes",e.settings="gear"}(i||(i={}))}}]);
//# sourceMappingURL=42097.4d0344c7.chunk.js.map