"use strict";(self.webpackChunkhub_layout_versioning=self.webpackChunkhub_layout_versioning||[]).push([[75049],{48202:function(e,n,t){var i,r,a,o,l,u,c,d,s,f,v,p,m,_,g,h,y,C,T,S,x,w,b,R,I,E,L,P,O,D,M,A,N,k,F,B,z,U,H,Z,W,G,K,V,q,X,Y,j,J,Q,$,ee,ne,te,ie,re,ae,oe,le,ue,ce;t.d(n,{$y:function(){return w},AH:function(){return r},CS:function(){return Y},DD:function(){return d},Dd:function(){return O},Em:function(){return x},JS:function(){return q},Ky:function(){return s},Lh:function(){return j},Qb:function(){return ae},RL:function(){return i},RS:function(){return le},TF:function(){return S},Tx:function(){return l},UR:function(){return y},UX:function(){return re},bj:function(){return X},eZ:function(){return c},id:function(){return I},kP:function(){return B},of:function(){return v},r4:function(){return Z},sj:function(){return z},v2:function(){return a},zQ:function(){return P},zV:function(){return h}}),function(e){e[e.BUTT=0]="BUTT",e[e.ROUND=1]="ROUND",e[e.SQUARE=2]="SQUARE",e[e.UNKNOWN=4]="UNKNOWN"}(i||(i={})),function(e){e[e.BEVEL=0]="BEVEL",e[e.ROUND=1]="ROUND",e[e.MITER=2]="MITER",e[e.UNKNOWN=4]="UNKNOWN"}(r||(r={})),function(e){e[e.SCREEN=0]="SCREEN",e[e.MAP=1]="MAP"}(a||(a={})),function(e){e[e.Tint=0]="Tint",e[e.Ignore=1]="Ignore",e[e.Multiply=99]="Multiply"}(o||(o={})),function(e){e.Both="Both",e.JustBegin="JustBegin",e.JustEnd="JustEnd",e.None="None"}(l||(l={})),function(e){e[e.Mosaic=0]="Mosaic",e[e.Centered=1]="Centered"}(u||(u={})),function(e){e[e.Normal=0]="Normal",e[e.Superscript=1]="Superscript",e[e.Subscript=2]="Subscript"}(c||(c={})),function(e){e[e.MSSymbol=0]="MSSymbol",e[e.Unicode=1]="Unicode"}(d||(d={})),function(e){e[e.Unspecified=0]="Unspecified",e[e.TrueType=1]="TrueType",e[e.PSOpenType=2]="PSOpenType",e[e.TTOpenType=3]="TTOpenType",e[e.Type1=4]="Type1"}(s||(s={})),function(e){e[e.Display=0]="Display",e[e.Map=1]="Map"}(f||(f={})),function(e){e.None="None",e.Loop="Loop",e.Oscillate="Oscillate"}(v||(v={})),function(e){e[e.Z=0]="Z",e[e.X=1]="X",e[e.Y=2]="Y"}(p||(p={})),function(e){e[e.XYZ=0]="XYZ",e[e.ZXY=1]="ZXY",e[e.YXZ=2]="YXZ"}(m||(m={})),function(e){e[e.Rectangle=0]="Rectangle",e[e.RoundedRectangle=1]="RoundedRectangle",e[e.Oval=2]="Oval"}(_||(_={})),function(e){e[e.None=0]="None",e[e.Alpha=1]="Alpha",e[e.Screen=2]="Screen",e[e.Multiply=3]="Multiply",e[e.Add=4]="Add"}(g||(g={})),function(e){e[e.TTB=0]="TTB",e[e.RTL=1]="RTL",e[e.BTT=2]="BTT"}(h||(h={})),function(e){e[e.None=0]="None",e[e.SignPost=1]="SignPost",e[e.FaceNearPlane=2]="FaceNearPlane"}(y||(y={})),function(e){e[e.Float=0]="Float",e[e.String=1]="String",e[e.Boolean=2]="Boolean"}(C||(C={})),function(e){e[e.Intersect=0]="Intersect",e[e.Subtract=1]="Subtract"}(T||(T={})),function(e){e.OpenEnded="OpenEnded",e.Block="Block",e.Crossed="Crossed"}(S||(S={})),function(e){e.FullGeometry="FullGeometry",e.PerpendicularFromFirstSegment="PerpendicularFromFirstSegment",e.ReversedFirstSegment="ReversedFirstSegment",e.PerpendicularToSecondSegment="PerpendicularToSecondSegment",e.SecondSegmentWithTicks="SecondSegmentWithTicks",e.DoublePerpendicular="DoublePerpendicular",e.OppositeToFirstSegment="OppositeToFirstSegment",e.TriplePerpendicular="TriplePerpendicular",e.HalfCircleFirstSegment="HalfCircleFirstSegment",e.HalfCircleSecondSegment="HalfCircleSecondSegment",e.HalfCircleExtended="HalfCircleExtended",e.OpenCircle="OpenCircle",e.CoverageEdgesWithTicks="CoverageEdgesWithTicks",e.GapExtentWithDoubleTicks="GapExtentWithDoubleTicks",e.GapExtentMidline="GapExtentMidline",e.Chevron="Chevron",e.PerpendicularWithArc="PerpendicularWithArc",e.ClosedHalfCircle="ClosedHalfCircle",e.TripleParallelExtended="TripleParallelExtended",e.ParallelWithTicks="ParallelWithTicks",e.Parallel="Parallel",e.PerpendicularToFirstSegment="PerpendicularToFirstSegment",e.ParallelOffset="ParallelOffset",e.OffsetOpposite="OffsetOpposite",e.OffsetSame="OffsetSame",e.CircleWithArc="CircleWithArc",e.DoubleJog="DoubleJog",e.PerpendicularOffset="PerpendicularOffset",e.LineExcludingLastSegment="LineExcludingLastSegment",e.MultivertexArrow="MultivertexArrow",e.CrossedArrow="CrossedArrow",e.ChevronArrow="ChevronArrow",e.ChevronArrowOffset="ChevronArrowOffset",e.PartialFirstSegment="PartialFirstSegment",e.Arch="Arch",e.CurvedParallelTicks="CurvedParallelTicks",e.Arc90Degrees="Arc90Degrees"}(x||(x={})),function(e){e.Mitered="Mitered",e.Bevelled="Bevelled",e.Rounded="Rounded",e.Square="Square",e.TrueBuffer="TrueBuffer"}(w||(w={})),function(e){e.ClosePath="ClosePath",e.ConvexHull="ConvexHull",e.RectangularBox="RectangularBox"}(b||(b={})),function(e){e.BeginningOfLine="BeginningOfLine",e.EndOfLine="EndOfLine"}(R||(R={})),function(e){e.Mitered="Mitered",e.Bevelled="Bevelled",e.Rounded="Rounded",e.Square="Square"}(I||(I={})),function(e){e.Fast="Fast",e.Accurate="Accurate"}(E||(E={})),function(e){e.BeginningOfLine="BeginningOfLine",e.EndOfLine="EndOfLine"}(L||(L={})),function(e){e.Sinus="Sinus",e.Square="Square",e.Triangle="Triangle",e.Random="Random"}(P||(P={})),function(e){e[e.None=0]="None",e[e.Default=1]="Default",e[e.Force=2]="Force"}(O||(O={})),function(e){e[e.Buffered=0]="Buffered",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.AlongLine=3]="AlongLine"}(D||(D={})),function(e){e[e.Linear=0]="Linear",e[e.Rectangular=1]="Rectangular",e[e.Circular=2]="Circular",e[e.Buffered=3]="Buffered"}(M||(M={})),function(e){e[e.Discrete=0]="Discrete",e[e.Continuous=1]="Continuous"}(A||(A={})),function(e){e[e.AcrossLine=0]="AcrossLine",e[e.AloneLine=1]="AloneLine"}(N||(N={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Center=2]="Center",e[e.Justify=3]="Justify"}(k||(k={})),function(e){e[e.Base=0]="Base",e[e.MidPoint=1]="MidPoint",e[e.ThreePoint=2]="ThreePoint",e[e.FourPoint=3]="FourPoint",e[e.Underline=4]="Underline",e[e.CircularCW=5]="CircularCW",e[e.CircularCCW=6]="CircularCCW"}(F||(F={})),function(e){e.Butt="Butt",e.Round="Round",e.Square="Square"}(B||(B={})),function(e){e.NoConstraint="NoConstraint",e.HalfPattern="HalfPattern",e.HalfGap="HalfGap",e.FullPattern="FullPattern",e.FullGap="FullGap",e.Custom="Custom"}(z||(z={})),function(e){e[e.None=-1]="None",e[e.Custom=0]="Custom",e[e.Circle=1]="Circle",e[e.OpenArrow=2]="OpenArrow",e[e.ClosedArrow=3]="ClosedArrow",e[e.Diamond=4]="Diamond"}(U||(U={})),function(e){e[e.ExtraLeading=0]="ExtraLeading",e[e.Multiple=1]="Multiple",e[e.Exact=2]="Exact"}(H||(H={})),function(e){e.Bevel="Bevel",e.Round="Round",e.Miter="Miter"}(Z||(Z={})),function(e){e[e.Default=0]="Default",e[e.String=1]="String",e[e.Numeric=2]="Numeric"}(W||(W={})),function(e){e[e.InsidePolygon=0]="InsidePolygon",e[e.PolygonCenter=1]="PolygonCenter",e[e.RandomlyInsidePolygon=2]="RandomlyInsidePolygon"}(G||(G={})),function(e){e[e.Tint=0]="Tint",e[e.Replace=1]="Replace",e[e.Multiply=2]="Multiply"}(K||(K={})),function(e){e[e.ClipAtBoundary=0]="ClipAtBoundary",e[e.RemoveIfCenterOutsideBoundary=1]="RemoveIfCenterOutsideBoundary",e[e.DoNotTouchBoundary=2]="DoNotTouchBoundary",e[e.DoNotClip=3]="DoNotClip"}(V||(V={})),function(e){e.NoConstraint="NoConstraint",e.WithMarkers="WithMarkers",e.WithFullGap="WithFullGap",e.WithHalfGap="WithHalfGap",e.Custom="Custom"}(q||(q={})),function(e){e.Fixed="Fixed",e.Random="Random",e.RandomFixedQuantity="RandomFixedQuantity"}(X||(X={})),function(e){e.LineMiddle="LineMiddle",e.LineBeginning="LineBeginning",e.LineEnd="LineEnd",e.SegmentMidpoint="SegmentMidpoint"}(Y||(Y={})),function(e){e.OnPolygon="OnPolygon",e.CenterOfMass="CenterOfMass",e.BoundingBoxCenter="BoundingBoxCenter"}(j||(j={})),function(e){e[e.Low=0]="Low",e[e.Medium=1]="Medium",e[e.High=2]="High"}(J||(J={})),function(e){e[e.MarkerCenter=0]="MarkerCenter",e[e.MarkerBounds=1]="MarkerBounds"}(Q||(Q={})),function(e){e[e.None=0]="None",e[e.PropUniform=1]="PropUniform",e[e.PropNonuniform=2]="PropNonuniform",e[e.DifUniform=3]="DifUniform",e[e.DifNonuniform=4]="DifNonuniform"}($||($={})),function(e){e.Tube="Tube",e.Strip="Strip",e.Wall="Wall"}(ee||(ee={})),function(e){e[e.Random=0]="Random",e[e.Increasing=1]="Increasing",e[e.Decreasing=2]="Decreasing",e[e.IncreasingThenDecreasing=3]="IncreasingThenDecreasing"}(ne||(ne={})),function(e){e[e.Relative=0]="Relative",e[e.Absolute=1]="Absolute"}(te||(te={})),function(e){e[e.Normal=0]="Normal",e[e.LowerCase=1]="LowerCase",e[e.Allcaps=2]="Allcaps"}(ie||(ie={})),function(e){e[e.LTR=0]="LTR",e[e.RTL=1]="RTL"}(re||(re={})),function(e){e.Draft="Draft",e.Picture="Picture",e.Text="Text"}(ae||(ae={})),function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Baseline=2]="Baseline",e[e.Bottom=3]="Bottom"}(oe||(oe={})),function(e){e[e.Right=0]="Right",e[e.Upright=1]="Upright"}(le||(le={})),function(e){e[e.Small=0]="Small",e[e.Medium=1]="Medium",e[e.Large=2]="Large"}(ue||(ue={})),function(e){e[e.Calm=0]="Calm",e[e.Rippled=1]="Rippled",e[e.Slight=2]="Slight",e[e.Moderate=3]="Moderate"}(ce||(ce={}))},28297:function(e,n,t){t.d(n,{Z:function(){return S}});var i=t(15671),r=t(43144),a=t(10106),o=t(34052),l=t(65706),u=function(e){return(0,l.K)({ID:e.id,PATTERN:e.pattern})},c={shaders:function(e){return{vertexShader:u(e)+(0,o.w)("background/background.vert"),fragmentShader:u(e)+(0,o.w)("background/background.frag")}}},d=function(e){return(0,l.K)({ID:e.id})},s={shaders:function(e){return{vertexShader:d(e)+(0,o.w)("circle/circle.vert"),fragmentShader:d(e)+(0,o.w)("circle/circle.frag")}}},f=function(e){return(0,l.K)({ID:e.id,PATTERN:e.pattern})},v={shaders:function(e){return{vertexShader:f(e)+(0,o.w)("fill/fill.vert"),fragmentShader:f(e)+(0,o.w)("fill/fill.frag")}}},p=function(e){return(0,l.K)({ID:e.id})},m={shaders:function(e){return{vertexShader:p(e)+(0,o.w)("outline/outline.vert"),fragmentShader:p(e)+(0,o.w)("outline/outline.frag")}}},_=function(e){return(0,l.K)({ID:e.id,SDF:e.sdf})},g={shaders:function(e){return{vertexShader:_(e)+(0,o.w)("icon/icon.vert"),fragmentShader:_(e)+(0,o.w)("icon/icon.frag")}}},h=function(e){return(0,l.K)({ID:e.id,PATTERN:e.pattern,SDF:e.sdf})},y={shaders:function(e){return{vertexShader:h(e)+(0,o.w)("line/line.vert"),fragmentShader:h(e)+(0,o.w)("line/line.frag")}}},C=function(e){return(0,l.K)({ID:e.id})},T={shaders:function(e){return{vertexShader:C(e)+(0,o.w)("text/text.vert"),fragmentShader:C(e)+(0,o.w)("text/text.frag")}}},S=function(){function e(){(0,i.Z)(this,e),this._programByKey=new Map}return(0,r.Z)(e,[{key:"dispose",value:function(){this._programByKey.forEach((function(e){return e.dispose()})),this._programByKey.clear()}},{key:"getMaterialProgram",value:function(e,n,t){var i=n.key<<3|this._getMaterialOptionsValue(n.type,t);if(this._programByKey.has(i))return this._programByKey.get(i);var r=(0,this._getProgramTemplate(n.type).shaders)(t),a=r.vertexShader,o=r.fragmentShader,l=n.getShaderHeader(),u=n.getShaderMain(),c=a.replace("#pragma header",l).replace("#pragma main",u),d=e.programCache.acquire(c,o,n.getAttributeLocations());return this._programByKey.set(i,d),d}},{key:"_getMaterialOptionsValue",value:function(e,n){switch(e){case a._K.BACKGROUND:var t=n;return(t.pattern?1:0)<<1|(t.id?1:0);case a._K.FILL:var i=n;return(i.pattern?1:0)<<1|(i.id?1:0);case a._K.OUTLINE:return n.id?1:0;case a._K.LINE:var r=n;return(r.sdf?1:0)<<2|(r.pattern?1:0)<<1|(r.id?1:0);case a._K.ICON:var o=n;return(o.sdf?1:0)<<1|(o.id?1:0);case a._K.CIRCLE:case a._K.TEXT:return n.id?1:0;default:return 0}}},{key:"_getProgramTemplate",value:function(e){switch(e){case a._K.BACKGROUND:return c;case a._K.CIRCLE:return s;case a._K.FILL:return v;case a._K.ICON:return g;case a._K.LINE:return y;case a._K.OUTLINE:return m;case a._K.TEXT:return T;default:return null}}}]),e}()},34052:function(e,n,t){t.d(n,{w:function(){return a}});var i={background:{"background.frag":"#ifdef PATTERN\nuniform lowp float u_opacity;\nuniform lowp sampler2D u_texture;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_tileTextureCoord;\n#else\nuniform lowp vec4 u_color;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main() {\n#ifdef PATTERN\nmediump vec2 normalizedTextureCoord = mod(v_tileTextureCoord, 1.0);\nmediump vec2 samplePos = mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\nlowp vec4 color = texture2D(u_texture, samplePos);\ngl_FragColor = u_opacity * color;\n#else\ngl_FragColor = u_color;\n#endif\n#ifdef ID\nif (gl_FragColor.a < 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor = v_id;\n#endif\n}","background.vert":"precision mediump float;\nattribute vec2 a_pos;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_coord_range;\nuniform mediump float u_depth;\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\nuniform mediump vec4 u_tlbr;\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\n#endif\nvoid main() {\ngl_Position = vec4((u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0)).xy, u_depth, 1.0);\n#ifdef PATTERN\nv_tileTextureCoord = (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\nv_tlbr             = u_tlbr / u_mosaicSize.xyxy;\n#endif\n#ifdef ID\nv_id = u_id / 255.0;\n#endif\n}"},circle:{"circle.frag":"precision lowp float;\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nmediump float dist = length(v_offset);\nmediump float alpha = smoothstep(0.0, -v_blur, dist - 1.0);\nlowp float color_mix_ratio = v_stroke_width < 0.01 ? 0.0 : smoothstep(-v_blur, 0.0, dist - v_radius / (v_radius + v_stroke_width));\ngl_FragColor = alpha * mix(v_color, v_stroke_color, color_mix_ratio);\n#ifdef ID\nif (gl_FragColor.a < 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor = v_id;\n#endif\n}","circle.vert":"precision mediump float;\nattribute vec2 a_pos;\n#pragma header\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_circleTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_antialiasingWidth;\nvoid main()\n{\n#pragma main\nv_color = color * opacity;\nv_stroke_color = stroke_color * stroke_opacity;\nv_stroke_width = stroke_width;\nv_radius = radius;\nv_blur = max(blur, u_antialiasingWidth / (radius + stroke_width));\nmediump vec2 offset = vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\nv_offset = offset;\n#ifdef ID\nv_id = u_id / 255.0;\n#endif\nmediump vec3 pos = u_dvsMat3 * vec3(a_pos * 0.5, 1.0) + u_displayMat3 * vec3((v_radius + v_stroke_width) * offset + u_circleTranslation, 0.0);\ngl_Position = vec4(pos.xy, u_depth, 1.0);\n}"},fill:{"fill.frag":"precision lowp float;\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\nvarying mediump vec4 v_tlbr;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvec4 mixColors(vec4 color1, vec4 color2) {\nfloat compositeAlpha = color2.a + color1.a * (1.0 - color2.a);\nvec3 compositeColor = color2.rgb + color1.rgb * (1.0 - color2.a);\nreturn vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef PATTERN\nmediump vec2 normalizedTextureCoord = fract(v_tileTextureCoord);\nmediump vec2 samplePos = mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\nlowp vec4 color = texture2D(u_texture, samplePos);\ngl_FragColor = v_color[3] * color;\n#else\ngl_FragColor = v_color;\n#endif\n#ifdef ID\nif (gl_FragColor.a < 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor = v_id;\n#endif\n}","fill.vert":"precision mediump float;\nattribute vec2 a_pos;\n#pragma header\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_fillTranslation;\n#ifdef PATTERN\n#include <util/util.glsl>\nuniform mediump vec2 u_mosaicSize;\nuniform mediump float u_patternFactor;\nvarying mediump vec2 v_tileTextureCoord;\nvarying mediump vec4 v_tlbr;\n#endif\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvoid main()\n{\n#pragma main\nv_color = color * opacity;\n#ifdef ID\nv_id = u_id / 255.0;\n#endif\n#ifdef PATTERN\nfloat patternWidth = nextPOT(tlbr.z - tlbr.x);\nfloat patternHeight = nextPOT(tlbr.w - tlbr.y);\nfloat scaleX = 1.0 / (patternWidth * u_patternFactor);\nfloat scaleY = 1.0 / (patternHeight * u_patternFactor);\nmat3 patterMat = mat3(scaleX, 0.0,    0.0,\n0.0,    -scaleY, 0.0,\n0.0,    0.0,    1.0);\nv_tileTextureCoord = (patterMat * vec3(a_pos, 1.0)).xy;\nv_tlbr             = tlbr / u_mosaicSize.xyxy;\n#endif\nvec3 pos = u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(u_fillTranslation, 0.0);\ngl_Position = vec4(pos.xy, u_depth, 1.0);\n}"},icon:{"icon.frag":"precision mediump float;\nuniform lowp sampler2D u_texture;\n#ifdef SDF\nuniform lowp vec4 u_color;\nuniform lowp vec4 u_outlineColor;\n#endif\nvarying mediump vec2 v_tex;\nvarying lowp float v_opacity;\nvarying mediump vec2 v_size;\nvarying lowp vec4 v_color;\n#ifdef SDF\nvarying mediump flaot v_halo_width;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\n#include <util/encoding.glsl>\nvec4 mixColors(vec4 color1, vec4 color2) {\nfloat compositeAlpha = color2.a + color1.a * (1.0 - color2.a);\nvec3 compositeColor = color2.rgb + color1.rgb * (1.0 - color2.a);\nreturn vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef SDF\nlowp vec4 fillPixelColor = v_color;\nfloat d = rgba2float(texture2D(u_texture, v_tex)) - 0.5;\nconst float softEdgeRatio = 0.248062016;\nfloat size = max(v_size.x, v_size.y);\nfloat dist = d * softEdgeRatio * size;\nfillPixelColor *= clamp(0.5 - dist, 0.0, 1.0);\nif (v_halo_width > 0.25) {\nlowp vec4 outlinePixelColor = u_outlineColor;\nconst float outlineLimitRatio = (16.0 / 86.0);\nfloat clampedOutlineSize = softEdgeRatio * min(v_halo_width, outlineLimitRatio * max(v_size.x, v_size.y));\noutlinePixelColor *= clamp(0.5 - (abs(dist) - clampedOutlineSize), 0.0, 1.0);\ngl_FragColor = v_opacity * mixColors(fillPixelColor, outlinePixelColor);\n}\nelse {\ngl_FragColor = v_opacity * fillPixelColor;\n}\n#else\nlowp vec4 texColor = texture2D(u_texture, v_tex);\ngl_FragColor = v_opacity * texColor;\n#endif\n#ifdef ID\nif (gl_FragColor.a < 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor = v_id;\n#endif\n}","icon.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texAngleRange;\nattribute vec4 a_levelInfo;\nattribute float a_opacityInfo;\n#pragma header\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\n#ifdef SDF\nvarying mediump float v_halo_width;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_iconTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeDuration;\nvarying mediump vec2 v_tex;\nvarying lowp float v_opacity;\nvarying mediump vec2 v_size;\nconst float C_OFFSET_PRECISION = 1.0 / 8.0;\nconst float C_256_TO_RAD = 3.14159265359 / 128.0;\nconst float C_DEG_TO_RAD = 3.14159265359 / 180.0;\nconst float tileCoordRatio = 1.0 / 8.0;\nuniform highp float u_time;\nvoid main()\n{\n#pragma main\nv_color = color;\nv_opacity = opacity;\n#ifdef SDF\nv_halo_width = halo_width;\n#endif\nfloat modded = mod(a_opacityInfo, 128.0);\nfloat targetOpacity = (a_opacityInfo - modded) / 128.0;\nfloat startOpacity = modded / 127.0;\nfloat interpolatedOpacity = clamp(startOpacity + 2.0 * (targetOpacity - 0.5) * u_time / u_fadeDuration, 0.0, 1.0);\nv_opacity *= interpolatedOpacity;\nmediump float a_angle         = a_levelInfo[1];\nmediump float a_minLevel      = a_levelInfo[2];\nmediump float a_maxLevel      = a_levelInfo[3];\nmediump vec2 a_tex            = a_texAngleRange.xy;\nmediump float delta_z = 0.0;\nmediump float rotated = mod(a_angle + u_mapRotation, 256.0);\ndelta_z += (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated));\ndelta_z += 1.0 - step(a_minLevel, u_level);\ndelta_z += step(a_maxLevel, u_level);\ndelta_z += step(v_opacity, 0.0);\nvec2 offset = C_OFFSET_PRECISION * a_vertexOffset;\nv_size = abs(offset);\n#ifdef SDF\noffset = (120.0 / 86.0) * offset;\n#endif\nmediump vec3 pos = u_dvsMat3 * vec3(a_pos, 1.0) + u_displayViewMat3 * vec3(size * offset, 0.0) + u_displayMat3 * vec3(u_iconTranslation, 0.0);\ngl_Position = vec4(pos.xy, u_depth + delta_z, 1.0);\n#ifdef ID\nv_id = u_id / 255.0;\n#endif\nv_tex = a_tex.xy / u_mosaicSize;\n}"},line:{"line.frag":"precision lowp float;\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nvarying mediump float v_lineHalfWidth;\nvarying lowp vec4 v_color;\nvarying mediump float v_blur;\n#if defined (PATTERN) || defined(SDF)\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\nvarying mediump float v_widthRatio;\nuniform sampler2D u_texture;\nuniform mediump float u_antialiasing;\n#endif\n#ifdef SDF\n#include <util/encoding.glsl>\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nmediump float fragDist = length(v_normal) * v_lineHalfWidth;\nlowp float alpha = clamp((v_lineHalfWidth - fragDist) / v_blur, 0.0, 1.0);\n#ifdef PATTERN\nmediump float relativeTexX = fract(v_accumulatedDistance / (v_patternSize.x * v_widthRatio));\nmediump float relativeTexY = 0.5 + v_normal.y * v_lineHalfWidth / (v_patternSize.y * v_widthRatio);\nmediump vec2 texCoord = mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\nlowp vec4 color = texture2D(u_texture, texCoord);\ngl_FragColor = alpha * v_color[3] * color;\n#elif defined(SDF)\nmediump float relativeTexX = fract((v_accumulatedDistance * 0.5) / (v_patternSize.x * v_widthRatio));\nmediump float relativeTexY =  0.5 + 0.25 * v_normal.y;\nmediump vec2 texCoord = mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\nmediump float d = rgba2float(texture2D(u_texture, texCoord)) - 0.5;\nfloat dist = d * (v_lineHalfWidth + u_antialiasing / 2.0);\ngl_FragColor = alpha * clamp(0.5 - dist, 0.0, 1.0) * v_color;\n#else\ngl_FragColor = alpha * v_color;\n#endif\n#ifdef ID\nif (gl_FragColor.a < 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor = v_id;\n#endif\n}","line.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec4 a_extrude_offset;\nattribute vec4 a_dir_normal;\nattribute vec2 a_accumulatedDistance;\n#pragma header\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump float u_zoomFactor;\nuniform mediump vec2 u_lineTranslation;\nuniform mediump float u_antialiasing;\nuniform mediump float u_depth;\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nconst float scale = 1.0 / 31.0;\nconst mediump float tileCoordRatio = 8.0;\n#if defined (SDF)\nconst mediump float sdfPatternHalfWidth = 15.5;\n#endif\n#if defined (PATTERN) || defined(SDF)\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\nvarying mediump float v_widthRatio;\n#endif\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvarying mediump float v_lineHalfWidth;\nvarying mediump float v_blur;\nvoid main()\n{\n#pragma main\nv_color = color * opacity;\nv_blur = blur + u_antialiasing;\nv_normal = a_dir_normal.zw * scale;\n#if defined (PATTERN) || defined(SDF)\nv_tlbr          = tlbr / u_mosaicSize.xyxy;\nv_patternSize   = vec2(tlbr.z - tlbr.x, tlbr.y - tlbr.w);\n#if defined (PATTERN)\nv_widthRatio = width / v_patternSize.y;\n#else\nv_widthRatio = width / sdfPatternHalfWidth / 2.0;\n#endif\n#endif\nv_lineHalfWidth = (width + u_antialiasing) * 0.5;\nmediump vec2 dir = a_dir_normal.xy * scale;\nmediump vec2 offset_ = a_extrude_offset.zw * scale * offset;\nmediump vec2 dist = v_lineHalfWidth * scale * a_extrude_offset.xy;\nmediump vec3 pos = u_dvsMat3 * vec3(a_pos + offset_ * tileCoordRatio / u_zoomFactor, 1.0) + u_displayViewMat3 * vec3(dist, 0.0) + u_displayMat3 * vec3(u_lineTranslation, 0.0);\ngl_Position = vec4(pos.xy, u_depth, 1.0);\n#if defined (PATTERN) || defined(SDF)\nv_accumulatedDistance = a_accumulatedDistance.x * u_zoomFactor / tileCoordRatio + dot(dir, dist + offset_);\n#endif\n#ifdef ID\nv_id = u_id / 255.0;\n#endif\n}"},outline:{"outline.frag":"varying lowp vec4 v_color;\nvarying mediump vec2 v_normal;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nlowp float dist = abs(v_normal.y);\nlowp float alpha = smoothstep(1.0, 0.0, dist);\ngl_FragColor = alpha * v_color;\n#ifdef ID\nif (gl_FragColor.a < 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor = v_id;\n#endif\n}","outline.vert":"attribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_xnormal;\n#pragma header\nvarying lowp vec4 v_color;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_fillTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_outline_width;\nvarying lowp vec2 v_normal;\nconst float scale = 1.0 / 15.0;\nvoid main()\n{\n#pragma main\nv_color = color * opacity;\n#ifdef ID\nv_id = u_id / 255.0;\n#endif\nv_normal = a_xnormal;\nmediump vec2 dist = u_outline_width * scale * a_offset;\nmediump vec3 pos = u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(dist + u_fillTranslation, 0.0);\ngl_Position = vec4(pos.xy, u_depth, 1.0);\n}"},text:{"text.frag":"uniform lowp sampler2D u_texture;\nvarying lowp vec2 v_tex;\nvarying lowp vec4 v_color;\nvarying mediump float v_edgeWidth;\nvarying mediump float v_edgeDistance;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nlowp float dist = texture2D(u_texture, v_tex).a;\nmediump float alpha = smoothstep(v_edgeDistance - v_edgeWidth, v_edgeDistance + v_edgeWidth, dist);\ngl_FragColor = alpha * v_color;\n#ifdef ID\nif (gl_FragColor.a < 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor = v_id;\n#endif\n}","text.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texAngleRange;\nattribute vec4 a_levelInfo;\nattribute float a_opacityInfo;\n#pragma header\nvarying lowp vec4 v_color;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_textTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeDuration;\nvarying lowp vec2 v_tex;\nconst float offsetPrecision = 1.0 / 8.0;\nconst mediump float edgePos = 0.75;\nuniform mediump float u_antialiasingWidth;\nvarying mediump float v_edgeDistance;\nvarying mediump float v_edgeWidth;\nuniform lowp float u_halo;\nconst float sdfFontScale = 1.0 / 24.0;\nconst float sdfPixel = 3.0;\nuniform highp float u_time;\nvoid main()\n{\n#pragma main\nif (u_halo > 0.5)\n{\nv_color = halo_color * opacity;\nhalo_width *= sdfPixel;\nhalo_blur *= sdfPixel;\n}\nelse\n{\nv_color = color * opacity;\nhalo_width = 0.0;\nhalo_blur = 0.0;\n}\nfloat modded = mod(a_opacityInfo, 128.0);\nfloat targetOpacity = (a_opacityInfo - modded) / 128.0;\nfloat startOpacity = modded / 127.0;\nfloat interpolatedOpacity = clamp(startOpacity + 2.0 * (targetOpacity - 0.5) * u_time / u_fadeDuration, 0.0, 1.0);\nv_color *= interpolatedOpacity;\nmediump float a_angle       = a_levelInfo[1];\nmediump float a_minLevel    = a_levelInfo[2];\nmediump float a_maxLevel    = a_levelInfo[3];\nmediump vec2 a_tex          = a_texAngleRange.xy;\nmediump float a_visMinAngle    = a_texAngleRange.z;\nmediump float a_visMaxAngle    = a_texAngleRange.w;\nmediump float delta_z = 0.0;\nmediump float angle = mod(a_angle + u_mapRotation, 256.0);\nif (a_visMinAngle < a_visMaxAngle)\n{\ndelta_z += (1.0 - step(u_keepUpright, 0.0)) * (step(a_visMaxAngle, angle) + (1.0 - step(a_visMinAngle, angle)));\n}\nelse\n{\ndelta_z += (1.0 - step(u_keepUpright, 0.0)) * (step(a_visMaxAngle, angle) * (1.0 - step(a_visMinAngle, angle)));\n}\ndelta_z += 1.0 - step(a_minLevel, u_level);\ndelta_z += step(a_maxLevel, u_level);\ndelta_z += step(v_color[3], 0.0);\nv_tex = a_tex.xy / u_mosaicSize;\n#ifdef ID\nv_id = u_id / 255.0;\n#endif\nv_edgeDistance = edgePos - halo_width / size;\nv_edgeWidth = (u_antialiasingWidth + halo_blur) / size;\nmediump vec3 pos = u_dvsMat3 * vec3(a_pos, 1.0) + sdfFontScale * u_displayViewMat3 * vec3(offsetPrecision * size * a_vertexOffset, 0.0) + u_displayMat3 * vec3(u_textTranslation, 0.0);\ngl_Position = vec4(pos.xy, u_depth + delta_z, 1.0);\n}"},util:{"encoding.glsl":"const vec4 rgba2float_factors = vec4(\n255.0 / (256.0),\n255.0 / (256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n);\nfloat rgba2float(vec4 rgba) {\nreturn dot(rgba, rgba2float_factors);\n}","util.glsl":"float nextPOT(in float x) {\nreturn pow(2.0, ceil(log2(abs(x))));\n}"}};var r=new(t(56648).B)((function(e){var n=i;return e.split("/").forEach((function(e){n&&(n=n[e])})),n}));function a(e){return r.resolveIncludes(e)}},94109:function(e,n,t){t.d(n,{$0:function(){return o},AI:function(){return i},Al:function(){return v},By:function(){return y},C1:function(){return G},CQ:function(){return V},CU:function(){return B},D3:function(){return f},Ex:function(){return c},I_:function(){return a},Ic:function(){return p},Ij:function(){return g},Ip:function(){return Z},Iv:function(){return j},Iw:function(){return d},Jw:function(){return x},MI:function(){return W},QU:function(){return S},SD:function(){return Q},Tz:function(){return q},Uh:function(){return K},V4:function(){return F},XD:function(){return ie},XJ:function(){return H},Xj:function(){return T},Zd:function(){return M},_5:function(){return R},_6:function(){return J},a:function(){return z},aK:function(){return L},dn:function(){return k},e0:function(){return Y},eF:function(){return s},eV:function(){return l},f2:function(){return h},fL:function(){return U},iJ:function(){return m},iV:function(){return A},jk:function(){return $},kF:function(){return w},lK:function(){return P},m4:function(){return O},mx:function(){return C},nM:function(){return _},nb:function(){return te},oK:function(){return X},pU:function(){return E},ru:function(){return r},tQ:function(){return N},u4:function(){return ne},uG:function(){return D},vw:function(){return ee},xl:function(){return I},xm:function(){return u},yP:function(){return b}});var i=1e-30,r=4294967295,a=512,o=8,l=10,u=29,c=24,d=8,s={metrics:{width:15,height:17,left:0,top:-7,advance:14}},f=0,v=0,p=0,m=1,_=2,g=3,h=4,y=5,C=6,T=12,S=5,x=6,w=5,b=6,R=0,I=1,E=2,L=3,P=4,O=2,D=1,M=2,A=4,N=1.05,k=3,F=5,B=6,z=1.15,U=2,H=8,Z=500,W=10,G=1024,K=2,V=0,q=1,X=4,Y=8,j=16,J=4,Q=1,$=4,ee=8,ne=128,te=4,ie=2},80613:function(e,n,t){var i,r,a,o,l,u,c;t.d(n,{LW:function(){return i},Un:function(){return u},X:function(){return o},jx:function(){return r},mD:function(){return c},mf:function(){return l},pc:function(){return a}}),function(e){e[e.FILL=0]="FILL",e[e.LINE=1]="LINE",e[e.MARKER=2]="MARKER",e[e.TEXT=3]="TEXT",e[e.LABEL=4]="LABEL"}(i||(i={})),function(e){e[e.NONE=0]="NONE",e[e.MAP=1]="MAP",e[e.LABEL=2]="LABEL",e[e.LABEL_ALPHA=4]="LABEL_ALPHA",e[e.HITTEST=8]="HITTEST",e[e.HIGHLIGHT=16]="HIGHLIGHT",e[e.CLIP=32]="CLIP",e[e.DEBUG=64]="DEBUG",e[e.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"}(r||(r={})),function(e){e[e.SIZE=0]="SIZE",e[e.COLOR=1]="COLOR",e[e.OPACITY=2]="OPACITY",e[e.ROTATION=3]="ROTATION"}(a||(a={})),function(e){e[e.NONE=0]="NONE",e[e.OPACITY=1]="OPACITY",e[e.COLOR=2]="COLOR",e[e.ROTATION=4]="ROTATION",e[e.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE",e[e.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS",e[e.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS",e[e.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"}(o||(o={})),function(e){e[e.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE",e[e.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE",e[e.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE",e[e.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"}(l||(l={})),function(e){e[e.SPRITE=0]="SPRITE",e[e.GLYPH=1]="GLYPH"}(u||(u={})),function(e){e[e.DEFAULT=0]="DEFAULT",e[e.SIMPLE=1]="SIMPLE",e[e.DOT_DENSITY=2]="DOT_DENSITY",e[e.OUTLINE_FILL=3]="OUTLINE_FILL",e[e.OUTLINE_FILL_SIMPLE=4]="OUTLINE_FILL_SIMPLE",e[e.HEATMAP=5]="HEATMAP",e[e.PIE_CHART=6]="PIE_CHART"}(c||(c={}))},73271:function(e,n,t){t.d(n,{Au:function(){return r},Jz:function(){return o},UJ:function(){return a}});var i=new Float32Array(1);new Uint32Array(i.buffer);function r(e){return[255&e,(65280&e)>>>8,(16711680&e)>>>16,(4278190080&e)>>>24]}function a(e,n){return 65535&e|n<<16}function o(e,n,t,i){return 255&e|(255&n)<<8|(255&t)<<16|i<<24}},42069:function(e,n,t){t.d(n,{A:function(){return h}});var i=t(74165),r=t(15861),a=t(15671),o=t(43144),l=t(11752),u=t(61120),c=t(60136),d=t(92572),s=t(27366),f=t(42537),v=t(66978),p=t(94172),m=t(49861),_=(t(25243),t(63780),t(69912)),g=t(5354),h=function(e){var n=function(e){(0,c.Z)(t,e);var n=(0,d.Z)(t);function t(){var e;return(0,a.Z)(this,t),(e=n.apply(this,arguments)).slicePlaneEnabled=!1,e.supportsHeightUnitConversion=!1,e}return(0,o.Z)(t,[{key:"postscript",value:function(e){(0,l.Z)((0,u.Z)(t.prototype),"postscript",this).call(this,e),(0,g.qC)(this.layer)&&this.addResolvingPromise(this._validateHeightModelInfo())}},{key:"_validateHeightModelInfo",value:function(){var e=(0,r.Z)((0,i.Z)().mark((function e(){var n,t,r,a=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new AbortController,t=n.signal,this.handles.add((0,f.kB)((function(){return n.abort()}))),e.next=4,(0,p.N1)((function(){var e;return null===(e=a.view.defaultsFromMap)||void 0===e?void 0:e.heightModelInfoReady}),t);case 4:if((0,v.k_)(t),!(r=(0,g.Wt)(this.layer,this.view.heightModelInfo,this.supportsHeightUnitConversion))){e.next=8;break}throw r;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"canResume",value:function(){var e=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return(0,l.Z)((0,u.Z)(t.prototype),"canResume",this).call(this)&&(!e||!e.minScale||!e.maxScale||e.minScale>=e.maxScale)}},{key:"getSuspendInfo",value:function(){var e=(0,l.Z)((0,u.Z)(t.prototype),"getSuspendInfo",this).call(this),n=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return n&&n.minScale&&n.maxScale&&n.minScale<n.maxScale&&(e.outsideScaleRange=!0),e}}]),t}(e);return(0,s._)([(0,m.Cb)()],n.prototype,"view",void 0),(0,s._)([(0,m.Cb)()],n.prototype,"slicePlaneEnabled",void 0),n=(0,s._)([(0,_.j)("esri.views.3d.layers.LayerView3D")],n)}},77385:function(e,n,t){t.d(n,{r:function(){return m}});var i=t(15671),r=t(43144),a=t(60136),o=t(92572),l=t(27366),u=t(10064),c=t(92026),d=t(94172),s=t(49861),f=(t(25243),t(63780),t(69912)),v=t(58890),p=t(53379),m=function(e){var n=function(e){(0,a.Z)(t,e);var n=(0,o.Z)(t);function t(){return(0,i.Z)(this,t),n.apply(this,arguments)}return(0,r.Z)(t,[{key:"imageFormatIsOpaque",get:function(){return!1}},{key:"fullExtent",get:function(){return this.layer.fullExtent}},{key:"isOpaque",get:function(){return this.fullOpacity>=1&&this.imageFormatIsOpaque}},{key:"dataLevelRange",get:function(){var e=this.tileInfo.lods,n=e[0].scale,t=e[e.length-1].scale;return this.levelRangeFromScaleRange(n,t)}},{key:"displayLevelRange",get:function(){var e=this.tileInfo.lods,n=this.layer.minScale||e[0].scale,t=this.layer.maxScale||e[e.length-1].scale,i=this.levelRangeFromScaleRange(n,t);return this.layer.maxScale&&i.maxLevel++,i}},{key:"getTileUrl",value:function(e,n,t){return this.layer.getTileUrl(e,n,t)}},{key:"_addTilingSchemeMatchPromise",value:function(){var e=this;if((0,c.Wi)(this.fullExtent))return this.addResolvingPromise(Promise.reject(new u.Z("tilingscheme:extent-not-defined","This layer doesn't define a fullExtent.")));var n=this._getTileInfoSupportError(this.tileInfo,this.fullExtent);if((0,c.pC)(n))return this.addResolvingPromise(Promise.reject(n));var t=(0,d.N1)((function(){var n,t;return null===(n=e.view)||void 0===n||null===(t=n.basemapTerrain)||void 0===t?void 0:t.tilingSchemeLocked})).then((function(){var n=e.view.basemapTerrain.tilingScheme,t=e._getTileInfoCompatibilityError(e.tileInfo,n);if(t)throw t}));this.addResolvingPromise(t)}},{key:"_getTileInfoSupportError",value:function(e,n){var t=(0,p.er)(e,n,this.view.spatialReference,this.view.state.viewingMode);if(t){var i,r={layer:this.layer,error:t};switch(t.name){case"tilingscheme:spatial-reference-mismatch":case"tilingscheme:global-unsupported-spatial-reference":case"tilingscheme:local-unsupported-spatial-reference":i=new u.Z("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",r);break;default:i=new u.Z("layerview:tiling-scheme-unsupported","The tiling scheme of this layer is not supported by SceneView",r)}return i}return null}},{key:"_getTileInfoCompatibilityError",value:function(e,n){return(0,c.Wi)(e)||!n.compatibleWith(e)?new u.Z("layerview:tiling-scheme-incompatible","The tiling scheme of this layer is incompatible with the tiling scheme of the surface"):null}},{key:"levelRangeFromScaleRange",value:function(e,n){var t={minLevel:0,maxLevel:1/0},i=this.view&&this.view.basemapTerrain&&this.view.basemapTerrain.tilingScheme;if(!i)return t;var r=i.levels[0],a=function(e){var n=Math.log(r.scale/e)/Math.LN2;return.5-Math.abs(.5-n%1)<1e-9?Math.round(n):Math.ceil(n)};return null!=e&&e>0&&(t.minLevel=Math.max(0,a(e))),null!=n&&n>0&&(t.maxLevel=Math.max(0,a(n))),t}},{key:"isUpdating",value:function(){return!!(this.view&&this.view.basemapTerrain&&this.view.basemapTerrain.updating)}}]),t}(e);return(0,l._)([(0,s.Cb)({readOnly:!0})],n.prototype,"imageFormatIsOpaque",null),(0,l._)([(0,s.Cb)({readOnly:!0})],n.prototype,"updating",void 0),(0,l._)([(0,s.Cb)(v.q)],n.prototype,"updatingProgress",void 0),(0,l._)([(0,s.Cb)(v.V)],n.prototype,"updatingProgressValue",void 0),(0,l._)([(0,s.Cb)()],n.prototype,"fullExtent",null),(0,l._)([(0,s.Cb)({readOnly:!0})],n.prototype,"isOpaque",null),(0,l._)([(0,s.Cb)({readOnly:!0})],n.prototype,"dataLevelRange",null),(0,l._)([(0,s.Cb)({readOnly:!0})],n.prototype,"displayLevelRange",null),(0,l._)([(0,s.Cb)()],n.prototype,"layer",void 0),(0,l._)([(0,s.Cb)()],n.prototype,"tileInfo",void 0),n=(0,l._)([(0,f.j)("esri.views.3d.layers.TiledLayerView3D")],n)}},15585:function(e,n,t){t.r(n),t.d(n,{default:function(){return J}});var i=t(74165),r=t(15861),a=t(29439),o=t(15671),l=t(43144),u=t(60136),c=t(92572),d=t(27366),s=t(10064),f=t(92026),v=t(66978),p=t(94172),m=t(49861),_=(t(25243),t(63780),t(69912)),g=function(){function e(n,t){(0,o.Z)(this,e),this._lockedSchemaPixelSize=n,this._isGCS=t}return(0,l.Z)(e,[{key:"getLevelRowColumn",value:function(e){return this._isGCS?[e[0],e[1]>>1,e[2]>>1]:256===this._lockedSchemaPixelSize&&e[0]>0?[e[0]-1,e[1]>>1,e[2]>>1]:e}},{key:"adjustLevel",value:function(e){return this._isGCS?e:256===this._lockedSchemaPixelSize?e>0?e-1:0:e}},{key:"getShift",value:function(e,n){var t=0,i=0;return(256===this._lockedSchemaPixelSize||this._isGCS)&&(e[2]%2&&(t=n),e[1]%2&&(i=n)),[t,i]}},{key:"getScale",value:function(e){if(this._isGCS){if(512===this._lockedSchemaPixelSize)return 4}else if(256===this._lockedSchemaPixelSize&&0===e)return 1;return 2}}]),e}(),h=t(11752),y=t(61120),C=t(18759),T=t(23588),S=t(65156),x=t(98067),w=t(72291),b=t(38684),R=t(42121),I=t(12463),E=t(36210),L=t(50127),P=t(21391);function O(e,n){var t=[],i=new E.L(4096,t,(function(){var e=new b.J;return e.show=!1,e.parts.push({startTime:0,startOpacity:0,targetOpacity:0,show:!1}),e.parts.push({startTime:0,startOpacity:0,targetOpacity:0,show:!1}),e})),r=new I.g(t,i,(function(n,t,i){return new R.f(n,t,i,e.styleRepository,e.key.level,0)}),(function(e,n){(0,L.C$)(e,n,!1)}),(function(){return 0}),(function(e){var t=n.getStyleLayerByUID(e).getLayoutProperty("visibility");return!t||t.getValue()!==P.EE.NONE}));t.push(e),i.add(e),r.setScreenSize(512,512),r.continue(1/0)}var D=t(75572),M=t(73828),A=function(e){(0,u.Z)(t,e);var n=(0,c.Z)(t);function t(e,i,r,a,l){var u;return(0,o.Z)(this,t),(u=n.call(this,e,i,r))._memCache=a,u._loader=l,u._ongoingTileRequests=new Map,u._ongoingRequestToController=new Map,u._tileInfoView=new D.Z(e.tileInfo,e.fullExtent),u}return(0,l.Z)(t,[{key:"destroy",value:function(){(0,h.Z)((0,y.Z)(t.prototype),"destroy",this).call(this),this._ongoingRequestToController.forEach((function(e){return e.abort()})),this._ongoingRequestToController.clear(),this._ongoingTileRequests.clear()}},{key:"getVectorTile",value:function(){var e=(0,r.Z)((0,i.Z)().mark((function e(n,t,r,a){var o,l,u,c,d;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=new M.Z(n,t,r,0),l=this._memCache.get(o.id),!(0,f.pC)(l)){e.next=4;break}return e.abrupt("return",(l.retain(),l));case 4:return e.next=6,this._getVectorTileData(o);case 6:if(u=e.sent,(0,v.k_)(a),this._layer){e.next=9;break}return e.abrupt("return",null);case 9:if(l=this._memCache.get(o.id),!(0,f.pC)(l)){e.next=11;break}return e.abrupt("return",(l.retain(),l));case 11:return c=this._layer.tileInfo.getTileBounds((0,S.Ue)(),o),d=this._tileInfoView.getTileResolution(n),e.abrupt("return",(l=new w.i(o,d,c[0],c[3],512,512,this._styleRepository,this._memCache),(0,f.pC)(u)?(l.setData(u),l.retain(),this._memCache.put(o.id,l,l.memoryUsage*l.referenced,C.an)):l.setData(null),l.neededForCoverage=!0,l.transforms.tileUnitsToPixels=(0,T.f)(1/8,0,0,0,1/8,0,0,0,1),O(l,this._styleRepository),l));case 13:case"end":return e.stop()}}),e,this)})));return function(n,t,i,r){return e.apply(this,arguments)}}()},{key:"_getVectorTileData",value:function(e){var n=this,t=e.id;if(this._ongoingTileRequests.has(t))return this._ongoingTileRequests.get(t);var i=new AbortController,r={signal:i.signal},a=this._getParsedVectorTileData(e,r).then((function(e){return n._ongoingTileRequests.delete(t),n._ongoingRequestToController.delete(t),e})).catch((function(){return n._ongoingTileRequests.delete(t),n._ongoingRequestToController.delete(t),null}));return this._ongoingTileRequests.set(t,a),this._ongoingRequestToController.set(t,i),a}},{key:"_getParsedVectorTileData",value:function(e,n){var t=this;return this.fetchTileData(e,n).then((function(i){return t.parseTileData({key:e,data:i},n)}))}},{key:"request",value:function(e,n){return this._loader.request(e,"binary",n)}}]),t}(x.m),N=t(17538),k=t(5562),F=t(54410),B=t(93509),z=t(11640),U={vtlBackground:N.J,vtlFill:F.R,vtlLine:B.z,vtlCircle:k.j,vtlSymbol:z.e},H=t(28297),Z=t(8548),W=1e-6,G=function(){function e(n,t){(0,o.Z)(this,e),this.spriteMosaic=n,this.glyphMosaic=t,this._brushCache=new Map,this._vtlMaterialManager=new H.Z}return(0,l.Z)(e,[{key:"dispose",value:function(){this._brushCache&&(this._brushCache.forEach((function(e){return e.dispose()})),this._brushCache=null),this._vtlMaterialManager=(0,f.M2)(this._vtlMaterialManager),this.spriteMosaic.dispose(),this.glyphMosaic.dispose()}},{key:"vectorTilesMaterialManager",get:function(){return this._vtlMaterialManager}},{key:"drawTile",value:function(e,n,t){var i=this,r=e.context,a=t.layers;t.backgroundBucketIds.length>0&&(e.renderPass="background",t.backgroundBucketIds.forEach((function(r){return i._renderStyleLayer(t.getLayerById(r),e,n,!0)}))),r.setBlendingEnabled(!1),r.setDepthTestEnabled(!0),r.setDepthWriteEnabled(!0),r.setDepthFunction(Z.wb.LEQUAL),e.renderPass="opaque";for(var o=a.length-1;o>=0;o--)this._renderStyleLayer(a[o],e,n,!1);r.setDepthWriteEnabled(!1),r.setBlendingEnabled(!0),r.setBlendFunctionSeparate(Z.zi.ONE,Z.zi.ONE_MINUS_SRC_ALPHA,Z.zi.ONE,Z.zi.ONE_MINUS_SRC_ALPHA),e.renderPass="translucent";for(var l=0;l<a.length;l++)this._renderStyleLayer(a[l],e,n,!1);r.setDepthTestEnabled(!1),r.bindVAO()}},{key:"_renderStyleLayer",value:function(e,n,t){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(i||e&&t.layerData.has(e.uid)){var r=e.getLayoutProperty("visibility");if(!r||r.getValue()!==P.EE.NONE){var a,o=n.renderPass;switch(e.type){case P.fR.BACKGROUND:if("background"!==o)return;a="vtlBackground";break;case P.fR.FILL:if("opaque"!==o&&"translucent"!==n.renderPass)return;a="vtlFill";break;case P.fR.LINE:if("translucent"!==o)return;a="vtlLine";break;case P.fR.CIRCLE:if("translucent"!==o)return;a="vtlCircle";break;case P.fR.SYMBOL:if("translucent"!==o)return;a="vtlSymbol"}var l=n.displayLevel;void 0!==e.minzoom&&e.minzoom>l+W||void 0!==e.maxzoom&&e.maxzoom<=l-W||(n.styleLayerUID=e.uid,n.styleLayer=e,this._drawWithBrush(n,t,a))}}}},{key:"_drawWithBrush",value:function(e,n,t){if(!this._brushCache.has(t)){var i=U[t];this._brushCache.set(t,new i)}this._brushCache.get(t).drawMany(e,[n])}}]),e}(),K=t(30969),V=t(42069),q=t(77385),X=t(53379),Y=t(67581),j=function(e){(0,u.Z)(t,e);var n=(0,c.Z)(t);function t(){var e;return(0,o.Z)(this,t),(e=n.apply(this,arguments))._tileHandlerController=null,e.type="vector-tile-3d",e}return(0,l.Z)(t,[{key:"initialize",value:function(){var e=this;if((0,f.Wi)(this.layer.fullExtent))this.addResolvingPromise(Promise.reject(new s.Z("vectortilelayerview:full-extent-undefined","This layer view's layer does not define a fullExtent.")));else{var n=this.view,t=n.basemapTerrain,i=n.spatialReference,r=n.state,o="local"===n.viewingMode&&!(0,X.jO)(i)||X.Bu.force512VTL,l=this.layer.tileInfo.spatialReference.isGeographic,u=o?this.layer.tileInfo:this.layer.tileInfo.getOrCreateCompatible(256,l?1:2),c=this._getTileInfoSupportError(u,this.layer.fullExtent);if((0,f.pC)(c))return this.addResolvingPromise(Promise.reject(c));var d=(0,p.N1)((function(){var n,t;return null===(n=e.view)||void 0===n||null===(t=n.basemapTerrain)||void 0===t?void 0:t.tilingSchemeLocked})).then((function(){var n,i,r=t.tilingScheme,a=r.pixelSize;if(e.schemaHelper=new g(a,(0,f.pC)(t.spatialReference)&&t.spatialReference.isGeographic),256===a){var o=e.layer.tileInfo.spatialReference.isGeographic;i=e.layer.tileInfo.getOrCreateCompatible(256,o?1:2)}else i=null!==(n=e.view.spatialReference)&&void 0!==n&&n.isGeographic?e.layer.tileInfo.getOrCreateCompatible(512,.5):e.layer.tileInfo;var l=e._getTileInfoCompatibilityError(i,r);if(l)throw l;e.tileInfo=i}));this._tileHandlerController=new AbortController;var m=this.view.resourceController;this._memCache=m.memoryController.newCache(this.layer.uid,(function(e){e.release()}));var _=new K.Z(this.layer.currentStyleInfo.style),h=t.mapTileRequester;this._tileHandler=new A(this.layer,_,r.contentPixelRatio,this._memCache,h);var y=this._tileHandlerController.signal,C=function(e){return m.immediate.schedule(e)},T=this._tileHandler.start({signal:y,schedule:C}),S=this._tileHandler.spriteMosaic;S.then((function(n){!(0,v.Hc)(y)&&e._tileHandler&&(e.painter=new G(n,e._tileHandler.glyphMosaic))})),T.then((function(){return e._tileHandlerController=null})),this.updatingHandles.add((function(){var n;return{style:e.layer.currentStyleInfo.style,pixelRatio:null===(n=e.view.state)||void 0===n?void 0:n.contentPixelRatio}}),(function(n){var t=n.style,i=n.pixelRatio;e._tileHandlerController&&e._tileHandlerController.abort(),e._tileHandlerController=new AbortController,e._memCache.clear();var r=new K.Z(t),o=new A(e.layer,r,i,e._memCache,h),l=o.start({signal:e._tileHandlerController.signal,schedule:C}),u=o.spriteMosaic;l.then((function(){return e._tileHandlerController=null})),e.updatingHandles.addPromise(Promise.all([l,u]).then((function(n){var t=(0,a.Z)(n,2)[1],i=e._tileHandler,r=e.painter;e.painter=new G(t,o.glyphMosaic),e._tileHandler=o,e.emit("data-changed"),i.destroy(),r&&r.dispose()})))}));var x=Promise.all([d,T,S]);this.addResolvingPromise(x)}}},{key:"destroy",value:function(){this.painter=(0,f.M2)(this.painter),this._tileHandlerController=(0,f.IM)(this._tileHandlerController),(0,f.SC)(this._tileHandler),this._memCache=(0,f.SC)(this._memCache),this._tileHandler=null}},{key:"dataLevelRange",get:function(){var e=this.tileInfo.lods,n=e[0].scale,t=e[e.length-1].scale,i=this.levelRangeFromScaleRange(n,t);return 1===i.minLevel&&256===this.tileInfo.size[0]&&(i.minLevel=0),i}},{key:"fetchTile",value:function(){var e=(0,r.Z)((0,i.Z)().mark((function e(n,t,r,a){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._tileHandler.getVectorTile(n,t,r,a));case 1:case"end":return e.stop()}}),e,this)})));return function(n,t,i,r){return e.apply(this,arguments)}}()}]),t}((0,q.r)((0,V.A)(Y.Z)));(0,d._)([(0,m.Cb)()],j.prototype,"layer",void 0),(0,d._)([(0,m.Cb)()],j.prototype,"dataLevelRange",null),(0,d._)([(0,m.Cb)()],j.prototype,"updatingProgressValue",void 0);var J=j=(0,d._)([(0,_.j)("esri.views.3d.layers.VectorTileLayerView3D")],j)},67581:function(e,n,t){t.d(n,{Z:function(){return h}});var i=t(15671),r=t(43144),a=t(60136),o=t(92572),l=t(27366),u=t(31319),c=t(91505),d=t(41691),s=t(79056),f=t(32718),v=t(92026),p=t(67426),m=t(49861),_=(t(25243),t(63780),t(69912)),g=function(e){(0,a.Z)(t,e);var n=(0,o.Z)(t);function t(e){var r;return(0,i.Z)(this,t),(r=n.call(this,e)).layer=null,r.parent=null,r}return(0,r.Z)(t,[{key:"initialize",value:function(){var e=this;this.when().catch((function(n){if("layerview:create-error"!==n.name){var t=e.layer&&e.layer.id||"no id",i=e.layer&&e.layer.title||"no title";f.Z.getLogger(e.declaredClass).error("#resolve()","Failed to resolve layer view (layer title: '".concat(i,"', id: '").concat(t,"')"),n)}}))}},{key:"fullOpacity",get:function(){return(0,v.Pt)(this.get("layer.opacity"),1)*(0,v.Pt)(this.get("parent.fullOpacity"),1)}},{key:"suspended",get:function(){return!this.canResume()}},{key:"suspendInfo",get:function(){return this.getSuspendInfo()}},{key:"legendEnabled",get:function(){var e;return!this.suspended&&!0===(null===(e=this.layer)||void 0===e?void 0:e.legendEnabled)}},{key:"updating",get:function(){var e;return!((null===(e=this.updatingHandles)||void 0===e||!e.updating)&&!this.isUpdating())}},{key:"updatingProgress",get:function(){return this.updating?0:1}},{key:"visible",get:function(){var e;return!0===(null===(e=this.layer)||void 0===e?void 0:e.visible)},set:function(e){this._overrideIfSome("visible",e)}},{key:"canResume",value:function(){var e,n,t;return this.visible&&(null===(e=this.layer)||void 0===e?void 0:e.loaded)&&!(null!==(n=this.parent)&&void 0!==n&&n.suspended)&&(null===(t=this.view)||void 0===t?void 0:t.ready)||!1}},{key:"getSuspendInfo",value:function(){var e=this.parent&&this.parent.suspended?this.parent.suspendInfo:{};return this.view&&this.view.ready||(e.viewNotReady=!0),this.layer&&this.layer.loaded||(e.layerNotLoaded=!0),this.visible||(e.layerInvisible=!0),e}},{key:"isUpdating",value:function(){return!1}}]),t}((0,d.p)((0,s.IG)((0,p.v)(c.Z.EventedMixin(u.Z)))));(0,l._)([(0,m.Cb)()],g.prototype,"fullOpacity",null),(0,l._)([(0,m.Cb)()],g.prototype,"layer",void 0),(0,l._)([(0,m.Cb)()],g.prototype,"parent",void 0),(0,l._)([(0,m.Cb)({readOnly:!0})],g.prototype,"suspended",null),(0,l._)([(0,m.Cb)({readOnly:!0})],g.prototype,"suspendInfo",null),(0,l._)([(0,m.Cb)({readOnly:!0})],g.prototype,"legendEnabled",null),(0,l._)([(0,m.Cb)({type:Boolean,readOnly:!0})],g.prototype,"updating",null),(0,l._)([(0,m.Cb)({readOnly:!0})],g.prototype,"updatingProgress",null),(0,l._)([(0,m.Cb)()],g.prototype,"visible",null),(0,l._)([(0,m.Cb)()],g.prototype,"view",void 0);var h=g=(0,l._)([(0,_.j)("esri.views.layers.LayerView")],g)},65706:function(e,n,t){function i(e){return"number"==typeof e.options[e.value]}function r(e){var n="";for(var t in e){var r=e[t];if("boolean"==typeof r)r&&(n+="#define ".concat(t,"\n"));else if("number"==typeof r)n+="#define ".concat(t," ").concat(r.toFixed(),"\n");else if("object"==typeof r)if(i(r)){var a=r.value,o=r.options,l=r.namespace,u=l?"".concat(l,"_"):"";for(var c in o)n+="#define ".concat(u).concat(c," ").concat(o[c].toFixed(),"\n");n+="#define ".concat(t," ").concat(u).concat(a,"\n")}else{var d=r.options,s=0;for(var f in d)n+="#define ".concat(d[f]," ").concat((s++).toFixed(),"\n");n+="#define ".concat(t," ").concat(d[r.value],"\n")}}return n}t.d(n,{K:function(){return r}})}}]);
//# sourceMappingURL=75049.c61abdaf.chunk.js.map