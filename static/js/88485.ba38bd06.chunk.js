"use strict";(self.webpackChunkhub_layout_versioning=self.webpackChunkhub_layout_versioning||[]).push([[88485],{88485:function(t,e,n){n.r(e),n.d(e,{arcgis_download_list_card:function(){return p}});var r=n(74165),i=n(15861),o=n(15671),a=n(43144),s=n(5692),u=n(54825),c=n(13913),l=n(13129),f=n(4541),p=(n(67450),n(7597),n(95101),function(){function t(e){(0,o.Z)(this,t),(0,s.r)(this,e),this.hubTelemetry=(0,s.c)(this,"hubTelemetry",7),this.showRateLimitNotice=!1,(0,u.b)(this,"handleCalciteNoticeClose")}return(0,a.Z)(t,[{key:"componentWillLoad",value:function(){var t=(0,i.Z)((0,r.Z)().mark((function t(){return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.i.loadIntlForComponent(this.element);case 2:this.intl=t.sent;case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"handleCalciteNoticeClose",value:function(){var t,e,n,r;this.showRateLimitNotice=!1,this.hubTelemetry.emit(Object.assign(Object.assign({},f.d.dictionary.category.interaction.action.download),{label:(0,c.f)(this.fileFormat),details:"dismiss limit reached",id:null===(t=this.item)||void 0===t?void 0:t.id,type:null===(e=this.item)||void 0===e?void 0:e.type,access:null===(n=this.item)||void 0===n?void 0:n.access,contentOrgId:null===(r=this.item)||void 0===r?void 0:r.orgId,response:"Failure"}))}},{key:"handleArcgisDownloadError",value:function(t){var e,n,r,i,o=t.detail.error;(0,c.a)(o)&&(this.showRateLimitNotice=!0,this.hubTelemetry.emit(Object.assign(Object.assign({},f.d.dictionary.category.interaction.action.download),{label:(0,c.f)(this.fileFormat),details:o.message,id:null===(e=this.item)||void 0===e?void 0:e.id,type:null===(n=this.item)||void 0===n?void 0:n.type,access:null===(r=this.item)||void 0===r?void 0:r.access,contentOrgId:null===(i=this.item)||void 0===i?void 0:i.orgId,response:"Failure"})))}},{key:"render",value:function(){return(0,s.h)(s.H,{"data-element":"download-list-card"},(0,s.h)("div",{class:"list-card-content"},(0,s.h)("div",null,this.intl.t(this.fileFormat)),(0,s.h)("arcgis-download-features-button",{authentication:this.authentication,fileFormat:this.fileFormat,filterGeometry:this.filterGeometry,item:this.item,layers:this.layers,server:this.server},this.intl.t("download".concat(this.fileFormat))),this.showRateLimitNotice&&(0,s.h)("calcite-notice",{active:!0,class:"rate-limit-notice",color:"red",dismissible:!0,scale:"s",width:"full"},(0,s.h)("div",{slot:"message"},this.intl.t("rateLimitMessage")))))}},{key:"element",get:function(){return(0,s.g)(this)}}],[{key:"assetsDirs",get:function(){return["locales"]}}]),t}());p.style=":host{display:block;border-width:1px;border-style:solid}.list-card-content{position:relative;margin:1rem;display:flex;height:6rem;flex-direction:column;justify-content:space-between}.rate-limit-notice{position:absolute;bottom:0px;left:0px;z-index:50}@-webkit-keyframes in-up{0%{opacity:0;transform:translate3D(0, 5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;transform:translate3D(0, 5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}.rate-limit-notice{-webkit-animation:in-up 300ms ease-in-out forwards;animation:in-up 300ms ease-in-out forwards}"},13913:function(t,e,n){n.d(e,{C:function(){return c},a:function(){return k},b:function(){return b},c:function(){return w},f:function(){return x},g:function(){return l},i:function(){return g}});var r=n(74165),i=n(15861),o=n(15671),a=n(43144),s=n(67450),u=n(12969),c=function(){function t(){(0,o.Z)(this,t),this._createReplicaOptions={layers:"0",layerQueries:{0:{queryOption:"all"}},returnAttachments:!0,returnAttachmentsDataByUrl:!0,async:!0,syncModel:"none",targetType:"client",syncDirection:"bidirectional",attachmentsSyncDirection:"bidirectional"}}return(0,a.Z)(t,[{key:"layers",value:function(t){return this._createReplicaOptions.layers=t,this}},{key:"dataFormat",value:function(t){return this._createReplicaOptions.dataFormat=t,this}},{key:"geometry",value:function(t){return this._createReplicaOptions.geometry=t,this._createReplicaOptions.geometryType={point:"esriGeometryPoint",multipoint:"esriGeometryMultipoint",polyline:"esriGeometryPolyline",polygon:"esriGeometryPolygon",extent:"esriGeometryEnvelope"}[t.type],this._createReplicaOptions.inSR=t.spatialReference,this}},{key:"layerQueries",value:function(t){return this._createReplicaOptions.layerQueries=t,this}},{key:"build",value:function(){return(0,u.c)(this._createReplicaOptions)}}]),t}();function l(t,e,n){return f.apply(this,arguments)}function f(){return f=(0,i.Z)((0,r.Z)().mark((function t(e,n,i){var o,a,s,u,c,l,f,h=arguments;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=h.length>3&&void 0!==h[3]?h[3]:5e3,t.next=3,p(e,n,i);case 3:return a=t.sent,t.next=6,d(a,n,o);case 6:if(s=t.sent,u=s.resultUrl,c=s.authRequired,l=u,!c){t.next=15;break}return t.next=13,n.getToken(u);case 13:f=t.sent,l="".concat(u,"?token=").concat(f);case 15:return t.abrupt("return",l);case 16:case"end":return t.stop()}}),t)}))),f.apply(this,arguments)}function p(t,e,n){return h.apply(this,arguments)}function h(){return(h=(0,i.Z)((0,r.Z)().mark((function t(e,n,i){var o,a,u;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o={httpMethod:"POST",params:i,authentication:n},t.next=3,(0,s.r)("".concat(e,"/createReplica"),o);case 3:return a=t.sent,u=a.statusUrl,t.abrupt("return",u);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function d(t,e,n){return y.apply(this,arguments)}function y(){return(y=(0,i.Z)((0,r.Z)().mark((function t(e,n,i){var o,a,s,u,c;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m(e,{authentication:n});case 2:if(o=t.sent,a=o.response,s=a.status,u=a.resultUrl,c=o.authRequired,"Completed"!==s){t.next=11;break}return t.abrupt("return",{resultUrl:u,authRequired:c});case 11:return t.next=13,new Promise((function(t){return setTimeout(t,i)}));case 13:return t.abrupt("return",d(e,n,i));case 14:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function m(t,e){return v.apply(this,arguments)}function v(){return(v=(0,i.Z)((0,r.Z)().mark((function t(e,n){var i,o,a;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,s.r)(e,Object.assign(Object.assign({},n),{rawResponse:!0,httpMethod:"GET"}));case 2:return i=t.sent,o=new URL("",i.url),t.next=6,i.json();case 6:return a=t.sent,t.abrupt("return",{response:a,authRequired:o.searchParams.has("token")});case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var g=function(t){return"string"===typeof t||t instanceof String},b=function(t){return Array.isArray(t)&&t.every((function(t){return!isNaN(t)}))},w=function(t){return Array.isArray(t)&&t.every((function(t){return!isNaN(t.id)}))},k=function(t){return"ArcGISRequestError"===t.name&&429===t.code},x=function(t){return{csv:"CSV",shapefile:"Shapefile",sqlite:"SQLite Geodatabase",geoPackage:"GeoPackage",filegdb:"File Geodatabase",featureCollection:"Feature Collection",geojson:"GeoJSON",excel:"Excel",json:"JSON"}[t]}},13115:function(t,e,n){function r(t,e){return e.split(".").reduce((function(t,e){return t?t[e]:void 0}),t)}n.d(e,{g:function(){return r}})},12969:function(t,e,n){n.d(e,{a:function(){return s},b:function(){return l},c:function(){return i},d:function(){return h},e:function(){return u},f:function(){return d},g:function(){return o},i:function(){return p},m:function(){return c},u:function(){return f},w:function(){return a}});var r=n(13115);function i(t){var e={};if(Array.isArray(t))e=t.map(i);else if("object"===typeof t){for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];null!=r&&"object"===typeof r?r instanceof Date?e[n]=new Date(r.getTime()):"undefined"!==typeof Blob&&r instanceof Blob?e[n]=new Blob([r],{type:r.type}):e[n]=i(r):e[n]=r}}else e=t;return e}function o(t,e,n){return t?t.reduce((function(t,i){return(0,r.g)(i,e)===n&&(t=i),t}),null):null}function a(t,e){return t.filter((function(t){return t!==e}))}function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"i";return"".concat(t).concat(Math.random().toString(36).substr(2,8))}function u(t,e,n){return null!==e&&void 0!==e&&((n=i(n))[t]=e),n}function c(t,e){return null!==t&&void 0!==t&&(e=i(e)).push(t),e}function l(t){return(t=(t=t.toLowerCase()).replace(/[`~!@#$%^&*()_|+\-=?;:'",.<>\{\}\[\]\\\/]/gi," ")).replace(/(\-|\_|\.|\s)+(.)?/g,(function(t,e,n){return n?n.toUpperCase():""})).replace(/(^|\/)([A-Z])/g,(function(t,e,n){return t.toLowerCase()}))}function f(t,e,n){return n.indexOf(t)===e}var p=function(t){return null==t},h=function(t){var e=Array.from(t);return e[0]=e[0].toUpperCase(),e.join("")};function d(t){return t.reduce((function(t,e){return t.concat(e)}),[])}}}]);
//# sourceMappingURL=88485.ba38bd06.chunk.js.map