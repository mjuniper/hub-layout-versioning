"use strict";(self.webpackChunkhub_layout_versioning=self.webpackChunkhub_layout_versioning||[]).push([[47942],{62970:function(e,t,s){s.r(t),s.d(t,{arcgis_hub_discussions_post:function(){return j},arcgis_hub_discussions_post_editor:function(){return V},arcgis_hub_discussions_post_header:function(){return L},arcgis_hub_discussions_reply:function(){return M},arcgis_hub_discussions_reply_editor:function(){return z},arcgis_load_more_button:function(){return B}});var i=s(93433),n=s(4942),o=s(74165),a=s(15861),r=s(15671),l=s(43144),c=s(29439),u=s(72585),d=s(32836),h=s(29315),p=s(12868),g=s(85621),m=s(59987),y=s(29043),v=s(36528),b=s(24267),f=s(65493),D=s(88752),k=s(45462),x=s(25434),w=s(34802);s(9882),s(77843),s(84354),s(80046),s(41817),s(46825),s(51274),s(94062),s(21010),s(49799),s(34601),s(69207),s(88968),s(73948),s(25831),s(18436),s(79399),s(21923),s(84371),s(10625),s(36106);function C(e){return function(t,s,i){var n=(0,h.q)(i.value,e);return Object.assign(Object.assign({},i),{value:n})}}function _(e){return function(t,s,i){var n=i.value;return Object.assign(Object.assign({},i),{value:function(){for(var t=arguments.length,s=new Array(t),i=0;i<t;i++)s[i]=arguments[i];var o=n.apply(this,s);return(0,m.a)(o,e)}})}}function E(e){var t=new y.S(null===e||void 0===e?void 0:e.filterOptions,null===e||void 0===e?void 0:e.extendDefaults);return function(e,s,i){var n=i.value;return Object.assign(Object.assign({},i),{value:function(){for(var e=arguments.length,s=new Array(e),i=0;i<e;i++)s[i]=arguments[i];var o=n.apply(this,s);return t.sanitize(o)}})}}var R=new RegExp("<[a-z-]+( [a-z-]+(=('|\")[\\w- ]+('|\"))?)*( ".concat("data-mention","=('|\")(\\w)+('|\"))( [a-z-]+(=('|\")[\\w- ]+('|\"))?)*>@\\w+</[a-z-]+>"),"g"),I=function(e,t){var s=(0,h.t)(e)[0];return t.find((function(e){return e.user.username===s}))};function O(e,t,s,i,n){return function e(){var t,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,r=s.match(R);if(r){var l=(0,c.Z)(r,1),u=l[0],d=s.indexOf(u),h=d+u.length,p=d>0?s.substring(0,d):"",g=s.substring(d,d+u.length),m=I(g,i.mentionedUsers),y=g.replace(u,'<arcgis-hub-discussions-mention-popover\n          access="'.concat(m.user.access,'"\n          channel-access="').concat(n.access,'"\n          channel-id="').concat(n.id,'"\n          creator-username="').concat(i.creatorDetails.user.username||i.post.creator,'"\n          full-name="').concat(m.user.fullName,'"\n          organization="').concat(null===(t=m.organization)||void 0===t?void 0:t.name,'"\n          parent-id="').concat(null!==a&&void 0!==a?a:"",'"\n          portal="').concat(o.portal,'"\n          post-id="').concat(i.post.id,'"\n          region="').concat(m.user.region,'"\n          thumbnail="').concat(m.user.thumbnail,'"\n          token="').concat(o.token,'"\n          user-id="').concat(m.user.id,'"\n          username="').concat(m.user.username,'"\n        >').concat(u,"</arcgis-hub-discussions-mention-popover>"));return p+y+e(s.substring(h),i,n,o,a)}return s}(e,t,s,i,n)}function A(){return function(e,t,s){var i=s.value;return Object.assign(Object.assign({},s),{value:function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];var n=i.apply(this,t);return O(n,this.replyDetails?this.replyDetails:this.postDetails,this.channelDetails.channel,this.context.session,this.replyDetails?this.postDetails.postId:null)}})}}var H,T=function(e,t,s,i){var n,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,s,i);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,s,a):n(t,s))||a);return o>3&&a&&Object.defineProperty(t,s,a),a};!function(e){e.Skeleton="skeleton",e.Content="content",e.Editor="editor",e.Deleted="deleted"}(H||(H={}));var F,j=function(){function e(t){(0,r.Z)(this,e),(0,u.r)(this,t),this.arcgisHubDiscussionsPostDelete=(0,u.c)(this,"arcgisHubDiscussionsPostDelete",7),this.arcgisHubDiscussionsPostSelect=(0,u.c)(this,"arcgisHubDiscussionsPostSelect",7),this.arcgisHubDiscussionsGeometryDrawReset=(0,u.c)(this,"arcgisHubDiscussionsGeometryDrawReset",7),this.arcgisHubDiscussionsGeometryDeselect=(0,u.c)(this,"arcgisHubDiscussionsGeometryDeselect",7),this.arcgisHubDiscussionsPostUpdate=(0,u.c)(this,"arcgisHubDiscussionsPostUpdate",7),this.arcgisHubDiscusssionsChannelUpdate=(0,u.c)(this,"arcgisHubDiscusssionsChannelUpdate",7),this.arcgisHubDiscussionsScrollTo=(0,u.c)(this,"arcgisHubDiscussionsScrollTo",7),this.hubTelemetry=(0,u.c)(this,"hubTelemetry",7),this.unsavedExistingFeatures=[],this.loading=!0,this.editing=!1,this.errorMessage=null,(0,d.b)(this,"handleDelete","handleEdit","handleViewThread","handleReply","handleViewReplies","handleLinkClicked","renderDeleted","renderPost","renderEditor","renderSkeleton")}return(0,l.Z)(e,[{key:"componentWillLoad",value:function(){this.initialize()}},{key:"componentDidLoad",value:function(){this.autoFocus&&this.arcgisHubDiscussionsScrollTo.emit()}},{key:"handleDetailsUpdates",value:function(){this.addEnrichments()}},{key:"handlePostEdited",value:function(){this.editing=!1}},{key:"handlePostCancelled",value:function(e){e.stopPropagation(),this.editing=!1,this.arcgisHubDiscussionsGeometryDrawReset.emit(),this.arcgisHubDiscussionsGeometryDeselect.emit()}},{key:"handleMultilineEllipsisExpanded",value:function(e){e.preventDefault(),e.stopPropagation(),this.handleViewThread()}},{key:"handleCalcitePopoverOpen",value:function(e){var t,s=e.target.open;if(e.target!==this.menuPopoverElement&&(null===(t=this.menuPopoverElement)||void 0===t?void 0:t.open))this.menuPopoverElement.toggle();else if(e.target===this.menuPopoverElement&&s){var i=this.index;this.emitHubTelemetry(Object.assign(Object.assign({},g.d.dictionary.category.interaction.action.open.label.popover.details.options),{position:i}))}}},{key:"emitHubTelemetry",value:function(e){var t=this.postDetails.postId,s=this.channelDetails.channel;this.hubTelemetry.emit(Object.assign(Object.assign({},e),{postId:t,channelId:s.id,channelAccess:s.access}))}},{key:"initialize",value:function(){var e=(0,a.Z)((0,o.Z)().mark((function e(){var t;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.element,this.addEnrichments(),e.next=4,p.i.loadIntlForComponent(t);case 4:this.intl=e.sent;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addEnrichments",value:function(){var e=this.isPostEnriched,t=this.isChannelEnriched,s=this.postDetails.postId,i=this.channelDetails.channelId;!e&&s&&this.enrichPostDetails(),!t&&i&&this.enrichChannelDetails(),this.updateLoading()}},{key:"updateLoading",value:function(){var e=this.isEnriched;this.loading=!e}},{key:"enrichPostDetails",value:function(){var e=(0,a.Z)((0,o.Z)().mark((function e(){var t,s,i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.postDetails,s=this.context,e.next=3,(0,h.n)(Object.assign({postDetails:t,includeReplyCount:!0},s.hubRequestOptions));case 3:i=e.sent,this.arcgisHubDiscussionsPostUpdate.emit(i);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"enrichChannelDetails",value:function(){var e=(0,a.Z)((0,o.Z)().mark((function e(){var t,s,i,n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.context,s=this.postDetails,i=this.channelDetails,e.next=3,(0,h.e)(Object.assign({channelDetails:i},t.hubRequestOptions));case 3:n=e.sent,this.arcgisHubDiscusssionsChannelUpdate.emit({postId:s.postId,channelDetails:n});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"computePostBody",value:function(){return this.postDetails.post.body}},{key:"computePostTitle",value:function(){return this.postDetails.post.title}},{key:"handleDelete",value:function(){var e=this,t=this.context,s=this.postDetails.post,i=this.menuPopoverElement;return this.errorMessage=null,(null===i||void 0===i?void 0:i.toggle)&&i.toggle(),(0,h.v)(Object.assign({postId:s.id},t.hubRequestOptions)).then((function(){e.deletedDuringSession=!0,e.emitHubTelemetry(Object.assign(Object.assign({},g.d.dictionary.category.content.action.delete),{response:g.d.constants.response.SUCCESS})),e.arcgisHubDiscussionsPostDelete.emit(s)})).catch((function(t){e.errorMessage="deleteFailure",e.emitHubTelemetry(Object.assign(Object.assign({},g.d.dictionary.category.content.action.delete),{response:g.d.constants.response.FAILURE})),console.error("Could not delete post:",t.message)}))}},{key:"handleEdit",value:function(){var e=this.index;this.emitHubTelemetry(Object.assign(Object.assign({},g.d.dictionary.category.interaction.action.open.label.editor),{position:e})),this.editing=!0}},{key:"handleViewThread",value:function(){var e=this.index;this.arcgisHubDiscussionsPostSelect.emit(),void 0!==e&&this.emitHubTelemetry(Object.assign(Object.assign({},g.d.dictionary.category.interaction.action.open.label.thread),{position:e}))}},{key:"handleReply",value:function(){this.arcgisHubDiscussionsPostSelect.emit("editor"),this.emitHubTelemetry(g.d.dictionary.category.interaction.action.open.label.editor.details.reply)}},{key:"handleViewReplies",value:function(){this.arcgisHubDiscussionsPostSelect.emit("list"),this.emitHubTelemetry(g.d.dictionary.category.interaction.action.open.label.thread.details.bodyAction)}},{key:"handleLinkClicked",value:function(e){var t=e.target;if(["CALCITE-LINK"].includes(t.nodeName)&&!t.hasAttribute("data-mention")){var s=this.postDetails.postId,i=this.channelDetails.channel,n=this.index;this.hubTelemetry.emit(Object.assign(Object.assign({},g.d.dictionary.category.navigation.action.external.label.link),{details:t.href,postId:s,channelId:i.id,channelAccess:i.access,position:n}))}}},{key:"capturePostDeepLinkImpression",value:function(){this.emitHubTelemetry(Object.assign(Object.assign({},g.d.dictionary.category.interaction.action.viewed.label.post.details.thread),{response:g.d.constants.response.SUCCESS}))}},{key:"capturePostListImpression",value:function(){this.emitHubTelemetry(Object.assign(Object.assign({},g.d.dictionary.category.interaction.action.viewed.label.post.details.postList),{position:this.index}))}},{key:"capturePostDeletedImpression",value:function(){this.emitHubTelemetry(Object.assign(Object.assign({},g.d.dictionary.category.interaction.action.viewed.label.post.details.thread),{response:g.d.constants.response.FAILURE}))}},{key:"isPostEnriched",get:function(){var e=this.postDetails,t=e.creatorDetails,s=e.post,i=[null===t||void 0===t?void 0:t.username,null===t||void 0===t?void 0:t.user,null===t||void 0===t?void 0:t.organization];return null===s||i.every((function(e){return void 0!==e}))}},{key:"isChannelEnriched",get:function(){var e=this.channelDetails;return[e.channel,e.groups].every((function(e){return void 0!==e}))}},{key:"isEnriched",get:function(){var e=this.intl,t=this.isPostEnriched,s=this.isChannelEnriched;return Boolean(e)&&t&&s}},{key:"views",get:function(){var e,t=this.renderEditor,s=this.renderDeleted,i=this.renderPost,o=this.renderSkeleton;return e={},(0,n.Z)(e,H.Skeleton,{render:o}),(0,n.Z)(e,H.Content,{render:i}),(0,n.Z)(e,H.Editor,{render:t}),(0,n.Z)(e,H.Deleted,{render:s}),e}},{key:"view",get:function(){var e=this.views,t=this.postDetails,s=this.editing;return e[this.loading?H.Skeleton:t.post?s?H.Editor:H.Content:H.Deleted]}},{key:"renderEditor",value:function(){var e=this.context,t=this.hasMap,s=this.index,i=this.isHub,n=this.unsavedFeatures,o=this.unsavedRelatedFeatures,a=this.unsavedExistingFeatures,r=this.postDetails,l=this.channelDetails,c=this.discussionDetails,d=this.isMobile;return(0,u.h)("arcgis-hub-discussions-post-editor",{channelDetails:l,context:e,discussionDetails:c,hasMap:t,index:s,isHub:i,isMobile:d,postDetails:r,unsavedExistingFeatures:a,unsavedFeatures:n,unsavedRelatedFeatures:o})}},{key:"renderPost",value:function(){var e,t=this.intl,s=this.errorMessage,i=this.hasMap,n=this.isHub,o=this.context,a=this.preview,r=this.postDetails,l=this.channelDetails,c=this.index,d=this.discussionDetails,h=this.unsavedFeatures,p=this.unsavedRelatedFeatures,g=this.unsavedExistingFeatures,m=this.isMobile,y="rtl"===t.direction?"arrow-left":"arrow-right";return void 0===c?this.capturePostDeepLinkImpression():this.capturePostListImpression(),(0,u.h)("article",null,(0,u.h)("arcgis-hub-discussions-post-header",{channelDetails:l,context:o,index:c,isHub:n,postDetails:r}),(0,u.h)("header",{innerHTML:this.computePostTitle()}),(0,u.h)("arcgis-multiline-ellipsis",{"expand-enabled":a,"expand-icon":y,innerHTML:this.computePostBody(),lines:a?4:0,onClick:this.handleLinkClicked}),a&&this.renderTextActions(),(0,u.h)("arcgis-hub-discussions-post-geography",{channelDetails:l,context:o,discussionDetails:d,expandable:a,hasMap:i,isMobile:m,postDetails:r,unsavedExistingFeatures:g,unsavedFeatures:h,unsavedRelatedFeatures:p,url:null===(e=null===d||void 0===d?void 0:d.reference)||void 0===e?void 0:e.url}),(0,u.h)("footer",null,this.renderActionGroup(),this.renderActionMenu()),s&&(0,u.h)("calcite-notice",{color:"red",scale:"s"},(0,u.h)("div",{slot:"title"},t.t("error")),(0,u.h)("div",{slot:"message"},t.t(s))))}},{key:"renderTextActions",value:function(){var e=this.intl,t=this.channelDetails.groups;return(0,u.h)("calcite-action-group",{id:"text-actions",layout:"horizontal"},Boolean(t.length)&&(0,u.h)("calcite-action",{onClick:this.handleReply,scale:"s",text:e.t("actions.reply"),textEnabled:!0}),(0,u.h)("calcite-action",{onClick:this.handleViewReplies,scale:"s",text:e.t("actions.view"),textEnabled:!0}))}},{key:"renderActionMenu",value:function(){var e=this,t=this.intl,s=this.context,i=this.postDetails.post,n=this.channelDetails,o=n.channel,a=[];if(n.groups.length&&(0,h.w)(i,s.currentUser)&&a.push({icon:"pencil",text:t.t("edit"),fn:this.handleEdit}),(0,h.x)(i,o,s.currentUser)&&a.push({icon:"trash",text:t.t("delete"),fn:this.handleDelete}),a.length)return(0,u.h)(u.F,null,(0,u.h)("calcite-action",{class:"discussions-post-action-menu",ref:function(t){e.menuActionElement=t},text:t.t("options")},(0,u.h)("calcite-icon",{class:"discussions-post-action-menu-icon",icon:"ellipsis",scale:"s"})),(0,u.h)("calcite-popover",{autoClose:!0,flipPlacements:["top","bottom"],label:t.t("options"),offsetDistance:0,placement:"bottom-end",ref:function(t){e.menuPopoverElement=t},referenceElement:this.menuActionElement},(0,u.h)("calcite-action-group",{layout:"vertical"},a.map((function(e){var t=e.text,s=e.fn,i=e.icon;return(0,u.h)("calcite-action",{class:"discussions-post-action-menu-options","data-action":t.toLowerCase(),id:"discussions-post-action-menu-option-"+i,key:i,onClick:s,scale:"m",text:t,"text-enabled":"true"},(0,u.h)("calcite-icon",{class:"discussions-post-action-menu-options-icon",icon:i,scale:"s"}))})))))}},{key:"renderActionGroup",value:function(){var e=this.intl,t=this.preview,s=this.linkToThread,i=this.postDetails.post;return(0,u.h)("calcite-action-group",{layout:"horizontal"},(0,u.h)("calcite-action",{appearance:"solid",class:"discussions-post-replies",disabled:!t&&!s,label:e.t("numReplies"),onClick:this.handleViewThread,scale:"m",text:i.replyCount.toString(),"text-enabled":"true"},(0,u.h)("calcite-icon",{class:"discussions-post-replies-icon",icon:"speech-bubble",scale:"s"})))}},{key:"renderDeleted",value:function(){var e=this.intl;return this.deletedDuringSession||this.capturePostDeletedImpression(),(0,u.h)("calcite-notice",{color:"red",scale:"m"},(0,u.h)("div",{slot:"title"},e.t("deleted.title")),(0,u.h)("div",{slot:"message"},e.t("deleted.message")))}},{key:"renderSkeleton",value:function(){return(0,u.h)("arcgis-hub-discussions-post-skeleton",null)}},{key:"render",value:function(){return(0,u.h)(u.H,{"data-element":"discussions-post"},this.view.render())}},{key:"element",get:function(){return(0,u.g)(this)}}],[{key:"assetsDirs",get:function(){return["locales"]}},{key:"watchers",get:function(){return{intl:["handleDetailsUpdates"],postDetails:["handleDetailsUpdates"],channelDetails:["handleDetailsUpdates"]}}}]),e}();T([C({scope:"arcgis-hub-discussions-post-body",getKey:function(){var e=this.postDetails,t=e.postId,s=e.post.body;return null!==s&&void 0!==s?s:t}}),_({calcite:!0}),A(),E({filterOptions:{whiteList:{"calcite-link":["href","data-mention"]}},extendDefaults:!0})],j.prototype,"computePostBody",null),T([C({scope:"arcgis-hub-discussions-post-title",getKey:function(){var e=this.postDetails,t=e.postId,s=e.post.title;return null!==s&&void 0!==s?s:t}}),E()],j.prototype,"computePostTitle",null),T([(0,v.c)()],j.prototype,"capturePostDeepLinkImpression",null),T([(0,v.c)()],j.prototype,"capturePostListImpression",null),T([(0,v.c)()],j.prototype,"capturePostDeletedImpression",null),j.style=".sc-arcgis-hub-discussions-post-h{display:block;background-color:var(--calcite-ui-foreground-1)}arcgis-hub-discussions-post-header.sc-arcgis-hub-discussions-post{margin-left:1rem;margin-right:1rem;margin-bottom:0.5rem}header.sc-arcgis-hub-discussions-post{margin-left:1rem;margin-right:1rem;margin-bottom:0.25rem;overflow-wrap:break-word;font-size:var(--calcite-font-size-1);line-height:1.5rem;font-weight:var(--calcite-font-weight-bold);color:var(--calcite-ui-text-1)}arcgis-multiline-ellipsis.sc-arcgis-hub-discussions-post{margin:0px;margin-left:1rem;margin-right:1rem;font-size:var(--calcite-font-size-0);line-height:1.25rem}footer.sc-arcgis-hub-discussions-post{display:grid;grid-template-columns:auto 48px}arcgis-hub-discussions-post-editor.sc-arcgis-hub-discussions-post{margin-top:0px;margin-bottom:0px}calcite-notice.sc-arcgis-hub-discussions-post{margin-left:1rem;margin-right:1rem;margin-bottom:1.5rem}footer.sc-arcgis-hub-discussions-post+calcite-notice.sc-arcgis-hub-discussions-post{margin-top:1rem}arcgis-hub-discussions-post-skeleton.sc-arcgis-hub-discussions-post{margin-left:1rem;margin-right:1rem}arcgis-hub-discussions-post-geography[loading].sc-arcgis-hub-discussions-post{margin-left:1rem;margin-right:1rem}#text-actions.sc-arcgis-hub-discussions-post{margin-left:0.5rem}calcite-popover[data-popper-placement][data-popper-reference-hidden].sc-arcgis-hub-discussions-post{pointer-events:auto;opacity:1}calcite-popover.sc-arcgis-hub-discussions-post{pointer-events:auto !important}.discussions-post-action-menu.sc-arcgis-hub-discussions-post:active .discussions-post-action-menu-icon.sc-arcgis-hub-discussions-post{--tw-text-opacity:1;color:rgb(21 21 21 / var(--tw-text-opacity))}.discussions-post-action-menu-options.sc-arcgis-hub-discussions-post:active{--tw-text-opacity:1;color:rgb(21 21 21 / var(--tw-text-opacity))}.discussions-post-action-menu-options.sc-arcgis-hub-discussions-post:active .discussions-post-action-menu-options-icon.sc-arcgis-hub-discussions-post{--tw-text-opacity:1;color:rgb(21 21 21 / var(--tw-text-opacity))}.discussions-post-replies.sc-arcgis-hub-discussions-post:active{--tw-text-opacity:1;color:rgb(21 21 21 / var(--tw-text-opacity))}.discussions-post-replies.sc-arcgis-hub-discussions-post:active .discussions-post-replies-icon.sc-arcgis-hub-discussions-post{--tw-text-opacity:1;color:rgb(21 21 21 / var(--tw-text-opacity))}",function(e){e.AUDIENCE="audience",e.CONTENT="content"}(F||(F={}));var S=function(e,t,s,i){var n,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,s,i);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,s,a):n(t,s))||a);return o>3&&a&&Object.defineProperty(t,s,a),a},V=function(){function e(t){(0,r.Z)(this,e),(0,u.r)(this,t),this.arcgisHubDiscussionsPostCancel=(0,u.c)(this,"arcgisHubDiscussionsPostCancel",7),this.arcgisHubDiscussionsPostCreate=(0,u.c)(this,"arcgisHubDiscussionsPostCreate",7),this.arcgisHubDiscussionsPostEdit=(0,u.c)(this,"arcgisHubDiscussionsPostEdit",7),this.arcgisHubDiscussionsGeometryDrawCreate=(0,u.c)(this,"arcgisHubDiscussionsGeometryDrawCreate",7),this.arcgisHubDiscussionsGeometryDrawTypeSelect=(0,u.c)(this,"arcgisHubDiscussionsGeometryDrawTypeSelect",7),this.arcgisHubDiscussionsGeometryDrawEdit=(0,u.c)(this,"arcgisHubDiscussionsGeometryDrawEdit",7),this.arcgisHubDiscussionsGeometryDrawReset=(0,u.c)(this,"arcgisHubDiscussionsGeometryDrawReset",7),this.arcgisHubDiscussionsGeometrySelect=(0,u.c)(this,"arcgisHubDiscussionsGeometrySelect",7),this.arcgisHubDiscussionsGeometryDeselect=(0,u.c)(this,"arcgisHubDiscussionsGeometryDeselect",7),this.arcgisHubDiscussionsGeometryClearAll=(0,u.c)(this,"arcgisHubDiscussionsGeometryClearAll",7),this.hubTelemetry=(0,u.c)(this,"hubTelemetry",7),this.unsavedFeatures=[],this.unsavedRelatedFeatures=[],this.unsavedExistingFeatures=[],this._unsavedFeatures=[],this._unsavedRelatedFeatures=[],this._unsavedExistingFeatures=[],this.pending=!1,this.titleValue="",this.bodyValue="",this.discussionValue="",this.errorMessage=null,(0,d.b)(this,"handleSubmit","handleCancel","handleCancelOrConfirm","handleConfirmBackButtonClicked","updateTitleValue","handleSelectRecentChannel","handleChannelSelectedFromCombobox","handleBack","handleGroupSearchOpened","proceedToContentCreation","handleAddLocationToggle","setActiveGeometryDrawType")}return(0,l.Z)(e,[{key:"shouldConfirmCancel",get:function(){var e=this.titleValue,t=this.bodyValue;return!this.postDetails&&(e.length>0||t.length>0)}},{key:"mentionConfig",get:function(){var e=this.context,t=this.channelDetails,s=this.selectedChannelDetails;return{searchUsers:function(i){var n;return(0,h.y)(Object.assign({id:null!==(n=null===t||void 0===t?void 0:t.groups[0].id)&&void 0!==n?n:s.groups[0].id,currentUser:e.currentUser,query:i},e.hubRequestOptions))}}}},{key:"postDetailsWithLocationEdits",get:function(){var e=this.postDetails,t=this.geometryValue,s=this.discussionValue,i=(0,x.c)(e);return i&&(i.post.geometry=t,s!==e.post.discussion&&(i.post.discussion=s)),i}},{key:"componentWillLoad",value:function(){var e=(0,a.Z)((0,o.Z)().mark((function e(){var t,s,i,n,a,r,l,c;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.postDetails,s=this.channelDetails,t&&(i=t.post,n=i.title,a=i.body,r=i.discussion,l=i.geometry,this.bodyValue=a,t.post.title&&(this.titleValue=n),this.discussionValue=r,c=(0,x.c)(l),this.geometryValue=Object.keys(c).length?c:null),s?this.proceedToContentCreation():(this.step=F.AUDIENCE,this.fetchRecentChannelDetails()),e.next=5,p.i.loadIntlForComponent(this.element);case 5:this.intl=e.sent;case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_fetchRecentChannelDetails",value:function(){var e=(0,a.Z)((0,o.Z)().mark((function e(){var t,s,i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.context,e.prev=1,e.next=4,(0,h.z)(Object.assign({user:t.currentUser},t.hubRequestOptions));case 4:return s=e.sent,0===(i=s.items).length?this.hubTelemetry.emit(g.d.dictionary.category.interaction.action.viewed.label.empty):this.hubTelemetry.emit(Object.assign(Object.assign({},g.d.dictionary.category.interaction.action.viewed.label.recents),{response:g.d.constants.response.SUCCESS})),e.abrupt("return",i);case 10:throw e.prev=10,e.t0=e.catch(1),this.hubTelemetry.emit(Object.assign(Object.assign({},g.d.dictionary.category.interaction.action.viewed.label.recents),{response:g.d.constants.response.FAILURE})),console.error("Failed to fetch recent channels:",e.t0.message),e.t0;case 15:case"end":return e.stop()}}),e,this,[[1,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"fetchRecentChannelDetails",value:function(){var e=(0,a.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.errorMessage=null,this.recentChannelsDetails=void 0,e.prev=2,e.next=5,this._fetchRecentChannelDetails();case 5:this.recentChannelsDetails=e.sent,e.next=12;break;case 8:e.prev=8,e.t0=e.catch(2),this.errorMessage="error.load",this.recentChannelsDetails=[];case 12:case"end":return e.stop()}}),e,this,[[2,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"emitHubTelemetry",value:function(e){var t,s=this.channelDetails,i=this.selectedChannelDetails||s;this.hubTelemetry.emit(Object.assign(Object.assign({},e),{groupId:i.groups[0].id,groupAccess:i.groups[0].access,groupOrgId:i.groups[0].orgId,channelId:i.channelId,channelAccess:null===(t=i.channel)||void 0===t?void 0:t.access}))}},{key:"handleSelectRecentChannel",value:function(e){var t=e.target.dataset.channelIndex;this.selectedChannelDetails=this.recentChannelsDetails[t],this.emitHubTelemetry(Object.assign(Object.assign({},g.d.dictionary.category.interaction.action.select.label.groups.details.recents),{position:t})),this.proceedToContentCreation()}},{key:"handleChannelSelectedFromCombobox",value:function(){this.emitHubTelemetry(g.d.dictionary.category.interaction.action.select.label.groups),this.proceedToContentCreation()}},{key:"proceedToContentCreation",value:function(){this.step=F.CONTENT}},{key:"handleComboboxChange",value:function(){var e=(0,a.Z)((0,o.Z)().mark((function e(t){var s,i,n,a,r,l,u,d,p;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=this.context.hubRequestOptions,!(i=t.detail.selectedItems).length){e.next=15;break}return n=(0,c.Z)(i,1),a=n[0].value,e.next=6,Promise.all([(0,h.A)(a,s),(0,h.B)(Object.assign({params:{num:1,groups:[a],access:[h.C.PRIVATE]}},s))]);case 6:r=e.sent,l=(0,c.Z)(r,2),u=l[0],d=(0,c.Z)(l[1].items,1),p=d[0],this.selectedChannelDetails=p?{channelId:p.id,channel:p,groups:[u]}:{groups:[u]},this.emitHubTelemetry(g.d.dictionary.category.interaction.action.select.label.groups),e.next=17;break;case 15:this.emitHubTelemetry(g.d.dictionary.category.interaction.action.deselect.label.groups),this.selectedChannelDetails=null;case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleGeometryValueUpdated",value:function(){if(this.postDetails){var e=this.postDetails.post.geometry,t=this.geometryValue;this.geometryValueHasChanges=JSON.stringify(t)!==JSON.stringify(e)}}},{key:"mapFeaturePropToState",value:function(e){var t,s=this.postDetails;if(e.length){var i=null===(t=e[0].properties)||void 0===t?void 0:t.id;((null===s||void 0===s?void 0:s.postId)===i||!s&&null===i)&&(this._unsavedFeatures=e)}else this._unsavedFeatures=[]}},{key:"mapExistingFeaturePropToState",value:function(e){var t,s=this.postDetails;if(e.length){var i=null===(t=e[0].properties)||void 0===t?void 0:t.id;(null===s||void 0===s?void 0:s.postId)===i&&(this._unsavedExistingFeatures=e)}else this._unsavedExistingFeatures=[]}},{key:"mapRelatedFeaturePropToState",value:function(e){var t=this.postDetails;if(e.length){var s=e[0].postId;((null===t||void 0===t?void 0:t.postId)===s||!t&&null===s)&&(this._unsavedRelatedFeatures=e)}else this._unsavedRelatedFeatures=[]}},{key:"handleAddLocationsActiveGeometryTypeChanged",value:function(e){e&&this.arcgisHubDiscussionsGeometryDrawTypeSelect.emit(e)}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var s=this.postDetails?this.handleEdit():this.handleCreate();return this.pending=!0,s.finally((function(){t.pending=!1,t.arcgisHubDiscussionsGeometryClearAll.emit(),t.canAddLocations=!1,t.addLocationsActiveGeometryType=null}))}},{key:"handleCreate",value:function(){var e=(0,a.Z)((0,o.Z)().mark((function e(){var t,s,i,n,a,r,l,c,u,d,p,m,y,v,b,f,D,k,x,w,C,_;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.context,a=this._unsavedFeatures,r=this._unsavedRelatedFeatures,l=this.bodyValue,c=this.titleValue,u=this.channelDetails,d=this.discussionDetails,p=d.discussion,m=d.reference.url,y=this.arcgisHubDiscussionsPostCreate,v=this.selectedChannelDetails,b=this.titleElement,f=u||v,D=p,r.length&&(k=m.split("/").pop(),x=new Set(r.map((function(e){return e.objectId}))),D=(0,h.E)(D,k,Array.from(x))),w=null,a.length&&(w=a.length>1?(0,h.F)(a):a[0].geometry),this.errorMessage=null,e.prev=7,e.next=10,(0,h.G)(Object.assign({params:{access:h.C.PRIVATE,groups:f.groups.map((function(e){return e.id})),discussion:D,title:c.trim()||void 0,body:l.trim(),geometry:w},mentionUrl:window.location.href},n.hubRequestOptions));case 10:if(C=e.sent,null===(t=f.channel)||void 0===t){e.next=15;break}e.t0=t,e.next=18;break;case 15:return e.next=17,(0,h.H)(Object.assign({channelId:C.channelId},n.hubRequestOptions));case 17:e.t0=e.sent;case 18:return _=e.t0,this.titleValue="",this.bodyValue="",this.hubTelemetry.emit(Object.assign(Object.assign({},g.d.dictionary.category.content.action.create),{response:g.d.constants.response.SUCCESS,details:null!==(s=C.title)&&void 0!==s?s:null,groupId:f.groups[0].id,groupAccess:f.groups[0].access,postId:C.id,channelId:_.id,channelAccess:_.access})),y.emit(C),b.focus(),e.abrupt("return",C);case 27:return e.prev=27,e.t1=e.catch(7),this.errorMessage="error.create",this.hubTelemetry.emit(Object.assign(Object.assign({},g.d.dictionary.category.content.action.create),{response:g.d.constants.response.FAILURE,groupId:f.groups[0].id,groupAccess:f.groups[0].access,channelId:f.channelId,channelAccess:null===(i=f.channel)||void 0===i?void 0:i.access})),console.error("Failed to create post:",e.t1.message),e.abrupt("return",null);case 33:case"end":return e.stop()}}),e,this,[[7,27]])})));return function(){return e.apply(this,arguments)}}()},{key:"handleEdit",value:function(){var e=this,t=this.context,s=this.bodyValue,n=this.titleValue,o=this.channelDetails,a=this.postDetails.post,r=this._unsavedFeatures,l=this._unsavedExistingFeatures,c=this._unsavedRelatedFeatures,u=this.arcgisHubDiscussionsPostEdit,d=this.discussionDetails.reference.url;this.errorMessage=null;var p=this.discussionValue;if(c.length){var m=d.split("/").pop(),y=c.map((function(e){return e.objectId}));p=(0,h.E)(p,m,y)}var v=this.geometryValue&&Object.keys(this.geometryValue).length?(0,h.d)(Object.assign(Object.assign({},a),{geometry:this.geometryValue})):[];l.forEach((function(e){var t=e.properties.index,s=e.geometry;v[+t].geometry=s}));var b=null,f=[].concat((0,i.Z)(v),(0,i.Z)(r));return f.length&&(b=f.length>1?(0,h.F)(f):f[0].geometry.coordinates.length?f[0].geometry:null),(0,h.I)(Object.assign({postId:a.id,params:{title:n.trim()||null,body:s.trim(),discussion:p,geometry:b},mentionUrl:window.location.href},t.hubRequestOptions)).then((function(t){return e.hubTelemetry.emit(Object.assign(Object.assign({},g.d.dictionary.category.content.action.update),{response:g.d.constants.response.SUCCESS,postId:a.id,channelId:o.channelId,channelAccess:o.channel.access})),u.emit(t),t})).catch((function(t){return e.errorMessage="error.edit",e.hubTelemetry.emit(Object.assign(Object.assign({},g.d.dictionary.category.content.action.update),{response:g.d.constants.response.FAILURE,postId:a.id,channelId:o.channelId,channelAccess:o.channel.access})),console.error("Failed to edit post:",t.message),null}))}},{key:"handleCancel",value:function(e){var t,s,i,n,o,a,r=this.channelDetails,l=this.postDetails,u=this.selectedChannelDetails,d=null!==(t=null===u||void 0===u?void 0:u.groups)&&void 0!==t?t:[],h=(0,c.Z)(d,1)[0];e.preventDefault(),this.hubTelemetry.emit(Object.assign(Object.assign({},g.d.dictionary.category.interaction.action.close.label.editor),{groupId:null!==(s=null===h||void 0===h?void 0:h.id)&&void 0!==s?s:null,groupAccess:null!==(i=null===h||void 0===h?void 0:h.access)&&void 0!==i?i:null,postId:null!==(n=null===l||void 0===l?void 0:l.postId)&&void 0!==n?n:null,channelId:null!==(o=null===r||void 0===r?void 0:r.channelId)&&void 0!==o?o:null,channelAccess:null!==(a=null===r||void 0===r?void 0:r.channel.access)&&void 0!==a?a:null})),this.arcgisHubDiscussionsPostCancel.emit()}},{key:"handleCancelOrConfirm",value:function(e){this.shouldConfirmCancel?this.confirmCancel=!0:this.handleCancel(e),this.arcgisHubDiscussionsGeometryClearAll.emit(),this.canAddLocations=!1}},{key:"handleConfirmBackButtonClicked",value:function(){this.confirmCancel=!1}},{key:"handleBack",value:function(){this.shouldConfirmCancel?this.confirmCancel=!0:(this.emitHubTelemetry(Object.assign({},g.d.dictionary.category.interaction.action.close.label.editor.details.addPost)),this.selectedChannelDetails=null,this.step=F.AUDIENCE,this.fetchRecentChannelDetails())}},{key:"handleAddLocationToggle",value:function(){var e=this.postDetails,t=this.channelDetails;if(this.canAddLocations=!this.canAddLocations,this.canAddLocations){var s=e&&e.postId;this.arcgisHubDiscussionsGeometryDrawCreate.emit(s)}else this.arcgisHubDiscussionsGeometryDrawReset.emit(),this.addLocationsActiveGeometryType=null;var i=this.canAddLocations?"enable":"disable";this.hubTelemetry.emit(Object.assign(Object.assign({},g.d.dictionary.category.interaction.action[i].label.addLocation),{postId:null===e||void 0===e?void 0:e.postId,channelId:null===t||void 0===t?void 0:t.channelId,channelAccess:null===t||void 0===t?void 0:t.channel.access}))}},{key:"handleHelpOpened",value:function(){this.hubTelemetry.emit(g.d.dictionary.category.interaction.action.open.label.popover.details.help)}},{key:"handleHelpClosed",value:function(){this.hubTelemetry.emit(g.d.dictionary.category.interaction.action.close.label.popover.details.help)}},{key:"handleGroupSearchOpened",value:function(){this.hubTelemetry.emit(g.d.dictionary.category.interaction.action.open.label.search)}},{key:"updateBodyValue",value:function(e){this.bodyValue=e.target.value}},{key:"handleFeatureRemove",value:function(e){var t,s=e.detail.properties,i=s.relatedFeatureId,n=s.index,o=s.unsaved;if(!o)if(i){var a=(0,h.i)(this.discussionValue).features,r=this.discussionDetails.reference.url.split("/").pop();a.splice(a.indexOf(i),1),this.discussionValue=(0,h.E)(this.discussionValue.split("?")[0],r,a)}else"GeometryCollection"===(null===(t=this.geometryValue)||void 0===t?void 0:t.type)?(o?this.geometryValue.geometries.splice(n,1):this.geometryValue.geometries[n]=null,this.geometryValue=Object.assign({},this.geometryValue)):this.geometryValue=null}},{key:"updateTitleValue",value:function(e){this.titleValue=e.target.value}},{key:"setActiveGeometryDrawType",value:function(e){var t=this.addLocationsActiveGeometryType,s=e.target.dataset.type;this.addLocationsActiveGeometryType=s===t?void 0:s}},{key:"isTitleValid",get:function(){return this.titleValue.length<=h.M}},{key:"isBodyValid",get:function(){var e=this.bodyValue;return e.trim().length>0&&e.length<=h.J}},{key:"hasLocationChanges",get:function(){if(this.postDetails){var e=this.postDetails.post.discussion,t=this.discussionValue;return Boolean(this._unsavedFeatures.length+this._unsavedRelatedFeatures.length+this._unsavedExistingFeatures.length)||t!==e||this.geometryValueHasChanges}return!1}},{key:"titleMessage",get:function(){var e=this.titleValue,t=this.isTitleValid,s=this.intl,i=e.length;if(i>=h.M-5)return t?{status:"idle",text:s.t("post.title.validation.warning")}:{icon:"exclamation-mark-circle",status:"invalid",text:s.t("post.title.validation.error",{characters:i-h.M})}}},{key:"bodyMessage",get:function(){var e=this.bodyValue,t=this.isBodyValid,s=this.intl;if(e.length>=h.W)return t?{status:"idle",text:s.t("post.body.validation.warning")}:{icon:"exclamation-mark-circle",status:"invalid",text:s.t("post.body.validation.error")}}},{key:"blockedNotice",get:function(){var e,t;if(this.channelDetails){var s=(0,h.l)(null===(e=this.channelDetails)||void 0===e?void 0:e.groups[0]),i=(0,h.l)(this.discussionDetails.reference);s||i?s?i||(t="group"===this.discussionDetails.type?k.A.EditPostGroup:k.A.EditPostItem):t=k.A.EditPostGroup:t=k.A.EditPost}return t}},{key:"renderPrimaryActionButton",value:function(){var e,t,s=this.postDetails,i=this.intl,n=this.titleValue,o=this.bodyValue,a=this.isBodyValid,r=this.isTitleValid,l=this.pending,c=this.hasLocationChanges,d=this.blockedNotice,h=!a||!r;return s?(e=i.t("post.save"),t=Boolean(d)||h||n===s.post.title&&o===s.post.body&&!c):(e=i.t("post.create"),t=Boolean(d)||h),(0,u.h)("calcite-button",{class:"hub-discussions-post-editor-post-actions__primary",disabled:t,label:e,loading:l,round:!0,scale:"l",type:"submit"},e)}},{key:"renderSecondaryActionButton",value:function(){var e=this.intl,t=this.handleCancelOrConfirm,s=e.t("post.cancel");return(0,u.h)("calcite-button",{class:"hub-discussions-post-editor-post-actions__secondary",color:"neutral",label:s,onClick:t,round:!0,scale:"l",type:"button"},s)}},{key:"renderAddLocationsButton",value:function(){var e=this,t=this.hasMap,s=this.canAddLocations,i=this.blockedNotice,n=this.addLocationsActiveGeometryType,o=this.intl,a=[{type:"select",icon:"select"},{type:"point",icon:"pin"},{type:"polyline",icon:"freehand"},{type:"polygon",icon:"freehand-area"}].map((function(t){var s=t.type,i=t.icon;return(0,u.h)("calcite-action",{active:n===s,"data-type":s,icon:i,key:s,onClick:e.setActiveGeometryDrawType,text:o.t("location.action.".concat(s)),textEnabled:!0})}));return(0,u.h)(u.F,null,(0,u.h)("calcite-popover",{label:o.t("location.heading"),open:s&&!Boolean(n),referenceElement:this.locationActionElement,triggerDisabled:!0},a),(0,u.h)("calcite-tooltip",{closeOnClick:!0,label:o.t("location.tooltip"),referenceElement:!s&&this.locationActionElement},(0,u.h)("span",null,o.t("location.tooltip"))),(0,u.h)("calcite-action",{active:s,appearance:"solid",class:"add-location-post",disabled:!t||Boolean(i),onClick:this.handleAddLocationToggle,ref:function(t){e.locationActionElement=t},text:o.t("location.heading")},(0,u.h)("calcite-icon",{class:"add-location-icon",icon:"pin-plus",scale:"s"})))}},{key:"renderTitleField",value:function(){var e=this,t=this.intl,s=this.titleValue,i=this.updateTitleValue,n=this.titleMessage,o=this.blockedNotice;return(0,u.h)(u.F,null,(0,u.h)("input",{"aria-label":t.t("post.title.label"),autofocus:!0,class:"hub-discussions-post-editor__title",disabled:Boolean(o),onInput:i,placeholder:t.t("post.title.placeholder"),ref:function(t){e.titleElement=t},type:"text",value:s}),n&&(0,u.h)("calcite-input-message",{class:"hub-discussions-post-editor__message",icon:n.icon,scale:"l",status:n.status},n.text))}},{key:"renderBodyField",value:function(){var e=this.intl,t=this.bodyValue,s=this.bodyMessage,i=this.pending,n=this.mentionConfig,o=this.context,a=this.blockedNotice;return(0,u.h)(u.F,null,(0,u.h)("arcgis-hub-rich-text",{class:"hub-discussions-post-editor__body",context:o,disabled:Boolean(a)||i,label:e.t("post.body.label"),mention:n,placeholder:e.t("post.body.placeholder"),"text-transform":!0,toolbar:"",value:t}),s&&(0,u.h)("calcite-input-message",{class:"hub-discussions-post-editor__message",icon:s.icon,scale:"l",status:s.status},s.text))}},{key:"renderContentStep",value:function(){var e,t=this.intl,s=this.hasMap,i=this.postDetails,n=this.channelDetails,o=this.discussionDetails,a=this.selectedChannelDetails,r=this.index,l=this.isHub,c=this.errorMessage,d=this.context,p=this._unsavedFeatures,g=this._unsavedRelatedFeatures,m=this._unsavedExistingFeatures,y=this.postDetailsWithLocationEdits,v=this.blockedNotice,b=this.isMobile;return this.confirmCancel?this.renderConfirmCancel():(0,u.h)("form",{onSubmit:this.handleSubmit},i&&n?(0,u.h)("arcgis-hub-discussions-post-header",{channelDetails:n,class:"hub-discussions-post-editor__header",context:d,index:r,isHub:l,postDetails:i}):(0,u.h)("arcgis-hub-discussions-post-header",{access:h.C.PRIVATE,class:"hub-discussions-post-editor__header",context:d,groups:a.groups,index:r,isHub:l}),this.renderTitleField(),this.renderBodyField(),(0,u.h)("arcgis-hub-discussions-post-geography",{channelDetails:n,context:d,disabled:Boolean(v),discussionDetails:o,hasMap:s,isMobile:b,postDetails:y,renderedInEditor:!0,unsavedExistingFeatures:m,unsavedFeatures:p,unsavedRelatedFeatures:g,url:null===(e=null===o||void 0===o?void 0:o.reference)||void 0===e?void 0:e.url}),(0,u.h)("div",{class:"hub-discussions-post-editor-post-actions"},this.renderAddLocationsButton(),this.renderSecondaryActionButton(),this.renderPrimaryActionButton()),v&&(0,u.h)("arcgis-hub-discussions-blocked-notice",{class:"hub-discussions-post-editor__not-discussable-notice",scale:"s",slot:"list-before",variant:v}),c&&(0,u.h)("calcite-notice",{class:"hub-discussions-post-editor__crud-error",color:"red",scale:"s"},(0,u.h)("div",{slot:"title"},t.t("error.title")),(0,u.h)("div",{slot:"message"},c&&t.t(c))))}},{key:"renderHeader",value:function(){var e=this.intl,t=this.handleCancelOrConfirm,s=this.handleBack,i=this.confirmCancel,n=this.step,o={action:t,icon:"x"};return n===F.CONTENT&&(o={action:s,icon:"chevron-left"}),(0,u.h)("header",{class:"hub-discussions-post-editor-header"},(0,u.h)("calcite-button",{color:"neutral",disabled:i,"icon-start":o.icon,label:e.t("header.".concat(n,".back")),onClick:o.action,round:!0,scale:"l",type:"button"}),(0,u.h)("p",{class:"hub-discussions-post-editor-header__title"},e.t("header.".concat(n,".title"))),(0,u.h)("calcite-popover",{label:e.t("header.help"),placement:"bottom-end",referenceElement:"help"},(0,u.h)("p",{class:"hub-discussions-post-editor-header__popover"},e.t("header.".concat(n,".help")))),(0,u.h)("calcite-button",{appearance:"transparent",color:"neutral",disabled:i,"icon-start":"lightbulb",id:"help",label:e.t("header.help"),round:!0,scale:"l",type:"button"}))}},{key:"renderConfirmCancel",value:function(){var e=this.intl,t=this.handleConfirmBackButtonClicked,s=this.handleCancel;return(0,u.h)("div",{class:"hub-discussions-post-editor-cancel-confirm"},(0,u.h)("header",{class:"hub-discussions-post-editor-cancel-confirm__header"},e.t("confirm.header")),(0,u.h)("p",{class:"hub-discussions-post-editor-cancel-confirm__message"},e.t("confirm.body")),(0,u.h)("footer",{class:"hub-discussions-post-editor-cancel-confirm__footer"},(0,u.h)("calcite-button",{color:"neutral",onClick:t,round:!0,scale:"l"},e.t("confirm.back")),(0,u.h)("calcite-button",{color:"red",onClick:s,round:!0,scale:"l"},e.t("confirm.discard"))))}},{key:"renderGroupSelectionStep",value:function(){var e=this.intl,t=this.selectedChannelDetails,s=this.handleChannelSelectedFromCombobox,i=this.context;return(0,u.h)(u.F,null,(0,u.h)("calcite-combobox",{label:e.t("groups.label"),placeholder:e.t("groups.placeholder"),scale:"l","selection-mode":"single",value:t?t.groups[0].id:null},i.currentUser.groups.map((function(e){var t=(0,h.l)(e);return(0,u.h)("calcite-combobox-item",{disabled:!t,icon:t?void 0:"circle-disallowed",key:e.id,textLabel:e.title,value:e.id})}))),t&&(0,u.h)("calcite-button",{class:"hub-discussions-post-editor-groups__action",onClick:s,round:!0,scale:"l",type:"button",width:"full"},e.t("groups.label")),this.renderRecentChannels())}},{key:"renderRecentChannelDetails",value:function(e,t){var s=this.intl,i=this.context,n=this.handleSelectRecentChannel,o=e.latestUserPost,a=(0,c.Z)(e.groups,1)[0],r=Date.now()-new Date(o.createdAt).valueOf(),l=Math.floor(r/b.a.DAY),d=s.formatRelativeTime(-l,b.T.DAY);return(0,u.h)("li",{class:"hub-discussions-post-editor-recent__item",key:a.id},(0,u.h)("calcite-avatar",{class:"hub-discussions-post-editor-recent__avatar","full-name":a.title,scale:"l",thumbnail:(0,w.g)(i.session.portal,a,i.session.token)}),(0,u.h)("b",{class:"hub-discussions-post-editor-recent__title"},a.title),(0,u.h)("i",{class:"hub-discussions-post-editor-recent__last-activity"},s.t("groups.posted",{timeStr:d})),(0,u.h)("calcite-button",{class:"hub-discussions-post-editor-recent__action",color:"neutral","data-channel-index":t,"icon-start":"chevron-right",onClick:n,round:!0,scale:"l",type:"button"}))}},{key:"renderRecentChannelSkeleton",value:function(e){return(0,u.h)("li",{class:"hub-discussions-post-editor-recent__skeleton",key:"skeleton-".concat(e)},(0,u.h)("arcgis-skeleton-loader",{active:!0,rows:0,showFooter:!1,showHeading:!1,showThumbnail:!1},(0,u.h)("div",null),(0,u.h)("div",null,(0,u.h)("div",null),(0,u.h)("div",null))))}},{key:"renderRecentChannelsEmpty",value:function(){var e=this.intl;return(0,u.h)("calcite-notice",{class:"hub-discussions-post-editor__empty",scale:"m"},(0,u.h)("div",{slot:"title"},e.t("empty.title")),(0,u.h)("div",{slot:"message"},e.t("empty.message")),(0,u.h)("calcite-link",{href:"https://doc.arcgis.com/en/hub/team/how-discussions-work.htm",iconEnd:"launch",slot:"link"},e.t("empty.link")))}},{key:"renderRecentChannelsError",value:function(){var e=this.errorMessage,t=this.intl;return(0,u.h)("calcite-notice",{class:"hub-discussions-post-editor__load-error",color:"red"},(0,u.h)("div",{slot:"title"},t.t("error.load.title")),(0,u.h)("div",{slot:"message"},e&&t.t(e)))}},{key:"renderRecentChannels",value:function(){var e,t=this,s=this.intl,i=this.errorMessage,n=this.recentChannelsDetails,o=void 0===n?Array.from({length:4}).map((function(e){return null})):n;return e=i?this.renderRecentChannelsError():o.length?(0,u.h)("ul",{class:"hub-discussions-post-editor-recent__list"},o.map((function(e,s){return e?t.renderRecentChannelDetails(e,s):t.renderRecentChannelSkeleton(s)}))):this.renderRecentChannelsEmpty(),(0,u.h)(u.F,null,(0,u.h)("header",{class:"hub-discussions-post-editor-recent__header"},s.t("groups.recent")),e)}},{key:"renderCreate",value:function(){return(0,u.h)(u.F,null,this.renderHeader(),this.step===F.AUDIENCE?this.renderGroupSelectionStep():this.renderContentStep())}},{key:"renderLoading",value:function(){return(0,u.h)("calcite-loader",{label:this.intl.t("loading"),scale:"m",type:"indeterminate"})}},{key:"render",value:function(){var e=this.postDetails?this.renderContentStep():this.renderCreate();return(0,u.h)(u.H,{class:"hub-discussions-post-editor","data-element":"discussions-post-editor"},e)}},{key:"element",get:function(){return(0,u.g)(this)}}],[{key:"assetsDirs",get:function(){return["locales"]}},{key:"watchers",get:function(){return{geometryValue:["handleGeometryValueUpdated"],unsavedFeatures:["mapFeaturePropToState"],unsavedExistingFeatures:["mapExistingFeaturePropToState"],unsavedRelatedFeatures:["mapRelatedFeaturePropToState"],addLocationsActiveGeometryType:["handleAddLocationsActiveGeometryTypeChanged"]}}}]),e}();S([(0,f.m)({delay:300})],V.prototype,"_fetchRecentChannelDetails",null),S([(0,D.C)({when:function(){return!this.isMobile}})],V.prototype,"renderAddLocationsButton",null),V.style=".hub-discussions-post-editor{margin-top:1.5rem;margin-bottom:1.5rem;margin-left:0.75rem;margin-right:0.75rem;display:block;border-radius:0.25rem;padding:0.75rem;--tw-shadow:0 2px 8px 0 rgba(0, 0, 0, 0.12);--tw-shadow-colored:0 2px 8px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.hub-discussions-post-editor-header{margin-bottom:1.5rem;display:grid;grid-template-rows:repeat(1, minmax(0, 1fr));align-items:center;-moz-column-gap:0.75rem;column-gap:0.75rem;grid-template-columns:44px auto 44px}.hub-discussions-post-editor-header__title{margin:0px;text-align:center;font-size:var(--calcite-font-size-1);line-height:1.5rem;font-weight:var(--calcite-font-weight-bold);color:var(--calcite-ui-text-1)}.hub-discussions-post-editor-header__popover{padding:1rem;margin-top:revert;margin-bottom:revert}.hub-discussions-post-editor-recent__header{margin-top:1.5rem;margin-bottom:0.75rem;font-size:var(--calcite-font-size--1);line-height:1rem;font-weight:var(--calcite-font-weight-bold);color:var(--calcite-ui-text-1)}.hub-discussions-post-editor-groups__action{margin-top:0.75rem}.hub-discussions-post-editor-recent__list{margin-top:0px;margin-bottom:0px;list-style-type:none;padding:0px}.hub-discussions-post-editor-recent__item{margin-bottom:0.75rem;margin-top:0px;display:grid;grid-auto-flow:column;grid-template-rows:repeat(2, minmax(0, 1fr));-moz-column-gap:0.75rem;column-gap:0.75rem;grid-template-columns:44px auto 44px}.hub-discussions-post-editor-recent__item:last-child{margin-bottom:0px}.hub-discussions-post-editor-recent__avatar{grid-row:span 2 / span 2}.hub-discussions-post-editor-recent__title{font-weight:var(--calcite-font-weight-bold);overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}.hub-discussions-post-editor-recent__last-activity{font-size:var(--calcite-font-size--1);line-height:1rem;font-style:normal;color:var(--calcite-ui-text-2)}.hub-discussions-post-editor-recent__action{grid-row:span 2 / span 2}.hub-discussions-post-editor-post-actions,.hub-discussions-post-editor-geometry-actions{margin-top:1rem;display:flex;justify-content:flex-end}.hub-discussions-post-editor-post-actions>calcite-action{margin-right:auto}.hub-discussions-post-editor-geometry-actions__feature,.hub-discussions-post-editor-geometry-actions__related,.hub-discussions-post-editor-post-actions__primary,.hub-discussions-post-editor-post-actions__secondary{margin-left:0.75rem}.hub-discussions-post-editor__title{margin:0px;margin-top:1rem;height:auto;width:100%;resize:none;border-style:none;background-color:var(--calcite-ui-foreground-1);padding:0px;font-size:var(--calcite-font-size-1);line-height:1.5rem;font-weight:var(--calcite-font-weight-bold);color:var(--calcite-ui-text-1);--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.hub-discussions-post-editor__title:focus{--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);outline:2px solid transparent;outline-offset:2px}.hub-discussions-post-editor .hub-discussions-post-editor__title::-moz-placeholder{color:var(--calcite-ui-text-3);opacity:1}.hub-discussions-post-editor .hub-discussions-post-editor__title:-ms-input-placeholder{color:var(--calcite-ui-text-3);opacity:1}.hub-discussions-post-editor .hub-discussions-post-editor__title::placeholder{color:var(--calcite-ui-text-3);opacity:1}.hub-discussions-post-editor__body{margin-top:0.5rem}.hub-discussions-post-editor__body[scale=m] .ck.ck-editor__editable{border-style:none;background-color:var(--calcite-ui-foreground-1);padding:0px;font-size:var(--calcite-font-size-0);line-height:1.25rem;color:var(--calcite-ui-text-1);outline:2px solid transparent;outline-offset:2px;min-height:6rem}.hub-discussions-post-editor__body .ck.ck-editor__editable.ck-focused:not(.ck-editor__nested-editable){border-style:none;outline:2px solid transparent;outline-offset:2px}.hub-discussions-post-editor__body[scale=m] .ck.ck-editor__editable .ck-placeholder:before{color:var(--calcite-ui-text-3)}.hub-discussions-post-editor__body .ck.ck-editor__editable_inline>:first-child{margin-top:0px}.hub-discussions-post-editor__body .ck.ck-editor__editable_inline>:last-child{margin-bottom:0px}.hub-discussions-post-editor__message{margin-top:0.5rem}.hub-discussions-post-editor__empty,.hub-discussions-post-editor__load-error{margin-top:1rem}.hub-discussions-post-editor__crud-error,.hub-discussions-post-editor__not-discussable-notice{margin-top:1rem}.hub-discussions-post-editor-cancel-confirm__header{margin:0px;display:block;font-size:var(--calcite-font-size-1);line-height:1.5rem;font-weight:var(--calcite-font-weight-bold)}.hub-discussions-post-editor-cancel-confirm__message{margin-top:0.5rem;margin-bottom:0px}.hub-discussions-post-editor-cancel-confirm__footer{margin-top:1.5rem;display:grid;grid-auto-flow:column;grid-template-columns:repeat(2, minmax(0, 1fr));-moz-column-gap:0.75rem;column-gap:0.75rem}.hub-discussions-post-editor-recent__skeleton{margin-bottom:0.75rem;margin-top:0px}.hub-discussions-post-editor-recent__skeleton arcgis-skeleton-loader{display:flex}@-webkit-keyframes shimmer{0%{background-size:200% 100%;background-position:100% 0}100%{background-size:200% 100%;background-position:-100% 0}}@keyframes shimmer{0%{background-size:200% 100%;background-position:100% 0}100%{background-size:200% 100%;background-position:-100% 0}}.hub-discussions-post-editor-recent__skeleton arcgis-skeleton-loader>div:nth-of-type(1),.hub-discussions-post-editor-recent__skeleton arcgis-skeleton-loader>div:nth-of-type(2) div{-webkit-animation:shimmer 2s cubic-bezier(0.4, 0, 0.2, 0.8) infinite;animation:shimmer 2s cubic-bezier(0.4, 0, 0.2, 0.8) infinite;background-image:linear-gradient(90deg, rgba(255, 255, 255, 0) 0, rgba(255, 255, 255, 0) 40%, rgba(255, 255, 255, 0.6) 50%, rgba(255, 255, 255, 0) 60%, rgba(255, 255, 255, 0) 100%);background-color:var(--calcite-ui-foreground-2)}.hub-discussions-post-editor-recent__skeleton arcgis-skeleton-loader>div:nth-of-type(1){height:2.75rem;width:2.75rem;border-radius:50%}.hub-discussions-post-editor-recent__skeleton arcgis-skeleton-loader>div:nth-of-type(2){margin-left:1rem;display:flex;flex-grow:1;flex-direction:column;justify-content:center}.hub-discussions-post-editor-recent__skeleton arcgis-skeleton-loader>div:nth-of-type(2) div:nth-of-type(1){margin-bottom:0.5rem;height:0.75rem;border-radius:0.375rem}.hub-discussions-post-editor-recent__skeleton arcgis-skeleton-loader>div:nth-of-type(2) div:nth-of-type(2){height:0.5rem;border-radius:0.25rem}.location-popover>div.popover,.popover{max-width:20rem;padding-top:0.75rem;padding-bottom:0.75rem;padding-left:1.25rem;padding-right:1.25rem}.add-location-post:active .add-location-icon{--tw-text-opacity:1;color:rgb(21 21 21 / var(--tw-text-opacity))}.add-location-post[active] .add-location-icon{--tw-text-opacity:1;color:rgb(21 21 21 / var(--tw-text-opacity))}";var L=function(){function e(t){(0,r.Z)(this,e),(0,u.r)(this,t)}return(0,l.Z)(e,[{key:"componentWillLoad",value:function(){var e=(0,a.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.i.loadIntlForComponent(this.element);case 2:this.intl=e.sent;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"creator",get:function(){var e,t=this.postDetails,s=this.context;return t?null===(e=t.creatorDetails)||void 0===e?void 0:e.user:s.currentUser}},{key:"group",get:function(){var e=this.channelDetails,t=this.groups;return e?e.groups[0]:t[0]}},{key:"creatorFullName",get:function(){var e,t=this.intl,s=this.postDetails,i=this.creator,n=t.t("anonymous");return(i||(null===(e=null===s||void 0===s?void 0:s.post)||void 0===e?void 0:e.creator))&&(n=(null===i||void 0===i?void 0:i.fullName)||t.t("privateUser")),n}},{key:"accessIcon",get:function(){var e,t,s=this.intl,i=this.channelDetails,n=i?i.channel.access:this.access;return n===h.C.PRIVATE?(e="lock",t=s.t("visiblePrivate")):n===h.C.ORG?(e="organization",t=s.t("visibleOrg")):(e="globe",t=s.t("visibleAll")),{icon:e,label:t}}},{key:"renderAccessIcon",value:function(){var e=this.accessIcon;return(0,u.h)("calcite-icon",{icon:e.icon,scale:"s","text-label":e.label})}},{key:"renderPopover",value:function(e){var t=this.postDetails,s=this.channelDetails,i=this.index,n=this.context,o=this.isHub;return t?(0,u.h)("arcgis-hub-discussions-popover",{channelDetails:s,context:n,index:i,isHub:o,postDetails:t},e):e}},{key:"renderAvatars",value:function(){var e=this.creator,t=(0,u.h)("div",{class:"avatars"},this.renderCreatorAvatar(),this.renderChannelAvatar());return e&&(t=this.renderPopover(t)),t}},{key:"renderCreatorAvatar",value:function(){var e,t,s=this.postDetails,i=this.creator,n=this.context,o=!i&&(null===s||void 0===s?void 0:s.post)?{username:null===(e=s.post)||void 0===e?void 0:e.creator}:i;return(0,u.h)("calcite-avatar",{"full-name":null===o||void 0===o?void 0:o.fullName,scale:"l",thumbnail:(null===o||void 0===o?void 0:o.thumbnail)&&(0,w.a)(n.session.portal,o,n.session.token),"user-id":null===(t=o)||void 0===t?void 0:t.id,username:null===o||void 0===o?void 0:o.username})}},{key:"renderChannelAvatar",value:function(){var e=this.group,t=this.context;return(0,u.h)("calcite-avatar",{"full-name":null===e||void 0===e?void 0:e.title,scale:"m",thumbnail:e&&(0,w.g)(t.session.portal,e,t.session.token)})}},{key:"render",value:function(){var e,t=this.postDetails,s=this.group,i=this.creatorFullName,n=this.intl;return(0,u.h)(u.H,null,(0,u.h)("address",null,this.renderAvatars(),(0,u.h)("header",null,i),(0,u.h)("div",{class:{metadata:!0,timestamp:Boolean(null===t||void 0===t?void 0:t.post)}},(0,u.h)("b",null,null!==(e=null===s||void 0===s?void 0:s.title)&&void 0!==e?e:n.t("group.deleted")),(null===t||void 0===t?void 0:t.post)&&(0,u.h)(u.F,null,(0,u.h)("span",null,"\xb7"),(0,u.h)("arcgis-relative-date",{dateTime:t.post.createdAt,formatStyle:"short"})),(0,u.h)("span",null,"\xb7"),this.renderAccessIcon())))}},{key:"element",get:function(){return(0,u.g)(this)}}],[{key:"assetsDirs",get:function(){return["locales"]}}]),e}();L.style=":host{display:block}address{display:grid;grid-template-rows:repeat(2, minmax(0, 1fr));-moz-column-gap:0.5rem;column-gap:0.5rem;row-gap:0.25rem;font-style:normal;grid-template-columns:54px auto}arcgis-hub-discussions-popover{grid-row:span 2 / span 2}button{cursor:pointer;border-style:none;background-color:transparent;padding:0px}header{display:flex;align-items:flex-end;font-size:var(--calcite-font-size-0);line-height:1.25rem;font-weight:var(--calcite-font-weight-bold);text-transform:capitalize;color:var(--calcite-ui-text-1)}.avatars{position:relative;grid-row:span 2 / span 2;display:flex;height:54px}.avatars calcite-avatar+calcite-avatar{position:absolute;top:1rem;left:1rem;z-index:10;border-radius:9999px;border:3px solid var(--calcite-ui-foreground-1)}.metadata{display:flex;flex-wrap:nowrap;font-size:var(--calcite-font-size--1);line-height:1rem}.metadata b{max-height:1rem;word-break:break-all;font-weight:var(--calcite-font-weight-medium);font-style:normal;color:var(--calcite-ui-text-2);overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}.metadata span{display:flex;width:1rem;justify-content:center;font-size:var(--calcite-font-size--1);line-height:1rem;color:var(--calcite-ui-text-2)}.metadata arcgis-relative-date{white-space:nowrap}.metadata calcite-icon{margin-top:-0.125rem}";var P,G,Z=function(e,t,s,i){var n,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,s,i);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,s,a):n(t,s))||a);return o>3&&a&&Object.defineProperty(t,s,a),a};!function(e){e.Skeleton="skeleton",e.Content="content",e.OutOfContext="outOfContext",e.Editor="editor",e.Deleted="deleted"}(P||(P={})),function(e){e.IN="in",e.OUT="out",e.HIDDEN="hidden"}(G||(G={}));var M=function(){function e(t){(0,r.Z)(this,e),(0,u.r)(this,t),this.arcgisHubDiscussionsReplyDelete=(0,u.c)(this,"arcgisHubDiscussionsReplyDelete",7),this.arcgisHubDiscussionsGeometryDrawReset=(0,u.c)(this,"arcgisHubDiscussionsGeometryDrawReset",7),this.arcgisHubDiscussionsViewAllReplies=(0,u.c)(this,"arcgisHubDiscussionsViewAllReplies",7),this.arcgisHubDiscussionsReplyUpdate=(0,u.c)(this,"arcgisHubDiscussionsReplyUpdate",7),this.arcgisHubDiscussionsPostUpdate=(0,u.c)(this,"arcgisHubDiscussionsPostUpdate",7),this.arcgisHubDiscusssionsChannelUpdate=(0,u.c)(this,"arcgisHubDiscusssionsChannelUpdate",7),this.arcgisHubDiscussionsReplySelect=(0,u.c)(this,"arcgisHubDiscussionsReplySelect",7),this.hubTelemetry=(0,u.c)(this,"hubTelemetry",7),this.unsavedExistingFeatures=[],this.loading=!0,this.editing=!1,this.errorMessage=null,this.minHeight=null,this.replyClass=null,this.editorClass=G.HIDDEN,this.renderedEl=null,(0,d.b)(this,"handleSetComponentRef","handleDelete","handleEdit","handleAnimationEnd","handleLinkClicked","handleViewThread","renderReply","renderReplyOutOfContext","renderEditor","renderDeleted","handleViewAllReplies")}return(0,l.Z)(e,[{key:"componentWillLoad",value:function(){this.initialize()}},{key:"connectedCallback",value:function(){this.addAnimationEventListeners(this.renderedEl)}},{key:"disconnectedCallback",value:function(){this.removeAnimationEventListeners(this.renderedEl)}},{key:"handleDetailsUpdates",value:function(){this.addEnrichments()}},{key:"handleRenderedElChange",value:function(e,t){this.removeAnimationEventListeners(t),this.addAnimationEventListeners(e)}},{key:"initialize",value:function(){var e=(0,a.Z)((0,o.Z)().mark((function e(){var t;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.element,this.addEnrichments(),e.next=4,p.i.loadIntlForComponent(t);case 4:this.intl=e.sent;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addEnrichments",value:function(){var e=this.isPostEnriched,t=this.isReplyEnriched,s=this.isChannelEnriched,i=this.replyDetails.postId,n=this.postDetails.postId,o=this.channelDetails.channelId;!t&&i&&this.enrichReplyDetails(),!e&&n&&this.enrichPostDetails(),!s&&o&&this.enrichChannelDetails(),this.updateLoading()}},{key:"updateLoading",value:function(){var e=this.isEnriched;this.loading=!e}},{key:"enrichReplyDetails",value:function(){var e=(0,a.Z)((0,o.Z)().mark((function e(){var t,s,i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.replyDetails,s=this.context,e.next=3,(0,h.n)(Object.assign({postDetails:t},s.hubRequestOptions));case 3:i=e.sent,this.arcgisHubDiscussionsReplyUpdate.emit(i);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"enrichPostDetails",value:function(){var e=(0,a.Z)((0,o.Z)().mark((function e(){var t,s,i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.postDetails,s=this.context,e.next=3,(0,h.n)(Object.assign({postDetails:t,includeReplyCount:!0},s.hubRequestOptions));case 3:i=e.sent,this.arcgisHubDiscussionsPostUpdate.emit(i);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"enrichChannelDetails",value:function(){var e=(0,a.Z)((0,o.Z)().mark((function e(){var t,s,i,n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.context,s=this.replyDetails,i=this.channelDetails,e.next=3,(0,h.e)(Object.assign({channelDetails:i},t.hubRequestOptions));case 3:n=e.sent,this.arcgisHubDiscusssionsChannelUpdate.emit({postId:null===s||void 0===s?void 0:s.postId,channelDetails:n});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addAnimationEventListeners",value:function(e){e&&e.addEventListener("animationend",this.handleAnimationEnd)}},{key:"removeAnimationEventListeners",value:function(e){e&&e.removeEventListener("animationend",this.handleAnimationEnd)}},{key:"computeReplyBody",value:function(){return this.replyDetails.post.body}},{key:"handleViewAllReplies",value:function(){this.arcgisHubDiscussionsViewAllReplies.emit()}},{key:"isReplyEnriched",get:function(){var e=this.replyDetails,t=e.creatorDetails,s=e.post,i=[null===t||void 0===t?void 0:t.username,null===t||void 0===t?void 0:t.user,null===t||void 0===t?void 0:t.organization];return null===s||i.every((function(e){return void 0!==e}))}},{key:"isPostEnriched",get:function(){var e=this.postDetails,t=e.creatorDetails,s=e.post,i=[null===t||void 0===t?void 0:t.username,null===t||void 0===t?void 0:t.user,null===t||void 0===t?void 0:t.organization];return null===s||i.every((function(e){return void 0!==e}))}},{key:"isChannelEnriched",get:function(){var e=this.channelDetails;return[e.channel,e.groups].every((function(e){return void 0!==e}))}},{key:"isEnriched",get:function(){var e=this.intl,t=this.isPostEnriched,s=this.isReplyEnriched,i=this.isChannelEnriched;return Boolean(e)&&t&&s&&i}},{key:"creatorFullName",get:function(){var e=this.intl,t=this.replyDetails,s=t.creatorDetails.user,i=t.post,n=e.t("anonymous");return(s||(null===i||void 0===i?void 0:i.creator))&&(n=(null===s||void 0===s?void 0:s.fullName)||e.t("privateUser")),n}},{key:"group",get:function(){var e=this.channelDetails;return e?e.groups[0]:void 0}},{key:"outOfContext",get:function(){var e=this.index;return void 0===this.lead&&void 0!==e}},{key:"styles",get:function(){var e=this.minHeight,t={zIndex:this.editing?"20":"10"};return e&&(t.minHeight="".concat(e,"px")),t}},{key:"handleSetComponentRef",value:function(e){e&&(this.renderedEl=e)}},{key:"handleReplyCancel",value:function(){this.transitionToReply(),this.arcgisHubDiscussionsGeometryDrawReset.emit()}},{key:"handleAnimationEnd",value:function(e){"out-left"===e.animationName?(this.editing=!0,this.editorClass=G.IN,this.replyClass=G.HIDDEN):"out-right"===e.animationName?(this.editing=!1,this.editorClass=G.HIDDEN,this.replyClass=G.IN):this.minHeight=null}},{key:"handleDelete",value:function(){var e=this,t=this.replyDetails.post,s=this.context;return this.errorMessage=null,(0,h.v)(Object.assign({postId:t.id},s.hubRequestOptions)).then((function(){e.deletedDuringSession=!0,e.emitHubTelemetry(Object.assign(Object.assign({},g.d.dictionary.category.content.action.delete),{response:g.d.constants.response.SUCCESS})),e.arcgisHubDiscussionsReplyDelete.emit(t)})).catch((function(t){e.errorMessage="deleteFailure",e.emitHubTelemetry(Object.assign(Object.assign({},g.d.dictionary.category.content.action.delete),{response:g.d.constants.response.FAILURE})),console.error("Could not delete reply:",t.message)}))}},{key:"handleEdit",value:function(){this.transitionEditorView(!0)}},{key:"handleViewThread",value:function(){this.arcgisHubDiscussionsReplySelect.emit()}},{key:"transitionToReply",value:function(){this.transitionEditorView(!1)}},{key:"transitionEditorView",value:function(e){var t,s;this.minHeight=null!==(s=null===(t=this.renderedEl)||void 0===t?void 0:t.offsetHeight)&&void 0!==s?s:null,this.editorClass=e?G.HIDDEN:G.OUT,this.replyClass=e?G.OUT:G.HIDDEN}},{key:"emitHubTelemetry",value:function(e){var t=this.postDetails.postId,s=this.replyDetails.postId,i=this.channelDetails.channel;this.hubTelemetry.emit(Object.assign(Object.assign({},e),{postId:s,parentId:t,channelId:i.id,channelAccess:i.access}))}},{key:"handleLinkClicked",value:function(e){var t=e.target;if(["CALCITE-LINK"].includes(t.nodeName)&&!t.hasAttribute("data-mention")){var s=this.replyDetails.postId,i=this.postDetails.postId,n=this.channelDetails.channel,o=this.index;this.hubTelemetry.emit(Object.assign(Object.assign({},g.d.dictionary.category.navigation.action.external.label.link),{details:t.href,postId:s,parentId:i,channelId:n.id,channelAccess:n.access,position:o}))}}},{key:"captureReplyDeepLinkImpression",value:function(){this.emitHubTelemetry(Object.assign(Object.assign({},g.d.dictionary.category.interaction.action.viewed.label.post.details.thread),{response:g.d.constants.response.SUCCESS}))}},{key:"captureReplyListImpression",value:function(){this.emitHubTelemetry(Object.assign(Object.assign({},g.d.dictionary.category.interaction.action.viewed.label.post.details.thread),{position:this.index}))}},{key:"captureReplyDeletedImpression",value:function(){this.emitHubTelemetry(Object.assign(Object.assign({},g.d.dictionary.category.interaction.action.viewed.label.post.details.thread),{response:g.d.constants.response.FAILURE}))}},{key:"views",get:function(){var e,t=this.renderReply,s=this.renderReplyOutOfContext,i=this.renderEditor,o=this.renderDeleted,a=this.renderSkeleton;return e={},(0,n.Z)(e,P.Skeleton,{render:a}),(0,n.Z)(e,P.Content,{render:t}),(0,n.Z)(e,P.OutOfContext,{render:s}),(0,n.Z)(e,P.Editor,{render:i}),(0,n.Z)(e,P.Deleted,{render:o}),e}},{key:"view",get:function(){var e=this.views,t=this.editing,s=this.outOfContext,i=this.replyDetails.post;return e[this.loading?P.Skeleton:t?P.Editor:s?P.OutOfContext:i?P.Content:P.Deleted]}},{key:"renderEditor",value:function(){var e=this.context,t=this.hasMap,s=this.unsavedFeatures,i=this.unsavedRelatedFeatures,n=this.unsavedExistingFeatures,o=this.editorClass,a=this.lead,r=this.postDetails,l=this.channelDetails,c=this.replyDetails,d=this.discussionDetails,h=this.isMobile,p={"reply-lead":a};return o&&(p[o]=!0),(0,u.h)("arcgis-hub-discussions-reply-editor",{channelDetails:l,class:p,context:e,discussionDetails:d,hasMap:t,isMobile:h,postDetails:r,ref:this.handleSetComponentRef,replyDetails:c,unsavedExistingFeatures:n,unsavedFeatures:s,unsavedRelatedFeatures:i})}},{key:"renderAvatars",value:function(){var e,t=this.context,s=this.isHub,i=this.postDetails,n=this.replyDetails,o=this.channelDetails,a=this.index,r=this.outOfContext,l=this.group,c=t.session,d=c.portal,h=c.token,p=!n.creatorDetails.user&&n.post?{username:n.post.creator}:n.creatorDetails.user,g=r?"l":"m",m=[(0,u.h)("calcite-avatar",{"full-name":null===p||void 0===p?void 0:p.fullName,key:"creator",scale:g,thumbnail:(null===p||void 0===p?void 0:p.thumbnail)&&(0,w.a)(d,p,h),"user-id":null===(e=p)||void 0===e?void 0:e.id,username:null===p||void 0===p?void 0:p.username})];return r&&l&&m.push((0,u.h)("calcite-avatar",{"full-name":l.title,scale:"m",thumbnail:(0,w.g)(t.session.portal,l,t.session.token)})),n.creatorDetails&&(m=(0,u.h)("arcgis-hub-discussions-popover",{channelDetails:o,context:t,index:a,isHub:s,originalPostDetails:i,postDetails:n},m)),m}},{key:"renderActions",value:function(){var e=this.intl,t=this.context,s=this.channelDetails,i=s.channel,n=s.groups,o=this.replyDetails.post,a=[];if(n.length&&(0,h.w)(o,t.currentUser)&&a.push({text:e.t("edit"),onClick:this.handleEdit}),(0,h.x)(o,i,t.currentUser)&&a.push({text:e.t("delete"),onClick:this.handleDelete}),a.length)return(0,u.h)("calcite-action-group",{layout:"horizontal"},a.map((function(e){return(0,u.h)("calcite-action",{appearance:e.appearance,"data-action":e.text.toLowerCase(),icon:e.icon,key:e.text||e.pin,onClick:e.onClick,onMouseOver:e.onMouseOver,scale:"s",text:e.text,"text-enabled":Boolean(e.text)})})))}},{key:"renderReplyOutOfContext",value:function(){var e,t=this.intl,s=this.errorMessage,i=this.replyDetails,n=this.postDetails,o=this.channelDetails,a=this.creatorFullName,r=this.hasMap,l=this.index,c=this.discussionDetails,d=this.context,h=this.replyClass,p=this.isMobile,g=n.creatorDetails.user.fullName,m="rtl"===t.direction?"arrow-left":"arrow-right",y={"out-of-context":!0};return h&&(y[h]=!0),void 0===l?this.captureReplyDeepLinkImpression():this.captureReplyListImpression(),(0,u.h)("article",{class:y,ref:this.handleSetComponentRef},(0,u.h)("div",{class:"reply-header"},(0,u.h)("div",{class:"header-avatars"},this.renderAvatars()),(0,u.h)("header",null,a),(0,u.h)("div",{class:"metadata"},(0,u.h)("calcite-icon",{class:"flipY",icon:"right",scale:"s"}),(0,u.h)("b",null,t.t("replyingTo",{fullName:g})),(0,u.h)("span",null,"\xb7"),(0,u.h)("calcite-link",{onClick:this.handleViewThread},t.t("viewPost")))),(0,u.h)("div",{class:"reply-body"},(0,u.h)("arcgis-multiline-ellipsis",{"collapse-enabled":!0,"expand-enabled":!0,"expand-icon":m,innerHTML:this.computeReplyBody(),lines:4,onClick:this.handleViewThread}),this.renderActions(),(0,u.h)("arcgis-hub-discussions-post-geography",{channelDetails:o,context:d,discussionDetails:c,hasMap:r,isMobile:p,parentDetails:n,postDetails:i,toggleable:!0,url:null===(e=null===c||void 0===c?void 0:c.reference)||void 0===e?void 0:e.url}),s&&(0,u.h)("calcite-notice",{color:"red",scale:"s"},(0,u.h)("div",{slot:"title"},t.t("error")),(0,u.h)("div",{slot:"message"},t.t(s)))))}},{key:"renderReply",value:function(){var e,t=this.intl,s=this.errorMessage,i=this.postDetails,n=this.replyDetails,o=this.channelDetails,a=this.replyClass,r=this.creatorFullName,l=this.lead,c=this.hasMap,d=this.index,h=this.discussionDetails,p=this.context,g=this.isMobile,m={"reply-lead":l};return a&&(m[a]=!0),void 0===d?this.captureReplyDeepLinkImpression():this.captureReplyListImpression(),(0,u.h)("article",{class:m,ref:this.handleSetComponentRef},this.renderAvatars(),(0,u.h)("div",null,(0,u.h)("address",null,(0,u.h)("b",null,r),(0,u.h)("span",null,"\xb7"),(0,u.h)("arcgis-relative-date",{dateTime:n.post.createdAt,formatStyle:"short"})),(0,u.h)("arcgis-multiline-ellipsis",{"collapse-enabled":!0,"expand-enabled":!0,innerHTML:this.computeReplyBody(),lines:4}),this.renderActions(),(0,u.h)("arcgis-hub-discussions-post-geography",{channelDetails:o,context:p,discussionDetails:h,hasMap:c,isMobile:g,parentDetails:i,postDetails:n,toggleable:!0,url:null===(e=null===h||void 0===h?void 0:h.reference)||void 0===e?void 0:e.url}),s&&(0,u.h)("calcite-notice",{color:"red",scale:"s"},(0,u.h)("div",{slot:"title"},t.t("error")),(0,u.h)("div",{slot:"message"},t.t(s)))))}},{key:"renderDeleted",value:function(){var e=this.intl,t=this.handleViewAllReplies;return this.deletedDuringSession||this.captureReplyDeletedImpression(),(0,u.h)("calcite-notice",{color:"red",scale:"m"},(0,u.h)("div",{slot:"title"},e.t("deleted.title")),(0,u.h)("div",{slot:"message"},e.t("deleted.message")),(0,u.h)("calcite-link",{onClick:t,slot:"link"},e.t("delete.action")))}},{key:"renderSkeleton",value:function(){return(0,u.h)("arcgis-hub-discussions-post-skeleton",null)}},{key:"render",value:function(){var e=this.view,t=this.styles;return(0,u.h)(u.H,{"data-element":"discussions-reply",style:t},e.render())}},{key:"element",get:function(){return(0,u.g)(this)}}],[{key:"assetsDirs",get:function(){return["locales"]}},{key:"watchers",get:function(){return{intl:["handleDetailsUpdates"],postDetails:["handleDetailsUpdates"],replyDetails:["handleDetailsUpdates"],channelDetails:["handleDetailsUpdates"],renderedEl:["handleRenderedElChange"]}}}]),e}();Z([C({getKey:function(){return this.replyDetails.post.body}}),_({calcite:!0}),A(),E({filterOptions:{whiteList:{"calcite-link":["href","data-mention"]}},extendDefaults:!0})],M.prototype,"computeReplyBody",null),Z([(0,v.c)()],M.prototype,"captureReplyDeepLinkImpression",null),Z([(0,v.c)()],M.prototype,"captureReplyListImpression",null),Z([(0,v.c)()],M.prototype,"captureReplyDeletedImpression",null),M.style='.sc-arcgis-hub-discussions-reply-h{display:block;background-color:var(--calcite-ui-foreground-1)}article.sc-arcgis-hub-discussions-reply{position:relative;display:grid;grid-template-rows:repeat(1, minmax(0, 1fr));gap:0.75rem;grid-template-columns:2rem auto}div.sc-arcgis-hub-discussions-reply{overflow-x:auto}.reply-lead.sc-arcgis-hub-discussions-reply{padding-bottom:1.25rem}.reply-lead.sc-arcgis-hub-discussions-reply::before{position:absolute;top:2.25rem;display:block;width:0.125rem;border-radius:0.125rem;background-color:var(--calcite-ui-foreground-2);height:calc(100% - 2.25rem);left:15px;content:""}arcgis-hub-discussions-reply-editor.reply-lead.sc-arcgis-hub-discussions-reply{padding-bottom:1.5rem}arcgis-hub-discussions-reply-editor.reply-lead.sc-arcgis-hub-discussions-reply::before{z-index:-10}address.sc-arcgis-hub-discussions-reply{margin-bottom:0.125rem;display:grid;font-size:var(--calcite-font-size--1);font-style:normal;line-height:1.25rem;grid-template-columns:minmax(0, -webkit-max-content) 1rem minmax(0, -webkit-max-content);grid-template-columns:minmax(0, max-content) 1rem minmax(0, max-content)}address.sc-arcgis-hub-discussions-reply b.sc-arcgis-hub-discussions-reply{font-size:var(--calcite-font-size-0);line-height:1.25rem;font-weight:var(--calcite-font-weight-bold);color:var(--calcite-ui-text-1)}address.sc-arcgis-hub-discussions-reply span.sc-arcgis-hub-discussions-reply{display:flex;justify-content:center;color:var(--calcite-ui-text-2)}address.sc-arcgis-hub-discussions-reply arcgis-relative-date.sc-arcgis-hub-discussions-reply{color:var(--calcite-ui-text-2)}arcgis-multiline-ellipsis.sc-arcgis-hub-discussions-reply{font-size:var(--calcite-font-size-0);line-height:1.375}calcite-action-group.sc-arcgis-hub-discussions-reply{margin-left:-0.5rem}.hidden.sc-arcgis-hub-discussions-reply{visibility:hidden}@-webkit-keyframes in-right{0%{opacity:0;transform:translate3D(-100%, 0, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-right{0%{opacity:0;transform:translate3D(-100%, 0, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}article.in.sc-arcgis-hub-discussions-reply{-webkit-animation:in-right 300ms ease-out forwards;animation:in-right 300ms ease-out forwards}@-webkit-keyframes out-left{0%{opacity:1;transform:translate3D(0, 0, 0)}100%{opacity:0;transform:translate3D(-100%, 0, 0)}}@keyframes out-left{0%{opacity:1;transform:translate3D(0, 0, 0)}100%{opacity:0;transform:translate3D(-100%, 0, 0)}}article.out.sc-arcgis-hub-discussions-reply{-webkit-animation:out-left 300ms ease-out forwards;animation:out-left 300ms ease-out forwards}arcgis-hub-discussions-reply-editor.sc-arcgis-hub-discussions-reply{padding-bottom:1rem}@-webkit-keyframes in-left{0%{opacity:0;transform:translate3D(100%, 0, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-left{0%{opacity:0;transform:translate3D(100%, 0, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}arcgis-hub-discussions-reply-editor.in.sc-arcgis-hub-discussions-reply{-webkit-animation:in-left 300ms ease-out forwards;animation:in-left 300ms ease-out forwards}@-webkit-keyframes out-right{0%{opacity:1;transform:translate3D(0, 0, 0)}100%{opacity:0;transform:translate3D(100%, 0, 0)}}@keyframes out-right{0%{opacity:1;transform:translate3D(0, 0, 0)}100%{opacity:0;transform:translate3D(100%, 0, 0)}}arcgis-hub-discussions-reply-editor.out.sc-arcgis-hub-discussions-reply{-webkit-animation:out-right 300ms ease-out forwards;animation:out-right 300ms ease-out forwards}arcgis-hub-discussions-reply-editor[data-editing].sc-arcgis-hub-discussions-reply{padding-left:0px;padding-right:0px}arcgis-multiline-ellipsis.sc-arcgis-hub-discussions-reply+calcite-notice.sc-arcgis-hub-discussions-reply{margin-top:1rem}.flipY.sc-arcgis-hub-discussions-reply{transform:scaleY(-1)}article.out-of-context.sc-arcgis-hub-discussions-reply{margin-left:1rem;margin-right:1rem;display:grid;gap:0.5rem;font-style:normal;grid-template-columns:1fr}article.out-of-context.sc-arcgis-hub-discussions-reply>div.reply-body.sc-arcgis-hub-discussions-reply{display:grid;gap:0.25rem}article.out-of-context.sc-arcgis-hub-discussions-reply>div.reply-body.sc-arcgis-hub-discussions-reply>arcgis-hub-discussions-post-geography.sc-arcgis-hub-discussions-reply{margin-left:-1rem}.reply-header.sc-arcgis-hub-discussions-reply{display:grid;grid-template-rows:repeat(2, minmax(0, 1fr));-moz-column-gap:0.5rem;column-gap:0.5rem;row-gap:0.25rem;font-style:normal;grid-template-columns:54px auto}arcgis-hub-discussions-popover.sc-arcgis-hub-discussions-reply{grid-row:span 2 / span 2}.reply-header.sc-arcgis-hub-discussions-reply header.sc-arcgis-hub-discussions-reply{display:flex;align-items:flex-end;font-size:var(--calcite-font-size-0);line-height:1.25rem;font-weight:var(--calcite-font-weight-bold);text-transform:capitalize;color:var(--calcite-ui-text-1)}.header-avatars.sc-arcgis-hub-discussions-reply{grid-row:span 2 / span 2;display:flex;height:54px}.header-avatars.sc-arcgis-hub-discussions-reply calcite-avatar.sc-arcgis-hub-discussions-reply+calcite-avatar.sc-arcgis-hub-discussions-reply{position:absolute;top:1rem;left:1rem;z-index:10;box-sizing:content-box;border-radius:9999px;border:3px solid var(--calcite-ui-foreground-1)}.reply-header.sc-arcgis-hub-discussions-reply .metadata.sc-arcgis-hub-discussions-reply{display:flex;flex-wrap:nowrap;gap:0.25rem;font-size:var(--calcite-font-size--1);line-height:1rem}.reply-header.sc-arcgis-hub-discussions-reply .metadata.sc-arcgis-hub-discussions-reply b.sc-arcgis-hub-discussions-reply{max-height:1rem;word-break:break-all;font-weight:var(--calcite-font-weight-medium);font-style:normal;color:var(--calcite-ui-text-2);overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}.reply-header.sc-arcgis-hub-discussions-reply .metadata.sc-arcgis-hub-discussions-reply span.sc-arcgis-hub-discussions-reply{display:flex;width:0.5rem;justify-content:center;font-size:var(--calcite-font-size--1);line-height:1rem;color:var(--calcite-ui-text-2)}';var U=function(e,t,s,i){var n,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,s,i);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,s,a):n(t,s))||a);return o>3&&a&&Object.defineProperty(t,s,a),a},z=function(){function e(t){(0,r.Z)(this,e),(0,u.r)(this,t),this.arcgisHubDiscussionsReplyCreate=(0,u.c)(this,"arcgisHubDiscussionsReplyCreate",7),this.arcgisHubDiscussionsReplyEdit=(0,u.c)(this,"arcgisHubDiscussionsReplyEdit",7),this.arcgisHubDiscussionsReplyCancel=(0,u.c)(this,"arcgisHubDiscussionsReplyCancel",7),this.arcgisHubDiscussionsGeometryDrawCreate=(0,u.c)(this,"arcgisHubDiscussionsGeometryDrawCreate",7),this.arcgisHubDiscussionsGeometryDrawTypeSelect=(0,u.c)(this,"arcgisHubDiscussionsGeometryDrawTypeSelect",7),this.arcgisHubDiscussionsGeometryDrawEdit=(0,u.c)(this,"arcgisHubDiscussionsGeometryDrawEdit",7),this.arcgisHubDiscussionsGeometryDrawReset=(0,u.c)(this,"arcgisHubDiscussionsGeometryDrawReset",7),this.arcgisHubDiscussionsGeometrySelect=(0,u.c)(this,"arcgisHubDiscussionsGeometrySelect",7),this.arcgisHubDiscussionsGeometryDeselect=(0,u.c)(this,"arcgisHubDiscussionsGeometryDeselect",7),this.arcgisHubDiscussionsGeometryClearAll=(0,u.c)(this,"arcgisHubDiscussionsGeometryClearAll",7),this.arcgisHubDiscussionsScrollTo=(0,u.c)(this,"arcgisHubDiscussionsScrollTo",7),this.hubTelemetry=(0,u.c)(this,"hubTelemetry",7),this.unsavedFeatures=[],this.unsavedRelatedFeatures=[],this.unsavedExistingFeatures=[],this._unsavedFeatures=[],this._unsavedRelatedFeatures=[],this._unsavedExistingFeatures=[],this.inputValue="",this.pending=!1,this.discussionValue="",this.errorMessage=null,(0,d.b)(this,"focusInput","handleReplySubmit","handleCancel","handleCancelOrConfirm","handleConfirmBackButtonClicked","handleInputChange","handleInputRef","handleAddLocationToggle","setActiveGeometryDrawType")}return(0,l.Z)(e,[{key:"componentWillLoad",value:function(){var e=(0,a.Z)((0,o.Z)().mark((function e(){var t,s;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(null===(t=this.replyDetails)||void 0===t?void 0:t.post)&&(this.inputValue=t.post.body,this.discussionValue=t.post.discussion,s=(0,x.c)(t.post.geometry),this.geometryValue=Object.keys(s).length?s:null),this._unsavedFeatures=this.unsavedFeatures,this._unsavedRelatedFeatures=this.unsavedRelatedFeatures,e.next=6,p.i.loadIntlForComponent(this.element);case 6:this.intl=e.sent;case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidLoad",value:function(){this.focusInput(),this.autoScroll&&this.arcgisHubDiscussionsScrollTo.emit()}},{key:"updateBodyValue",value:function(e){this.inputValue=e.target.value}},{key:"mentionConfig",get:function(){var e=this.context,t=this.channelDetails;return{searchUsers:function(s){return(0,h.y)(Object.assign({id:t.groups[0].id,currentUser:e.currentUser,query:s},e.hubRequestOptions))}}}},{key:"shouldConfirmCancel",get:function(){var e=this.replyDetails;return this.inputValue!==e.post.body}},{key:"isInputValid",get:function(){var e=this.inputValue;return e.trim().length>0&&e.length<=h.J}},{key:"inputMessage",get:function(){var e=this.inputValue,t=this.isInputValid,s=this.intl;if(e.length>=h.W)return t?{status:"idle",text:s.t("reply.body.validation.warning")}:{icon:"exclamation-mark-circle",status:"invalid",text:s.t("reply.body.validation.error")}}},{key:"replyDetailsWithLocationEdits",get:function(){var e=this.replyDetails,t=this.geometryValue,s=this.discussionValue,i=(0,x.c)(e);return i&&(i.post.geometry=t,s!==e.post.discussion&&(i.post.discussion=s)),i}},{key:"blockedNotice",get:function(){var e,t=(0,h.l)(this.channelDetails.groups[0]),s=(0,h.l)(this.discussionDetails.reference);return t||s?t?s||(e="group"===this.discussionDetails.type?k.A.EditReplyGroup:k.A.EditReplyItem):e=k.A.EditReplyGroup:e=k.A.EditReply,e}},{key:"focusInput",value:function(){var e=this.input;e&&e.setFocus&&e.setFocus()}},{key:"handleGeometryValueUpdated",value:function(){if(this.replyDetails){var e=this.replyDetails.post.geometry,t=this.geometryValue;this.geometryValueHasChanges=JSON.stringify(t)!==JSON.stringify(e)}}},{key:"handleFeatureChange",value:function(e){var t,s,i,n=this.replyDetails;if(e.length){var o=null===(s=null===(t=e[0])||void 0===t?void 0:t.properties)||void 0===s?void 0:s.id;((null===(i=null===n||void 0===n?void 0:n.post)||void 0===i?void 0:i.id)===o||!(null===n||void 0===n?void 0:n.post)&&null===o)&&(this._unsavedFeatures=e)}else this._unsavedFeatures=[]}},{key:"handleRelatedFeatureChange",value:function(e){var t,s=this.replyDetails;if(e.length){var i=e[0].postId;((null===(t=null===s||void 0===s?void 0:s.post)||void 0===t?void 0:t.id)===i||!(null===s||void 0===s?void 0:s.post)&&null===i)&&(this._unsavedRelatedFeatures=e)}else this._unsavedRelatedFeatures=[]}},{key:"handleExistingFeatureChange",value:function(e){var t,s=this.replyDetails;if(e.length){var i=null===(t=e[0].properties)||void 0===t?void 0:t.id;(null===s||void 0===s?void 0:s.postId)===i&&(this._unsavedExistingFeatures=e)}else this._unsavedExistingFeatures=[]}},{key:"handleAddLocationsActiveGeometryTypeChanged",value:function(e){e&&this.arcgisHubDiscussionsGeometryDrawTypeSelect.emit(e)}},{key:"handleReplySubmit",value:function(e){var t=this;return e.preventDefault(),this.pending=!0,(this.replyDetails?this.handleEdit():this.handleCreate()).catch((function(e){return console.error("Could not create reply:",e.message),null})).finally((0,a.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.pending=!1,t.arcgisHubDiscussionsGeometryClearAll.emit(),t.canAddLocations=!1,t.addLocationsActiveGeometryType=null,setTimeout(t.focusInput,100);case 5:case"end":return e.stop()}}),e)}))))}},{key:"handleCreate",value:function(){var e=this,t=this.context,s=this._unsavedFeatures,i=this._unsavedRelatedFeatures,n=this.inputValue,o=this.postDetails.post,a=this.channelDetails.channel,r=this.discussionDetails,l=r.discussion,c=r.reference.url,u=this.arcgisHubDiscussionsReplyCreate,d=l;if(i.length){var p=c.split("/").pop(),m=new Set(i.map((function(e){return e.objectId})));d=(0,h.E)(d,p,Array.from(m))}var y=null;return s.length&&(y=s.length>1?(0,h.F)(s):s[0].geometry),this.errorMessage=null,(0,h.K)(Object.assign({postId:o.id,params:{access:a.access,groups:a.groups,channelId:a.id,discussion:d,body:n.trim(),geometry:y},mentionUrl:window.location.href},t.hubRequestOptions)).then((function(t){return e.inputValue="",e.hubTelemetry.emit(Object.assign(Object.assign({},g.d.dictionary.category.content.action.create),{response:g.d.constants.response.SUCCESS,postId:t.id,parentId:o.id,channelId:a.id,channelAccess:a.access})),u.emit(t),t})).catch((function(t){return console.error("ERROR:",t),e.errorMessage="createFailure",e.hubTelemetry.emit(Object.assign(Object.assign({},g.d.dictionary.category.content.action.create),{response:g.d.constants.response.FAILURE,parentId:o.id,channelId:a.id,channelAccess:a.access})),console.error("Failed to create reply:",t.message),null}))}},{key:"handleEdit",value:function(){var e=this,t=this.context,s=this.inputValue,n=this.replyDetails.post,o=this.postDetails.postId,a=this.channelDetails.channel,r=this.arcgisHubDiscussionsReplyEdit,l=this._unsavedFeatures,c=this._unsavedRelatedFeatures,u=this._unsavedExistingFeatures,d=this.discussionDetails.reference.url;this.errorMessage=null;var p=this.discussionValue;if(c.length){var m=d.split("/").pop(),y=c.map((function(e){return e.objectId}));p=(0,h.E)(p,m,y)}var v=this.geometryValue&&Object.keys(this.geometryValue).length?(0,h.d)(Object.assign(Object.assign({},n),{geometry:this.geometryValue})):[];u.forEach((function(e){var t=e.properties.index,s=e.geometry;v[+t].geometry=s}));var b=null,f=[].concat((0,i.Z)(v),(0,i.Z)(l));return f.length&&(b=f.length>1?(0,h.F)(f):f[0].geometry.coordinates.length?f[0].geometry:null),(0,h.I)(Object.assign({postId:n.id,params:{body:s.trim(),discussion:p,geometry:b},mentionUrl:window.location.href},t.hubRequestOptions)).then((function(t){return e.hubTelemetry.emit(Object.assign(Object.assign({},g.d.dictionary.category.content.action.update),{response:g.d.constants.response.SUCCESS,postId:n.id,parentId:o,channelId:a.id,channelAccess:a.access})),r.emit(t),t})).catch((function(t){return e.errorMessage="editFailure",e.hubTelemetry.emit(Object.assign(Object.assign({},g.d.dictionary.category.content.action.update),{response:g.d.constants.response.FAILURE,postId:n.id,parentId:o,channelId:a.id,channelAccess:a.access})),console.error("Failed to edit reply:",t.message),null}))}},{key:"handleCancel",value:function(){var e=this.replyDetails.post,t=this.postDetails.post,s=this.channelDetails.channel;this.hubTelemetry.emit(Object.assign(Object.assign({},g.d.dictionary.category.interaction.action.close.label.editor),{postId:null===e||void 0===e?void 0:e.id,parentId:null===t||void 0===t?void 0:t.id,channelId:s.id,channelAccess:s.access})),this.arcgisHubDiscussionsReplyCancel.emit()}},{key:"handleCancelOrConfirm",value:function(){this.shouldConfirmCancel?this.confirmCancel=!0:this.handleCancel(),this.arcgisHubDiscussionsGeometryClearAll.emit(),this.canAddLocations=!1}},{key:"handleConfirmBackButtonClicked",value:function(){this.confirmCancel=!1}},{key:"handleInputChange",value:function(e){e.preventDefault(),this.inputValue=e.target.value}},{key:"handleAddLocationToggle",value:function(){var e=this.replyDetails,t=this.postDetails,s=this.channelDetails;if(this.canAddLocations=!this.canAddLocations,this.canAddLocations){var i=null===e||void 0===e?void 0:e.postId;this.arcgisHubDiscussionsGeometryDrawCreate.emit(i),this.hubTelemetry.emit(Object.assign(Object.assign({},g.d.dictionary.category.interaction.action.enable.label.addLocation),{postId:null===e||void 0===e?void 0:e.postId,parentId:t.postId,channelId:s.channelId,channelAccess:s.channel.access}))}else this.arcgisHubDiscussionsGeometryDrawReset.emit(),this.addLocationsActiveGeometryType=null,this.hubTelemetry.emit(Object.assign(Object.assign({},g.d.dictionary.category.interaction.action.disable.label.addLocation),{postId:null===e||void 0===e?void 0:e.postId,parentId:t.postId,channelId:s.channelId,channelAccess:s.channel.access}))}},{key:"handleFeatureRemove",value:function(e){var t,s=e.detail.properties,i=s.relatedFeatureId,n=s.index,o=s.unsaved;if(!o)if(i){var a=(0,h.i)(this.discussionValue).features,r=this.discussionDetails.reference.url.split("/").pop();a.splice(a.indexOf(i),1),this.discussionValue=(0,h.E)(this.discussionValue.split("?")[0],r,a)}else"GeometryCollection"===(null===(t=this.geometryValue)||void 0===t?void 0:t.type)?(o?this.geometryValue.geometries.splice(n,1):this.geometryValue.geometries[n]=null,this.geometryValue=Object.assign({},this.geometryValue)):this.geometryValue=null}},{key:"setActiveGeometryDrawType",value:function(e){var t=this.addLocationsActiveGeometryType,s=e.target.dataset.type;this.addLocationsActiveGeometryType=s===t?void 0:s}},{key:"hasLocationChanges",get:function(){if(this.replyDetails){var e=this.replyDetails.post.discussion,t=this.discussionValue;return Boolean(this._unsavedFeatures.length+this._unsavedRelatedFeatures.length+this._unsavedExistingFeatures.length)||t!==e||this.geometryValueHasChanges}return!1}},{key:"handleInputRef",value:function(e){this.input=e}},{key:"renderUserDetails",value:function(){var e=this.context,t=(0,u.h)("calcite-icon",{icon:"user",scale:"l"}),s=this.intl.t("anonymous");if(e.currentUser){s=e.currentUser.fullName;var i=e.currentUser,n=i.username,o=i.id;t=(0,u.h)("calcite-avatar",{"full-name":s,scale:"m",slot:"header-actions-start",thumbnail:(0,w.a)(e.session.portal,e.currentUser,e.session.token),"user-id":o,username:n})}return(0,u.h)("address",{class:"hub-discussions-reply-editor-user-details"},t,(0,u.h)("b",{class:"hub-discussions-reply-editor-user-details__name"},s))}},{key:"renderAddLocationsButton",value:function(){var e=this,t=this.hasMap,s=this.canAddLocations,i=this.blockedNotice,n=this.addLocationsActiveGeometryType,o=this.intl,a=[{type:"select",icon:"select"},{type:"point",icon:"pin"},{type:"polyline",icon:"freehand"},{type:"polygon",icon:"freehand-area"}].map((function(t){var s=t.type,i=t.icon;return(0,u.h)("calcite-action",{active:n===s,"data-type":s,icon:i,key:s,onClick:e.setActiveGeometryDrawType,text:o.t("location.action.".concat(s)),textEnabled:!0})}));return(0,u.h)(u.F,null,(0,u.h)("calcite-popover",{label:o.t("location.heading"),open:s&&!Boolean(n),referenceElement:this.locationActionElement,triggerDisabled:!0},a),(0,u.h)("calcite-tooltip",{closeOnClick:!0,label:o.t("location.tooltip"),referenceElement:!s&&this.locationActionElement},(0,u.h)("span",null,o.t("location.tooltip"))),(0,u.h)("calcite-action",{active:s,appearance:"solid",class:"add-location-post",disabled:!t||Boolean(i),onClick:this.handleAddLocationToggle,ref:function(t){e.locationActionElement=t},text:o.t("location.heading")},(0,u.h)("calcite-icon",{class:"add-location-icon",icon:"pin-plus",scale:"s"})))}},{key:"renderPrimaryActionButton",value:function(){var e,t,s=this.replyDetails,i=this.intl,n=this.inputValue,o=this.pending,a=this.isInputValid,r=this.hasLocationChanges,l=this.blockedNotice;return s?(e=i.t("saveReply"),t=Boolean(l)||!a||n===s.post.body&&!r):(e=i.t("createReply"),t=Boolean(l)||!a),(0,u.h)("calcite-button",{class:"hub-discussions-reply-editor__button",disabled:t,label:e,loading:o,round:!0,scale:"l",type:"submit",width:"auto"},e)}},{key:"renderSecondaryActionButton",value:function(){var e=this.replyDetails,t=this.intl;if(e){var s=t.t("cancel");return(0,u.h)("calcite-button",{class:"hub-discussions-reply-editor__button",color:"neutral",disabled:!1,label:s,onClick:this.handleCancelOrConfirm,round:!0,scale:"l",type:"reset",width:"auto"},s)}}},{key:"renderInput",value:function(){var e=this.inputValue,t=this.inputMessage,s=this.pending,i=this.intl,n=this.postDetails.creatorDetails.user,o=this.context,a=this.mentionConfig,r=this.blockedNotice,l=i.t("replyToPost");return n&&(l=i.t("replyToUserPost",{firstName:n.firstName})),(0,u.h)(u.F,null,(0,u.h)("arcgis-hub-rich-text",{class:"hub-discussions-reply-editor__body",context:o,disabled:Boolean(r)||s,label:i.t("inputLabel"),mention:a,placeholder:l,"text-transform":!0,toolbar:"",value:e}),t&&(0,u.h)("calcite-input-message",{class:"hub-discussions-reply-editor__message",icon:t.icon,scale:"l",status:t.status},t.text))}},{key:"renderEditor",value:function(){var e,t=this.intl,s=this.errorMessage,i=this.channelDetails,n=this.context,o=this.hasMap,a=this.replyDetailsWithLocationEdits,r=this._unsavedFeatures,l=this._unsavedRelatedFeatures,c=this._unsavedExistingFeatures,d=this.discussionDetails,h=this.postDetails,p=this.blockedNotice,g=this.isMobile;return(0,u.h)(u.F,null,this.renderInput(),(0,u.h)("arcgis-hub-discussions-post-geography",{channelDetails:i,context:n,disabled:Boolean(p),discussionDetails:d,hasMap:o,isMobile:g,parentDetails:h,postDetails:a,renderedInEditor:!0,unsavedExistingFeatures:c,unsavedFeatures:r,unsavedRelatedFeatures:l,url:null===(e=null===d||void 0===d?void 0:d.reference)||void 0===e?void 0:e.url}),(0,u.h)("div",{class:"hub-discussions-reply-editor__button-group"},this.renderAddLocationsButton(),this.renderSecondaryActionButton(),this.renderPrimaryActionButton()),p&&(0,u.h)("arcgis-hub-discussions-blocked-notice",{class:"hub-discussions-reply-editor__not-discussable-notice",scale:"s",slot:"list-before",variant:p}),s&&(0,u.h)("calcite-notice",{class:"hub-discussions-reply-editor__notice",color:"red",scale:"s"},(0,u.h)("div",{slot:"title"},t.t("error")),(0,u.h)("div",{slot:"message"},t.t(s))))}},{key:"renderConfirmCancel",value:function(){var e=this.intl;return(0,u.h)(u.F,null,(0,u.h)("div",{class:"hub-discussions-reply-editor-confirmation"},(0,u.h)("header",{class:"hub-discussions-reply-editor-confirmation__header"},e.t("confirmHeader")),(0,u.h)("p",{class:"hub-discussions-reply-editor-confirmation__text"},e.t("confirm"))),(0,u.h)("footer",{class:"hub-discussions-reply-editor-footer"},(0,u.h)("calcite-button",{class:"hub-discussions-reply-editor-footer__button",color:"neutral",onClick:this.handleConfirmBackButtonClicked,round:!0,scale:"l"},e.t("back")),(0,u.h)("calcite-button",{class:"hub-discussions-reply-editor-footer__button",color:"red",onClick:this.handleCancel,round:!0,scale:"l"},e.t("discard"))))}},{key:"render",value:function(){var e=this.replyDetails,t=this.confirmCancel;return(0,u.h)(u.H,{class:"hub-discussions-reply-editor","data-editing":Boolean(e)},(0,u.h)("form",{class:"hub-discussions-reply-editor__form",onSubmit:this.handleReplySubmit},this.renderUserDetails(),t?this.renderConfirmCancel():this.renderEditor()))}},{key:"element",get:function(){return(0,u.g)(this)}}],[{key:"assetsDirs",get:function(){return["locales"]}},{key:"watchers",get:function(){return{geometryValue:["handleGeometryValueUpdated"],unsavedFeatures:["handleFeatureChange"],unsavedRelatedFeatures:["handleRelatedFeatureChange"],unsavedExistingFeatures:["handleExistingFeatureChange"],addLocationsActiveGeometryType:["handleAddLocationsActiveGeometryTypeChanged"]}}}]),e}();U([(0,D.C)({when:function(){return!this.isMobile}})],z.prototype,"renderAddLocationsButton",null),z.style=".hub-discussions-reply-editor{display:block;padding-left:0.75rem;padding-right:0.75rem}.hub-discussions-reply-editor__form{border-radius:0.25rem;background-color:var(--calcite-ui-foreground-1);padding:0.75rem;--tw-shadow:0 2px 8px 0 rgba(0, 0, 0, 0.12);--tw-shadow-colored:0 2px 8px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.hub-discussions-reply-editor__button-group{margin-top:1rem;display:flex;justify-content:flex-end}.hub-discussions-reply-editor__button{margin-left:0.75rem}.hub-discussions-reply-editor__button-group>calcite-action{margin-right:auto}.hub-discussions-reply-editor-user-details{margin:0px;display:grid;align-items:center;-moz-column-gap:0.75rem;column-gap:0.75rem;grid-template-columns:32px auto}.hub-discussions-reply-editor-user-details__name{font-size:var(--calcite-font-size-0);line-height:1.25rem;font-weight:var(--calcite-font-weight-bold);font-style:normal}.hub-discussions-reply-editor__notice,.hub-discussions-reply-editor__not-discussable-notice{margin-left:0px;margin-right:0px;margin-top:1rem}.hub-discussions-reply-editor-confirmation{display:block}.hub-discussions-reply-editor-confirmation__header{margin-top:0.5rem;font-size:var(--calcite-font-size-1);line-height:1.5rem;font-weight:var(--calcite-font-weight-bold)}.hub-discussions-reply-editor-confirmation__text{margin-top:0.5rem;font-size:var(--calcite-font-size-0);line-height:1.25rem}.hub-discussions-reply-editor-footer{display:grid;grid-auto-flow:column;grid-template-columns:repeat(2, minmax(0, 1fr));-moz-column-gap:0.75rem;column-gap:0.75rem}.hub-discussions-reply-editor-footer__button{margin:0px}.hub-discussions-reply-editor__body{margin-top:0.75rem}.hub-discussions-reply-editor__body[scale=m] .ck.ck-editor__editable{border-style:none;background-color:var(--calcite-ui-foreground-1);padding:0px;font-size:var(--calcite-font-size-0);line-height:1.25rem;color:var(--calcite-ui-text-1);outline:2px solid transparent;outline-offset:2px;min-height:6rem}.hub-discussions-reply-editor__body .ck.ck-editor__editable.ck-focused:not(.ck-editor__nested-editable){border-style:none;outline:2px solid transparent;outline-offset:2px}.hub-discussions-reply-editor__body[scale=m] .ck.ck-editor__editable .ck-placeholder:before{color:var(--calcite-ui-text-3)}.hub-discussions-reply-editor__body .ck.ck-editor__editable_inline>:first-child{margin-top:0px}.hub-discussions-reply-editor__body .ck.ck-editor__editable_inline>:last-child{margin-bottom:0px}.hub-discussions-reply-editor__message{margin-top:0.5rem}.hub-discussions-reply-editor__location-popover>div.hub-discussions-reply-editor__location-popover__content,.hub-discussions-reply-editor__location-popover__content{max-width:20rem;padding-top:0.75rem;padding-bottom:0.75rem;padding-left:1.25rem;padding-right:1.25rem}.add-location-post:active .add-location-icon{--tw-text-opacity:1;color:rgb(21 21 21 / var(--tw-text-opacity))}.add-location-post[active] .add-location-icon{--tw-text-opacity:1;color:rgb(21 21 21 / var(--tw-text-opacity))}";var B=function(){function e(t){(0,r.Z)(this,e),(0,u.r)(this,t),this.arcgisLoadMoreChange=(0,u.c)(this,"arcgisLoadMoreChange",7),this.color="neutral",this.appearance="clear",this.scale="l",this.width="full",this.round=!0,this.loading=!1,(0,d.b)(this,"handleLoadMore")}return(0,l.Z)(e,[{key:"hasMoreResults",get:function(){return-1!==this.nextStart}},{key:"disabled",get:function(){var e=this.loading,t=this.hasMoreResults;return e||!t}},{key:"componentWillLoad",value:function(){var e=(0,a.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.i.loadIntlForComponent(this.el);case 2:this.intl=e.sent;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleLoadMore",value:function(){var e=this.nextStart;this.arcgisLoadMoreChange.emit(e)}},{key:"render",value:function(){var e=this.loading,t=this.handleLoadMore,s=this.round,i=this.scale,n=this.width,o=this.intl,a=this.hasMoreResults,r=this.disabled,l=o.t("loadMore");return(0,u.h)(u.H,null,a&&(0,u.h)("calcite-button",{disabled:r,label:l,loading:e,onClick:t,round:s,scale:i,width:n},l))}},{key:"el",get:function(){return(0,u.g)(this)}}],[{key:"assetsDirs",get:function(){return["locales"]}}]),e}();B.style=":host{display:block}"},36528:function(e,t,s){function i(){return function(e,t,s){var i=s.value,n="_".concat(t,"Called");Object.defineProperty(e,n,{writable:!0,value:!1});var o="_".concat(t,"Cache");return Object.defineProperty(e,o,{writable:!0}),Object.assign(Object.assign({},s),{value:function(){if(!this[n]){this[n]=!0;for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this[o]=i.apply(this,t)}return this[o]}})}}s.d(t,{c:function(){return i}})},88752:function(e,t,s){function i(e){return function(t,s,i){var n=i.value,o=e.when;return Object.assign(Object.assign({},i),{value:function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];var i=o.apply(this,t);if(i)return n.apply(this,t)}})}}s.d(t,{C:function(){return i}})},24267:function(e,t,s){var i,n;s.d(t,{T:function(){return n},a:function(){return i}}),function(e){e[e.SECOND=1e3]="SECOND",e[e.MINUTE=6e4]="MINUTE",e[e.HOUR=36e5]="HOUR",e[e.DAY=864e5]="DAY",e[e.WEEK=6048e5]="WEEK",e[e.MONTH=26298e5]="MONTH",e[e.YEAR=31536e6]="YEAR"}(i||(i={})),function(e){e.SECOND="second",e.MINUTE="minute",e.HOUR="hour",e.DAY="day",e.WEEK="week",e.MONTH="month",e.QUARTER="quarter",e.YEAR="year"}(n||(n={}))},65493:function(e,t,s){s.d(t,{m:function(){return o}});var i=s(74165),n=s(15861);function o(e){var t=e.delay;if(!Number.isInteger(t)||t<0)throw new Error("delay must be a positive integer");return function(e,s,o){var a=o.value,r=function(){var e=(0,n.Z)((0,i.Z)().mark((function e(){var s,n,o,r,l,c=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(s=new Promise((function(e){return setTimeout(e,t)})),n=c.length,o=new Array(n),r=0;r<n;r++)o[r]=c[r];return l=a.apply(this,o),e.abrupt("return",s.then((function(){return l})));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}();return Object.assign(Object.assign({},o),{value:r})}}},45462:function(e,t,s){s.d(t,{A:function(){return n},a:function(){return a}});var i,n,o=s(4942);!function(e){e.Item="item",e.EditPost="edit.post",e.EditPostGroup="edit.post.group",e.EditPostItem="edit.post.item",e.EditReply="reply.post",e.EditReplyGroup="edit.reply.group",e.EditReplyItem="edit.reply.item",e.Group="group",e.Reply="reply"}(n||(n={}));var a=(i={},(0,o.Z)(i,n.Item,{title:"item.title",message:"item.message"}),(0,o.Z)(i,n.EditPost,{title:"post.title",message:"post.message"}),(0,o.Z)(i,n.EditPostGroup,{title:"post.title",message:"post.message.group"}),(0,o.Z)(i,n.EditPostItem,{title:"post.title",message:"post.message.item"}),(0,o.Z)(i,n.EditReply,{title:"reply.title",message:"reply.message"}),(0,o.Z)(i,n.EditReplyGroup,{title:"reply.title",message:"reply.message.group"}),(0,o.Z)(i,n.EditReplyItem,{title:"reply.title",message:"reply.message.item"}),(0,o.Z)(i,n.Group,{title:"group.title",message:"group.message"}),(0,o.Z)(i,n.Reply,{title:"reply.title.generic",message:"reply.message.generic"}),i)},34802:function(e,t,s){s.d(t,{a:function(){return d},b:function(){return c},e:function(){return a},g:function(){return u},r:function(){return l},v:function(){return r}});var i=s(25434),n=s(36106),o={arcgis:{label:"ArcGIS Online",url:"https://www.arcgis.com",type:"arcgis"},arcgisQA:{label:"ArcGIS Online QAEXT",url:"https://qaext.arcgis.com",type:"arcgis"},arcgisDEV:{label:"ArcGIS Online DEVEXT",url:"https://devext.arcgis.com",type:"arcgis"},hub:{label:"ArcGIS Hub",url:"https://hub.arcgis.com/api",type:"arcgis-hub"},hubDEV:{label:"ArcGIS Hub DEV",url:"https://hubdev.arcgis.com/api",type:"arcgis-hub"},hubQA:{label:"ArcGIS Hub QA",url:"https://hubqa.arcgis.com/api",type:"arcgis-hub"}};function a(e){return"string"===typeof e&&e in o?o[e]:e}function r(e){var t={};return Array.isArray(e)?t={any:e}:("string"===typeof e&&(t={any:[e]}),"object"===typeof e&&(t=e)),t}function l(e){var t=new Date,s={type:"date-range",from:t.getTime(),to:t.getTime()};switch(e.unit){case"hours":case"days":case"weeks":s.from=s.to-{min:6e4,hours:36e5,days:864e5,weeks:6048e5}[e.unit]*e.num;break;case"months":t.setMonth(t.getMonth()-e.num),s.from=t.getTime();break;case"years":t.setFullYear(t.getFullYear()-e.num),s.from=t.getTime()}return s}function c(e,t,s,o){var a=(0,i.c)(e);return e.authentication&&(a.authentication=n.U.deserialize(e.authentication.serialize())),a.start=t>-1?t:s+1,function(e){return e&&(a.authentication=e),o(a)}}function u(e,t,s){var i=null;return t.thumbnail&&(i="".concat(e,"/community/groups/").concat(t.id,"/info/").concat(t.thumbnail),s&&"public"!==t.access&&(i="".concat(i,"?token=").concat(s))),i}function d(e,t,s){var i=null;return t.thumbnail&&(i="".concat(e,"/community/users/").concat(t.username,"/info/").concat(t.thumbnail),s&&"public"!==t.access&&(i="".concat(i,"?token=").concat(s))),i}},84506:function(e,t,s){s.d(t,{Z:function(){return r}});var i=s(83878),n=s(59199),o=s(40181),a=s(25267);function r(e){return(0,i.Z)(e)||(0,n.Z)(e)||(0,o.Z)(e)||(0,a.Z)()}}}]);
//# sourceMappingURL=47942.1243736e.chunk.js.map