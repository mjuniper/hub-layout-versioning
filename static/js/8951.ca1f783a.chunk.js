"use strict";(self.webpackChunkhub_layout_versioning=self.webpackChunkhub_layout_versioning||[]).push([[8951],{35582:function(e,t,i){i.d(t,{M:function(){return v},b:function(){return h}});var n,r,a=i(30168),o=i(41012),s=i(95276),l=i(58406),u=i(98634),c=i(64201),d=i(4760);function h(e){var t=new c.kG,i=t.vertex,h=t.fragment;(0,o.Sv)(i,e),i.uniforms.add(new l.p("width",(function(e){return e.width}))),t.attributes.add(d.T.POSITION,"vec3"),t.attributes.add(d.T.NORMAL,"vec3"),t.attributes.add(d.T.UV0,"vec2"),t.attributes.add(d.T.AUXPOS1,"float"),t.varyings.add("vtc","vec2"),t.varyings.add("vlength","float"),t.varyings.add("vradius","float"),i.code.add((0,u.H)(n||(n=(0,a.Z)(["void main(void) {\nvec3 bitangent = normal;\nvtc = uv0;\nvlength = auxpos1;\nvradius = 0.5 * width;\nvec4 pos = view * vec4(position + vradius * bitangent * uv0.y, 1.0);\ngl_Position = proj * pos;\n}"])))),h.uniforms.add([new l.p("outlineSize",(function(e){return e.outlineSize})),new s.N("outlineColor",(function(e){return e.outlineColor})),new l.p("stripeLength",(function(e){return e.stripeLength})),new s.N("stripeEvenColor",(function(e){return e.stripeEvenColor})),new s.N("stripeOddColor",(function(e){return e.stripeOddColor}))]);var v=1/Math.sqrt(2);return h.code.add((0,u.H)(r||(r=(0,a.Z)(["\n    const float INV_SQRT2 = ",";\n\n    vec4 arrowColor(vec2 tc, float len) {\n      float d = INV_SQRT2 * (tc.x - abs(tc.y));\n      d = min(d, INV_SQRT2 * (len - tc.x - abs(tc.y)));\n      d = min(d, 1.0 - abs(tc.y));\n\n      if (d < 0.0) {\n        return vec4(0.0);\n      } else if (d < outlineSize) {\n        return outlineColor;\n      } else {\n        return fract(0.5 / stripeLength * tc.x * vradius) >= 0.5 ? stripeOddColor : stripeEvenColor;\n      }\n    }\n\n    void main(void) {\n      vec2 ntc = vec2(vtc.x / vradius, vtc.y);\n      vec4 color = arrowColor(ntc, vlength / vradius);\n      if (color.a == 0.0) {\n        discard;\n      }\n      gl_FragColor = color;\n    }\n  "])),u.H.float(v))),t}var v=Object.freeze(Object.defineProperty({__proto__:null,build:h},Symbol.toStringTag,{value:"Module"}))},58935:function(e,t,i){i.d(t,{N9:function(){return b},Pr:function(){return P},Rd:function(){return l},SP:function(){return m},Se:function(){return S},Ud:function(){return v},VG:function(){return o},Wv:function(){return c},Zv:function(){return _},cy:function(){return y},i_:function(){return w},ym:function(){return C}});var n=i(92026),r=i(47898),a=i(5163);function o(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";return(0,a.VG)(e,(0,r.nn)(t,i).value,i,n,o)}function s(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";return(0,a.LO)(e,(0,r.nn)(t,i).value,i,n,o)}function l(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"abbr";return(0,a.Rd)(e,t.value,t.unit,i,n)}function u(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"abbr";return(0,a.mg)(e,t.value,t.unit,i,n)}function c(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"abbr";return(0,a.Wv)(e,t.value,t.unit,i,n)}function d(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"abbr";return(0,a.h9)(e,t.value,t.unit,i,n)}function h(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"abbr";return(0,a.ld)(e,t.value,t.unit,i,n)}function v(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"abbr";return(0,a.Ud)(e,t.value,t.unit,i,n)}function g(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"abbr";return(0,a.q6)(e,t.value,t.unit,i,n)}function _(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"abbr";return(0,a.Zv)(e,t.value,t.unit,i,n)}function p(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"abbr";return(0,a.aC)(e,t.value,t.unit,i,n)}function f(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"abbr";return(0,a.yc)(e,t.value,t.unit,i,n)}function y(e,t,i){return(0,a.L4)(e.value,e.unit,e.rotationType,t,i)}function m(e,t,i){return(0,a._o)(e.value,e.unit,e.rotationType,t,i)}function b(e,t,i,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";switch(r=(0,n.Pt)(r,2),i){case"imperial":return v(e,t,r,a);case"metric":return l(e,t,r,a);default:return o(e,t,i,r,a)}}function w(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";switch(i){case"imperial":return g(e,t,n,r);case"metric":return u(e,t,n,r);default:return s(e,t,i,n,r)}}function C(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";switch(i){case"imperial":return _(e,t,n,r);case"metric":return c(e,t,n,r);default:return o(e,t,i,n,r)}}function P(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";switch(i){case"imperial":return p(e,t,n,r);case"metric":return d(e,t,n,r);default:return s(e,t,i,n,r)}}function S(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";switch(i){case"imperial":return f(e,t,n,r);case"metric":return h(e,t,n,r);default:return o(e,t,i,n,r)}}},47898:function(e,t,i){i.d(t,{EV:function(){return o},Fp:function(){return d},GJ:function(){return u},MQ:function(){return g},bA:function(){return h},ne:function(){return l},nn:function(){return c},yG:function(){return s},yP:function(){return v}});var n=i(1413),r=i(92026),a=i(68860);function o(e,t){return{type:(0,a.UF)(t),value:e,unit:t}}function s(e,t){return{type:(0,a.UF)(t),value:e,unit:t}}function l(e,t){return{type:(0,a.UF)(t),value:e,unit:t}}function u(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"arithmetic";return{type:(0,a.UF)(t),value:e,unit:t,rotationType:i}}function c(e,t){return o((0,a.En)(e.value,e.unit,t),t)}function d(e,t){return(0,r.Wi)(e)?t:(0,r.Wi)(t)||e.value>(0,a.En)(t.value,t.unit,e.unit)?e:t}function h(e,t){return(0,r.Wi)(e)?null:(0,n.Z)((0,n.Z)({},e),{},{value:e.value*t})}var v=s(0,"meters"),g=l(0,"square-meters");u(0,"radians")},74177:function(e,t,i){i.d(t,{R:function(){return o}});var n=i(92026),r=i(68860),a=i(70032);function o(e){var t,i,o,s,l="metric";if((0,n.Wi)(e))return l;var u=e.map,c=null!==(t=u&&"portalItem"in u?null===(i=u.portalItem)||void 0===i?void 0:i.portal:null)&&void 0!==t?t:a.Z.getDefault();switch(null!==(o=null===(s=c.user)||void 0===s?void 0:s.units)&&void 0!==o?o:c.units){case l:return l;case"english":return"imperial"}return(0,n.Pt)((0,r.yT)(e.spatialReference),l)}},88978:function(e,t,i){i.r(t),i.d(t,{default:function(){return Be}});var n=i(1413),r=i(15671),a=i(43144),o=i(60136),s=i(92572),l=i(27366),u=i(85015),c=i(92026),d=i(49861),h=(i(25243),i(63780),i(69912)),v=i(77671),g=i(98074),_=i(51817),p=i(100),f=i(32718),y=i(47898),m=i(94172),b=i(11186),w=i(71353),C=i(2170),P=i(29909),S=i(79803),L=i(29691),O=i(15559),A=i(33906),E=i(39409),V="esri.views.3d.analysis.DirectLineMeasurement.DirectLineMeasurementController",k=f.Z.getLogger(V),z=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,r.Z)(this,i),(n=t.call(this,e))._unitNormalizer=new E.D,n._handles=new p.Z,n._tempStartPosition=(0,w.c)(),n._tempEndPosition=(0,w.c)(),n._tempCornerPosition=(0,w.c)(),n}return(0,a.Z)(i,[{key:"initialize",value:function(){var e=this,t=this.view.spatialReference,i=(0,L.rS)(t),n=i===L.GG?L.wY:i;this._sphericalPCPF=n;var r=(0,S.Up)(t,n);this._unitNormalizer.spatialReference=r?n:t,this._handles.add([(0,m.YP)((function(){return{viewData:e.viewData,startPoint:e.analysis.startPoint}}),(function(t){var i=t.viewData,n=t.startPoint;i.elevationAlignedStartPoint=e._applyProjectionAndElevationAlignment(n)}),m.tX),(0,m.YP)((function(){return{viewData:e.viewData,endPoint:e.analysis.endPoint}}),(function(t){var i=t.viewData,n=t.endPoint;i.elevationAlignedEndPoint=e._applyProjectionAndElevationAlignment(n)}),m.tX),(0,m.YP)((function(){return{result:e._computedResult,viewData:e.viewData}}),(function(e){var t=e.result;e.viewData.result=t}),m.tX)])}},{key:"destroy",value:function(){this._handles=(0,c.SC)(this._handles)}},{key:"_applyProjectionAndElevationAlignment",value:function(e){if((0,c.Wi)(e))return e;var t=this.view,i=t.spatialReference,n=t.elevationProvider,r=(0,A.G)(e,i,n);return(0,c.Wi)(r)?((0,A.e)(this.analysis,e.spatialReference,k),null):r}},{key:"_computedResult",get:function(){var e=this.viewData,t=e.elevationAlignedStartPoint,i=e.elevationAlignedEndPoint,n=e.measurementMode;if((0,c.Wi)(t)||(0,c.Wi)(i))return null;var r=this._euclideanDistances(t,i),a=this._geodesicDistance(t,i,r.horizontal.value),o=n===_.e.Geodesic||n===_.e.Auto&&r.horizontal.value>1e5?"geodesic":"euclidean";return{mode:o,distance:"euclidean"===o?r.direct:a,directDistance:r.direct,horizontalDistance:r.horizontal,verticalDistance:r.vertical,geodesicDistance:a}}},{key:"_euclideanDistances",value:function(e,t){var i=this,n=e.clone();n.z=t.z;var r=this._tempStartPosition,a=this._tempEndPosition,o=this._tempCornerPosition,s=this.view.spatialReference,l=this._sphericalPCPF,u=(0,S.Up)(s,l)?l:s;(0,S.KC)(e,r,u),(0,S.KC)(t,a,u),(0,S.KC)(n,o,u);var c=(0,b.i)(r,a),d=(0,b.i)(o,a),h=Math.abs(t.z-e.z),v=function(e){return i._unitNormalizer.normalizeDistance(e)},g=v(c),_=v(d),p=v(h);return{direct:(0,y.EV)(g,"meters"),horizontal:(0,y.EV)(_,"meters"),vertical:(0,y.EV)(p,"meters")}}},{key:"_geodesicDistance",value:function(e,t,i){var n=e.spatialReference,r=new P.Z({spatialReference:n});r.addPath([e,t]);var a=n.isGeographic&&(0,O.Gb)(n)?(0,O.Jf)([r],"meters")[0]:n.isWebMercator?(0,C.geodesicLength)(r,"meters"):null,o=(0,c.pC)(a)?a:this._fallbackGeodesicDistance(e,t,i);return(0,y.EV)(o,"meters")}},{key:"_fallbackGeodesicDistance",value:function(e,t,i){if((0,S.UY)(e,D)&&(0,S.UY)(t,T)){var n=new O._q;return(0,O.cA)(n,D,T),n.distance}return i}}]),i}(u.Z);(0,l._)([(0,d.Cb)()],z.prototype,"view",void 0),(0,l._)([(0,d.Cb)()],z.prototype,"analysis",void 0),(0,l._)([(0,d.Cb)()],z.prototype,"viewData",void 0),(0,l._)([(0,d.Cb)()],z.prototype,"_computedResult",null),z=(0,l._)([(0,h.j)(V)],z);var Z,M,D=(0,w.c)(),T=(0,w.c)(),R=i(74165),G=i(15861),x=i(51995),W=(i(59166),i(70148)),j=i(16889),U=i(58935),N=i(17842),H=i(68860),F=i(88396);!function(e){e[e.None=0]="None",e[e.Direct=1]="Direct",e[e.Triangle=2]="Triangle",e[e.ProjectedGeodesic=3]="ProjectedGeodesic"}(Z||(Z={})),function(e){e[e.Auto=0]="Auto",e[e.AboveSegment=1]="AboveSegment",e[e.BelowSegment=2]="BelowSegment"}(M||(M={}));var B=i(26243),I=i(27210),Y=i(33837),X=i(81949),q=i(67077),Q=i(51378),K=i(52168),J=i(70619),$=i(56529),ee=i(55158),te=i(37081),ie=i(23620),ne=i(93822),re=i(4760),ae=i(82144),oe=i(31132),se=i(33559),le=i(7566),ue=i(78041),ce=i(27627),de=i(25920),he=i(8883),ve=i(35582),ge=i(8548),_e=i(36207),pe=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e,n,a){return(0,r.Z)(this,i),t.call(this,e,n,a)}return(0,a.Z)(i,[{key:"initializeProgram",value:function(e){return new ce.$(e.rctx,i.shader.get().build(this.configuration),le.i)}},{key:"_setPipelineState",value:function(e){var t=e===de.A.NONE,i=this.configuration;return(0,_e.sm)({blending:i.transparent?t?ue.wu:(0,ue.j7)(e):null,polygonOffset:this.configuration.polygonOffsetEnabled?{factor:0,units:-4}:null,depthTest:{func:ge.wb.LESS},depthWrite:_e.LZ,colorWrite:_e.BK})}},{key:"initializePipeline",value:function(){return this._setPipelineState(this.configuration.transparencyPassType)}},{key:"primitiveType",get:function(){return ge.MX.TRIANGLE_STRIP}}]),i}(oe.A);pe.shader=new ae.J(ve.M,(function(){return i.e(14142).then(i.bind(i,14142))}));var fe=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(){var e;return(0,r.Z)(this,i),(e=t.apply(this,arguments)).polygonOffsetEnabled=!1,e.transparent=!1,e.transparencyPassType=de.A.NONE,e}return(0,a.Z)(i)}(he.W);(0,l._)([(0,se.o)()],fe.prototype,"polygonOffsetEnabled",void 0),(0,l._)([(0,se.o)()],fe.prototype,"transparent",void 0),(0,l._)([(0,se.o)({count:de.A.COUNT})],fe.prototype,"transparencyPassType",void 0);var ye=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,r.Z)(this,i),(n=t.call(this,e,new be))._configuration=new fe,n}return(0,a.Z)(i,[{key:"getConfiguration",value:function(e,t){return this._configuration.polygonOffsetEnabled=this.parameters.polygonOffset,this._configuration.transparent=this.parameters.stripeEvenColor[3]<1||this.parameters.stripeOddColor[3]<1||this.parameters.outlineColor[3]<1,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration}},{key:"dispose",value:function(){}},{key:"intersect",value:function(){}},{key:"requiresSlot",value:function(e,t){return t===te.H.Color&&e===ne.r.OPAQUE_MATERIAL}},{key:"createGLMaterial",value:function(e){return new me(e)}},{key:"createBufferWriter",value:function(){return new Ae}}]),i}($.F5),me=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(){return(0,r.Z)(this,i),t.apply(this,arguments)}return(0,a.Z)(i,[{key:"beginSlot",value:function(e){return this.ensureTechnique(pe,e)}}]),i}(ie.Z),be=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(){var e;return(0,r.Z)(this,i),(e=t.apply(this,arguments)).width=32,e.outlineSize=.2,e.outlineColor=(0,q.f)(1,.5,0,1),e.stripeEvenColor=(0,q.f)(1,1,1,1),e.stripeOddColor=(0,q.f)(1,.5,0,1),e.stripeLength=1,e.polygonOffset=!1,e}return(0,a.Z)(i)}($.Mt),we=(0,ee.U$)().vec3f(re.T.POSITION).vec3f(re.T.NORMAL).vec2f(re.T.UV0).f32(re.T.AUXPOS1),Ce=(0,w.c)(),Pe=(0,w.c)(),Se=(0,w.c)(),Le=(0,w.c)(),Oe=(0,w.c)(),Ae=function(){function e(){(0,r.Z)(this,e),this.vertexBufferLayout=we}return(0,a.Z)(e,[{key:"allocate",value:function(e){return this.vertexBufferLayout.createBuffer(e)}},{key:"elementCount",value:function(e){return 2*(e.indices.get(re.T.POSITION).length/2+1)}},{key:"write",value:function(e,t,i,n,r){var a=i.vertexAttributes.get(re.T.POSITION).data,o=i.vertexAttributes.get(re.T.NORMAL).data,s=a.length/3,l=i&&i.indices&&i.indices.get(re.T.POSITION);l&&l.length!==2*(s-1)&&console.warn("MeasurementArrowMaterial does not support indices");for(var u=Ce,c=Pe,d=Se,h=Le,v=Oe,g=n.position,_=n.normal,p=n.uv0,f=0,y=0;y<s;++y){var m=3*y;if((0,b.s)(u,a[m],a[m+1],a[m+2]),y<s-1){var w=3*(y+1);(0,b.s)(c,a[w],a[w+1],a[w+2]),(0,b.s)(v,o[w],o[w+1],o[w+2]),(0,b.n)(v,v),(0,b.b)(d,c,u),(0,b.n)(d,d),(0,b.f)(h,v,d),(0,b.n)(h,h)}var C=(0,b.i)(u,c);e&&t&&((0,b.m)(u,u,e),(0,b.m)(c,c,e),(0,b.m)(h,h,t));var P=r+2*y,S=P+1;g.setVec(P,u),g.setVec(S,u),_.setVec(P,h),_.setVec(S,h),p.set(P,0,f),p.set(P,1,-1),p.set(S,0,f),p.set(S,1,1),y<s-1&&(f+=C)}for(var L=n.auxpos1,O=0;O<2*s;++O)L.set(r+O,f)}}]),e}(),Ee=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,r.Z)(this,i),(n=t.call(this,e))._parameters={arrowWidth:16,arrowOutlineColor:x.Z.toUnitRGBA((0,W.e9)()),arrowStripeEvenColor:x.Z.toUnitRGBA((0,W.RN)()),arrowStripeOddColor:x.Z.toUnitRGBA((0,W.e9)()),arrowSubdivisions:128},n._origin=(0,w.c)(),n._originTransform=(0,X.c)(),n._arrowCenter=(0,w.c)(),n._renderOccluded=$.yD.OccludeAndTransparent,n._geometry=null,n._stripeLength=1,n._stripesEnabled=!0,n._opacity=1,n.applyProps(e),n}return(0,a.Z)(i,[{key:"renderOccluded",get:function(){return this._renderOccluded},set:function(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._arrowMaterial&&this._arrowMaterial.setParameters({renderOccluded:e}))}},{key:"geometry",get:function(){return this._geometry},set:function(e){this._geometry=e,this._geometryChanged()}},{key:"stripeLength",get:function(){return this._stripeLength},set:function(e){this._stripeLength=e,this.attached&&this._arrowMaterial.setParameters({stripeLength:this._stripeLength})}},{key:"stripesEnabled",get:function(){return this._stripesEnabled},set:function(e){if(this._stripesEnabled=e,this.attached){var t=this.opacity,i=this._parameters,n=i.arrowStripeEvenColor,r=i.arrowStripeOddColor,a=(0,j.H)(Ve,this._stripesEnabled?n:r,t);this._arrowMaterial.setParameters({stripeEvenColor:a})}}},{key:"opacity",get:function(){return this._opacity},set:function(e){e!==this._opacity&&(this._opacity=e,this._updateArrowOpacity())}},{key:"createExternalResources",value:function(){var e=this,t=this._parameters,i=t.arrowStripeEvenColor,n=t.arrowStripeOddColor,r=t.arrowOutlineColor,a=this._stripesEnabled?i:n;this._arrowMaterial=new ye({outlineColor:r,stripeEvenColor:a,stripeOddColor:n,renderOccluded:this.renderOccluded,polygonOffset:!0}),this._handles=new p.Z,this._handles.add((0,m.YP)((function(){return e.view.state.camera}),(function(){e._viewChanged()})))}},{key:"destroyExternalResources",value:function(){this._arrowMaterial=null,this._handles=(0,c.SC)(this._handles)}},{key:"forEachExternalMaterial",value:function(e){e(this._arrowMaterial)}},{key:"createGeometries",value:function(e){if(!((0,c.Wi)(this._geometry)||(0,c.Wi)(this._geometry.startRenderSpace)||(0,c.Wi)(this._geometry.endRenderSpace))){var t=this._createArrowGeometry(this._geometry.startRenderSpace,this._geometry.endRenderSpace,this._origin,this._geometry);t.transformation=this._originTransform,e.addGeometry(t),this._viewChanged()}}},{key:"_createArrowGeometry",value:function(e,t,i,n){var r=this.view.renderCoordsHelper,a=[],o=[],s=function(e,t){var n=Q.WM.get();(0,b.b)(n,e,i),a.push(n),o.push(t)};if("euclidean"===n.type){n.eval(.5,this._arrowCenter);var l=Q.WM.get();r.worldUpAtPosition(this._arrowCenter,l),s(e,l),s(t,l)}else{n.eval(.5,this._arrowCenter);for(var u=this._parameters.arrowSubdivisions+1&-2,c=0;c<u;++c){var d=c/(u-1),h=Q.WM.get(),v=Q.WM.get();n.eval(d,h),r.worldUpAtPosition(h,v),s(h,v)}}return(0,J.rh)(this._arrowMaterial,a,o)}},{key:"_geometryChanged",value:function(){this.recreateGeometry()}},{key:"_viewChanged",value:function(){if(this.view.ready&&this.attached&&(0,c.pC)(this._geometry)){var e=this.view.state.camera.computeScreenPixelSizeAt(this._arrowCenter);this._arrowMaterial.setParameters({width:this._parameters.arrowWidth*e})}}},{key:"_updateArrowOpacity",value:function(){var e=this.opacity,t=this._parameters,i=t.arrowStripeEvenColor,n=t.arrowStripeOddColor,r=t.arrowOutlineColor,a=(0,j.H)(Ve,this._stripesEnabled?i:n,e),o=(0,j.H)(ke,r,e),s=(0,j.H)(ze,n,e);this._arrowMaterial.setParameters({stripeEvenColor:a,outlineColor:o,stripeOddColor:s})}}]),i}(K._),Ve=(0,q.c)(),ke=(0,q.c)(),ze=(0,q.c)(),Ze=i(98917),Me=i(9052),De=i(86700),Te=i(36257),Re=i(41201),Ge=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,r.Z)(this,i),(n=t.call(this,e))._params={triangleColor:x.Z.toUnitRGBA((0,W.e9)(.75)),triangleLineWidth:3,geodesicProjectionLineWidth:2,geodesicProjectionLineColor:x.Z.toUnitRGBA((0,W.e9)(.75)),guideLineWidth:2,guideStippleLengthPixels:6,direcLabelFontSize:16,horizontalLabelFontSize:12,verticalLabelFontSize:12},n._handles=new p.Z,n._segmentVisualElement=null,n._triangleVisualElement=null,n._rightAngleQuad=null,n._projectedGeodesicLine=null,n._geodesicStartHint=null,n._geodesicEndHint=null,n._segmentLabel=null,n._verticalLabel=null,n._horizontalLabel=null,n._startPosition=(0,w.c)(),n._endPosition=(0,w.c)(),n._cornerPosition=(0,w.c)(),n._startPositionAtSeaLevel=(0,w.c)(),n._endPositionAtSeaLevel=(0,w.c)(),n._triangleOrientationOverride=null,n.messages=null,n.loadingMessages=!0,n.visualElementOrientation=M.Auto,n.triangleCollapseRatioThreshold=.03,n}return(0,a.Z)(i,[{key:"visible",get:function(){return this.analysisView.visible}},{key:"viewMode",get:function(){var e=this.analysisView,t=e.elevationAlignedStartPoint,i=e.elevationAlignedEndPoint;if((0,c.Wi)(t)||(0,c.Wi)(i)||t.equals(i))return Z.None;var n=this.analysisView.result;if((0,c.Wi)(n))return Z.Direct;if("geodesic"===n.mode)return this._requiresGeodesicGuideAt(this._startPosition)||this._requiresGeodesicGuideAt(this._endPosition)?Z.ProjectedGeodesic:Z.Direct;var r=n.verticalDistance,a=n.horizontalDistance,o=r.value,s=a.value;return Math.min(o/s,s/o)<this.triangleCollapseRatioThreshold?Z.Direct:Z.Triangle}},{key:"actualVisualizedMeasurement",get:function(){if((0,c.Wi)(this.analysisView.result))switch(this.analysisView.measurementMode){case _.e.Auto:case _.e.Euclidean:default:return"euclidean";case _.e.Geodesic:return"geodesic"}return this.analysisView.result.mode}},{key:"allowVisualElementsOrientationChange",get:function(){return(0,c.Wi)(this._triangleOrientationOverride)},set:function(e){(0,c.Wi)(this._triangleOrientationOverride)!==e&&((0,c.Wi)(this._triangleOrientationOverride)?this._triangleOrientationOverride=this._actualVisualElementsOrientation:this._triangleOrientationOverride=null)}},{key:"labels",get:function(){var e="geodesic"===this.actualVisualizedMeasurement;return{direct:this._segmentLabel,horizontal:e?this._segmentLabel:this._horizontalLabel,vertical:this._verticalLabel}}},{key:"initialize",value:function(){var e=this,t=this._params,i={attached:!0,view:this.view};this._segmentVisualElement=new Ee((0,n.Z)((0,n.Z)({},i),{},{geometry:null,renderOccluded:$.yD.OccludeAndTransparent})),this._triangleVisualElement=new Y.r((0,n.Z)((0,n.Z)({},i),{},{width:t.triangleLineWidth,color:t.triangleColor,renderOccluded:$.yD.OccludeAndTransparent})),this._rightAngleQuad=new Ze.R((0,n.Z)((0,n.Z)({},i),{},{color:x.Z.toUnitRGBA((0,W.e9)(.75)),renderOccluded:$.yD.OccludeAndTransparent}));var r=(0,n.Z)((0,n.Z)({},i),{},{polygonOffset:!0,renderOccluded:$.yD.OccludeAndTransparent});this._projectedGeodesicLine=new Y.r((0,n.Z)((0,n.Z)({},r),{},{width:t.geodesicProjectionLineWidth,color:t.geodesicProjectionLineColor,stipplePattern:(0,De.z5)(t.guideStippleLengthPixels)})),this._geodesicStartHint=new Y.r((0,n.Z)((0,n.Z)({},r),{},{width:t.guideLineWidth,color:t.geodesicProjectionLineColor,stipplePattern:(0,De.z5)(t.guideStippleLengthPixels)})),this._geodesicEndHint=new Y.r((0,n.Z)((0,n.Z)({},r),{},{width:t.guideLineWidth,color:t.geodesicProjectionLineColor,stipplePattern:(0,De.z5)(t.guideStippleLengthPixels)}));var a=(0,n.Z)((0,n.Z)({},i),{},{backgroundColor:(0,W.hU)(.6),textColor:(0,W.uu)()});this._segmentLabel=new I.Kc((0,n.Z)((0,n.Z)({},a),{},{fontSize:t.direcLabelFontSize})),this._verticalLabel=new I.Kc((0,n.Z)((0,n.Z)({},a),{},{fontSize:t.verticalLabelFontSize})),this._horizontalLabel=new I.Kc((0,n.Z)((0,n.Z)({},a),{},{fontSize:t.horizontalLabelFontSize})),this._handles.add([(0,m.YP)((function(){var t=e.analysisView,i=t.elevationAlignedStartPoint,n=t.elevationAlignedEndPoint,r=e.view;return{view:r,camera:r.state.camera,viewMode:e.viewMode,elevationAlignedStartPoint:i,elevationAlignedEndPoint:n,orientation:e._actualVisualElementsOrientation,visualizedMeasurement:e.actualVisualizedMeasurement,stripeLength:e._measurementArrowStripeLength}}),(function(t){return e._updateGeometryAndViewMode(t)}),m.tX),(0,m.YP)((function(){return{visible:e.visible,viewMode:e.viewMode}}),(function(t){return e._updateVisualElementVisibility(t)}),m.tX),(0,m.YP)((function(){return{text:e._labelsText,visualizedMeasurement:e.actualVisualizedMeasurement}}),(function(t){return e._updateLabelText(t)}),m.tX),(0,m.YP)((function(){return{visible:e.visible,viewMode:e.viewMode}}),(function(t){return e._updateLabelVisibility(t)}),m.tX),(0,m.YP)((function(){return e._measurementArrowStripeLength}),(function(t){return e._updateSegmentStripeLength(t)}),m.tX),(0,Te.qe)((0,G.Z)((0,R.Z)().mark((function t(){return(0,R.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._updateMessageBundle());case 1:case"end":return t.stop()}}),t)}))))]),this._updateMessageBundle()}},{key:"destroy",value:function(){this._handles=(0,c.SC)(this._handles),this._segmentVisualElement=(0,c.SC)(this._segmentVisualElement),this._triangleVisualElement=(0,c.SC)(this._triangleVisualElement),this._rightAngleQuad=(0,c.SC)(this._rightAngleQuad),this._projectedGeodesicLine=(0,c.SC)(this._projectedGeodesicLine),this._geodesicStartHint=(0,c.SC)(this._geodesicStartHint),this._geodesicEndHint=(0,c.SC)(this._geodesicEndHint),this._segmentLabel=(0,c.SC)(this._segmentLabel),this._verticalLabel=(0,c.SC)(this._verticalLabel),this._horizontalLabel=(0,c.SC)(this._horizontalLabel),this.set("view",null)}},{key:"_updateVisualElementVisibility",value:function(e){var t=e.visible,i=e.viewMode;if(this._segmentVisualElement.visible=!1,this._triangleVisualElement.visible=!1,this._rightAngleQuad.visible=!1,this._projectedGeodesicLine.visible=!1,this._geodesicStartHint.visible=!1,this._geodesicEndHint.visible=!1,t)switch(i){case Z.None:break;case Z.Direct:this._segmentVisualElement.visible=!0;break;case Z.Triangle:this._segmentVisualElement.visible=!0,this._triangleVisualElement.visible=!0,this._rightAngleQuad.visible=!0;break;case Z.ProjectedGeodesic:this._segmentVisualElement.visible=!0,this._projectedGeodesicLine.visible=!0,this._geodesicStartHint.visible=!0,this._geodesicEndHint.visible=!0}}},{key:"_updateGeometryAndViewMode",value:function(e){var t=e.view,i=e.camera,n=e.viewMode,r=e.elevationAlignedStartPoint,a=e.elevationAlignedEndPoint,o=e.orientation,s=e.visualizedMeasurement,l=e.stripeLength,u=t.renderCoordsHelper;if(!((0,c.Wi)(u)||(0,c.Wi)(r)||(0,c.Wi)(a)||r.equals(a))){var d=this._startPosition,h=this._endPosition;u.toRenderCoords(r,d),u.toRenderCoords(a,h);var v=o===M.AboveSegment?1:-1,g=v*(u.getAltitude(h)-u.getAltitude(d));g<0&&(d=this._endPosition,h=this._startPosition);var _="geodesic"===s?new Me.u(this._startPosition,this._endPosition,u.spatialReference):new Me.y(this._startPosition,this._endPosition);switch(this._segmentVisualElement.geometry=_,this._updateSegmentStripeLength(l),n){case Z.Direct:this._updateSegment(_,o);break;case Z.Triangle:this._updateSegmentAndTriangle({view:t,camera:i,segment:_,orientation:o,startPosition:d,endPosition:h,deltaSign:v,altitudeDelta:g});break;case Z.ProjectedGeodesic:this._updateSegmentAndProjection({view:t,orientation:o,startPosition:d,endPosition:h})}}}},{key:"_updateSegment",value:function(e,t){this._segmentLabel.anchor=t===M.AboveSegment?"top":"bottom",this._segmentLabel.geometry={type:"segment",segment:e,sampleLocation:"center"}}},{key:"_updateSegmentAndTriangle",value:function(e){var t=e.view.renderCoordsHelper,i=e.camera,n=e.segment,r=e.orientation,a=e.startPosition,o=e.endPosition,s=e.deltaSign,l=e.altitudeDelta,u=this._cornerPosition;t.worldUpAtPosition(a,u),(0,b.g)(u,u,s*Math.abs(l)),(0,b.a)(u,u,a),this._triangleVisualElement.geometry=[[[a[0],a[1],a[2]],[u[0],u[1],u[2]],[o[0],o[1],o[2]]]],this._rightAngleQuad.geometry={previous:a,center:u,next:o};var c=new Me.y(a,u),d=new Me.y(u,o),h=function(e,t,i,n,r){var a=We,o=je;r.projectToRenderScreen(i,a),r.projectToRenderScreen(t,o);var s={segment:"bottom",horizontal:"top",vertical:a[0]<o[0]?"left":"right"},l=Ue,u=Ne;if((0,B.c)(e,i,l,r),(0,B.c)(e,t,u,r),(0,F.h)(l,u)>=xe){var c=Math.sign(l[1])===Math.sign(u[1]);s.segment=c?(0,I.jB)(s.vertical):s.vertical}else{var d=He;(0,B.c)(i,t,d,r),(0,F.h)(d,u)>=xe&&(s.segment=Math.sign(d[0])===Math.sign(u[0])?(0,I.jB)(s.horizontal):s.horizontal)}if(n===M.BelowSegment){var h=function(e){return"top"===e?"bottom":"top"};s.segment=h(s.segment),s.horizontal=h(s.horizontal),s.vertical=h(s.vertical)}return s}(a,o,u,r,i);this._segmentLabel.anchor=h.segment,this._segmentLabel.geometry={type:"segment",segment:n,sampleLocation:"center"},this._verticalLabel.geometry={type:"segment",segment:c,sampleLocation:"center"},this._verticalLabel.anchor=h.vertical,this._horizontalLabel.geometry={type:"segment",segment:d,sampleLocation:"center"},this._horizontalLabel.anchor=h.horizontal}},{key:"_updateSegmentAndProjection",value:function(e){var t=e.view.renderCoordsHelper,i=e.orientation,n=e.startPosition,r=e.endPosition;t.setAltitude(this._startPositionAtSeaLevel,0,n),t.setAltitude(this._endPositionAtSeaLevel,0,r);var a=new Me.u(this._startPositionAtSeaLevel,this._endPositionAtSeaLevel,t.spatialReference);this._projectedGeodesicLine.setGeometryFromSegment(a),this._geodesicStartHint.setGeometryFromSegment(new Me.y(this._startPositionAtSeaLevel,n)),this._geodesicEndHint.setGeometryFromSegment(new Me.y(this._endPositionAtSeaLevel,r)),this._segmentLabel.geometry={type:"segment",segment:a,sampleLocation:"center"},this._segmentLabel.anchor=i===M.AboveSegment?"top":"bottom"}},{key:"_updateLabelText",value:function(e){var t=e.text,i=e.visualizedMeasurement;(0,c.pC)(t)?(this._segmentLabel.text="euclidean"===i?t.euclideanDistance:t.geodesicDistance,this._horizontalLabel.text=t.horizontalDistance,this._verticalLabel.text=t.verticalDistance):(this._segmentLabel.text=null,this._horizontalLabel.text=null,this._verticalLabel.text=null),this.notifyChange("labels")}},{key:"_updateLabelVisibility",value:function(e){var t=e.visible,i=e.viewMode,n=this._segmentLabel,r=this._horizontalLabel,a=this._verticalLabel;if(n.visible=!1,r.visible=!1,a.visible=!1,t)switch(i){case Z.Direct:n.visible=!0;break;case Z.Triangle:n.visible=!0,r.visible=!0,a.visible=!0;break;case Z.ProjectedGeodesic:n.visible=!0;case Z.None:}}},{key:"_labelsText",get:function(){if(this.destroyed)return null;var e=this.messages,t=this.analysisView.result;if((0,c.Wi)(t)||(0,c.Wi)(e))return null;var i=t.directDistance,r=t.horizontalDistance,a=t.verticalDistance,o=t.geodesicDistance,s=this.analysisView.unit,l=function(e){return(0,n.Z)({euclideanDistance:"",geodesicDistance:"",horizontalDistance:"",verticalDistance:""},e)};switch(s){case"metric":return l({euclideanDistance:i&&(0,U.Rd)(e,i),geodesicDistance:o&&(0,U.Rd)(e,o),horizontalDistance:r&&(0,U.Rd)(e,r),verticalDistance:a&&(0,U.Wv)(e,a)});case"imperial":return l({euclideanDistance:i&&(0,U.Ud)(e,i),geodesicDistance:o&&(0,U.Ud)(e,o),horizontalDistance:r&&(0,U.Ud)(e,r),verticalDistance:a&&(0,U.Zv)(e,a)});default:return l({euclideanDistance:i&&(0,U.VG)(e,i,s),geodesicDistance:o&&(0,U.VG)(e,o,s),horizontalDistance:r&&(0,U.VG)(e,r,s),verticalDistance:a&&(0,U.VG)(e,a,s)})}}},{key:"_updateSegmentStripeLength",value:function(e){var t=this._segmentVisualElement;(0,c.pC)(e)?(t.stripeLength=e,t.stripesEnabled=!0):t.stripesEnabled=!1}},{key:"_actualVisualElementsOrientation",get:function(){if((0,c.pC)(this._triangleOrientationOverride))return this._triangleOrientationOverride;var e=this.visualElementOrientation;return e===M.Auto?this.view.state.camera.aboveGround?M.AboveSegment:M.BelowSegment:e}},{key:"_requiresGeodesicGuideAt",value:function(e){var t=this.view;if(null===t||void 0===t||!t.state)return!1;var i=t.state.camera,n=t.renderCoordsHelper,r=i.computeScreenPixelSizeAt(e);return n.getAltitude(e)/r>=10}},{key:"_measurementArrowStripeLength",get:function(){var e=this.analysisView,t=e.result,i=e.unit;if((0,c.Wi)(t))return null;var n=null,r=t.directDistance;switch(i){case"metric":n=r&&(0,y.nn)(r,"meters");break;case"imperial":n=r&&(0,y.nn)(r,(0,H.FN)(r.value,r.unit));break;default:n=r&&(0,y.nn)(r,i)}return(0,c.Wi)(n)?null:(0,j.sk)(n.value/30)*(0,H.En)(1,n.unit,"meters")}},{key:"_updateMessageBundle",value:function(){var e=this;this.loadingMessages=!0,(0,Re.ME)("esri/core/t9n/Units").then((function(t){e.messages=t})).finally((function(){e.loadingMessages=!1}))}},{key:"testData",get:function(){var e;return{labels:this.labels,stripeLength:null===(e=this._segmentVisualElement)||void 0===e?void 0:e.stripeLength}}}]),i}(u.Z);(0,l._)([(0,d.Cb)()],Ge.prototype,"_triangleOrientationOverride",void 0),(0,l._)([(0,d.Cb)()],Ge.prototype,"messages",void 0),(0,l._)([(0,d.Cb)()],Ge.prototype,"view",void 0),(0,l._)([(0,d.Cb)()],Ge.prototype,"analysis",void 0),(0,l._)([(0,d.Cb)()],Ge.prototype,"analysisView",void 0),(0,l._)([(0,d.Cb)()],Ge.prototype,"loadingMessages",void 0),(0,l._)([(0,d.Cb)()],Ge.prototype,"visible",null),(0,l._)([(0,d.Cb)()],Ge.prototype,"viewMode",null),(0,l._)([(0,d.Cb)()],Ge.prototype,"actualVisualizedMeasurement",null),(0,l._)([(0,d.Cb)()],Ge.prototype,"visualElementOrientation",void 0),(0,l._)([(0,d.Cb)()],Ge.prototype,"triangleCollapseRatioThreshold",void 0),(0,l._)([(0,d.Cb)()],Ge.prototype,"allowVisualElementsOrientationChange",null),(0,l._)([(0,d.Cb)()],Ge.prototype,"labels",null),(0,l._)([(0,d.Cb)()],Ge.prototype,"_labelsText",null),(0,l._)([(0,d.Cb)()],Ge.prototype,"_actualVisualElementsOrientation",null),(0,l._)([(0,d.Cb)()],Ge.prototype,"_measurementArrowStripeLength",null),Ge=(0,l._)([(0,h.j)("esri.views.3d.analysis.DirectLineMeasurement.DirectLineMeasurementVisualization")],Ge);var xe=Math.cos((0,j.Vl)(12)),We=(0,N.J$)(),je=(0,N.J$)(),Ue=(0,N.gX)(),Ne=(0,N.gX)(),He=(0,N.gX)(),Fe=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,r.Z)(this,i),(n=t.call(this,e)).type="direct-line-measurement-view-3d",n.analysis=null,n.result=null,n.measurementMode=_.e.Auto,n.elevationAlignedStartPoint=null,n.elevationAlignedEndPoint=null,n}return(0,a.Z)(i,[{key:"initialize",value:function(){var e=this.view,t=this.analysis;this._analysisVisualization=new Ge({view:e,analysis:t,analysisView:this}),this._analysisController=new z({view:e,analysis:t,viewData:this})}},{key:"destroy",value:function(){this._analysisController=(0,c.SC)(this._analysisController),this._analysisVisualization=(0,c.SC)(this._analysisVisualization)}},{key:"updating",get:function(){var e;return!(null===(e=this._analysisVisualization)||void 0===e||!e.loadingMessages)}},{key:"viewMode",get:function(){return this._analysisVisualization.viewMode}},{key:"actualVisualizedMeasurement",get:function(){return this._analysisVisualization.actualVisualizedMeasurement}},{key:"visualElementOrientation",get:function(){return this._analysisVisualization.visualElementOrientation},set:function(e){this._analysisVisualization.visualElementOrientation=e}},{key:"allowVisualElementsOrientationChange",get:function(){return this._analysisVisualization.allowVisualElementsOrientationChange},set:function(e){this._analysisVisualization.allowVisualElementsOrientationChange=e}},{key:"triangleCollapseRatioThreshold",get:function(){return this._analysisVisualization.triangleCollapseRatioThreshold},set:function(e){this._analysisVisualization.triangleCollapseRatioThreshold=e}},{key:"directLabelText",get:function(){var e,t;return null!==(e=null===(t=this._analysisVisualization.labels.direct)||void 0===t?void 0:t.text)&&void 0!==e?e:""}},{key:"horizontalLabelText",get:function(){var e,t;return null!==(e=null===(t=this._analysisVisualization.labels.horizontal)||void 0===t?void 0:t.text)&&void 0!==e?e:""}},{key:"verticalLabelText",get:function(){var e,t;return null!==(e=null===(t=this._analysisVisualization.labels.vertical)||void 0===t?void 0:t.text)&&void 0!==e?e:""}},{key:"unit",get:function(){return(0,c.Pt)(this.analysis.unit,this._defaultUnit)}},{key:"testData",get:function(){var e;return this.destroyed?{labels:null,stripeLength:null,visualization:null,controller:null}:(0,n.Z)((0,n.Z)({},null===(e=this._analysisVisualization)||void 0===e?void 0:e.testData),{},{visualization:this._analysisVisualization,controller:this._analysisController})}}]),i}((0,g.p)(u.Z));(0,l._)([(0,d.Cb)()],Fe.prototype,"updating",null),(0,l._)([(0,d.Cb)({readOnly:!0})],Fe.prototype,"type",void 0),(0,l._)([(0,d.Cb)({constructOnly:!0,nonNullable:!0})],Fe.prototype,"analysis",void 0),(0,l._)([(0,d.Cb)()],Fe.prototype,"result",void 0),(0,l._)([(0,d.Cb)()],Fe.prototype,"measurementMode",void 0),(0,l._)([(0,d.Cb)()],Fe.prototype,"elevationAlignedStartPoint",void 0),(0,l._)([(0,d.Cb)()],Fe.prototype,"elevationAlignedEndPoint",void 0),(0,l._)([(0,d.Cb)({readOnly:!0})],Fe.prototype,"viewMode",null),(0,l._)([(0,d.Cb)({readOnly:!0})],Fe.prototype,"actualVisualizedMeasurement",null),(0,l._)([(0,d.Cb)()],Fe.prototype,"visualElementOrientation",null),(0,l._)([(0,d.Cb)()],Fe.prototype,"allowVisualElementsOrientationChange",null),(0,l._)([(0,d.Cb)()],Fe.prototype,"triangleCollapseRatioThreshold",null),(0,l._)([(0,d.Cb)({readOnly:!0})],Fe.prototype,"directLabelText",null),(0,l._)([(0,d.Cb)({readOnly:!0})],Fe.prototype,"horizontalLabelText",null),(0,l._)([(0,d.Cb)({readOnly:!0})],Fe.prototype,"verticalLabelText",null),(0,l._)([(0,d.Cb)()],Fe.prototype,"_analysisVisualization",void 0),(0,l._)([(0,d.Cb)()],Fe.prototype,"_analysisController",void 0),(0,l._)([(0,d.Cb)()],Fe.prototype,"unit",null),(0,l._)([(0,d.Cb)(v.Y)],Fe.prototype,"_defaultUnit",void 0);var Be=Fe=(0,l._)([(0,h.j)("esri.views.3d.analysis.DirectLineMeasurementAnalysisView3D")],Fe)},63825:function(e,t,i){i.d(t,{O:function(){return h}});var n=i(15671),r=i(43144),a=i(92026),o=i(94172),s=i(79100),l=i(66327),u=i(1487),c=i(78485),d=i(97882),h=function(){function e(t){(0,n.Z)(this,e),this._resourceFactory=t,this._resources=null,this._visible=!0,this._attached=!1}return(0,r.Z)(e,[{key:"destroy",value:function(){this._destroyResources()}},{key:"object",get:function(){return(0,a.pC)(this._resources)?this._resources.object:null}},{key:"resources",get:function(){return(0,a.pC)(this._resources)?this._resources.external:null}},{key:"visible",get:function(){return this._visible},set:function(e){e!==this._visible&&(this._visible=e,this._syncVisible())}},{key:"attached",get:function(){return this._attached},set:function(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}},{key:"recreate",value:function(){this.attached&&this._createResources()}},{key:"recreateGeometry",value:function(){if(this._resourceFactory.recreateGeometry){var e=this._resourceFactory.view._stage;if(!(0,a.Wi)(this._resources)&&e){var t=this._resources.object;this._resources.external.forEach((function(t){t.type!==s.U.Mesh&&t.type!==s.U.Line&&t.type!==s.U.Point||e.remove(t)})),t.removeAllGeometries(),this._resourceFactory.recreateGeometry(this._resources.external,t,this._resources.layer),this._resources.external.forEach((function(t){t.type!==s.U.Mesh&&t.type!==s.U.Line&&t.type!==s.U.Point||e.add(t)}))}}else this.recreate()}},{key:"_createOrDestroyResources",value:function(){this._attached?this._resources||this._createResources():this._destroyResources()}},{key:"_createResources",value:function(){this._destroyResources();var e=this._resourceFactory,t=e.view,i=t._stage;if(i){var n=new d.F({pickable:!1,updatePolicy:c.j.SYNC});i.add(n);var r=new l.T({castShadow:!1}),a=e.createResources(r,n);a.forEach((function(e){i.add(e),e instanceof u.x&&i.loadImmediate(e)})),i.add(r),n.add(r);var s=e.cameraChanged,h=s?(0,o.YP)((function(){return t.state.camera}),(function(e){return s(e)}),o.nn):null;this._resources={layer:n,object:r,external:a,cameraHandle:h},this._syncVisible()}}},{key:"_destroyResources",value:function(){var e;if(!(0,a.Wi)(this._resources)){var t=this._resourceFactory.view._stage;t&&(t.remove(this._resources.object),t.remove(this._resources.layer),this._resources.external.forEach((function(e){return t.remove(e)}))),this._resources.object.dispose(),null!==(e=this._resources.cameraHandle)&&void 0!==e&&e.remove(),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}}},{key:"_syncVisible",value:function(){(0,a.Wi)(this._resources)||(this._resources.object.visible=this._visible)}}]),e}()}}]);
//# sourceMappingURL=8951.ca1f783a.chunk.js.map