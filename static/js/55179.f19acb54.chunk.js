"use strict";(self.webpackChunkhub_layout_versioning=self.webpackChunkhub_layout_versioning||[]).push([[55179],{68312:function(t,e,r){r.d(e,{Ue:function(){return Fr},G8:function(){return Ir}});var n=r(1413),i=r(86950),a=r(10064),o=r(84652),s=r(15671),u=r(43144),l=r(60136),c=r(92572),p=r(27366),f=r(92026),v=r(49861),d=(r(25243),r(63780),r(69912)),h=(r(32718),r(93169),r(46784)),m=function(t){(0,l.Z)(r,t);var e=(0,c.Z)(r);function r(){var t;return(0,s.Z)(this,r),(t=e.apply(this,arguments)).raster=void 0,t}return(0,u.Z)(r)}(h.wq);(0,p._)([(0,v.Cb)({json:{write:!0}})],m.prototype,"raster",void 0);var y,g=m=(0,p._)([(0,d.j)("esri.layers.support.rasterFunctions.AspectFunctionArguments")],m),b=y=function(t){(0,l.Z)(r,t);var e=(0,c.Z)(r);function r(){return(0,s.Z)(this,r),e.apply(this,arguments)}return(0,u.Z)(r,[{key:"clone",value:function(){return new y({raster:this.raster})}}]),r}(g),w=b=y=(0,p._)([(0,d.j)("esri.layers.support.rasterFunctions.AspectFunctionArguments")],b),x=r(93433),Z=r(89125),_=r(96212),C=r(86200),A=function(t){(0,l.Z)(r,t);var e=(0,c.Z)(r);function r(){var t;return(0,s.Z)(this,r),(t=e.apply(this,arguments)).functionArguments=null,t.readingBufferSize=0,t.id=-1,t.isNoopProcess=!1,t.rawInputBandIds=[],t.isInputBandIdsSwizzled=!1,t.swizzledBandSelection=[],t.isBranch=!1,t._bindingResult=null,t}return(0,u.Z)(r,[{key:"supportsGPU",get:function(){return this._bindingResult.supportsGPU}},{key:"bind",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;this.id=r+1;for(var n=this._getRasterValues(),i=!0,a=0;a<n.length;a++){var o=n[a];if((0,f.pC)(o)&&this._isRasterFunctionValue(o)){var s=o.bind(t,e,this.id+a);if(!s.success)return this._bindingResult=s,s;i=i&&s.supportsGPU}}return!this.rasterInfo||e?(this.sourceRasterInfos=this._getSourceRasterInfos(t),this._bindingResult=this._bindSourceRasters(),this._bindingResult.supportsGPU=i&&this._bindingResult.supportsGPU,this.processInputBandIds(),this._bindingResult):(this._bindingResult={success:!0,supportsGPU:!0},this.processInputBandIds(),this._bindingResult)}},{key:"process",value:function(t){var e,r=this,i=this._getRasterValues(),a=0===i.length?null!==(e=t.pixelBlocks)&&void 0!==e?e:t.primaryPixelBlocks:i.map((function(e){return r._readRasterValue(e,t)}));return this._processPixels((0,n.Z)((0,n.Z)({},t),{},{pixelBlocks:a}))}},{key:"processInputBandIds",value:function(){var t,e=this._getRasterValues().filter(this._isRasterFunctionValue);if(e.length>1){var r=e.map((function(t){return t.processInputBandIds()[0]}));this.rawInputBandIds=r,this.isInputBandIdsSwizzled=this.rawInputBandIds.some((function(t,e){return t!==e}));var n=e.filter((function(t){return"ExtractBand"===t.functionName}));return n.length&&n.forEach((function(t,e){t.isInputBandIdsSwizzled=!0,t.swizzledBandSelection=[e,e,e]})),this.rawInputBandIds}var i=e[0];if(i){if(t=i.processInputBandIds(),i.isInputBandIdsSwizzled)return this.rawInputBandIds=t,t}else{t=[];for(var a=this.sourceRasterInfos[0].bandCount,o=0;o<a;o++)t.push(o)}var s=this._getInputBandIds(t);return this.isInputBandIdsSwizzled=s.some((function(t,e){return t!==e})),this.rawInputBandIds=s,this.rawInputBandIds}},{key:"getPrimaryRasters",value:function(){var t=[],e=[];return this._getPrimaryRasters(this,t,e),{rasters:t,rasterIds:e}}},{key:"getWebGLProcessorDefinition",value:function(){var t=this,e=this._getWebGLParameters(),r=this.functionArguments,n=r.raster,i=r.rasters;return i&&Array.isArray(i)&&i.length?(e.rasters=i.map((function(e){return t._isRasterFunctionValue(e)?e.getWebGLProcessorDefinition():"number"==typeof e?{name:"Constant",parameters:{value:e},pixelType:"f32",id:-1,isNoopProcess:!1}:{name:"Identity",parameters:{value:e},pixelType:"f32",id:-1,isNoopProcess:!1}})),e.rasters.some((function(t){return null!=t}))||(e.rasters=null)):this._isRasterFunctionValue(n)&&(e.raster=n.getWebGLProcessorDefinition()),{name:this.functionName,parameters:e,pixelType:this.outputPixelType,id:this.id,isNoopProcess:this.isNoopProcess}}},{key:"getFlatWebGLFunctionChain",value:function(){var t=this.getWebGLProcessorDefinition();if(!t)return null;for(var e=[t],r=t.parameters,n=r.rasters||r.raster&&[r.raster];null!==(i=n)&&void 0!==i&&i.length;){var i;e.unshift.apply(e,(0,x.Z)(n));for(var a=[],o=0;o<n.length;o++){var s=n[o].parameters,u=s.rasters||s.raster&&[s.raster];(null===u||void 0===u?void 0:u.length)&&a.push.apply(a,(0,x.Z)(u))}n=a}for(var l=e.length-1;l>=0;l--)e[l].isNoopProcess&&e.splice(l,1);for(var c=!1,p=0;p<e.length;p++){var f=e[p];f.id=e.length-p-1;var v=f.parameters.rasters;c=c||null!=v&&v.length>1}return{hasBranches:c,functions:e}}},{key:"_getOutputPixelType",value:function(t){var e;return"unknown"===this.outputPixelType?t:null!==(e=this.outputPixelType)&&void 0!==e?e:t}},{key:"_getWebGLParameters",value:function(){return{}}},{key:"_getInputBandIds",value:function(t){return t}},{key:"_isOutputRoundingNeeded",value:function(){var t,e=this.outputPixelType;return null!==(t=(null===e||void 0===e?void 0:e.startsWith("u"))||(null===e||void 0===e?void 0:e.startsWith("s")))&&void 0!==t&&t}},{key:"_getRasterValues",value:function(){var t,e=this,r=this.rasterArgumentNames;return"rasters"===r[0]?null!==(t=this.functionArguments.rasters)&&void 0!==t?t:[]:r.map((function(t){return e.functionArguments[t]}))}},{key:"_getSourceRasterInfos",value:function(t){var e,r=this._getRasterValues(),n=t.rasterInfos,i=t.rasterIds;if(0===r.length)return n;var a=r.map((function(t){return t&&"object"==typeof t&&"bind"in t&&t.rasterInfo?t.rasterInfo:"string"==typeof t&&i.includes(t)?n[i.indexOf(t)]:"number"!=typeof t?n[0]:void 0})),o=null!==(e=a.find((function(t){return t})))&&void 0!==e?e:n[0];return a.forEach((function(t,e){void 0===t&&(a[e]=o)})),a}},{key:"_getPrimaryRasterId",value:function(t){return null===t||void 0===t?void 0:t.url}},{key:"_getPrimaryRasters",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=0;n<t.sourceRasters.length;n++){var i=t.sourceRasters[n];if("number"!=typeof i)if("bind"in i)this._getPrimaryRasters(i,e,r);else{var a=i,o=this._getPrimaryRasterId(a);if(null==o)continue;r.includes(o)||(this.mainPrimaryRasterId===o?(e.unshift(a),r.unshift(o)):(e.push(a),r.push(o)))}}}},{key:"_isRasterFunctionValue",value:function(t){return null!=t&&"object"==typeof t&&"getWebGLProcessorDefinition"in t}},{key:"_readRasterValue",value:function(t,e){var r=e.primaryPixelBlocks;if((0,f.Wi)(t)||"$$"===t){var n=r[0];return(0,f.Wi)(n)?null:n.clone()}if("string"==typeof t){var i=e.primaryRasterIds.indexOf(t);return-1===i?null:r[i]}if("number"==typeof t){var a=r[0];if((0,f.Wi)(a))return null;var o=a.width,s=a.height,u=a.pixelType,l=a.mask,c=l?new Uint8Array(l):null,p=new Float32Array(o*s);p.fill(t);var v=this.sourceRasterInfos[0].bandCount,d=new Array(v).fill(p);return new _.Z({width:o,height:s,pixelType:u,pixels:d,mask:c})}return t.process(e)}}]),r}(h.wq);(0,p._)([(0,v.Cb)({json:{write:!0}})],A.prototype,"functionName",void 0),(0,p._)([(0,v.Cb)({json:{write:!0}})],A.prototype,"functionArguments",void 0),(0,p._)([(0,v.Cb)()],A.prototype,"rasterArgumentNames",void 0),(0,p._)([(0,v.Cb)({json:{write:!0}}),(0,Z.p)((function(t){return null===t||void 0===t?void 0:t.toLowerCase()}))],A.prototype,"outputPixelType",void 0),(0,p._)([(0,v.Cb)({json:{write:!0}})],A.prototype,"mainPrimaryRasterId",void 0),(0,p._)([(0,v.Cb)()],A.prototype,"sourceRasters",void 0),(0,p._)([(0,v.Cb)({type:[C.Z],json:{write:!0}})],A.prototype,"sourceRasterInfos",void 0),(0,p._)([(0,v.Cb)({json:{write:!0}})],A.prototype,"rasterInfo",void 0),(0,p._)([(0,v.Cb)({json:{write:!0}})],A.prototype,"readingBufferSize",void 0),(0,p._)([(0,v.Cb)({json:{write:!0}})],A.prototype,"id",void 0),(0,p._)([(0,v.Cb)()],A.prototype,"isNoopProcess",void 0),(0,p._)([(0,v.Cb)()],A.prototype,"supportsGPU",null),(0,p._)([(0,v.Cb)()],A.prototype,"rawInputBandIds",void 0),(0,p._)([(0,v.Cb)()],A.prototype,"isInputBandIdsSwizzled",void 0),(0,p._)([(0,v.Cb)()],A.prototype,"swizzledBandSelection",void 0),(0,p._)([(0,v.Cb)()],A.prototype,"isBranch",void 0),(0,p._)([(0,v.Cb)()],A.prototype,"_bindingResult",void 0);var k=A=(0,p._)([(0,d.j)("esri.layers.support.rasterFunctions.BaseRasterFunction")],A),I=r(86807),F=function(t){(0,l.Z)(r,t);var e=(0,c.Z)(r);function r(){var t;return(0,s.Z)(this,r),(t=e.apply(this,arguments)).functionName="Aspect",t.functionArguments=null,t.rasterArgumentNames=["raster"],t.isGCS=!1,t}return(0,u.Z)(r,[{key:"_bindSourceRasters",value:function(){var t,e,r=this.sourceRasterInfos[0];this.isGCS=null!==(t=null===(e=r.spatialReference)||void 0===e?void 0:e.isGeographic)&&void 0!==t&&t,this.outputPixelType=this._getOutputPixelType("f32");var n=r.clone();return n.pixelType=this.outputPixelType,n.statistics=[{min:0,max:360,avg:180,stddev:30}],n.histograms=null,n.colormap=null,n.attributeTable=null,n.bandCount=1,this.rasterInfo=n,{success:!0,supportsGPU:!0}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if((0,f.Wi)(r))return null;var n=t.extent,i=n?{x:n.width/r.width,y:n.height/r.height}:{x:1,y:1};return(0,I.M_)(r,{resolution:i})}}]),r}(k);(0,p._)([(0,v.Cb)({json:{write:!0,name:"rasterFunction"}})],F.prototype,"functionName",void 0),(0,p._)([(0,v.Cb)({type:w,json:{write:!0,name:"rasterFunctionArguments"}})],F.prototype,"functionArguments",void 0),(0,p._)([(0,v.Cb)()],F.prototype,"rasterArgumentNames",void 0),(0,p._)([(0,v.Cb)({json:{write:!0}})],F.prototype,"isGCS",void 0);var P=F=(0,p._)([(0,d.j)("esri.layers.support.rasterFunctions.AspectFunction")],F),N=r(27135),R=r(29439),T=r(43404),j=new Set(["+","-","*","/","(",")"]);function B(t,e,r,n){if("number"==typeof r&&"number"==typeof n)return r+n;var i;if("number"==typeof r){i=n.length;var a=r;(r=new Float32Array(i)).fill(a)}else if(i=r.length,n.constructor===Number){var o=n;(n=new Float32Array(i)).fill(o)}var s=new Float32Array(i);switch(e){case"+":for(var u=0;u<i;u++)(null==t||t[u])&&(s[u]=r[u]+n[u]);break;case"-":for(var l=0;l<i;l++)(null==t||t[l])&&(s[l]=r[l]-n[l]);break;case"*":for(var c=0;c<i;c++)(null==t||t[c])&&(s[c]=r[c]*n[c]);break;case"/":for(var p=0;p<i;p++)(null==t||t[p])&&n[p]&&(s[p]=r[p]/n[p]);break;case"(":case")":throw new Error("encountered error with custom band index equation")}return s}function S(t,e){t.splice(e,1);var r=0,n=0;do{r=0,n=0;for(var i=0;i<t.length;i++)if("("===t[i])r=i;else if(")"===t[i]){n=i;break}n===r+1&&t.splice(r,2)}while(n===r+1);return t}function M(t){if(1===t.length)return{opIndex:0,numIndex:0};for(var e=0,r=0,n=0;n<t.length;n++)if("("===t[n])e=n;else if(")"===t[n]){r=n;break}for(var i=0===r?t:t.slice(e+1,r),a=-1,o=0;o<i.length;o++)if("*"===i[o]||"/"===i[o]){a=o;break}if(a>-1)r>0&&(a+=e+1);else{for(var s=0;s<i.length;s++)if("+"===i[s]||"-"===i[s]){a=s;break}r>0&&(a+=e+1)}for(var u=0,l=0;l<a;l++)"("===t[l]&&u++;return{opIndex:a,numIndex:a-u}}function D(t,e,r){var n,i=function(t,e){(t=t.replace(/ /g,"")).startsWith("-")&&(t="0"+t),t.startsWith("+")&&(t=t.slice(1,t.length));for(var r=t.split(""),n=[],i=[],a="",o=0;o<r.length;o++){var s=r[o];if(j.has(s))""!==a&&i.push(parseFloat(a)),n.push(s),a="";else{if("b"===s.toLowerCase()){o++,a=s.concat(r[o]),i.push(e[parseInt(a[1],10)-1]),a="";continue}a=a.concat(s),o===r.length-1&&i.push(parseFloat(a))}}return{ops:n,nums:i}}(r,e),a=i.ops,o=i.nums;if(0===a.length){var s=1===o.length?o[0]:e[0];if(s instanceof Float32Array)return[s];var u=new Float32Array(e[0].length);return"number"==typeof s?u.fill(s):u.set(s),[u]}for(;a.length>0;){var l=M(a),c=l.numIndex,p=l.opIndex;if(n=B(t,a[p],o[c],o[c+1]),1===a.length)break;a=S(a,p),o.splice(c,2,n)}return[n]}var E,G=r(17314),O=new T.X({0:"custom",1:"ndvi",2:"savi",3:"tsavi",4:"msavi",5:"gemi",6:"pvi",7:"gvitm",8:"sultan",9:"vari",10:"gndvi",11:"sr",12:"ndvi-re",13:"sr-re",14:"mtvi2",15:"rtvi-core",16:"ci-re",17:"ci-g",18:"ndwi",19:"evi",20:"iron-oxide",21:"ferrous-minerals",22:"clay-minerals",23:"wndwi",24:"bai",25:"nbr",26:"ndbi",27:"ndmi",28:"ndsi",29:"mndwi"},{useNumericKeys:!0});function z(t,e){if(!(0,G.nk)(t))return t;var r,n=e.equation,i=e.method,a=e.bandIndexes.map((function(t){return t-1})),o=t.pixels,s=t.mask;switch(i){case"gndvi":case"nbr":case"ndbi":case"ndvi":case"ndvi-re":case"ndsi":case"ndmi":case"mndwi":r=L(s,o[a[0]],o[a[1]]);break;case"ndwi":r=L(s,o[a[1]],o[a[0]]);break;case"sr":case"sr-re":case"iron-oxide":case"ferrous-minerals":case"clay-minerals":r=function(t,e,r){for(var n=r.length,i=new Float32Array(n),a=0;a<n;a++)if(null==t||t[a]){var o=e[a],s=r[a];s&&(i[a]=o/s)}return[i]}(s,o[a[0]],o[a[1]]);break;case"ci-g":case"ci-re":r=function(t,e,r){for(var n=e.length,i=new Float32Array(n),a=0;a<n;a++)if(null==t||t[a]){var o=e[a],s=r[a];s&&(i[a]=o/s-1)}return[i]}(s,o[a[0]],o[a[1]]);break;case"savi":r=function(t,e,r,n){for(var i=r.length,a=new Float32Array(i),o=0;o<i;o++)if(null==t||t[o]){var s=r[o],u=e[o],l=u+s+n;l&&(a[o]=(u-s)/l*(1+n))}return[a]}(s,o[a[0]],o[a[1]],a[2]+1);break;case"tsavi":r=function(t,e,r,n,i,a){for(var o=r.length,s=new Float32Array(o),u=-i*n+a*(1+n*n),l=0;l<o;l++)if(null==t||t[l]){var c=r[l],p=e[l],f=i*p+c+u;f&&(s[l]=n*(p-n*c-i)/f)}return[s]}(s,o[a[0]],o[a[1]],a[2]+1,a[3]+1,a[4]+1);break;case"msavi":r=function(t,e,r){for(var n=r.length,i=new Float32Array(n),a=0;a<n;a++)if(null==t||t[a]){var o=r[a],s=e[a];i[a]=.5*(2*(s+1)-Math.sqrt(Math.pow(2*s+1,2)-8*(s-o)))}return[i]}(s,o[a[0]],o[a[1]]);break;case"gemi":r=function(t,e,r){for(var n=r.length,i=new Float32Array(n),a=0;a<n;a++)if(null==t||t[a]){var o=r[a],s=e[a];if(1!==o){var u=(2*(s*s-o*o)+1.5*s+.5*o)/(s+o+.5);i[a]=u*(1-.25*u)-(o-.125)/(1-o)}}return[i]}(s,o[a[0]],o[a[1]]);break;case"pvi":r=function(t,e,r,n,i){for(var a=r.length,o=new Float32Array(a),s=Math.sqrt(1+n*n),u=0;u<a;u++)if(null==t||t[u]){var l=r[u],c=e[u];o[u]=(c-n*l-i)/s}return[o]}(s,o[a[0]],o[a[1]],a[2]+1,a[3]+1);break;case"gvitm":r=function(t,e){for(var r=(0,R.Z)(e,6),n=r[0],i=r[1],a=r[2],o=r[3],s=r[4],u=r[5],l=n.length,c=new Float32Array(l),p=0;p<l;p++)(null==t||t[p])&&(c[p]=-.2848*n[p]-.2435*i[p]-.5436*a[p]+.7243*o[p]+.084*s[p]-1.18*u[p]);return[c]}(s,[o[a[0]],o[a[1]],o[a[2]],o[a[3]],o[a[4]],o[a[5]]]);break;case"sultan":r=function(t,e){for(var r=(0,R.Z)(e,6),n=r[0],i=r[2],a=r[3],o=r[4],s=r[5],u=n.length,l=new Float32Array(u),c=new Float32Array(u),p=new Float32Array(u),f=0;f<u;f++)(null==t||t[f])&&(l[f]=s[f]?o[f]/s[f]*100:0,c[f]=n[f]?o[f]/n[f]*100:0,p[f]=a[f]?i[f]/a[f]*(o[f]/a[f])*100:0);return[l,c,p]}(s,[o[a[0]],o[a[1]],o[a[2]],o[a[3]],o[a[4]],o[a[5]]]);break;case"vari":r=function(t,e){for(var r=(0,R.Z)(e,3),n=r[0],i=r[1],a=r[2],o=n.length,s=new Float32Array(o),u=0;u<o;u++)if(null==t||t[u])for(u=0;u<o;u++){var l=n[u],c=i[u],p=c+l-a[u];p&&(s[u]=(c-l)/p)}return[s]}(s,[o[a[0]],o[a[1]],o[a[2]]]);break;case"mtvi2":r=function(t,e){for(var r=(0,R.Z)(e,3),n=r[0],i=r[1],a=r[2],o=n.length,s=new Float32Array(o),u=0;u<o;u++)if(null==t||t[u])for(u=0;u<o;u++){var l=n[u],c=i[u],p=a[u],f=Math.sqrt(Math.pow(2*l+1,2)-6*l-5*Math.sqrt(c)-.5);s[u]=1.5*(1.2*(l-p)-2.5*(c-p))*f}return[s]}(s,[o[a[0]],o[a[1]],o[a[2]]]);break;case"rtvi-core":r=function(t,e){for(var r=(0,R.Z)(e,3),n=r[0],i=r[1],a=r[2],o=n.length,s=new Float32Array(o),u=0;u<o;u++)if(null==t||t[u])for(u=0;u<o;u++){var l=n[u],c=i[u],p=a[u];s[u]=100*(l-c)-10*(l-p)}return[s]}(s,[o[a[0]],o[a[1]],o[a[2]]]);break;case"evi":r=function(t,e){for(var r=(0,R.Z)(e,3),n=r[0],i=r[1],a=r[2],o=n.length,s=new Float32Array(o),u=0;u<o;u++)if(null==t||t[u])for(u=0;u<o;u++){var l=n[u],c=i[u],p=l+6*c-7.5*a[u]+1;p&&(s[u]=2.5*(l-c)/p)}return[s]}(s,[o[a[0]],o[a[1]],o[a[2]]]);break;case"wndwi":r=function(t,e){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,n=(0,R.Z)(e,3),i=n[0],a=n[1],o=n[2],s=a.length,u=new Float32Array(s),l=0;l<s;l++)if(null==t||t[l])for(l=0;l<s;l++){var c=i[l],p=a[l],f=o[l],v=c+r*p+(1-r)*f;v&&(u[l]=(c-r*p-(1-r)*f)/v)}return[u]}(s,[o[a[0]],o[a[1]],o[a[2]]],a[3]?a[3]+1:.5);break;case"bai":r=function(t,e,r){for(var n=r.length,i=new Float32Array(n),a=0;a<n;a++)if(null==t||t[a])for(a=0;a<n;a++){var o=Math.pow(.1-e[a],2)+Math.pow(.06-r[a],2);o&&(i[a]=1/o)}return[i]}(s,o[a[0]],o[a[1]]);break;case"custom":r=D(s,o,n);break;default:return t}var u=(0,f.pC)(s)?new Uint8Array(s.length):null;(0,f.pC)(s)&&(0,f.pC)(u)&&u.set(s);var l=new _.Z({width:t.width,height:t.height,pixelType:"f32",pixels:r,mask:u});return l.updateStatistics(),l}function V(t){var e=new Float32Array(9);return e[3*t[0]]=1,e[3*t[1]+1]=1,e[3*t[2]+2]=1,e}function L(t,e,r){for(var n=r.length,i=new Float32Array(n),a=0;a<n;a++)if(null==t||t[a]){var o=e[a],s=r[a],u=o+s;u&&(i[a]=(o-s)/u)}return[i]}var U=E=function(t){(0,l.Z)(r,t);var e=(0,c.Z)(r);function r(){var t;return(0,s.Z)(this,r),(t=e.apply(this,arguments)).method="custom",t}return(0,u.Z)(r,[{key:"clone",value:function(){return new E({method:this.method,bandIndexes:this.bandIndexes,raster:(0,o.d9)(this.raster)})}}]),r}(g);(0,p._)([(0,v.Cb)({json:{type:String,write:!0}})],U.prototype,"bandIndexes",void 0),(0,p._)([(0,N.J)(O)],U.prototype,"method",void 0);var W=U=E=(0,p._)([(0,d.j)("esri.layers.support.rasterFunctions.BandArithmeticFunctionArguments")],U),q=new Set(["vari","mtvi2","rtvi-core","evi"]),X=function(t){(0,l.Z)(r,t);var e=(0,c.Z)(r);function r(){var t;return(0,s.Z)(this,r),(t=e.apply(this,arguments)).functionName="BandArithmetic",t.functionArguments=null,t.rasterArgumentNames=["raster"],t}return(0,u.Z)(r,[{key:"_bindSourceRasters",value:function(){this.outputPixelType=this._getOutputPixelType("f32");var t=this.sourceRasterInfos[0],e=t.clone();return e.pixelType=this.outputPixelType,e.statistics=null,e.histograms=null,e.bandCount="sultan"===this.functionArguments.method?t.bandCount:1,this.rasterInfo=e,{success:!0,supportsGPU:!["custom","gvitm","sultan"].includes(this.functionArguments.method)}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if((0,f.Wi)(r))return r;var n=this.functionArguments,i=n.method,a=n.bandIndexes,o=a.split(" ").map((function(t){return parseFloat(t)}));return z(r,{method:i,bandIndexes:o,equation:a})}},{key:"_getWebGLParameters",value:function(){var t=this.functionArguments.bandIndexes.split(" ").map((function(t){return parseFloat(t)-1}));2===t.length&&t.push(0);var e,r,n=this.isInputBandIdsSwizzled?[0,1,2]:t,i=new Float32Array(3);switch(this.functionArguments.method){case"gndvi":case"nbr":case"ndbi":case"ndvi":case"ndvi-re":case"ndsi":case"ndmi":case"mndwi":e=V([n[0],n[1],0]),r="ndxi";break;case"ndwi":e=V([n[1],n[0],0]),r="ndxi";break;case"sr":case"sr-re":case"iron-oxide":case"ferrous-minerals":case"clay-minerals":e=V([n[0],n[1],0]),r="sr";break;case"ci-g":case"ci-re":e=V([n[0],n[1],0]),r="ci";break;case"savi":e=V([n[0],n[1],0]),r="savi",i[0]=t[2]+1;break;case"tsavi":e=V([n[0],n[1],0]),r="tsavi",i[0]=t[2]+1,i[1]=t[3]+1,i[2]=t[4]+1;break;case"msavi":e=V([n[0],n[1],0]),r="msavi";break;case"gemi":e=V([n[0],n[1],0]),r="gemi";break;case"pvi":e=V([n[0],n[1],0]),r="tsavi",i[0]=t[2]+1,i[1]=t[3]+1;break;case"vari":e=V([n[0],n[1],n[2]]),r="vari";break;case"mtvi2":e=V([n[0],n[1],n[2]]),r="mtvi2";break;case"rtvi-core":e=V([n[0],n[1],n[2]]),r="rtvicore";break;case"evi":e=V([n[0],n[1],n[2]]),r="evi";break;case"wndwi":e=V([n[0],n[1],0]),r="wndwi",i[0]=t[3]?t[3]+1:.5;break;case"bai":e=V([n[1],n[0],0]),r="bai";break;default:e=V([0,1,2]),r="custom"}return{bandIndexMat3:e,indexType:r,adjustments:i}}},{key:"_getInputBandIds",value:function(t){if("custom"===this.functionArguments.method)return t;var e=this.functionArguments.bandIndexes.split(" ").map((function(t){return parseFloat(t)-1})),r=t.length,n=e.map((function(t){return t>=r?r-1:t})),i=q.has(this.functionArguments.method)?3:2,a=n.slice(0,i).map((function(e){return t[e]}));return 2===a.length&&a.push(0),a}}]),r}(k);(0,p._)([(0,v.Cb)({json:{write:!0,name:"rasterFunction"}})],X.prototype,"functionName",void 0),(0,p._)([(0,v.Cb)({type:W,json:{write:!0,name:"rasterFunctionArguments"}})],X.prototype,"functionArguments",void 0),(0,p._)([(0,v.Cb)()],X.prototype,"rasterArgumentNames",void 0);var H,J=X=(0,p._)([(0,d.j)("esri.layers.support.rasterFunctions.BandArithmeticFunction")],X),$=r(38511),Y=r(22850),K=r(57634),Q=H=function(t){(0,l.Z)(r,t);var e=(0,c.Z)(r);function r(){return(0,s.Z)(this,r),e.apply(this,arguments)}return(0,u.Z)(r,[{key:"castColormapName",value:function(t){if(!t)return null;var e=t.toLowerCase();return Y.Oi.includes(e)?e:null}},{key:"readColorRamp",value:function(t){return(0,K.i)(t)}},{key:"readColorRampName",value:function(t,e){if(!t)return null;var r=Y.H0.jsonValues.find((function(e){return e.toLowerCase()===t.toLowerCase()}));return r?Y.H0.fromJSON(r):null}},{key:"clone",value:function(){var t;return new H({colormap:(0,o.d9)(this.colormap),colormapName:this.colormapName,colorRamp:null===(t=this.colorRamp)||void 0===t?void 0:t.clone(),colorRampName:this.colorRampName})}}]),r}(g);(0,p._)([(0,v.Cb)({type:[[Number]],json:{write:!0}})],Q.prototype,"colormap",void 0),(0,p._)([(0,v.Cb)({type:String,json:{write:!0}})],Q.prototype,"colormapName",void 0),(0,p._)([(0,Z.p)("colormapName")],Q.prototype,"castColormapName",null),(0,p._)([(0,v.Cb)({types:K.V,json:{write:!0}})],Q.prototype,"colorRamp",void 0),(0,p._)([(0,$.r)("colorRamp")],Q.prototype,"readColorRamp",null),(0,p._)([(0,v.Cb)({type:Y.H0.apiValues,json:{type:Y.H0.jsonValues,write:Y.H0.write}})],Q.prototype,"colorRampName",void 0),(0,p._)([(0,$.r)("colorRampName")],Q.prototype,"readColorRampName",null);var tt=Q=H=(0,p._)([(0,d.j)("esri.layers.support.rasterFunctions.ColormapFunctionArguments")],Q),et=[[36,0,255],[36,0,255],[36,0,255],[36,0,255],[112,75,3],[113,76,3],[114,77,3],[115,77,3],[116,78,3],[117,79,3],[118,79,3],[119,80,3],[121,81,4],[122,82,4],[123,82,4],[124,83,4],[125,84,4],[126,84,4],[127,85,4],[128,86,4],[129,86,4],[130,87,4],[131,88,4],[132,89,4],[133,89,4],[134,90,4],[135,91,4],[136,91,4],[137,92,4],[138,93,4],[139,94,4],[140,94,4],[142,95,5],[143,96,5],[144,96,5],[145,97,5],[146,98,5],[147,99,5],[148,99,5],[149,100,5],[150,101,5],[151,101,5],[152,102,5],[153,103,5],[154,104,5],[155,104,5],[156,105,5],[157,106,5],[158,106,5],[159,107,5],[160,108,5],[161,108,5],[162,109,5],[164,110,6],[165,111,6],[166,111,6],[167,112,6],[168,113,6],[169,113,6],[170,114,6],[171,115,6],[172,116,6],[173,116,6],[174,117,6],[245,0,0],[245,5,0],[245,10,0],[246,15,0],[246,20,0],[246,25,0],[246,30,0],[247,35,0],[247,40,0],[247,45,0],[247,50,0],[247,55,0],[248,60,0],[248,65,0],[248,70,0],[248,75,0],[249,81,0],[249,86,0],[249,91,0],[249,96,0],[250,101,0],[250,106,0],[250,111,0],[250,116,0],[250,121,0],[251,126,0],[251,131,0],[251,136,0],[251,141,0],[252,146,0],[252,151,0],[252,156,0],[252,156,0],[251,159,0],[250,162,0],[249,165,0],[248,168,0],[247,171,0],[246,174,0],[245,177,0],[245,179,0],[244,182,0],[243,185,0],[242,188,0],[241,191,0],[240,194,0],[239,197,0],[238,200,0],[237,203,0],[236,206,0],[235,209,0],[234,212,0],[233,215,0],[232,218,0],[231,221,0],[230,224,0],[230,226,0],[229,229,0],[228,232,0],[227,235,0],[226,238,0],[225,241,0],[224,244,0],[223,247,0],[165,247,0],[163,244,0],[161,240,0],[158,237,0],[156,233,1],[154,230,1],[152,227,1],[149,223,1],[147,220,1],[145,216,1],[143,213,1],[140,210,2],[138,206,2],[136,203,2],[134,200,2],[132,196,2],[129,193,2],[127,189,2],[125,186,3],[123,183,3],[120,179,3],[118,176,3],[116,172,3],[114,169,3],[111,166,3],[109,162,4],[107,159,4],[105,155,4],[103,152,4],[100,149,4],[98,145,4],[96,142,4],[94,138,5],[91,135,5],[89,132,5],[87,128,5],[85,125,5],[82,121,5],[80,118,5],[78,115,6],[76,111,6],[73,108,6],[71,105,6],[69,101,6],[67,98,6],[65,94,6],[62,91,7],[60,88,7],[58,84,7],[56,81,7],[53,77,7],[51,74,7],[49,71,7],[47,67,8],[44,64,8],[42,60,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8]],rt=[[36,0,255],[36,0,255],[36,0,255],[36,0,255],[245,20,0],[245,24,0],[245,29,0],[245,31,0],[247,33,0],[247,33,0],[247,37,0],[247,41,0],[247,41,0],[247,41,0],[247,45,0],[247,45,0],[247,47,0],[247,49,0],[247,49,0],[247,54,0],[247,54,0],[247,56,0],[247,58,0],[247,58,0],[250,62,0],[250,62,0],[250,62,0],[250,67,0],[250,67,0],[250,67,0],[250,69,0],[250,71,0],[250,71,0],[250,75,0],[250,75,0],[250,78,0],[250,79,0],[250,79,0],[250,79,0],[250,81,0],[250,83,0],[250,83,0],[250,87,0],[250,87,0],[250,90,0],[250,92,0],[252,93,0],[252,93,0],[252,97,0],[252,97,0],[252,97,0],[252,97,0],[252,101,0],[252,101,0],[252,101,0],[252,101,0],[252,105,0],[252,105,0],[252,107,0],[252,109,0],[252,109,0],[252,113,13],[255,118,20],[255,119,23],[255,121,25],[255,126,33],[255,132,38],[255,133,40],[255,135,43],[255,141,48],[255,144,54],[255,150,59],[255,152,61],[255,153,64],[255,159,69],[255,163,77],[255,165,79],[255,168,82],[255,174,87],[255,176,92],[255,181,97],[255,183,99],[255,186,102],[255,191,107],[255,197,115],[255,201,120],[255,203,123],[255,205,125],[255,209,130],[255,214,138],[255,216,141],[255,218,143],[255,224,150],[255,228,156],[255,234,163],[255,236,165],[255,238,168],[255,243,173],[255,248,181],[255,252,186],[253,252,186],[250,252,187],[244,250,180],[238,247,176],[234,246,173],[231,245,169],[223,240,163],[217,237,157],[211,235,150],[205,233,146],[200,230,142],[195,227,136],[189,224,132],[184,222,126],[180,220,123],[174,217,119],[169,214,114],[163,212,108],[160,210,105],[154,207,101],[148,204,96],[143,201,93],[138,199,88],[134,197,84],[130,194,81],[126,191,77],[117,189,70],[115,186,68],[112,184,64],[106,181,60],[100,179,55],[94,176,49],[92,174,47],[90,173,45],[81,168,37],[75,166,33],[71,163,28],[66,160,24],[62,158,21],[56,156,14],[51,153,0],[51,153,0],[51,153,0],[50,150,0],[50,150,0],[50,150,0],[50,150,0],[49,148,0],[49,148,0],[49,148,0],[48,145,0],[48,145,0],[48,145,0],[48,145,0],[48,143,0],[48,143,0],[48,143,0],[48,143,0],[47,140,0],[47,140,0],[47,140,0],[47,140,0],[46,138,0],[46,138,0],[46,138,0],[46,138,0],[45,135,0],[45,135,0],[45,135,0],[45,135,0],[44,133,0],[44,133,0],[44,133,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[42,128,0],[42,128,0],[42,128,0],[42,125,0],[42,125,0],[42,125,0],[42,125,0],[41,122,0],[41,122,0],[41,122,0],[41,122,0],[40,120,0],[40,120,0],[40,120,0],[40,120,0],[40,120,0],[39,117,0],[39,117,0],[39,117,0],[39,117,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0]];function nt(t,e){for(var r,n=[],i=[],a=0;a<t.length-1;a++)n.push({type:"algorithmic",algorithm:"esriHSVAlgorithm",fromColor:t[a].slice(1),toColor:t[a+1].slice(1)}),i.push(t[a+1][0]-t[a][0]);var o=t[t.length-1][0];return(0,Y.XL)({type:"multipart",colorRamps:n},{numColors:o,weights:e=null!==(r=e)&&void 0!==r?r:i})}function it(t){var e;switch(t){case"elevation":e=nt([[0,0,191,191],[51,0,255,0],[102,255,255,0],[153,255,127,0],[204,191,127,63],[256,20,20,20]]);break;case"gray":e=(0,Y.XL)({type:"algorithmic",algorithm:"esriHSVAlgorithm",fromColor:[0,0,0],toColor:[255,255,255]});break;case"hillshade":e=nt([[0,38,54,41],[69,79,90,82],[131,156,156,156],[256,253,241,253]],[.268,.238,.495]);break;case"ndvi":e=et;break;case"ndvi2":e=function(){for(var t=nt([[0,255,255,255],[70,0,0,255],[80,205,193,173],[100,150,150,150],[110,120,100,51],[130,120,200,100],[140,28,144,3],[160,6,55,0],[180,10,30,25],[201,6,27,7]]),e=t.length;e<256;e++)t.push([6,27,7]);return t}();break;case"ndvi3":e=rt;break;case"random":e=function(){for(var t=[],e=0;e<256;e++){for(var r=[],n=0;n<3;n++)r.push(Math.round(255*Math.random()));t.push(r)}return t}()}return e?(e=e.map((function(t,e){return[e].concat((0,x.Z)(t))})),e):null}var at=function(t){(0,l.Z)(r,t);var e=(0,c.Z)(r);function r(){var t;return(0,s.Z)(this,r),(t=e.apply(this,arguments)).functionName="Colormap",t.functionArguments=null,t.rasterArgumentNames=["raster"],t.isNoopProcess=!0,t}return(0,u.Z)(r,[{key:"_bindSourceRasters",value:function(){var t,e,r=this.sourceRasterInfos[0];if(r.bandCount>1)return{success:!1,supportsGPU:!1,error:"colormap-function: source data must be single band"};var n=this.functionArguments,i=n.colormap,a=n.colormapName,o=n.colorRamp,s=n.colorRampName;if(null===(t=i)||void 0===t||!t.length)if(o)i=(0,Y.Jw)(o,{interpolateAlpha:!0});else if(s){var u=(0,Y.B4)(s);u&&(i=(0,Y.Jw)(u))}else a&&(i=it(a));if(null===(e=i)||void 0===e||!e.length)return{success:!1,supportsGPU:!1,error:"colormap-function: missing colormap argument"};this.outputPixelType=this._getOutputPixelType("u8");var l=r.clone();return l.pixelType=this.outputPixelType,l.colormap=i,l.bandCount=1,this.rasterInfo=l,{success:!0,supportsGPU:!0}}},{key:"_processPixels",value:function(t){var e;return null===(e=t.pixelBlocks)||void 0===e?void 0:e[0]}}]),r}(k);(0,p._)([(0,v.Cb)({json:{write:!0,name:"rasterFunction"}})],at.prototype,"functionName",void 0),(0,p._)([(0,v.Cb)({type:tt,json:{write:!0,name:"rasterFunctionArguments"}})],at.prototype,"functionArguments",void 0),(0,p._)([(0,v.Cb)()],at.prototype,"rasterArgumentNames",void 0),(0,p._)([(0,v.Cb)()],at.prototype,"isNoopProcess",void 0),(0,p._)([(0,v.Cb)({json:{write:!0}})],at.prototype,"indexedColormap",void 0);var ot,st=at=(0,p._)([(0,d.j)("esri.layers.support.rasterFunctions.ColormapFunction")],at),ut=r(31201),lt=ot=function(t){(0,l.Z)(r,t);var e=(0,c.Z)(r);function r(){var t;return(0,s.Z)(this,r),(t=e.apply(this,arguments)).rasters=[],t}return(0,u.Z)(r,[{key:"writeRasters",value:function(t,e){e.rasters=t.map((function(t){return"number"==typeof t||"string"==typeof t?t:t.toJSON()}))}},{key:"clone",value:function(){return new ot({rasters:(0,o.d9)(this.rasters)})}}]),r}(g);(0,p._)([(0,v.Cb)({json:{write:!0}})],lt.prototype,"rasters",void 0),(0,p._)([(0,ut.c)("rasters")],lt.prototype,"writeRasters",null);var ct=lt=ot=(0,p._)([(0,d.j)("esri.layers.support.rasterFunctions.CompositeBandFunctionArguments")],lt),pt=function(t){(0,l.Z)(r,t);var e=(0,c.Z)(r);function r(){var t;return(0,s.Z)(this,r),(t=e.apply(this,arguments)).functionName="CompositeBand",t.functionArguments=null,t.rasterArgumentNames=["rasters"],t}return(0,u.Z)(r,[{key:"_bindSourceRasters",value:function(){var t=this.sourceRasterInfos,e=t[0];this.outputPixelType=this._getOutputPixelType(e.pixelType);var r=e.clone();if(r.attributeTable=null,r.colormap=null,r.pixelType=this.outputPixelType,r.bandCount=t.map((function(t){return t.bandCount})).reduce((function(t,e){return t+e})),t.every((function(t){var e=t.statistics;return(0,f.pC)(e)&&e.length}))){var n=[];t.forEach((function(t){var e=t.statistics;return(0,f.pC)(e)&&n.push.apply(n,(0,x.Z)(e))})),r.statistics=n}if(t.every((function(t){var e=t.histograms;return(0,f.pC)(e)&&e.length}))){var i=[];t.forEach((function(t){var e=t.histograms;return(0,f.pC)(e)&&i.push.apply(i,(0,x.Z)(e))})),r.histograms=i}return r.bandCount>1&&(r.colormap=null,r.attributeTable=null),this.rasterInfo=r,{success:!0,supportsGPU:r.bandCount<=3}}},{key:"_processPixels",value:function(t){var e=t.pixelBlocks;if(!e)return null;var r=null===e||void 0===e?void 0:e[0];return(0,f.Wi)(r)?null:(0,G.Gd)(e)}},{key:"_getWebGLParameters",value:function(){return{bandCount:this.rasterInfo.bandCount}}}]),r}(k);(0,p._)([(0,v.Cb)({json:{write:!0,name:"rasterFunction"}})],pt.prototype,"functionName",void 0),(0,p._)([(0,v.Cb)({type:ct,json:{write:!0,name:"rasterFunctionArguments"}})],pt.prototype,"functionArguments",void 0),(0,p._)([(0,v.Cb)()],pt.prototype,"rasterArgumentNames",void 0);var ft,vt=pt=(0,p._)([(0,d.j)("esri.layers.support.rasterFunctions.CompositeBandFunction")],pt),dt={userDefined:-1,lineDetectionHorizontal:0,lineDetectionVertical:1,lineDetectionLeftDiagonal:2,lineDetectionRightDiagonal:3,gradientNorth:4,gradientWest:5,gradientEast:6,gradientSouth:7,gradientNorthEast:8,gradientNorthWest:9,smoothArithmeticMean:10,smoothing3x3:11,smoothing5x5:12,sharpening3x3:13,sharpening5x5:14,laplacian3x3:15,laplacian5x5:16,sobelHorizontal:17,sobelVertical:18,sharpen:19,sharpen2:20,pointSpread:21,none:255},ht={bitwiseAnd:11,bitwiseLeftShift:12,bitwiseNot:13,bitwiseOr:14,bitwiseRightShift:15,bitwiseXOr:16,booleanAnd:17,booleanNot:18,booleanOr:19,booleanXOr:20,equalTo:24,greaterThan:28,greaterThanEqual:29,lessThan:33,lessThanEqual:34,isNull:31,notEqual:46},mt={acos:6,asin:7,atan:8,atanh:9,cos:21,cosh:22,sin:51,sinh:52,tan:56,tanh:57,acosh:59,asinh:60,atan2:61},yt={setNull:50,conditional:78},gt=(0,n.Z)((0,n.Z)((0,n.Z)((0,n.Z)((0,n.Z)({},{plus:1,minus:2,times:3,sqrt:4,power:5,abs:10,divide:23,exp:25,exp10:26,exp2:27,int:30,float:32,ln:35,log10:36,log2:37,mod:44,negate:45,roundDown:48,roundUp:49,square:53,floatDivide:64,floorDivide:65}),ht),mt),{majority:38,max:39,mean:40,med:41,min:42,minority:43,range:47,stddev:54,sum:55,variety:58,majorityIgnoreNoData:66,maxIgnoreNoData:67,meanIgnoreNoData:68,medIgnoreNoData:69,minIgnoreNoData:70,minorityIgnoreNoData:71,rangeIgnoreNoData:72,stddevIgnoreNoData:73,sumIgnoreNoData:74,varietyIgnoreNoData:75}),yt),bt=r(92089),wt=new Map;function xt(t,e,r,n,i,a,o){for(var s=new Float32Array(e*r),u=a.length,l=o?0:n,c=o?n:0,p=o?1:e,f=l;f<r-l;f++)for(var v=f*e,d=c;d<e-c;d++)if(!i||i[v+d]){for(var h=0,m=0;m<u;m++)h+=t[v+d+(m-n)*p]*a[m];s[v+d]=h}return s}function Zt(t,e,r,n,i,a,o){for(var s=new Float32Array(e*r),u=Math.floor(n/2),l=Math.floor(i/2),c=u;c<r-u;c++)for(var p=c*e,f=l;f<e-l;f++)if(!a||a[p+f]){for(var v=0,d=0;d<n;d++)for(var h=0;h<i;h++)v+=t[p+f+(d-u)*e+h-l]*o[d*i+h];s[p+f]=v}return s}function _t(t,e,r,n,i){for(var a=Math.floor(n/2),o=0;o<a;o++)for(var s=0;s<e;s++)t[o*e+s]=t[(i-1-o)*e+s],t[(r-1-o)*e+s]=t[(r-i+o)*e+s];for(var u=Math.floor(i/2),l=0;l<r;l++)for(var c=l*e,p=0;p<u;p++)t[c+p]=t[c+i-1-p],t[c+e-p-1]=t[c+e+p-i]}function Ct(t,e){var r=function(t){for(var e=Math.sqrt(t.length),r=t.slice(0,e),n=[1],i=1;i<e;i++){for(var a=null,o=0;o<e;o++){var s=t[o+i*e],u=t[o];if(null==a)if(0===u){if(s)return{separable:!1,row:null,col:null}}else a=s/u;else if(s/u!==a)return{separable:!1,row:null,col:null}}if(null==a)return{separable:!1,row:null,col:null};n.push(a)}return{separable:!0,row:r,col:n}}(e.kernel),n=!1!==e.mirrorEdges,i=r.separable?function(t,e,r){for(var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=t.pixels,a=t.width,o=t.height,s=t.pixelType,u=t.mask,l=i.length,c=[],p=e.length,f=r.length,v=Math.floor(p/2),d=Math.floor(f/2),h=0;h<l;h++){var m=xt(i[h],a,o,v,u,e,!0);m=xt(m,a,o,d,u,r,!1),n&&_t(m,a,o,p,f),c.push(m)}return new _.Z({width:a,height:o,pixelType:s,pixels:c,mask:u})}(t,r.row,r.col,n):function(t,e){for(var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=t.pixels,i=t.width,a=t.height,o=t.pixelType,s=t.mask,u=n.length,l=[],c=e.kernel,p=e.rows,f=e.cols,v=0;v<u;v++){var d=Zt(n[v],i,a,p,f,s,c);r&&_t(d,i,a,p,f),l.push(d)}return new _.Z({width:i,height:a,pixelType:o,pixels:l,mask:s})}(t,e,n),a=e.outputPixelType;return a&&i.clamp(a),i}wt.set(dt.none,[0,0,0,0,1,0,0,0,0]),wt.set(dt.lineDetectionHorizontal,[-1,-1,-1,2,2,2,-1,-1,-1]),wt.set(dt.lineDetectionVertical,[-1,2,-1,-1,2,-1,-1,2,-1]),wt.set(dt.lineDetectionLeftDiagonal,[2,-1,-1,-1,2,-1,-1,-1,2]),wt.set(dt.lineDetectionRightDiagonal,[-1,-1,2,-1,2,-1,2,-1,-1]),wt.set(dt.gradientNorth,[-1,-2,-1,0,0,0,1,2,1]),wt.set(dt.gradientWest,[-1,0,1,-2,0,2,-1,0,1]),wt.set(dt.gradientEast,[1,0,-1,2,0,-2,1,0,-1]),wt.set(dt.gradientSouth,[1,2,1,0,0,0,-1,-2,-1]),wt.set(dt.gradientNorthEast,[0,-1,-2,1,0,-1,2,1,0]),wt.set(dt.gradientNorthWest,[-2,-1,0,-1,0,1,0,1,2]),wt.set(dt.smoothArithmeticMean,[.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111]),wt.set(dt.smoothing3x3,[.0625,.125,.0625,.125,.25,.125,.0625,.125,.0625]),wt.set(dt.smoothing5x5,[1,1,1,1,1,1,4,4,4,1,1,4,12,4,1,1,4,4,4,1,1,1,1,1,1]),wt.set(dt.sharpening3x3,[-1,-1,-1,-1,9,-1,-1,-1,-1]),wt.set(dt.sharpening5x5,[-1,-3,-4,-3,-1,-3,0,6,0,-3,-4,6,21,6,-4,-3,0,6,0,-3,-1,-3,-4,-3,-1]),wt.set(dt.laplacian3x3,[0,-1,0,-1,4,-1,0,-1,0]),wt.set(dt.laplacian5x5,[0,0,-1,0,0,0,-1,-2,-1,0,-1,-2,17,-2,-1,0,-1,-2,-1,0,0,0,-1,0,0]),wt.set(dt.sobelHorizontal,[-1,-2,-1,0,0,0,1,2,1]),wt.set(dt.sobelVertical,[-1,0,1,-2,0,2,-1,0,1]),wt.set(dt.sharpen,[0,-.25,0,-.25,2,-.25,0,-.25,0]),wt.set(dt.sharpen2,[-.25,-.25,-.25,-.25,3,-.25,-.25,-.25,-.25]),wt.set(dt.pointSpread,[-.627,.352,-.627,.352,2.923,.352,-.627,.352,-.627]);var At=ft=function(t){(0,l.Z)(r,t);var e=(0,c.Z)(r);function r(){var t;return(0,s.Z)(this,r),(t=e.apply(this,arguments)).rows=3,t.cols=3,t.kernel=[0,0,0,0,1,0,0,0,0],t}return(0,u.Z)(r,[{key:"convolutionType",set:function(t){this._set("convolutionType",t);var e=wt.get(t);if(e&&t!==dt.userDefined&&t!==dt.none){var r=Math.sqrt(e.length);this._set("kernel",e),this._set("cols",r),this._set("rows",r)}}},{key:"clone",value:function(){return new ft({cols:this.cols,rows:this.rows,kernel:(0,x.Z)(this.kernel),convolutionType:this.convolutionType,raster:(0,o.d9)(this.raster)})}}]),r}(g);(0,p._)([(0,v.Cb)({json:{type:Number,write:!0}})],At.prototype,"rows",void 0),(0,p._)([(0,v.Cb)({json:{type:Number,write:!0}})],At.prototype,"cols",void 0),(0,p._)([(0,v.Cb)({json:{name:"type",type:Number,write:!0}})],At.prototype,"convolutionType",null),(0,p._)([(0,v.Cb)({json:{type:[Number],write:!0}})],At.prototype,"kernel",void 0);var kt=At=ft=(0,p._)([(0,d.j)("esri.layers.support.rasterFunctions.ConvolutionFunctionArguments")],At),It=function(t){(0,l.Z)(r,t);var e=(0,c.Z)(r);function r(){var t;return(0,s.Z)(this,r),(t=e.apply(this,arguments)).functionName="Convolution",t.rasterArgumentNames=["raster"],t}return(0,u.Z)(r,[{key:"_bindSourceRasters",value:function(){var t=this.functionArguments,e=t.convolutionType,r=t.rows,n=t.cols,i=t.kernel;if(!Object.values(dt).includes(e))return{success:!1,supportsGPU:!1,error:"convolution-function: the specified kernel type is not supported ".concat(e)};if(e!==dt.none&&r*n!==i.length)return{success:!1,supportsGPU:!1,error:"convolution-function: the specified rows and cols do not match the length of the kernel"};var a=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType(a.pixelType);var o=a.clone();o.pixelType=this.outputPixelType;var s=[dt.none,dt.sharpen,dt.sharpen2,dt.sharpening3x3,dt.sharpening5x5];return"u8"===this.outputPixelType||s.includes(e)||(o.statistics=null,o.histograms=null),o.colormap=null,o.attributeTable=null,this.rasterInfo=o,{success:!0,supportsGPU:i.length<=25}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if((0,f.Wi)(r)||this.functionArguments.convolutionType===dt.none)return r;var n=this.functionArguments,i=n.kernel,a=n.rows,o=n.cols,s=i.reduce((function(t,e){return t+e}));return 0!==s&&1!==s&&(i=i.map((function(t){return t/s}))),Ct(r,{kernel:i,rows:a,cols:o,outputPixelType:this.outputPixelType})}},{key:"_getWebGLParameters",value:function(){var t=this.functionArguments.kernel,e=t.reduce((function(t,e){return t+e}));0!==e&&1!==e&&(t=t.map((function(t){return t/e})));var r=new Float32Array(25);return r.set(t),{kernelRows:this.functionArguments.rows,kernelCols:this.functionArguments.cols,kernel:r,clampRange:(0,bt.r)(this.outputPixelType)}}}]),r}(k);(0,p._)([(0,v.Cb)({json:{write:!0,name:"rasterFunction"}})],It.prototype,"functionName",void 0),(0,p._)([(0,v.Cb)({type:kt,json:{write:!0,name:"rasterFunctionArguments"}})],It.prototype,"functionArguments",void 0),(0,p._)([(0,v.Cb)()],It.prototype,"rasterArgumentNames",void 0);var Ft,Pt=It=(0,p._)([(0,d.j)("esri.layers.support.rasterFunctions.ConvolutionFunction")],It),Nt=Ft=function(t){(0,l.Z)(r,t);var e=(0,c.Z)(r);function r(){var t;return(0,s.Z)(this,r),(t=e.apply(this,arguments)).bandIds=[],t.missingBandAction=G.CD.bestMatch,t}return(0,u.Z)(r,[{key:"clone",value:function(){return new Ft({bandIds:(0,x.Z)(this.bandIds),missingBandAction:this.missingBandAction})}}]),r}(g);(0,p._)([(0,v.Cb)({json:{write:!0}})],Nt.prototype,"bandIds",void 0),(0,p._)([(0,v.Cb)({json:{write:!0}})],Nt.prototype,"missingBandAction",void 0);var Rt=Nt=Ft=(0,p._)([(0,d.j)("esri.layers.support.rasterFunctions.ExtractBandFunctionArguments")],Nt),Tt=function(t){(0,l.Z)(r,t);var e=(0,c.Z)(r);function r(){var t;return(0,s.Z)(this,r),(t=e.apply(this,arguments)).functionName="ExtractBand",t.functionArguments=null,t.rasterArgumentNames=["raster"],t}return(0,u.Z)(r,[{key:"_bindSourceRasters",value:function(){var t=this.sourceRasterInfos[0],e=t.bandCount,r=this.functionArguments,n=r.bandIds;if(r.missingBandAction===G.CD.fail&&n.some((function(t){return t<0||t>=e})))return{success:!1,supportsGPU:!1,error:"extract-band-function: invalid bandIds"};this.outputPixelType=this._getOutputPixelType("f32");var i=t.clone();i.pixelType=this.outputPixelType,i.bandCount=n.length;var a=i.statistics,o=i.histograms;return(0,f.pC)(a)&&a.length&&(i.statistics=n.map((function(t){return a[t]||a[a.length-1]}))),(0,f.pC)(o)&&o.length&&(i.histograms=n.map((function(t){return o[t]||o[o.length-1]}))),this.rasterInfo=i,{success:!0,supportsGPU:i.bandCount<=3}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if((0,f.Wi)(r))return null;var n=r.pixels.length,i=this.functionArguments.bandIds.map((function(t){return t>=n?n-1:t}));return r.extractBands(i)}},{key:"_getWebGLParameters",value:function(){var t;if(this.isInputBandIdsSwizzled)t=this.swizzledBandSelection.length?this.swizzledBandSelection:[0,1,2];else{var e,r;0===(t=(0,x.Z)(this.functionArguments.bandIds)).length?t=[0,1,2]:t.length<3&&(t[1]=null!==(e=t[1])&&void 0!==e?e:t[0],t[2]=null!==(r=t[2])&&void 0!==r?r:t[1]);for(var n=0;n<3;n++)t[n]=Math.min(t[n],2)}return{bandIndexMat3:V(t)}}},{key:"_getInputBandIds",value:function(t){var e=t.length;return this.functionArguments.bandIds.map((function(t){return t>=e?e-1:t})).map((function(e){return t[e]}))}}]),r}(k);(0,p._)([(0,v.Cb)({json:{write:!0,name:"rasterFunction"}})],Tt.prototype,"functionName",void 0),(0,p._)([(0,v.Cb)({type:Rt,json:{write:!0,name:"rasterFunctionArguments"}})],Tt.prototype,"functionArguments",void 0),(0,p._)([(0,v.Cb)()],Tt.prototype,"rasterArgumentNames",void 0);var jt,Bt=Tt=(0,p._)([(0,d.j)("esri.layers.support.rasterFunctions.ExtractBandFunction")],Tt),St=jt=function(t){(0,l.Z)(r,t);var e=(0,c.Z)(r);function r(){var t;return(0,s.Z)(this,r),(t=e.apply(this,arguments)).rasters=[],t.processAsMultiband=!0,t}return(0,u.Z)(r,[{key:"writeRasters",value:function(t,e){e.rasters=t.map((function(t){return"number"==typeof t||"string"==typeof t?t:t.toJSON()}))}},{key:"clone",value:function(){return new jt({operation:this.operation,processAsMultiband:this.processAsMultiband,rasters:(0,o.d9)(this.rasters)})}}]),r}(g);(0,p._)([(0,v.Cb)({json:{write:!0}})],St.prototype,"operation",void 0),(0,p._)([(0,v.Cb)({json:{write:!0}})],St.prototype,"rasters",void 0),(0,p._)([(0,ut.c)("rasters")],St.prototype,"writeRasters",null),(0,p._)([(0,v.Cb)({json:{write:!0}})],St.prototype,"processAsMultiband",void 0);var Mt=St=jt=(0,p._)([(0,d.j)("esri.layers.support.rasterFunctions.LocalFunctionArguments")],St),Dt=r(37762),Et=new Map;Et.set(mt.acos,[0,Math.PI]),Et.set(mt.asin,[-Math.PI/2,Math.PI/2]),Et.set(mt.atan,[-Math.PI/2,Math.PI/2]),Et.set(mt.cos,[-1,1]),Et.set(mt.sin,[-1,1]),Et.set(ht.booleanAnd,[0,1]),Et.set(ht.booleanNot,[0,1]),Et.set(ht.booleanOr,[0,1]),Et.set(ht.booleanXOr,[0,1]),Et.set(ht.equalTo,[0,1]),Et.set(ht.notEqual,[0,1]),Et.set(ht.greaterThan,[0,1]),Et.set(ht.greaterThanEqual,[0,1]),Et.set(ht.lessThan,[0,1]),Et.set(ht.lessThanEqual,[0,1]),Et.set(ht.isNull,[0,1]);var Gt=[0,2,2,2,1,2,1,1,1,1,1,2,2,1,2,2,2,2,1,2,2,1,1,2,2,1,1,1,2,2,1,1,1,2,2,1,1,1,999,999,999,999,999,999,2,1,2,999,1,1,2,1,1,1,999,999,1,1,999,1,1,2,999,999,2,2,999,999,999,999,999,999,999,999,999,999,3,999,3];function Ot(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t.map((function(t){return t.mask})),n=r.filter((function(t){return(0,f.pC)(t)})),i=t[0].pixels[0].length;if(0===n.length)return new Uint8Array(i).fill(255);var a=n[0],o=new Uint8Array(a);if(1===n.length)return o;if(!e){for(var s=1;s<n.length;s++)for(var u=n[s],l=0;l<o.length;l++)o[l]&&(o[l]=u[l]?255:0);return o}if(n.length!==r.length)return new Uint8Array(i).fill(255);for(var c=1;c<n.length;c++)for(var p=n[c],v=0;v<o.length;v++)0===o[v]&&(o[v]=p[v]?255:0);return o}function zt(t,e,r){for(var n=(0,R.Z)(t,2),i=n[0],a=n[1],o=i.length,s=_.Z.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=i[u]+a[u]);return s}function Vt(t,e,r){var n=(0,R.Z)(t,1)[0],i=n.length,a=_.Z.createEmptyBand("f32",i);return a.set(n),a}function Lt(t,e,r){for(var n=(0,R.Z)(t,2),i=n[0],a=n[1],o=i.length,s=_.Z.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=i[u]-a[u]);return s}function Ut(t,e,r){for(var n=(0,R.Z)(t,2),i=n[0],a=n[1],o=i.length,s=_.Z.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=i[u]*a[u]);return s}function Wt(t,e,r){for(var n=(0,R.Z)(t,1)[0],i=n.length,a=_.Z.createEmptyBand(r,i),o=0;o<i;o++)e&&!e[o]||(a[o]=Math.sign(n[o])*Math.floor(Math.abs(n[o])));return a}function qt(t,e,r){for(var n=(0,R.Z)(t,2),i=n[0],a=n[1],o=i.length,s=_.Z.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=i[u]/a[u]);return s}function Xt(t,e,r){return qt(t,e,"f32")}function Ht(t,e,r){for(var n=(0,R.Z)(t,2),i=n[0],a=n[1],o=i.length,s=_.Z.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=Math.floor(i[u]/a[u]));return s}function Jt(t,e,r,n){var i=t[0],a=i.length,o=_.Z.createEmptyBand(r,a);if(n===mt.atanh){for(var s=0;s<a;s++)if(e[s]){var u=i[s];Math.abs(u)>=1?e[s]=0:o[s]=Math.atanh(u)}return o}for(var l=n===mt.asin?Math.asin:Math.acos,c=0;c<a;c++)if(e[c]){var p=i[c];Math.abs(p)>1?e[c]=0:o[c]=l(p)}return o}function $t(t,e,r,n){for(var i=(0,R.Z)(t,1)[0],a=i.length,o=_.Z.createEmptyBand(r,a),s=0;s<a;s++)e&&!e[s]||(o[s]=n(i[s]));return o}function Yt(t,e,r,n){for(var i=(0,R.Z)(t,2),a=i[0],o=i[1],s=a.length,u=_.Z.createEmptyBand(r,s),l=0;l<s;l++)e&&!e[l]||(u[l]=n(a[l],o[l]));return u}function Kt(t,e,r){for(var n=(0,R.Z)(t,2),i=n[0],a=n[1],o=i.length,s=_.Z.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=i[u]&a[u]);return s}function Qt(t,e,r){for(var n=(0,R.Z)(t,2),i=n[0],a=n[1],o=i.length,s=_.Z.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=i[u]<<a[u]);return s}function te(t,e,r){for(var n=(0,R.Z)(t,1)[0],i=n.length,a=_.Z.createEmptyBand(r,i),o=0;o<i;o++)e&&!e[o]||(a[o]=~n[o]);return a}function ee(t,e,r){for(var n=(0,R.Z)(t,2),i=n[0],a=n[1],o=i.length,s=_.Z.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=i[u]|a[u]);return s}function re(t,e,r){for(var n=(0,R.Z)(t,2),i=n[0],a=n[1],o=i.length,s=_.Z.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=i[u]>>a[u]);return s}function ne(t,e,r){for(var n=(0,R.Z)(t,2),i=n[0],a=n[1],o=i.length,s=_.Z.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=i[u]^a[u]);return s}function ie(t,e,r){for(var n=(0,R.Z)(t,2),i=n[0],a=n[1],o=i.length,s=_.Z.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=i[u]&&a[u]?1:0);return s}function ae(t,e,r){for(var n=(0,R.Z)(t,1)[0],i=n.length,a=_.Z.createEmptyBand(r,i),o=0;o<i;o++)e&&!e[o]||(a[o]=n[o]?0:1);return a}function oe(t,e,r){for(var n=(0,R.Z)(t,2),i=n[0],a=n[1],o=i.length,s=_.Z.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=i[u]||a[u]?1:0);return s}function se(t,e,r){for(var n=(0,R.Z)(t,2),i=n[0],a=n[1],o=i.length,s=_.Z.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=(i[u]?1:0)^(a[u]?1:0));return s}function ue(t,e,r){for(var n=(0,R.Z)(t,2),i=n[0],a=n[1],o=i.length,s=_.Z.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=i[u]===a[u]?1:0);return s}function le(t,e,r,n){for(var i=(0,R.Z)(t,1)[0],a=i.length,o=_.Z.createEmptyBand(r,a),s=n===Math.E,u=0;u<a;u++)e&&!e[u]||(o[u]=s?Math.exp(i[u]):Math.pow(n,i[u]));return o}function ce(t,e,r){return le(t,e,r,10)}function pe(t,e,r){return le(t,e,r,2)}function fe(t,e,r){return le(t,e,r,Math.E)}function ve(t,e,r,n){for(var i=(0,R.Z)(t,1)[0],a=i.length,o=_.Z.createEmptyBand(r,a),s=0;s<a;s++)e&&!e[s]||(i[s]<=0?e[s]=0:o[s]=n(i[s]));return o}function de(t,e,r){return ve(t,e,r,Math.log10)}function he(t,e,r){return ve(t,e,r,Math.log2)}function me(t,e,r){return ve(t,e,r,Math.log)}function ye(t,e,r){for(var n=(0,R.Z)(t,2),i=n[0],a=n[1],o=i.length,s=_.Z.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=i[u]>a[u]?1:0);return s}function ge(t,e,r){for(var n=(0,R.Z)(t,2),i=n[0],a=n[1],o=i.length,s=_.Z.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=i[u]>=a[u]?1:0);return s}function be(t,e,r){for(var n=(0,R.Z)(t,2),i=n[0],a=n[1],o=i.length,s=_.Z.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=i[u]<a[u]?1:0);return s}function we(t,e,r){for(var n=(0,R.Z)(t,2),i=n[0],a=n[1],o=i.length,s=_.Z.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=i[u]<=a[u]?1:0);return s}function xe(t,e,r){var n=(0,R.Z)(t,1)[0].length,i=_.Z.createEmptyBand(r,n);if(!e)return i;for(var a=0;a<n;a++)i[a]=e[a]?0:1;return i}function Ze(t,e,r){for(var n=(0,R.Z)(t,2),i=n[0],a=n[1],o=i.length,s=_.Z.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=i[u]%a[u]);return s}function _e(t,e,r){for(var n=(0,R.Z)(t,1)[0],i=n.length,a=_.Z.createEmptyBand(r,i),o=0;o<i;o++)e&&!e[o]||(a[o]=-n[o]);return a}function Ce(t,e,r){for(var n=(0,R.Z)(t,2),i=n[0],a=n[1],o=i.length,s=_.Z.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=i[u]===a[u]?0:1);return s}function Ae(t,e,r){for(var n=(0,R.Z)(t,2),i=n[0],a=n[1],o=i.length,s=_.Z.createEmptyBand(r,o),u=new Uint8Array(o),l=0;l<o;l++)null!=e&&!e[l]||0!==i[l]||(s[l]=a[l],u[l]=255);return{band:s,mask:u}}function ke(t,e,r){for(var n=(0,R.Z)(t,3),i=n[0],a=n[1],o=n[2],s=i.length,u=_.Z.createEmptyBand(r,s),l=0;l<s;l++)e&&!e[l]||(u[l]=i[l]?a[l]:o[l]);return u}function Ie(t,e,r){var n=t.length;if(n<2)return t[0];for(var i=(0,R.Z)(t,1)[0],a=i.length,o=_.Z.createEmptyBand(r,a),s=0;s<a;s++)if(!e||e[s]){for(var u=i[s],l=1;l<n;l++){var c=t[l][s];u<c&&(u=c)}o[s]=u}return o}function Fe(t,e,r){var n=t.length;if(n<2)return t[0];for(var i=(0,R.Z)(t,1)[0],a=i.length,o=_.Z.createEmptyBand(r,a),s=0;s<a;s++)if(!e||e[s]){for(var u=i[s],l=1;l<n;l++){var c=t[l][s];u>c&&(u=c)}o[s]=u}return o}function Pe(t,e,r){var n=t.length;if(n<2)return t[0];for(var i=(0,R.Z)(t,1)[0],a=i.length,o=_.Z.createEmptyBand(r,a),s=0;s<a;s++)if(!e||e[s]){for(var u=i[s],l=u,c=1;c<n;c++){var p=t[c][s];l<p?l=p:u>p&&(u=p)}o[s]=l-u}return o}function Ne(t,e,r){var n=t.length;if(n<2)return t[0];for(var i=(0,R.Z)(t,1)[0].length,a=_.Z.createEmptyBand(r,i),o=0;o<i;o++)if(!e||e[o]){for(var s=0,u=0;u<n;u++)s+=t[u][o];a[o]=s/n}return a}function Re(t,e,r){var n=t.length;if(n<2)return t[0];for(var i=(0,R.Z)(t,1)[0].length,a=_.Z.createEmptyBand(r,i),o=0;o<i;o++)if(!e||e[o])for(var s=0;s<n;s++){var u=t[s];a[o]+=u[o]}return a}function Te(t,e,r){var n=t.length;if(n<2)return t[0];for(var i=(0,R.Z)(t,1)[0].length,a=_.Z.createEmptyBand(r,i),o=0;o<i;o++)if(!e||e[o]){for(var s=new Float32Array(n),u=0,l=0;l<n;l++){var c=t[l];u+=c[o],s[l]=c[o]}u/=n;for(var p=0,f=0;f<n;f++)p+=Math.pow(s[f]-u,2);a[o]=Math.sqrt(p/n)}return a}function je(t,e,r){var n=t.length;if(n<2)return t[0];for(var i=Math.floor(n/2),a=(0,R.Z)(t,1)[0].length,o=_.Z.createEmptyBand(r,a),s=new Float32Array(n),u=n%2==1,l=0;l<a;l++)if(!e||e[l]){for(var c=0;c<n;c++)s[c]=t[c][l];s.sort(),o[l]=u?s[i]:(s[i]+s[i-1])/2}return o}function Be(t,e,r){var n=(0,R.Z)(t,2),i=n[0],a=n[1];if(null==a)return i;for(var o=i.length,s=_.Z.createEmptyBand(r,o),u=0;u<o;u++)e[u]&&(i[u]===a[u]?s[u]=i[u]:e[u]=0);return s}function Se(t,e,r){var n=t.length;if(n<=2)return Be(t,e,r);for(var i=t[0].length,a=_.Z.createEmptyBand(r,i),o=new Map,s=0;s<i;s++)if(!e||e[s]){var u=void 0;o.clear();for(var l=0;l<n;l++)u=t[l][s],o.set(u,o.has(u)?o.get(u)+1:1);var c,p=0,f=0,v=(0,Dt.Z)(o.keys());try{for(v.s();!(c=v.n()).done;){var d=c.value;(p=o.get(d))>f&&(f=p,u=d)}}catch(h){v.e(h)}finally{v.f()}a[s]=u}return a}function Me(t,e,r){var n=t.length;if(n<=2)return Be(t,e,r);for(var i=t[0].length,a=_.Z.createEmptyBand(r,i),o=new Map,s=0;s<i;s++)if(!e||e[s]){var u=void 0;o.clear();for(var l=0;l<n;l++)u=t[l][s],o.set(u,o.has(u)?o.get(u)+1:1);var c,p=0,f=t.length,v=(0,Dt.Z)(o.keys());try{for(v.s();!(c=v.n()).done;){var d=c.value;(p=o.get(d))<f&&(f=p,u=d)}}catch(h){v.e(h)}finally{v.f()}a[s]=u}return a}function De(t,e,r){var n=t.length;if(n<2)return t[0];for(var i=(0,R.Z)(t,1)[0].length,a=_.Z.createEmptyBand(r,i),o=new Set,s=0;s<i;s++)if(!e||e[s]){var u=void 0;o.clear();for(var l=0;l<n;l++)u=t[l][s],o.add(u);a[s]=o.size}return a}var Ee=new Map,Ge=new Map,Oe=new Map,ze=new Map;function Ve(){Ee.size||(Ee.set(4,Math.sqrt),Ee.set(6,Math.acos),Ee.set(7,Math.asin),Ee.set(8,Math.atan),Ee.set(9,Math.atanh),Ee.set(10,Math.abs),Ee.set(21,Math.cos),Ee.set(22,Math.cosh),Ee.set(48,Math.floor),Ee.set(49,Math.ceil),Ee.set(51,Math.sin),Ee.set(52,Math.sinh),Ee.set(56,Math.tan),Ee.set(57,Math.tanh),Ee.set(59,Math.acosh),Ee.set(60,Math.asinh),Ee.set(65,Math.floor),Ge.set(5,Math.pow),Ge.set(61,Math.atan2),Oe.set(1,zt),Oe.set(2,Lt),Oe.set(3,Ut),Oe.set(11,Kt),Oe.set(12,Qt),Oe.set(12,Qt),Oe.set(13,te),Oe.set(14,ee),Oe.set(15,re),Oe.set(16,ne),Oe.set(17,ie),Oe.set(18,ae),Oe.set(19,oe),Oe.set(20,se),Oe.set(23,qt),Oe.set(24,ue),Oe.set(25,fe),Oe.set(26,ce),Oe.set(27,pe),Oe.set(28,ye),Oe.set(29,ge),Oe.set(30,Wt),Oe.set(31,xe),Oe.set(32,Vt),Oe.set(33,be),Oe.set(34,we),Oe.set(35,me),Oe.set(36,de),Oe.set(37,he),Oe.set(44,Ze),Oe.set(45,_e),Oe.set(46,Ce),Oe.set(64,Xt),Oe.set(65,Ht),Oe.set(76,ke),Oe.set(78,ke),ze.set(38,Se),ze.set(39,Ie),ze.set(40,Ne),ze.set(41,je),ze.set(42,Fe),ze.set(43,Me),ze.set(47,Pe),ze.set(54,Te),ze.set(55,Re),ze.set(58,De),ze.set(66,Se),ze.set(67,Ie),ze.set(68,Ne),ze.set(69,je),ze.set(70,Fe),ze.set(71,Me),ze.set(72,Pe),ze.set(73,Te),ze.set(74,Re),ze.set(75,De))}function Le(t,e,r,n){var i=(0,bt.r)(r),a=(0,R.Z)(i,2),o=a[0],s=a[1],u=r.startsWith("u")||r.startsWith("s");u&&(o-=1e-5,s+=1e-5);for(var l=0;l<e.length;l++)if(e[l]){var c=t[l];isNaN(c)||c<o||c>s?e[l]=0:n[l]=u?Math.round(c):c}}var Ue=function(t){(0,l.Z)(r,t);var e=(0,c.Z)(r);function r(){var t;return(0,s.Z)(this,r),(t=e.apply(this,arguments)).functionName="Local",t.functionArguments=null,t.rasterArgumentNames=["rasters"],t}return(0,u.Z)(r,[{key:"_bindSourceRasters",value:function(){var t=this.sourceRasterInfos,e=t[0],r=e.bandCount,n=this.functionArguments.processAsMultiband;if(t.some((function(t){return t.bandCount!==r})))return{success:!1,supportsGPU:!1,error:"local-function: input rasters do not have same band count"};var i=this.functionArguments,a=i.operation,o=i.rasters,s=Gt[a];if(!(999===s||o.length===s||o.length<=1&&1===s))return{success:!1,supportsGPU:!1,error:"local-function: the length of functionArguments.rasters does not match operation's requirement: ".concat(s)};this.outputPixelType=this._getOutputPixelType("f32");var u=e.clone();u.pixelType=this.outputPixelType,u.statistics=null,u.histograms=null,u.colormap=null,u.attributeTable=null,u.bandCount=999!==s||n?r:1;var l=function(t){return Et.get(t)}(a);if(l){u.statistics=[];for(var c=0;c<u.bandCount;c++)u.statistics[c]={min:l[0],max:l[1],avg:(l[0]+l[1])/2,stddev:(l[0]+l[1])/10}}return this.rasterInfo=u,{success:!0,supportsGPU:1===u.bandCount&&s<=3&&(a<11||a>16)}}},{key:"_processPixels",value:function(t){var e,r=t.pixelBlocks;return(0,f.Wi)(r)||r.some((function(t){return(0,f.Wi)(t)}))?null:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Ve();for(var n=Ot(t,e>=66&&e<=75),i=r.outputPixelType,a=void 0===i?"f32":i,o=!ze.has(e)||r.processAsMultiband,s=o?t[0].pixels.length:1,u=[],l=function(r){var i=ze.has(e)&&!o?t.flatMap((function(t){return t.pixels})):t.map((function(t){return t.pixels[r]})),s=void 0,l=!0;if(e===yt.setNull){var c=Ae(i,n,a);s=c.band,n=c.mask,l=!1}else Oe.has(e)?s=Oe.get(e)(i,n,"f64"):Ee.has(e)?s=e===mt.asin||e===mt.acos||e===mt.atanh?Jt(i,n,"f64",e):$t(i,n,"f64",Ee.get(e)):Ge.has(e)?s=Yt(i,n,"f64",Ge.get(e)):ze.has(e)?s=ze.get(e)(i,n,"f64"):(s=i[0],l=!1);if(l&&e!==ht.isNull&&!Et.has(e)){var p=_.Z.createEmptyBand(a,s.length);n||(n=new Uint8Array(s.length).fill(255)),Le(s,n,a,p),s=p}u.push(s)},c=0;c<s;c++)l(c);var p=t[0];return new _.Z({width:p.width,height:p.height,pixelType:a,mask:e===ht.isNull?null:n,pixels:u})}(r,this.functionArguments.operation,{processAsMultiband:this.functionArguments.processAsMultiband,outputPixelType:null!==(e=this.outputPixelType)&&void 0!==e?e:void 0})}},{key:"_getWebGLParameters",value:function(){var t,e,r,n=this.functionArguments.operation,i=Gt[n],a=null!==(t=null===(e=Object.keys(gt).find((function(t){return gt[t]===n})))||void 0===e?void 0:e.toLowerCase())&&void 0!==t?t:"undefined",o=null!==(r=this.outputPixelType)&&void 0!==r?r:"f32",s=(0,bt.r)(o),u=(0,R.Z)(s,2),l=u[0],c=u[1],p=o.startsWith("u")||o.startsWith("s");return p&&(l-=1e-4,c+=1e-4),{imageCount:i,operationName:a,domainRange:[l,c],isOutputRounded:p}}}]),r}(k);(0,p._)([(0,v.Cb)({json:{write:!0,name:"rasterFunction"}})],Ue.prototype,"functionName",void 0),(0,p._)([(0,v.Cb)({type:Mt,json:{write:!0,name:"rasterFunctionArguments"}})],Ue.prototype,"functionArguments",void 0),(0,p._)([(0,v.Cb)()],Ue.prototype,"rasterArgumentNames",void 0);var We,qe=Ue=(0,p._)([(0,d.j)("esri.layers.support.rasterFunctions.LocalFunction")],Ue),Xe=r(16889),He=We=function(t){(0,l.Z)(r,t);var e=(0,c.Z)(r);function r(){var t;return(0,s.Z)(this,r),(t=e.apply(this,arguments)).includedRanges=null,t.noDataValues=null,t.noDataInterpretation=G.DX.matchAny,t}return(0,u.Z)(r,[{key:"normalizedNoDataValues",get:function(){var t=this.noDataValues;if(null===t||void 0===t||!t.length)return null;var e=!1,r=t.map((function(t){if("number"==typeof t)return e=!0,[t];if("string"==typeof t){var r=t.trim().split(" ").filter((function(t){return""!==t.trim()})).map((function(t){return Number(t)}));return e=e||r.length>0,0===r.length?null:r}return null}));return e?r:null}},{key:"clone",value:function(){var t,e,r,n;return new We({includedRanges:null!==(t=null===(e=this.includedRanges)||void 0===e?void 0:e.slice())&&void 0!==t?t:[],noDataValues:null!==(r=null===(n=this.noDataValues)||void 0===n?void 0:n.slice())&&void 0!==r?r:[],noDataInterpretation:this.noDataInterpretation})}}]),r}(g);(0,p._)([(0,v.Cb)({json:{write:!0}})],He.prototype,"includedRanges",void 0),(0,p._)([(0,v.Cb)({json:{write:!0}})],He.prototype,"noDataValues",void 0),(0,p._)([(0,v.Cb)()],He.prototype,"normalizedNoDataValues",null),(0,p._)([(0,v.Cb)({json:{write:!0}})],He.prototype,"noDataInterpretation",void 0);var Je=He=We=(0,p._)([(0,d.j)("esri.layers.support.rasterFunctions.MaskFunctionArguments")],He),$e=function(t){(0,l.Z)(r,t);var e=(0,c.Z)(r);function r(){var t;return(0,s.Z)(this,r),(t=e.apply(this,arguments)).functionName="Mask",t.functionArguments=null,t.rasterArgumentNames=["raster"],t}return(0,u.Z)(r,[{key:"_bindSourceRasters",value:function(){var t=this.sourceRasterInfos[0].clone(),e=t.pixelType;this.outputPixelType=this._getOutputPixelType(e),t.pixelType=this.outputPixelType,this.rasterInfo=t;var r=this.functionArguments,n=r.includedRanges,i=r.normalizedNoDataValues;if((null===n||void 0===n||!n.length)&&(null===i||void 0===i||!i.length))return{success:!1,supportsGPU:!1,error:"missing includedRanges or noDataValues argument"};for(var a=[],o=0;o<t.bandCount;o++){var s=(0,G.nA)(e,null===n||void 0===n?void 0:n.slice(2*o,2*o+2),null===i||void 0===i?void 0:i[o]);if(null==s){a=null;break}a.push(s)}this.lookups=a;var u=null!=i&&i.every((function(t){var e;return(null===t||void 0===t?void 0:t.length)===(null===(e=i[0])||void 0===e?void 0:e.length)}));return{success:!0,supportsGPU:(!n||n.length<=2*G.hd)&&(!i||u&&i[0].length<=G.hd)}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if((0,f.Wi)(r))return null;var n=this.outputPixelType,i=this.lookups,a=this.functionArguments,o=a.includedRanges,s=a.noDataInterpretation,u=a.normalizedNoDataValues,l=s===G.DX.matchAll;return(0,G.sS)(r,{includedRanges:o,noDataValues:u,outputPixelType:n,matchAll:l,lookups:i})}},{key:"_getWebGLParameters",value:function(){var t,e=this.functionArguments,r=e.includedRanges,n=e.normalizedNoDataValues,i=new Float32Array(G.hd);i.fill(Xe._3),(null===n||void 0===n||null===(t=n[0])||void 0===t?void 0:t.length)&&i.set(n[0]);for(var a=new Float32Array(G.hd),o=0;o<a.length;o+=2){var s,u;a[o]=null!==(s=null===r||void 0===r?void 0:r[o])&&void 0!==s?s:-Xe._3,a[o+1]=null!==(u=null===r||void 0===r?void 0:r[o+1])&&void 0!==u?u:Xe._3}return r&&r.length&&a.set(r),{bandCount:this.sourceRasterInfos[0].bandCount,noDataValues:i,includedRanges:a}}}]),r}(k);(0,p._)([(0,v.Cb)({json:{write:!0,name:"rasterFunction"}})],$e.prototype,"functionName",void 0),(0,p._)([(0,v.Cb)({type:Je,json:{write:!0,name:"rasterFunctionArguments"}})],$e.prototype,"functionArguments",void 0),(0,p._)([(0,v.Cb)()],$e.prototype,"rasterArgumentNames",void 0),(0,p._)([(0,v.Cb)({json:{write:!0}})],$e.prototype,"lookups",void 0);var Ye,Ke=$e=(0,p._)([(0,d.j)("esri.layers.support.rasterFunctions.MaskFunction")],$e),Qe=Ye=function(t){(0,l.Z)(r,t);var e=(0,c.Z)(r);function r(){var t;return(0,s.Z)(this,r),(t=e.apply(this,arguments)).visibleBandID=0,t.infraredBandID=1,t.scientificOutput=!1,t}return(0,u.Z)(r,[{key:"clone",value:function(){var t=this.visibleBandID,e=this.infraredBandID,r=this.scientificOutput;return new Ye({visibleBandID:t,infraredBandID:e,scientificOutput:r})}}]),r}(g);(0,p._)([(0,v.Cb)({json:{write:!0}})],Qe.prototype,"visibleBandID",void 0),(0,p._)([(0,v.Cb)({json:{write:!0}})],Qe.prototype,"infraredBandID",void 0),(0,p._)([(0,v.Cb)({json:{write:!0}})],Qe.prototype,"scientificOutput",void 0);var tr=Qe=Ye=(0,p._)([(0,d.j)("esri.layers.support.rasterFunctions.NDVIFunctionArguments")],Qe),er=function(t){(0,l.Z)(r,t);var e=(0,c.Z)(r);function r(){var t;return(0,s.Z)(this,r),(t=e.apply(this,arguments)).functionName="NDVI",t.functionArguments=null,t.rasterArgumentNames=["raster"],t}return(0,u.Z)(r,[{key:"_bindSourceRasters",value:function(){var t=this.functionArguments.scientificOutput;this.outputPixelType=this._getOutputPixelType(t?"f32":"u8");var e=this.sourceRasterInfos[0].clone();e.pixelType=this.outputPixelType,e.colormap=null,e.histograms=null,e.bandCount=1;var r=t?[-1,1,0,.1]:[0,200,100,10],n=(0,R.Z)(r,4),i=n[0],a=n[1],o=n[2],s=n[3];return e.statistics=[{min:i,max:a,avg:o,stddev:s}],this.rasterInfo=e,{success:!0,supportsGPU:!0}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if((0,f.Wi)(r))return null;var n=this.functionArguments;return function(t,e,r,n){for(var i=t.mask,a=t.pixels,o=t.width,s=t.height,u=a[r],l=a[e],c=l.length,p=n?new Uint8Array(c):new Float32Array(c),f=n?100:1,v=n?100.5:0,d=0;d<c;d++)if(null==i||i[d]){var h=u[d],m=l[d],y=h+m;y&&(p[d]=(h-m)/y*f+v)}var g=new _.Z({width:o,height:s,mask:i,pixelType:n?"u8":"f32",pixels:[p]});return g.updateStatistics(),g}(r,n.visibleBandID,n.infraredBandID,!n.scientificOutput)}},{key:"_getWebGLParameters",value:function(){var t=this.functionArguments,e=t.visibleBandID,r=t.infraredBandID,n=t.scientificOutput;return{bandIndexMat3:V(this.isInputBandIdsSwizzled?[0,1,2]:[r,e,0]),scaled:!n}}},{key:"_getInputBandIds",value:function(t){var e=this.functionArguments,r=e.visibleBandID;return[e.infraredBandID,r,0].map((function(e){return t[e]}))}}]),r}(k);(0,p._)([(0,v.Cb)({json:{write:!0,name:"rasterFunction"}})],er.prototype,"functionName",void 0),(0,p._)([(0,v.Cb)({type:tr,json:{write:!0,name:"rasterFunctionArguments"}})],er.prototype,"functionArguments",void 0),(0,p._)([(0,v.Cb)()],er.prototype,"rasterArgumentNames",void 0);var rr,nr=er=(0,p._)([(0,d.j)("esri.layers.support.rasterFunctions.NDVIFunction")],er),ir=rr=function(t){(0,l.Z)(r,t);var e=(0,c.Z)(r);function r(){var t;return(0,s.Z)(this,r),(t=e.apply(this,arguments)).inputRanges=null,t.outputValues=null,t.noDataRanges=null,t.allowUnmatched=!1,t.isLastInputRangeInclusive=!1,t}return(0,u.Z)(r,[{key:"clone",value:function(){return new rr({inputRanges:(0,x.Z)(this.inputRanges),outputValues:(0,x.Z)(this.outputValues),noDataRanges:(0,x.Z)(this.noDataRanges),allowUnmatched:this.allowUnmatched,isLastInputRangeInclusive:this.isLastInputRangeInclusive})}}]),r}(g);(0,p._)([(0,v.Cb)({json:{write:!0}})],ir.prototype,"inputRanges",void 0),(0,p._)([(0,v.Cb)({json:{write:!0}})],ir.prototype,"outputValues",void 0),(0,p._)([(0,v.Cb)({json:{write:!0}})],ir.prototype,"noDataRanges",void 0),(0,p._)([(0,v.Cb)({json:{write:!0}})],ir.prototype,"allowUnmatched",void 0),(0,p._)([(0,v.Cb)({json:{write:!0}})],ir.prototype,"isLastInputRangeInclusive",void 0);var ar=ir=rr=(0,p._)([(0,d.j)("esri.layers.support.rasterFunctions.RemapFunctionArguments")],ir),or=function(t){(0,l.Z)(r,t);var e=(0,c.Z)(r);function r(){var t;return(0,s.Z)(this,r),(t=e.apply(this,arguments)).functionName="Remap",t.functionArguments=null,t.rasterArgumentNames=["raster"],t.lookup=null,t}return(0,u.Z)(r,[{key:"_bindSourceRasters",value:function(){var t=this.sourceRasterInfos[0].clone(),e=t.pixelType;this.outputPixelType=this._getOutputPixelType(e),t.pixelType=this.outputPixelType,t.colormap=null,t.histograms=null,t.bandCount=1,t.attributeTable=null;var r=t.statistics,i=this.functionArguments,a=i.allowUnmatched,o=i.outputValues,s=i.inputRanges,u=i.noDataRanges,l=i.isLastInputRangeInclusive;if((0,f.pC)(r)&&r.length&&null!==o&&void 0!==o&&o.length)if(a){var c=Math.min.apply(null,[].concat((0,x.Z)(o),[r[0].min])),p=Math.max.apply(null,[].concat((0,x.Z)(o),[r[0].max]));t.statistics=[(0,n.Z)((0,n.Z)({},r[0]),{},{min:c,max:p})]}else{for(var v=o[0],d=v,h=0;h<o.length;h++)v=v>o[h]?o[h]:v,d=d>o[h]?d:o[h];t.statistics=[(0,n.Z)((0,n.Z)({},r[0]),{},{min:v,max:d})]}return this.rasterInfo=t,this.lookup=a?null:(0,G.oB)({srcPixelType:e,inputRanges:s,outputValues:o,noDataRanges:u,allowUnmatched:a,isLastInputRangeInclusive:l,outputPixelType:this.outputPixelType}),{success:!0,supportsGPU:(!o||o.length<=G.hd)&&(!u||u.length<=G.hd)}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if((0,f.Wi)(r))return null;var n=this.lookup,i=this.outputPixelType;if(n){var a=(0,G.XV)(r,{lut:[n.lut],offset:n.offset,outputPixelType:i});return(0,f.pC)(a)&&n.mask&&(a.mask=(0,G.wV)(r.pixels[0],r.mask,n.mask,n.offset,"u8")),a}var o=this.functionArguments,s=o.inputRanges,u=o.outputValues,l=o.noDataRanges,c=o.allowUnmatched,p=o.isLastInputRangeInclusive;return(0,G.a2)(r,{inputRanges:s,outputValues:u,noDataRanges:l,outputPixelType:i,allowUnmatched:c,isLastInputRangeInclusive:p})}},{key:"_getWebGLParameters",value:function(){var t=this.functionArguments,e=t.allowUnmatched,r=t.inputRanges,n=t.outputValues,i=t.noDataRanges,a=t.isLastInputRangeInclusive,o=new Float32Array(3*G.hd),s=1e-5,u=n.length;if(null!==r&&void 0!==r&&r.length)for(var l=0,c=0,p=0;p<o.length;p+=3){var f,v,d;o[p]=null!==(f=r[l++])&&void 0!==f?f:Xe._3-1,o[p+1]=null!==(v=r[l++])&&void 0!==v?v:Xe._3,o[p+2]=null!==(d=n[c++])&&void 0!==d?d:0,c<=u&&(p>0&&(o[p]-=s),(c<u||!a)&&(o[p+1]-=s))}var h=new Float32Array(2*G.hd);return h.fill(Xe._3),(null===i||void 0===i?void 0:i.length)&&h.set(i),{allowUnmatched:e,rangeMaps:o,noDataRanges:h,clampRange:(0,bt.r)(this.outputPixelType)}}}]),r}(k);(0,p._)([(0,v.Cb)({json:{write:!0,name:"rasterFunction"}})],or.prototype,"functionName",void 0),(0,p._)([(0,v.Cb)({type:ar,json:{write:!0,name:"rasterFunctionArguments"}})],or.prototype,"functionArguments",void 0),(0,p._)([(0,v.Cb)()],or.prototype,"rasterArgumentNames",void 0),(0,p._)([(0,v.Cb)({json:{write:!0}})],or.prototype,"lookup",void 0);var sr,ur=or=(0,p._)([(0,d.j)("esri.layers.support.rasterFunctions.RemapFunction")],or),lr=new T.X({1:"degree",2:"percent-rise",3:"adjusted"},{useNumericKeys:!0}),cr=sr=function(t){(0,l.Z)(r,t);var e=(0,c.Z)(r);function r(){var t;return(0,s.Z)(this,r),(t=e.apply(this,arguments)).slopeType="degree",t.zFactor=1,t.pixelSizePower=.664,t.pixelSizeFactor=.024,t.removeEdgeEffect=!1,t}return(0,u.Z)(r,[{key:"clone",value:function(){return new sr({slopeType:this.slopeType,zFactor:this.zFactor,pixelSizePower:this.pixelSizePower,pixelSizeFactor:this.pixelSizeFactor,removeEdgeEffect:this.removeEdgeEffect,raster:this.raster})}}]),r}(g);(0,p._)([(0,N.J)(lr)],cr.prototype,"slopeType",void 0),(0,p._)([(0,v.Cb)({type:Number,json:{write:!0}})],cr.prototype,"zFactor",void 0),(0,p._)([(0,v.Cb)({type:Number,json:{name:"psPower",write:!0}})],cr.prototype,"pixelSizePower",void 0),(0,p._)([(0,v.Cb)({type:Number,json:{name:"psZFactor",write:!0}})],cr.prototype,"pixelSizeFactor",void 0),(0,p._)([(0,v.Cb)({type:Boolean,json:{write:!0}})],cr.prototype,"removeEdgeEffect",void 0);var pr=cr=sr=(0,p._)([(0,d.j)("esri.layers.support.rasterFunctions.SlopeFunctionArguments")],cr),fr=function(t){(0,l.Z)(r,t);var e=(0,c.Z)(r);function r(){var t;return(0,s.Z)(this,r),(t=e.apply(this,arguments)).functionName="Slope",t.functionArguments=null,t.rasterArgumentNames=["raster"],t.isGCS=!1,t}return(0,u.Z)(r,[{key:"_bindSourceRasters",value:function(){var t,e;this.outputPixelType=this._getOutputPixelType("f32");var r=this.sourceRasterInfos[0].clone();return r.pixelType=this.outputPixelType,r.statistics="percent-rise"!==this.functionArguments.slopeType?[{min:0,max:90,avg:1,stddev:1}]:null,r.histograms=null,r.colormap=null,r.attributeTable=null,r.bandCount=1,this.rasterInfo=r,this.isGCS=null!==(t=null===(e=r.spatialReference)||void 0===e?void 0:e.isGeographic)&&void 0!==t&&t,{success:!0,supportsGPU:!0}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if((0,f.Wi)(r))return null;var n=this.functionArguments,i=n.zFactor,a=n.slopeType,o=n.pixelSizePower,s=n.pixelSizeFactor,u=this.isGCS,l=t.extent,c=l?{x:l.width/r.width,y:l.height/r.height}:{x:1,y:1};return(0,I.yg)(r,{zFactor:i,slopeType:a,pixelSizePower:o,pixelSizeFactor:s,isGCS:u,resolution:c})}},{key:"_getWebGLParameters",value:function(){var t=this.functionArguments,e=t.zFactor,r=t.slopeType,n=t.pixelSizeFactor,i=t.pixelSizePower;return{zFactor:this.isGCS&&e>=1?900900900900901e-20*e:e,slopeType:r,pixelSizeFactor:null!==n&&void 0!==n?n:0,pixelSizePower:null!==i&&void 0!==i?i:0}}}]),r}(k);(0,p._)([(0,v.Cb)({json:{write:!0,name:"rasterFunction"}})],fr.prototype,"functionName",void 0),(0,p._)([(0,v.Cb)({type:pr,json:{write:!0,name:"rasterFunctionArguments"}})],fr.prototype,"functionArguments",void 0),(0,p._)([(0,v.Cb)()],fr.prototype,"rasterArgumentNames",void 0),(0,p._)([(0,v.Cb)({json:{write:!0}})],fr.prototype,"isGCS",void 0);var vr,dr=fr=(0,p._)([(0,d.j)("esri.layers.support.rasterFunctions.SlopeFunction")],fr),hr=vr=function(t){(0,l.Z)(r,t);var e=(0,c.Z)(r);function r(){var t;return(0,s.Z)(this,r),(t=e.apply(this,arguments)).statistics=null,t.histograms=null,t}return(0,u.Z)(r,[{key:"readStatistics",value:function(t,e){if(null===t||void 0===t||!t.length)return null;var r=[];return t.forEach((function(t){var e,n,i={min:t.min,max:t.max,avg:null!==(e=t.avg)&&void 0!==e?e:t.mean,stddev:null!==(n=t.stddev)&&void 0!==n?n:t.standardDeviation};r.push(i)})),r}},{key:"writeStatistics",value:function(t,e,r){if(null!==t&&void 0!==t&&t.length){var i=[];t.forEach((function(t){var e=(0,n.Z)((0,n.Z)({},t),{},{mean:t.avg,standardDeviation:t.stddev});delete e.avg,delete e.stddev,i.push(e)})),e[r]=i}}},{key:"clone",value:function(){return new vr({statistics:(0,o.d9)(this.statistics),histograms:(0,o.d9)(this.histograms)})}}]),r}(g);(0,p._)([(0,v.Cb)({json:{write:!0}})],hr.prototype,"statistics",void 0),(0,p._)([(0,$.r)("statistics")],hr.prototype,"readStatistics",null),(0,p._)([(0,ut.c)("statistics")],hr.prototype,"writeStatistics",null),(0,p._)([(0,v.Cb)({json:{write:!0}})],hr.prototype,"histograms",void 0);var mr=hr=vr=(0,p._)([(0,d.j)("esri.layers.support.rasterFunctions.StatisticsHistogramFunctionArguments")],hr),yr=function(t){(0,l.Z)(r,t);var e=(0,c.Z)(r);function r(){var t;return(0,s.Z)(this,r),(t=e.apply(this,arguments)).functionName="StatisticsHistogram",t.functionArguments=null,t.rasterArgumentNames=["raster"],t.isNoopProcess=!0,t}return(0,u.Z)(r,[{key:"_bindSourceRasters",value:function(){var t=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType("u8");var e=t.clone(),r=this.functionArguments,n=r.statistics,i=r.histograms;return i&&(e.histograms=i),n&&(e.statistics=n),this.rasterInfo=e,{success:!0,supportsGPU:!0}}},{key:"_processPixels",value:function(t){var e;return null===(e=t.pixelBlocks)||void 0===e?void 0:e[0]}}]),r}(k);(0,p._)([(0,v.Cb)({json:{write:!0,name:"rasterFunction"}})],yr.prototype,"functionName",void 0),(0,p._)([(0,v.Cb)({type:mr,json:{write:!0,name:"rasterFunctionArguments"}})],yr.prototype,"functionArguments",void 0),(0,p._)([(0,v.Cb)()],yr.prototype,"rasterArgumentNames",void 0),(0,p._)([(0,v.Cb)({json:{write:!0}})],yr.prototype,"indexedColormap",void 0),(0,p._)([(0,v.Cb)()],yr.prototype,"isNoopProcess",void 0);var gr,br=yr=(0,p._)([(0,d.j)("esri.layers.support.rasterFunctions.StatisticsHistogramFunction")],yr),wr=new T.X({0:"none",3:"standard-deviation",4:"histogram-equalization",5:"min-max",6:"percent-clip",9:"sigmoid"},{useNumericKeys:!0}),xr=gr=function(t){(0,l.Z)(r,t);var e=(0,c.Z)(r);function r(){var t;return(0,s.Z)(this,r),(t=e.apply(this,arguments)).computeGamma=!1,t.dynamicRangeAdjustment=!1,t.gamma=[],t.histograms=null,t.statistics=null,t.stretchType="none",t.useGamma=!1,t}return(0,u.Z)(r,[{key:"writeStatistics",value:function(t,e,r){var n;(null===(n=t)||void 0===n?void 0:n.length)&&(Array.isArray(t[0])||(t=t.map((function(t){return[t.min,t.max,t.avg,t.stddev]}))),e[r]=t)}},{key:"clone",value:function(){return new gr({stretchType:this.stretchType,outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:(0,o.d9)(this.statistics),gamma:(0,o.d9)(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,numberOfStandardDeviations:this.numberOfStandardDeviations,minPercent:this.minPercent,maxPercent:this.maxPercent,histograms:(0,o.d9)(this.histograms),dynamicRangeAdjustment:this.dynamicRangeAdjustment,raster:this.raster})}}]),r}(g);(0,p._)([(0,v.Cb)({type:Boolean,json:{write:!0}})],xr.prototype,"computeGamma",void 0),(0,p._)([(0,v.Cb)({type:Boolean,json:{name:"dra",write:!0}})],xr.prototype,"dynamicRangeAdjustment",void 0),(0,p._)([(0,v.Cb)({type:[Number],json:{write:!0}})],xr.prototype,"gamma",void 0),(0,p._)([(0,v.Cb)()],xr.prototype,"histograms",void 0),(0,p._)([(0,v.Cb)({type:Number,json:{write:!0}})],xr.prototype,"maxPercent",void 0),(0,p._)([(0,v.Cb)({type:Number,json:{write:!0}})],xr.prototype,"minPercent",void 0),(0,p._)([(0,v.Cb)({type:Number,json:{write:!0}})],xr.prototype,"numberOfStandardDeviations",void 0),(0,p._)([(0,v.Cb)({type:Number,json:{name:"max",write:!0}})],xr.prototype,"outputMax",void 0),(0,p._)([(0,v.Cb)({type:Number,json:{name:"min",write:!0}})],xr.prototype,"outputMin",void 0),(0,p._)([(0,v.Cb)({type:Number,json:{write:!0}})],xr.prototype,"sigmoidStrengthLevel",void 0),(0,p._)([(0,v.Cb)({json:{type:[[Number]],write:!0}})],xr.prototype,"statistics",void 0),(0,p._)([(0,ut.c)("statistics")],xr.prototype,"writeStatistics",null),(0,p._)([(0,N.J)(wr)],xr.prototype,"stretchType",void 0),(0,p._)([(0,v.Cb)({type:Boolean,json:{write:!0}})],xr.prototype,"useGamma",void 0);var Zr=xr=gr=(0,p._)([(0,d.j)("esri.layers.support.rasterFunctions.StretchFunctionArguments")],xr),_r=r(21449),Cr=function(t){(0,l.Z)(r,t);var e=(0,c.Z)(r);function r(){var t;return(0,s.Z)(this,r),(t=e.apply(this,arguments)).functionName="Stretch",t.functionArguments=null,t.rasterArgumentNames=["raster"],t.lookup=null,t.cutOffs=null,t}return(0,u.Z)(r,[{key:"_bindSourceRasters",value:function(){this.lookup=null,this.cutOffs=null;var t=this.sourceRasterInfos[0],e=t.pixelType,r=this.functionArguments,i=r.dynamicRangeAdjustment,a=r.gamma,o=r.useGamma;if(!i&&["u8","u16","s8","s16"].includes(e)){var s=(0,_r.AV)(r.toJSON(),{rasterInfo:t}),u=this._isOutputRoundingNeeded()?"round":"float";this.lookup=(0,_r.hE)((0,n.Z)((0,n.Z)({pixelType:e},s),{},{gamma:o?a:null,rounding:u})),this.cutOffs=s}else i||(this.cutOffs=(0,_r.AV)(r.toJSON(),{rasterInfo:t}));this.outputPixelType=this._getOutputPixelType(e);var l=t.clone();return l.pixelType=this.outputPixelType,l.statistics=null,l.histograms=null,l.colormap=null,l.attributeTable=null,"u8"===this.outputPixelType&&(l.keyProperties.DataType="processed"),this.rasterInfo=l,{success:!0,supportsGPU:!i}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if((0,f.Wi)(r))return r;var i=this.lookup;if(i)return(0,G.XV)(r,(0,n.Z)((0,n.Z)({},i),{},{outputPixelType:this.rasterInfo.pixelType}));var a=this.functionArguments,o=this.cutOffs||(0,_r.AV)(a.toJSON(),{rasterInfo:this.sourceRasterInfos[0],pixelBlock:r}),s=a.useGamma?a.gamma:null;return(0,_r.dy)(r,(0,n.Z)((0,n.Z)({},o),{},{gamma:s,outputPixelType:this.outputPixelType}))}},{key:"_getWebGLParameters",value:function(){var t,e=this.functionArguments,r=e.outputMin,n=void 0===r?0:r,i=e.outputMax,a=void 0===i?255:i,o=e.gamma,s=e.useGamma,u=this.rasterInfo.bandCount>=2?3:1,l=s&&o&&o.length?(0,_r.um)(u,o):[1,1,1],c=null!==(t=this.cutOffs)&&void 0!==t?t:{minCutOff:[0,0,0],maxCutOff:[255,255,255]},p=c.minCutOff,f=c.maxCutOff;1===p.length&&(p[1]=p[2]=p[0],f[1]=f[2]=f[0]);var v,d=new Float32Array(u);for(v=0;v<u;v++)d[v]=(a-n)/(f[v]-p[v]);var h=this._isOutputRoundingNeeded();return{bandCount:u,outMin:n,outMax:a,minCutOff:p,maxCutOff:f,factor:d,useGamma:s,gamma:s&&o?o:[1,1,1],gammaCorrection:s&&l?l:[1,1,1],stretchType:this.functionArguments.stretchType,isOutputRounded:h,type:"stretch"}}}]),r}(k);(0,p._)([(0,v.Cb)({json:{write:!0,name:"rasterFunction"}})],Cr.prototype,"functionName",void 0),(0,p._)([(0,v.Cb)({type:Zr,json:{write:!0,name:"rasterFunctionArguments"}})],Cr.prototype,"functionArguments",void 0),(0,p._)([(0,v.Cb)()],Cr.prototype,"rasterArgumentNames",void 0),(0,p._)([(0,v.Cb)({json:{write:!0}})],Cr.prototype,"lookup",void 0),(0,p._)([(0,v.Cb)({json:{write:!0}})],Cr.prototype,"cutOffs",void 0);var Ar=Cr=(0,p._)([(0,d.j)("esri.layers.support.rasterFunctions.StretchFunction")],Cr),kr=new Map;function Ir(t,e){var r=t.rasterFunctionArguments;r&&(r.rasters||[r.raster]).forEach((function(t){t&&"number"!=typeof t&&("string"==typeof t?t.startsWith("http")&&(e.includes(t)||e.push(t)):"rasterFunctionArguments"in t&&Ir(t,e))}))}function Fr(t,e){var r;if(e=null!==(r=e)&&void 0!==r?r:{},"function"in(t=(0,o.d9)(t))&&"arguments"in t&&t.arguments&&(t=function(t,e){e&&Tr(t,e);var r={};return Sr(t,r),r}(t,e)),"rasterFunction"in t)return Rr(t=Nr(t),e);throw new a.Z("raster-function-helper","unsupported raster function json.")}function Pr(t){return!!(t&&"object"==typeof t&&t.rasterFunction&&t.rasterFunctionArguments)}function Nr(t){var e,r=t.rasterFunction,i=t.rasterFunctionArguments,a={};for(var o in i){var s=i[o],u=o.toLowerCase();if("rasters"===u&&Array.isArray(s))a.rasters=s.map((function(t){return Pr(t)?Nr(t):t}));else switch(Pr(s)&&(s=Nr(s)),u){case"dra":a.dra=s;break;case"pspower":a.psPower=s;break;case"pszfactor":a.psZFactor=s;break;case"bandids":a.bandIds=s;break;default:a[o[0].toLowerCase()+o.slice(1)]=s}}return"Local"!==r||null!==(e=a.rasters)&&void 0!==e&&e.length||(a.rasters=["$$"]),(0,n.Z)((0,n.Z)({},t),{},{rasterFunctionArguments:a})}function Rr(t,e){var r,i=t.rasterFunction,o=t.rasterFunctionArguments,s=null===(r=t.outputPixelType)||void 0===r?void 0:r.toLowerCase();if(null==i||!kr.has(i))throw new a.Z("raster-function-helper","unsupported raster function: ".concat(i));for(var u=kr.get(i),l=("function"==typeof u.ctor?u.ctor:u.ctor.default).fromJSON((0,n.Z)((0,n.Z)({},t),{},{outputPixelType:s})),c=l.rasterArgumentNames,p=[],f=function(t,e){return"rasters"===e[0]&&Array.isArray(t.rasters)?t.rasters:e.map((function(e){return t[e]}))}(o,c),v="rasters"===c[0],d=[],h=0;h<f.length;h++){var m,y=f[h],g=void 0;null==y||"string"==typeof y&&y.startsWith("$")?p.push(null===e||void 0===e?void 0:e.raster):"string"==typeof y?e[y]&&p.push(e[y]):"number"!=typeof y&&"rasterFunction"in y&&(g=Rr(y,e),v||(l.functionArguments[c[h]]=g),p.push(g)),v&&d.push(null!==(m=g)&&void 0!==m?m:y)}if(v&&(l.functionArguments.rasters=d),e){var b;l.sourceRasters=p;var w=null===(b=e.raster)||void 0===b?void 0:b.url;w&&(l.mainPrimaryRasterId=w)}return l}function Tr(t,e){if(t&&e)for(var r in t){var n=t[r];n&&"object"==typeof n&&(n.function&&n.arguments?Tr(n.arguments,e):"RasterFunctionVariable"===n.type&&null!=e[n.name]&&(n.value=e[n.name]))}}function jr(t){var e;if(!t||"object"!=typeof t)return t;if(Array.isArray(t)&&0===t.length)return 0===t.length?null:["number","string"].includes(typeof t[0])?t:t.map((function(t){return jr(t)}));if("value"in t&&["number","string","boolean"].includes(typeof t.value))return t.value;if(!("type"in t))return t;switch(t.type){case"Scalar":return t.value;case"AlgorithmicColorRamp":return Br(t);case"MultiPartColorRamp":return{type:"multipart",colorRamps:t.ArrayOfColorRamp.map(Br)};case"ArgumentArray":return null!==(e=t.elements)&&void 0!==e&&e.length?"RasterStatistics"===t.elements[0].type?t.elements:"RasterFunctionVariable"===t.elements[0].type?t.elements.map((function(t){return null!=t.value?jr(t.value):t.name.toLowerCase().includes("raster")?"$$":null})):t:t.elements;default:return t}}function Br(t){var e,r=null!==(e=t.algorithm)&&void 0!==e?e:"esriHSVAlgorithm",n=t.FromColor,a=t.ToColor;if(!Array.isArray(n)){var o=(0,i.xr)({h:n.Hue,s:n.Saturation,v:n.Value});n=[o.r,o.g,o.b,n.AlphaValue]}if(!Array.isArray(a)){var s=(0,i.xr)({h:a.Hue,s:a.Saturation,v:a.Value});a=[s.r,s.g,s.b,a.AlphaValue]}return{type:"algorithmic",algorithm:r,fromColor:n,toColor:a}}function Sr(t,e){if(t&&e){var r=t.function,n=t.arguments;if(r&&n){e.rasterFunction=r.type.replace("Function",""),e.outputPixelType=r.pixelType;var i={};for(var a in e.rasterFunctionArguments=i,n){var o=n[a];"object"==typeof o&&("function"in o&&o.function&&o.arguments?(e.rasterFunctionArguments[a]={},Sr(o,e.rasterFunctionArguments[a])):"value"in o&&(i[a]=jr(o.value)))}switch(i.DEM&&!i.Raster&&(i.Raster=i.DEM,delete i.DEM),e.rasterFunction){case"Stretch":!function(t){var e;null!==(e=t.Statistics)&&void 0!==e&&e.length&&"object"==typeof t.Statistics&&(t.Statistics=t.Statistics.map((function(t){return[t.min,t.max,t.mean,t.standardDeviation]}))),null!=t.NumberOfStandardDeviation&&(t.NumberOfStandardDeviations=t.NumberOfStandardDeviation,delete t.NumberOfStandardDeviation)}(i);break;case"Colormap":!function(t){var e,r;"randomcolorramp"===(null===(e=t.ColorRamp)||void 0===e||null===(r=e.type)||void 0===r?void 0:r.toLowerCase())&&(delete t.ColorRamp,t.ColormapName="Random"),0===t.ColorSchemeType&&delete t.ColorRamp}(i);break;case"Convolution":!function(t){null!=t.ConvolutionType&&(t.Type=t.ConvolutionType,delete t.ConvolutionType)}(i);break;case"Mask":!function(t){var e;(null===(e=t.NoDataValues)||void 0===e?void 0:e.length)&&"string"==typeof t.NoDataValues[0]&&(t.NoDataValues=t.NoDataValues.filter((function(t){return""!==t})).map((function(t){return Number(t)})))}(i)}}}}kr.set("Aspect",{desc:"Aspect Function",ctor:P,rasterArgumentNames:["raster"]}),kr.set("BandArithmetic",{desc:"Band Arithmetic Function",ctor:J,rasterArgumentNames:["raster"]}),kr.set("Colormap",{desc:"Colormap Function",ctor:st,rasterArgumentNames:["raster"]}),kr.set("CompositeBand",{desc:"CompositeBand Function",ctor:vt,rasterArgumentNames:["rasters"]}),kr.set("Convolution",{desc:"Convolution Function",ctor:Pt,rasterArgumentNames:["raster"]}),kr.set("ExtractBand",{desc:"ExtractBand Function",ctor:Bt,rasterArgumentNames:["raster"]}),kr.set("Local",{desc:"Local Function",ctor:qe,rasterArgumentNames:["rasters"]}),kr.set("Mask",{desc:"Mask Function",ctor:Ke,rasterArgumentNames:["raster"]}),kr.set("NDVI",{desc:"NDVI Function",ctor:nr,rasterArgumentNames:["raster"]}),kr.set("Remap",{desc:"Remap Function",ctor:ur,rasterArgumentNames:["raster"]}),kr.set("Slope",{desc:"Slope Function",ctor:dr,rasterArgumentNames:["raster"]}),kr.set("StatisticsHistogram",{desc:"Statistics Histogram Function",ctor:br,rasterArgumentNames:["raster"]}),kr.set("Stretch",{desc:"Stretch Function",ctor:Ar,rasterArgumentNames:["raster"]})},32935:function(t,e,r){r.d(e,{Z:function(){return f}});var n=r(15671),i=r(43144),a=r(60136),o=r(92572),s=r(27366),u=r(46784),l=r(49861),c=(r(25243),r(63780),r(69912)),p=function(t){(0,a.Z)(r,t);var e=(0,o.Z)(r);function r(){return(0,n.Z)(this,r),e.apply(this,arguments)}return(0,i.Z)(r,[{key:"affectsPixelSize",get:function(){return!1}},{key:"forwardTransform",value:function(t){return t}},{key:"inverseTransform",value:function(t){return t}}]),r}(u.wq);(0,s._)([(0,l.Cb)()],p.prototype,"affectsPixelSize",null),(0,s._)([(0,l.Cb)({json:{write:!0}})],p.prototype,"spatialReference",void 0);var f=p=(0,s._)([(0,c.j)("esri.layers.support.rasterTransforms.BaseRasterTransform")],p)},3089:function(t,e,r){r.d(e,{Z:function(){return f}});var n=r(15671),i=r(43144),a=r(60136),o=r(92572),s=r(27366),u=r(49861),l=(r(25243),r(63780),r(27135)),c=r(69912),p=function(t){(0,a.Z)(r,t);var e=(0,o.Z)(r);function r(){var t;return(0,n.Z)(this,r),(t=e.apply(this,arguments)).type="gcs-shift",t.tolerance=1e-8,t}return(0,i.Z)(r,[{key:"forwardTransform",value:function(t){return"point"===(t=t.clone()).type?(t.x>180+this.tolerance&&(t.x-=360),t):(t.xmin>=180-this.tolerance?(t.xmax-=360,t.xmin-=360):t.xmax>180+this.tolerance&&(t.xmin=-180,t.xmax=180),t)}},{key:"inverseTransform",value:function(t){return"point"===(t=t.clone()).type?(t.x<-this.tolerance&&(t.x+=360),t):(t.xmin<-this.tolerance&&(t.xmin+=360,t.xmax+=360),t)}}]),r}(r(32935).Z);(0,s._)([(0,l.J)({GCSShiftXform:"gcs-shift"})],p.prototype,"type",void 0),(0,s._)([(0,u.Cb)()],p.prototype,"tolerance",void 0);var f=p=(0,s._)([(0,c.j)("esri.layers.support.rasterTransforms.GCSShiftTransform")],p)},69405:function(t,e,r){r.d(e,{Z:function(){return w}});var n=r(15671),i=r(43144),a=r(60136),o=r(92572),s=r(29439),u=r(27366),l=(r(59486),r(49861)),c=(r(25243),r(63780),r(27135)),p=r(38511),f=r(69912),v=r(31201),d=r(32935),h=r(585),m=r(53866);function y(t,e,r){var n=e.x,i=e.y;if(r<2)return{x:t[0]+n*t[2]+i*t[4],y:t[1]+n*t[3]+i*t[5]};if(2===r){var a=n*n,o=i*i,s=n*i;return{x:t[0]+n*t[2]+i*t[4]+a*t[6]+s*t[8]+o*t[10],y:t[1]+n*t[3]+i*t[5]+a*t[7]+s*t[9]+o*t[11]}}var u=n*n,l=i*i,c=n*i,p=u*n,f=u*i,v=n*l,d=i*l;return{x:t[0]+n*t[2]+i*t[4]+u*t[6]+c*t[8]+l*t[10]+p*t[12]+f*t[14]+v*t[16]+d*t[18],y:t[1]+n*t[3]+i*t[5]+u*t[7]+c*t[9]+l*t[11]+p*t[13]+f*t[15]+v*t[17]+d*t[19]}}function g(t,e,r){var n=e.xmin,i=e.ymin,a=e.xmax,o=e.ymax,s=e.spatialReference,u=[];if(r<2)u.push({x:n,y:o}),u.push({x:a,y:o}),u.push({x:n,y:i}),u.push({x:a,y:i});else{for(var l=10,c=0;c<l;c++)u.push({x:n,y:i+(o-i)*c/(l-1)}),u.push({x:a,y:i+(o-i)*c/(l-1)});l=8;for(var p=1;p<=l;p++)u.push({x:n+(a-n)*p/l,y:i}),u.push({x:n+(a-n)*p/l,y:o})}u=u.map((function(e){return y(t,e,r)}));var f=u.map((function(t){return t.x})),v=u.map((function(t){return t.y}));return new m.Z({xmin:Math.min.apply(null,f),xmax:Math.max.apply(null,f),ymin:Math.min.apply(null,v),ymax:Math.max.apply(null,v),spatialReference:s})}var b=function(t){(0,a.Z)(r,t);var e=(0,o.Z)(r);function r(){var t;return(0,n.Z)(this,r),(t=e.apply(this,arguments)).polynomialOrder=1,t.type="polynomial",t}return(0,i.Z)(r,[{key:"readForwardCoefficients",value:function(t,e){var r=e.coeffX,n=e.coeffY;if(null===r||void 0===r||!r.length||null===n||void 0===n||!n.length||r.length!==n.length)return null;for(var i=[],a=0;a<r.length;a++)i.push(r[a]),i.push(n[a]);return i}},{key:"writeForwardCoefficients",value:function(t,e,r){for(var n=[],i=[],a=0;a<(null===t||void 0===t?void 0:t.length);a++)a%2==0?n.push(t[a]):i.push(t[a]);e.coeffX=n,e.coeffY=i}},{key:"inverseCoefficients",get:function(){var t=this._get("inverseCoefficients"),e=this._get("forwardCoefficients");return!t&&e&&this.polynomialOrder<2&&(t=function(t){var e=(0,s.Z)(t,6),r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],u=e[5],l=i*u-o*a,c=o*a-i*u;return[(o*n-r*u)/l,(i*n-r*a)/c,u/l,a/c,-o/l,-i/c]}(e)),t},set:function(t){this._set("inverseCoefficients",t)}},{key:"readInverseCoefficients",value:function(t,e){var r=e.inverseCoeffX,n=e.inverseCoeffY;if(null===r||void 0===r||!r.length||null===n||void 0===n||!n.length||r.length!==n.length)return null;for(var i=[],a=0;a<r.length;a++)i.push(r[a]),i.push(n[a]);return i}},{key:"writeInverseCoefficients",value:function(t,e,r){for(var n=[],i=[],a=0;a<(null===t||void 0===t?void 0:t.length);a++)a%2==0?n.push(t[a]):i.push(t[a]);e.inverseCoeffX=n,e.inverseCoeffY=i}},{key:"affectsPixelSize",get:function(){return this.polynomialOrder>0}},{key:"forwardTransform",value:function(t){if("point"===t.type){var e=y(this.forwardCoefficients,t,this.polynomialOrder);return new h.Z({x:e.x,y:e.y,spatialReference:t.spatialReference})}return g(this.forwardCoefficients,t,this.polynomialOrder)}},{key:"inverseTransform",value:function(t){if("point"===t.type){var e=y(this.inverseCoefficients,t,this.polynomialOrder);return new h.Z({x:e.x,y:e.y,spatialReference:t.spatialReference})}return g(this.inverseCoefficients,t,this.polynomialOrder)}}]),r}(d.Z);(0,u._)([(0,l.Cb)({json:{write:!0}})],b.prototype,"polynomialOrder",void 0),(0,u._)([(0,l.Cb)()],b.prototype,"forwardCoefficients",void 0),(0,u._)([(0,p.r)("forwardCoefficients",["coeffX","coeffY"])],b.prototype,"readForwardCoefficients",null),(0,u._)([(0,v.c)("forwardCoefficients")],b.prototype,"writeForwardCoefficients",null),(0,u._)([(0,l.Cb)({json:{write:!0}})],b.prototype,"inverseCoefficients",null),(0,u._)([(0,p.r)("inverseCoefficients",["inverseCoeffX","inverseCoeffY"])],b.prototype,"readInverseCoefficients",null),(0,u._)([(0,v.c)("inverseCoefficients")],b.prototype,"writeInverseCoefficients",null),(0,u._)([(0,l.Cb)()],b.prototype,"affectsPixelSize",null),(0,u._)([(0,c.J)({PolynomialXform:"polynomial"})],b.prototype,"type",void 0);var w=b=(0,u._)([(0,f.j)("esri.layers.support.rasterTransforms.PolynomialTransform")],b)},77960:function(t,e,r){r.d(e,{j:function(){return m},c:function(){return y}});var n=r(3089),i=r(43144),a=r(15671),o=r(60136),s=r(92572),u=r(27366),l=(r(32718),r(25243),r(63780),r(10064),r(93169),r(27135)),c=r(69912),p=function(t){(0,o.Z)(r,t);var e=(0,s.Z)(r);function r(){var t;return(0,a.Z)(this,r),(t=e.apply(this,arguments)).type="identity",t}return(0,i.Z)(r)}(r(32935).Z);(0,u._)([(0,l.J)({IdentityXform:"identity"})],p.prototype,"type",void 0);var f=p=(0,u._)([(0,c.j)("esri.layers.support.rasterTransforms.IdentityTransform")],p),v=r(69405),d={GCSShiftXform:n.Z,IdentityXform:f,PolynomialXform:v.Z},h=Object.keys(d);function m(t){var e=null===t||void 0===t?void 0:t.type;return!t||h.includes(e)}function y(t){if(!(null===t||void 0===t?void 0:t.type))return null;var e=d[null===t||void 0===t?void 0:t.type];if(e){var r=new e;return r.read(t),r}return null}}}]);
//# sourceMappingURL=55179.f19acb54.chunk.js.map