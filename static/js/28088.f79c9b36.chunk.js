"use strict";(self.webpackChunkhub_layout_versioning=self.webpackChunkhub_layout_versioning||[]).push([[28088],{28088:function(e,t,n){n.r(t),n.d(t,{arcgis_download_list:function(){return h}});var r=n(74165),i=n(15861),a=n(15671),o=n(43144),u=n(72585),s=n(77144),c=n(12868),l=n(88968),f=n(25434),p=n(4066),h=(n(77843),n(84371),function(){function e(t){(0,a.Z)(this,e),(0,u.r)(this,t),this.layout="cards"}return(0,o.Z)(e,[{key:"handleDownloadSuccess",value:function(e){!function(e){var t=document.createElement("a");t.style.display="none",t.setAttribute("href",e),document.body.appendChild(t),t.onclick=function(){document.body.removeChild(t)},t.click()}(e.detail.downloadUrl)}},{key:"componentWillLoad",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.i.loadIntlForComponent(this.element);case 2:return this.intl=e.sent,e.next=5,this.loadServer();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onItemUpdate",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadServer();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onServerUpdate",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadServer();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadServer",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,s.i)(this.server)){e.next=7;break}return e.next=3,(0,l.g)({url:this.server,authentication:this.authentication});case 3:this.serverDefinition=e.sent,this.serverDefinition.url=this.server,e.next=17;break;case 7:if(!this.server){e.next=11;break}this.serverDefinition=(0,f.c)(this.server),e.next=17;break;case 11:if(!this.item){e.next=17;break}return t=(0,p.p)(this.item.url),e.next=15,(0,l.g)({url:t,authentication:this.authentication});case 15:this.serverDefinition=e.sent,this.serverDefinition.url=t;case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"availableFormats",get:function(){var e,t,n=(null===(e=this.serverDefinition)||void 0===e?void 0:e.capabilities)||"",r=(null===(t=this.serverDefinition)||void 0===t?void 0:t.supportedExportFormats)||"";return n.includes("Extract")?r.split(","):[]}},{key:"renderCards",value:function(){var e=this;return this.availableFormats.map((function(t){return(0,u.h)("arcgis-download-list-card",{authentication:e.authentication,class:"list-card",fileFormat:t,filterGeometry:e.filterGeometry,item:e.item,layers:e.layers,server:e.server})}))}},{key:"renderLinks",value:function(){var e=this;return this.availableFormats.map((function(t){return(0,u.h)("div",{class:"format-link"},(0,u.h)("arcgis-download-features-button",{appearance:"transparent",authentication:e.authentication,fileFormat:t,filterGeometry:e.filterGeometry,item:e.item,layers:e.layers,server:e.server},e.intl.t(t)))}))}},{key:"renderDropdown",value:function(){var e=this;return(0,u.h)("calcite-dropdown",null,(0,u.h)("calcite-button",{slot:"dropdown-trigger"},this.intl.t("download")),(0,u.h)("calcite-dropdown-group",{"selection-mode":"none"},this.availableFormats.map((function(t){return(0,u.h)("calcite-dropdown-item",{class:"dropdown-option"},(0,u.h)("arcgis-download-features-button",{appearance:"transparent",authentication:e.authentication,fileFormat:t,filterGeometry:e.filterGeometry,item:e.item,layers:e.layers,server:e.server,width:"full"},e.intl.t(t)))}))))}},{key:"render",value:function(){var e;switch(this.layout){case"links":e=this.renderLinks();break;case"cards":e=this.renderCards();break;case"dropdown":e=this.renderDropdown()}return(0,u.h)(u.H,{"data-element":"download-list"},(0,u.h)("slot",null),(0,u.h)("div",null,e))}},{key:"element",get:function(){return(0,u.g)(this)}}],[{key:"assetsDirs",get:function(){return["locales"]}},{key:"watchers",get:function(){return{item:["onItemUpdate"],server:["onServerUpdate"]}}}]),e}());h.style=":host{display:flex;flex-direction:column}.list-card:not(:first-child){margin-top:0.75rem}.format-link:not(:first-child){margin-top:0.75rem}.dropdown-option{width:100%}"},30678:function(e,t,n){function r(e){return"string"!==typeof e||"/"===(e=e.trim())[e.length-1]&&(e=e.slice(0,-1)),e}n.d(t,{c:function(){return r}})},77144:function(e,t,n){n.d(t,{C:function(){return c},a:function(){return b},b:function(){return g},c:function(){return w},f:function(){return x},g:function(){return l},i:function(){return k}});var r=n(74165),i=n(15861),a=n(15671),o=n(43144),u=n(77843),s=n(25434),c=function(){function e(){(0,a.Z)(this,e),this._createReplicaOptions={layers:"0",layerQueries:{0:{queryOption:"all"}},returnAttachments:!0,returnAttachmentsDataByUrl:!0,async:!0,syncModel:"none",targetType:"client",syncDirection:"bidirectional",attachmentsSyncDirection:"bidirectional"}}return(0,o.Z)(e,[{key:"layers",value:function(e){return this._createReplicaOptions.layers=e,this}},{key:"dataFormat",value:function(e){return this._createReplicaOptions.dataFormat=e,this}},{key:"geometry",value:function(e){return this._createReplicaOptions.geometry=e,this._createReplicaOptions.geometryType={point:"esriGeometryPoint",multipoint:"esriGeometryMultipoint",polyline:"esriGeometryPolyline",polygon:"esriGeometryPolygon",extent:"esriGeometryEnvelope"}[e.type],this._createReplicaOptions.inSR=e.spatialReference,this}},{key:"layerQueries",value:function(e){return this._createReplicaOptions.layerQueries=e,this}},{key:"build",value:function(){return(0,s.c)(this._createReplicaOptions)}}]),e}();function l(e,t,n){return f.apply(this,arguments)}function f(){return f=(0,i.Z)((0,r.Z)().mark((function e(t,n,i){var a,o,u,s,c,l,f,h=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=h.length>3&&void 0!==h[3]?h[3]:5e3,e.next=3,p(t,n,i);case 3:return o=e.sent,e.next=6,d(o,n,a);case 6:if(u=e.sent,s=u.resultUrl,c=u.authRequired,l=s,!c){e.next=15;break}return e.next=13,n.getToken(s);case 13:f=e.sent,l="".concat(s,"?token=").concat(f);case 15:return e.abrupt("return",l);case 16:case"end":return e.stop()}}),e)}))),f.apply(this,arguments)}function p(e,t,n){return h.apply(this,arguments)}function h(){return(h=(0,i.Z)((0,r.Z)().mark((function e(t,n,i){var a,o,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={httpMethod:"POST",params:i,authentication:n},e.next=3,(0,u.r)("".concat(t,"/createReplica"),a);case 3:return o=e.sent,s=o.statusUrl,e.abrupt("return",s);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e,t,n){return v.apply(this,arguments)}function v(){return(v=(0,i.Z)((0,r.Z)().mark((function e(t,n,i){var a,o,u,s,c;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(t,{authentication:n});case 2:if(a=e.sent,o=a.response,u=o.status,s=o.resultUrl,c=a.authRequired,"Completed"!==u){e.next=11;break}return e.abrupt("return",{resultUrl:s,authRequired:c});case 11:return e.next=13,new Promise((function(e){return setTimeout(e,i)}));case 13:return e.abrupt("return",d(t,n,i));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e,t){return m.apply(this,arguments)}function m(){return(m=(0,i.Z)((0,r.Z)().mark((function e(t,n){var i,a,o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,u.r)(t,Object.assign(Object.assign({},n),{rawResponse:!0,httpMethod:"GET"}));case 2:return i=e.sent,a=new URL("",i.url),e.next=6,i.json();case 6:return o=e.sent,e.abrupt("return",{response:o,authRequired:a.searchParams.has("token")});case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var k=function(e){return"string"===typeof e||e instanceof String},g=function(e){return Array.isArray(e)&&e.every((function(e){return!isNaN(e)}))},w=function(e){return Array.isArray(e)&&e.every((function(e){return!isNaN(e.id)}))},b=function(e){return"ArcGISRequestError"===e.name&&429===e.code},x=function(e){return{csv:"CSV",shapefile:"Shapefile",sqlite:"SQLite Geodatabase",geoPackage:"GeoPackage",filegdb:"File Geodatabase",featureCollection:"Feature Collection",geojson:"GeoJSON",excel:"Excel",json:"JSON"}[e]}},62254:function(e,t,n){function r(e,t){return t.split(".").reduce((function(e,t){return e?e[t]:void 0}),e)}n.d(t,{g:function(){return r}})},88968:function(e,t,n){n.d(t,{g:function(){return a}});var r=n(77843),i=n(30678);function a(e){return(0,r.r)((0,i.c)(e.url),e)}},4066:function(e,t,n){n.d(t,{p:function(){return a}});var r=n(30678),i=new RegExp(/.+(?:map|feature|image)server/i);function a(e){var t=e.match(i);return t?t[0]:function(e){var t=e.split("?")[0];return(0,r.c)(t)}(e)}},25434:function(e,t,n){n.d(t,{a:function(){return u},b:function(){return l},c:function(){return i},d:function(){return c},e:function(){return h},f:function(){return d},g:function(){return a},i:function(){return p},m:function(){return s},u:function(){return f},w:function(){return o}});var r=n(62254);function i(e){var t={};if(Array.isArray(e))t=e.map(i);else if("object"===typeof e){for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];null!=r&&"object"===typeof r?r instanceof Date?t[n]=new Date(r.getTime()):"undefined"!==typeof Blob&&r instanceof Blob?t[n]=new Blob([r],{type:r.type}):t[n]=i(r):t[n]=r}}else t=e;return t}function a(e,t,n){return e?e.reduce((function(e,i){return(0,r.g)(i,t)===n&&(e=i),e}),null):null}function o(e,t){return e.filter((function(e){return e!==t}))}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"i";return"".concat(e).concat(Math.random().toString(36).substr(2,8))}function s(e,t,n){return null!==t&&void 0!==t&&((n=i(n))[e]=t),n}function c(e,t){return null!==e&&void 0!==e&&(t=i(t)).push(e),t}function l(e){return(e=(e=e.toLowerCase()).replace(/[`~!@#$%^&*()_|+\-=?;:'",.<>\{\}\[\]\\\/]/gi," ")).replace(/(\-|\_|\.|\s)+(.)?/g,(function(e,t,n){return n?n.toUpperCase():""})).replace(/(^|\/)([A-Z])/g,(function(e,t,n){return e.toLowerCase()}))}function f(e,t,n){return n.indexOf(e)===t}var p=function(e){return null==e},h=function(e){var t=Array.from(e);return t[0]=t[0].toUpperCase(),t.join("")};function d(e){return e.reduce((function(e,t){return e.concat(t)}),[])}}}]);
//# sourceMappingURL=28088.f79c9b36.chunk.js.map