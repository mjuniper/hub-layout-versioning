{"version":3,"file":"static/js/47942.1243736e.chunk.js","mappings":"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","sources":["../.yalc/@esri/hub-components/dist/esm/arcgis-hub-discussions-post_6.entry.js","../.yalc/@esri/hub-components/dist/esm/call-once-194f02c7.js","../.yalc/@esri/hub-components/dist/esm/call-when-744df66d.js","../.yalc/@esri/hub-components/dist/esm/date-time-d2b464c4.js","../.yalc/@esri/hub-components/dist/esm/min-promise-delay-d6a589f6.js","../.yalc/@esri/hub-components/dist/esm/resources-2625913b.js","../.yalc/@esri/hub-components/dist/esm/utils-f1c97eba.js","../node_modules/@babel/runtime/helpers/esm/toArray.js"],"sourcesContent":["import { r as registerInstance, c as createEvent, h, F as Fragment, H as Host, g as getElement } from './index-0d95d9d4.js';\nimport { b as bind } from './context-7d8f7366.js';\nimport { q as cache, t as parseMentionedUsers, n as enrichPostDetails, e as enrichChannelDetails, v as removePost, w as canModifyPost, x as canDeletePost, y as searchOtherTeamMembers, z as fetchRecentChannelDetails, A as fetchTeamFromCache, B as searchChannels, C as SharingAccess, E as augmentDiscussionURIWithFeature, F as featuresToGeometryCollection, G as createPost, H as fetchChannel, d as postToFeatures, I as updatePost, i as parseDiscussionURI, M as MAX_TITLE_LENGTH, J as MAX_BODY_LENGTH, W as WARNING_BODY_LENGTH, l as isDiscussable, K as createReply } from './discussions-0e185b12.js';\nimport { i as intlManager } from './intl-manager-821aea3b.js';\nimport { d as dist } from './index-bcc98773.js';\nimport { a as autoLink } from './string-dcf03d71.js';\nimport { S as Sanitizer } from './index-16b1ebce.js';\nimport { c as callOnceFactory } from './call-once-194f02c7.js';\nimport { T as TIME_UNIT, a as TIME_INTERVAL } from './date-time-d2b464c4.js';\nimport { m as minPromiseDelayFactory } from './min-promise-delay-d6a589f6.js';\nimport { C as CallWhenFactory } from './call-when-744df66d.js';\nimport { A as ArcgisHubDiscussionsBlockedNoticeVariant } from './resources-2625913b.js';\nimport { c as cloneObject } from './util-2150bd9e.js';\nimport { g as getGroupThumbnailUrl, a as getUserThumbnailUrl } from './utils-f1c97eba.js';\nimport './getPortalBaseFromOrgUrl-6a5781aa.js';\nimport './tslib.es6-3669ad41.js';\nimport './get-portal-url-423a76f5.js';\nimport './clean-url-be7c0879.js';\nimport './request-c15cc2af.js';\nimport './get-859a2960.js';\nimport './append-custom-params-fd9b7e72.js';\nimport './get-portal-06f7947b.js';\nimport './query-15c2c6ed.js';\nimport './tslib.es6-b2e8cdb8.js';\nimport './fetch-eff7ab83.js';\nimport './tslib.es6-e75776ba.js';\nimport './_enrichments-9747f1f3.js';\nimport './get-with-default-6db049d8.js';\nimport './get-prop-d82e4fa6.js';\nimport './_internal-f8d6239a.js';\nimport './get-portal-api-url-2391fbac.js';\nimport './extent-0f42acfc.js';\nimport './helpers-a80c0291.js';\nimport './OperationError-85fd80c7.js';\nimport './get-f2cd18e7.js';\nimport './getService-49b539e3.js';\nimport './slugs-150ad0db.js';\nimport './is-guid-8127621d.js';\nimport './request-be948455.js';\nimport './api-3826163b.js';\nimport './compose-cc2f466a.js';\nimport './get-structured-license-d1e63636.js';\nimport './get-item-thumbnail-url-7608a737.js';\nimport './update-fec93fc5.js';\nimport './index-4e91769f.js';\nimport './_commonjsHelpers-11ca3be1.js';\nimport './UserSession-d3a97494.js';\n\n/* eslint-disable no-unused-vars */\n/**\n * A decorator factory function that accepts the cache decorator configuration params\n *\n * @param params An ICacheDecoratorParams object\n * @returns The cache decorator function\n */\nfunction CacheDecoratorFactory(params) {\n  /**\n   * A decorator function that augments a class method with client caching behavior\n   *\n   * @param _target A reference to the class prototype\n   * @param _propertyKey The name of the method being decorated\n   * @param descriptor A PropertyDescriptor for the method being decorated\n   * @returns A new PropertyDescriptor that aguments the decorated method with caching behavior\n   */\n  function CacheDecorator(_target, _propertyKey, descriptor) {\n    const value = cache(descriptor.value, params);\n    return Object.assign(Object.assign({}, descriptor), { value });\n  }\n  return CacheDecorator;\n}\n\n/**\n * A decorator factory function that accepts the auto link decorator configuration params\n *\n * @returns The cache decorator function\n */\nfunction AutoLinkDecoratorFactory(options) {\n  /**\n   * A decorator function that augments a class method with an auto link transformation that converts\n   * URLs in plain text to either an anchor or calcite-link\n   *\n   * @param _target A reference to the class prototype\n   * @param _propertyKey The name of the method being decorated\n   * @param descriptor A PropertyDescriptor for the method being decorated\n   * @returns A new PropertyDescriptor that aguments the decorated method with auto linking behavior\n   */\n  function AutoLinkDecorator(_target, _propertyKey, descriptor) {\n    const { value: original } = descriptor;\n    const value = function AutoLink(...args) {\n      const result = original.apply(this, args);\n      return autoLink(result, options);\n    };\n    return Object.assign(Object.assign({}, descriptor), { value });\n  }\n  return AutoLinkDecorator;\n}\n\n/**\n * A decorator factory function that accepts the auto link decorator configuration params\n *\n * @returns The cache decorator function\n */\nfunction SanitizeDecoratorFactory(options) {\n  const sanitizer = new Sanitizer(options === null || options === void 0 ? void 0 : options.filterOptions, options === null || options === void 0 ? void 0 : options.extendDefaults);\n  /**\n   * A decorator function that augments a class method with a sanitizing transformation\n   *\n   * @param _target A reference to the class prototype\n   * @param _propertyKey The name of the method being decorated\n   * @param descriptor A PropertyDescriptor for the method being decorated\n   * @returns A new PropertyDescriptor that aguments the decorated method with sanitizing behavior\n   */\n  function AutoLinkDecorator(_target, _propertyKey, descriptor) {\n    const { value: original } = descriptor;\n    const value = function Sanitize(...args) {\n      const result = original.apply(this, args);\n      return sanitizer.sanitize(result);\n    };\n    return Object.assign(Object.assign({}, descriptor), { value });\n  }\n  return AutoLinkDecorator;\n}\n\nconst MENTION_ATTRIBUTE = \"data-mention\";\nconst MENTION_ELEMENTS_PATTERN = new RegExp(`<[a-z-]+( [a-z-]+(=('|\")[\\\\w- ]+('|\"))?)*( ${MENTION_ATTRIBUTE}=('|\")(\\\\w)+('|\"))( [a-z-]+(=('|\")[\\\\w- ]+('|\"))?)*>@\\\\w+<\\/[a-z-]+>`, 'g');\nconst getMentionedUser = (match, mentionedUsers) => {\n  const username = parseMentionedUsers(match)[0];\n  return mentionedUsers.find(userDetails => userDetails.user.username === username);\n};\nfunction mentionPopoverTransform(input, postDetails, channel, session, originalPostId) {\n  const transform = (input = '', postDetails, channel, session, originalPostId) => {\n    var _a;\n    const matches = input.match(MENTION_ELEMENTS_PATTERN);\n    if (!matches) {\n      return input;\n    }\n    else {\n      const [match] = matches;\n      const startIdx = input.indexOf(match);\n      const endIdx = startIdx + match.length;\n      const before = startIdx > 0 ? input.substring(0, startIdx) : '';\n      const toReplace = input.substring(startIdx, startIdx + match.length);\n      const mentionedUser = getMentionedUser(toReplace, postDetails.mentionedUsers);\n      const replaced = toReplace.replace(match, `<arcgis-hub-discussions-mention-popover\n          access=\"${mentionedUser.user.access}\"\n          channel-access=\"${channel.access}\"\n          channel-id=\"${channel.id}\"\n          creator-username=\"${postDetails.creatorDetails.user.username || postDetails.post.creator}\"\n          full-name=\"${mentionedUser.user.fullName}\"\n          organization=\"${(_a = mentionedUser.organization) === null || _a === void 0 ? void 0 : _a.name}\"\n          parent-id=\"${originalPostId !== null && originalPostId !== void 0 ? originalPostId : \"\"}\"\n          portal=\"${session.portal}\"\n          post-id=\"${postDetails.post.id}\"\n          region=\"${mentionedUser.user.region}\"\n          thumbnail=\"${mentionedUser.user.thumbnail}\"\n          token=\"${session.token}\"\n          user-id=\"${mentionedUser.user.id}\"\n          username=\"${mentionedUser.user.username}\"\n        >${match}</arcgis-hub-discussions-mention-popover>`);\n      return before + replaced + transform(input.substring(endIdx), postDetails, channel, session, originalPostId);\n    }\n  };\n  return transform(input, postDetails, channel, session, originalPostId);\n}\n\nfunction MentionPopoverTransformDecoratorFactory() {\n  function MentionPopoverTransformDecorator(_target, _propertyKey, descriptor) {\n    const { value: original } = descriptor;\n    const value = function MentionPopoverTransform(...args) {\n      const result = original.apply(this, args);\n      return mentionPopoverTransform(result, this.replyDetails ? this.replyDetails : this.postDetails, this.channelDetails.channel, this.context.session, this.replyDetails ? this.postDetails.postId : null);\n    };\n    return Object.assign(Object.assign({}, descriptor), { value });\n  }\n  return MentionPopoverTransformDecorator;\n}\n\nconst arcgisHubDiscussionsPostCss = \".sc-arcgis-hub-discussions-post-h{display:block;background-color:var(--calcite-ui-foreground-1)}arcgis-hub-discussions-post-header.sc-arcgis-hub-discussions-post{margin-left:1rem;margin-right:1rem;margin-bottom:0.5rem}header.sc-arcgis-hub-discussions-post{margin-left:1rem;margin-right:1rem;margin-bottom:0.25rem;overflow-wrap:break-word;font-size:var(--calcite-font-size-1);line-height:1.5rem;font-weight:var(--calcite-font-weight-bold);color:var(--calcite-ui-text-1)}arcgis-multiline-ellipsis.sc-arcgis-hub-discussions-post{margin:0px;margin-left:1rem;margin-right:1rem;font-size:var(--calcite-font-size-0);line-height:1.25rem}footer.sc-arcgis-hub-discussions-post{display:grid;grid-template-columns:auto 48px}arcgis-hub-discussions-post-editor.sc-arcgis-hub-discussions-post{margin-top:0px;margin-bottom:0px}calcite-notice.sc-arcgis-hub-discussions-post{margin-left:1rem;margin-right:1rem;margin-bottom:1.5rem}footer.sc-arcgis-hub-discussions-post+calcite-notice.sc-arcgis-hub-discussions-post{margin-top:1rem}arcgis-hub-discussions-post-skeleton.sc-arcgis-hub-discussions-post{margin-left:1rem;margin-right:1rem}arcgis-hub-discussions-post-geography[loading].sc-arcgis-hub-discussions-post{margin-left:1rem;margin-right:1rem}#text-actions.sc-arcgis-hub-discussions-post{margin-left:0.5rem}calcite-popover[data-popper-placement][data-popper-reference-hidden].sc-arcgis-hub-discussions-post{pointer-events:auto;opacity:1}calcite-popover.sc-arcgis-hub-discussions-post{pointer-events:auto !important}.discussions-post-action-menu.sc-arcgis-hub-discussions-post:active .discussions-post-action-menu-icon.sc-arcgis-hub-discussions-post{--tw-text-opacity:1;color:rgb(21 21 21 / var(--tw-text-opacity))}.discussions-post-action-menu-options.sc-arcgis-hub-discussions-post:active{--tw-text-opacity:1;color:rgb(21 21 21 / var(--tw-text-opacity))}.discussions-post-action-menu-options.sc-arcgis-hub-discussions-post:active .discussions-post-action-menu-options-icon.sc-arcgis-hub-discussions-post{--tw-text-opacity:1;color:rgb(21 21 21 / var(--tw-text-opacity))}.discussions-post-replies.sc-arcgis-hub-discussions-post:active{--tw-text-opacity:1;color:rgb(21 21 21 / var(--tw-text-opacity))}.discussions-post-replies.sc-arcgis-hub-discussions-post:active .discussions-post-replies-icon.sc-arcgis-hub-discussions-post{--tw-text-opacity:1;color:rgb(21 21 21 / var(--tw-text-opacity))}\";\n\nvar __decorate$3 = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\n  var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\")\n    r = Reflect.decorate(decorators, target, key, desc);\n  else\n    for (var i = decorators.length - 1; i >= 0; i--)\n      if (d = decorators[i])\n        r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar PostView;\n(function (PostView) {\n  PostView[\"Skeleton\"] = \"skeleton\";\n  PostView[\"Content\"] = \"content\";\n  PostView[\"Editor\"] = \"editor\";\n  PostView[\"Deleted\"] = \"deleted\";\n})(PostView || (PostView = {}));\nconst ArcgisHubDiscussionsPost = class {\n  constructor(hostRef) {\n    registerInstance(this, hostRef);\n    this.arcgisHubDiscussionsPostDelete = createEvent(this, \"arcgisHubDiscussionsPostDelete\", 7);\n    this.arcgisHubDiscussionsPostSelect = createEvent(this, \"arcgisHubDiscussionsPostSelect\", 7);\n    this.arcgisHubDiscussionsGeometryDrawReset = createEvent(this, \"arcgisHubDiscussionsGeometryDrawReset\", 7);\n    this.arcgisHubDiscussionsGeometryDeselect = createEvent(this, \"arcgisHubDiscussionsGeometryDeselect\", 7);\n    this.arcgisHubDiscussionsPostUpdate = createEvent(this, \"arcgisHubDiscussionsPostUpdate\", 7);\n    this.arcgisHubDiscusssionsChannelUpdate = createEvent(this, \"arcgisHubDiscusssionsChannelUpdate\", 7);\n    this.arcgisHubDiscussionsScrollTo = createEvent(this, \"arcgisHubDiscussionsScrollTo\", 7);\n    this.hubTelemetry = createEvent(this, \"hubTelemetry\", 7);\n    /**\n     * Feature geometry edits for existing post locations\n     */\n    this.unsavedExistingFeatures = [];\n    /**\n     * Whether the component should show it's skeleton state\n     */\n    this.loading = true;\n    /**\n     * The user elected to edit the post\n     */\n    this.editing = false;\n    /**\n     * An event failed\n     */\n    this.errorMessage = null;\n    bind(this, 'handleDelete', 'handleEdit', 'handleViewThread', 'handleReply', 'handleViewReplies', 'handleLinkClicked', 'renderDeleted', 'renderPost', 'renderEditor', 'renderSkeleton');\n  }\n  componentWillLoad() {\n    this.initialize();\n  }\n  componentDidLoad() {\n    if (this.autoFocus) {\n      this.arcgisHubDiscussionsScrollTo.emit();\n    }\n  }\n  /**\n   * Updates loading state when intl or postDetails\n   * are updated\n   */\n  handleDetailsUpdates() {\n    this.addEnrichments();\n  }\n  handlePostEdited() {\n    this.editing = false;\n  }\n  handlePostCancelled(evt) {\n    evt.stopPropagation();\n    this.editing = false;\n    this.arcgisHubDiscussionsGeometryDrawReset.emit();\n    this.arcgisHubDiscussionsGeometryDeselect.emit();\n  }\n  handleMultilineEllipsisExpanded(evt) {\n    evt.preventDefault();\n    evt.stopPropagation();\n    this.handleViewThread();\n  }\n  handleCalcitePopoverOpen(evt) {\n    var _a;\n    const { open } = evt.target;\n    if (evt.target !== this.menuPopoverElement && ((_a = this.menuPopoverElement) === null || _a === void 0 ? void 0 : _a.open)) {\n      this.menuPopoverElement.toggle();\n    }\n    else if (evt.target === this.menuPopoverElement && open) {\n      const { index } = this;\n      this.emitHubTelemetry(Object.assign(Object.assign({}, dist.dictionary.category.interaction.action.open.label.popover.details.options), { position: index }));\n    }\n  }\n  emitHubTelemetry(telemetry) {\n    const { postDetails: { postId }, channelDetails: { channel } } = this;\n    this.hubTelemetry.emit(Object.assign(Object.assign({}, telemetry), { postId, channelId: channel.id, channelAccess: channel.access }));\n  }\n  /**\n   * Initiates post details enrichmentment, initializes\n   * loading state, and loads localizations\n   */\n  async initialize() {\n    const { element } = this;\n    this.addEnrichments();\n    this.intl = await intlManager.loadIntlForComponent(element);\n  }\n  addEnrichments() {\n    const { isPostEnriched, isChannelEnriched, postDetails: { postId }, channelDetails: { channelId } } = this;\n    if (!isPostEnriched && postId) {\n      this.enrichPostDetails();\n    }\n    if (!isChannelEnriched && channelId) {\n      this.enrichChannelDetails();\n    }\n    this.updateLoading();\n  }\n  updateLoading() {\n    const { isEnriched } = this;\n    this.loading = !isEnriched;\n  }\n  /**\n   * Enriches post details and emits arcgisHubDiscussionsPostUpdate so\n   * upstream state is updated\n   */\n  async enrichPostDetails() {\n    const { postDetails: rawPostDetails, context } = this;\n    const postDetails = await enrichPostDetails(Object.assign({ postDetails: rawPostDetails, includeReplyCount: true }, context.hubRequestOptions));\n    this.arcgisHubDiscussionsPostUpdate.emit(postDetails);\n  }\n  /**\n   * Enriches channel details and emits arcgisHubDiscusssionsChannelUpdate so\n   * upstream state is updated\n   */\n  async enrichChannelDetails() {\n    const { context, postDetails, channelDetails: _channelDetails } = this;\n    const channelDetails = await enrichChannelDetails(Object.assign({ channelDetails: _channelDetails }, context.hubRequestOptions));\n    this.arcgisHubDiscusssionsChannelUpdate.emit({\n      postId: postDetails.postId,\n      channelDetails\n    });\n  }\n  /**\n   * Sanitizes body text and renders urls as links. Caches post body so operation is only performed as needed.\n   * @returns string: body text of a post with urls rendered as calcite-links\n   */\n  computePostBody() {\n    return this.postDetails.post.body;\n  }\n  computePostTitle() {\n    return this.postDetails.post.title;\n  }\n  handleDelete() {\n    const { context, postDetails: { post }, menuPopoverElement } = this;\n    this.errorMessage = null;\n    if (menuPopoverElement === null || menuPopoverElement === void 0 ? void 0 : menuPopoverElement.toggle) {\n      menuPopoverElement.toggle();\n    }\n    return removePost(Object.assign({ postId: post.id }, context.hubRequestOptions))\n      .then(() => {\n      this.deletedDuringSession = true;\n      this.emitHubTelemetry(Object.assign(Object.assign({}, dist.dictionary.category.content.action.delete), { response: dist.constants.response.SUCCESS }));\n      this.arcgisHubDiscussionsPostDelete.emit(post);\n    })\n      .catch(e => {\n      this.errorMessage = 'deleteFailure';\n      this.emitHubTelemetry(Object.assign(Object.assign({}, dist.dictionary.category.content.action.delete), { response: dist.constants.response.FAILURE }));\n      console.error(`Could not delete post:`, e.message);\n    });\n  }\n  handleEdit() {\n    const { index } = this;\n    this.emitHubTelemetry(Object.assign(Object.assign({}, dist.dictionary.category.interaction.action.open.label.editor), { position: index }));\n    this.editing = true;\n  }\n  handleViewThread() {\n    const { index } = this;\n    this.arcgisHubDiscussionsPostSelect.emit();\n    if (index !== undefined) {\n      this.emitHubTelemetry(Object.assign(Object.assign({}, dist.dictionary.category.interaction.action.open.label.thread), { position: index }));\n    }\n  }\n  handleReply() {\n    this.arcgisHubDiscussionsPostSelect.emit(\"editor\");\n    this.emitHubTelemetry(dist.dictionary.category.interaction.action.open.label.editor.details.reply);\n  }\n  handleViewReplies() {\n    this.arcgisHubDiscussionsPostSelect.emit(\"list\");\n    this.emitHubTelemetry(dist.dictionary.category.interaction.action.open.label.thread.details.bodyAction);\n  }\n  handleLinkClicked(evt) {\n    const el = evt.target;\n    if (['CALCITE-LINK'].includes(el.nodeName) && !el.hasAttribute(\"data-mention\")) {\n      const { postDetails: { postId }, channelDetails: { channel }, index } = this;\n      this.hubTelemetry.emit(Object.assign(Object.assign({}, dist.dictionary.category.navigation.action.external.label.link), { details: el.href, postId: postId, channelId: channel.id, channelAccess: channel.access, position: index }));\n    }\n  }\n  capturePostDeepLinkImpression() {\n    this.emitHubTelemetry(Object.assign(Object.assign({}, dist.dictionary.category.interaction.action.viewed.label.post.details.thread), { response: dist.constants.response.SUCCESS }));\n  }\n  capturePostListImpression() {\n    this.emitHubTelemetry(Object.assign(Object.assign({}, dist.dictionary.category.interaction.action.viewed.label.post.details.postList), { position: this.index }));\n  }\n  capturePostDeletedImpression() {\n    this.emitHubTelemetry(Object.assign(Object.assign({}, dist.dictionary.category.interaction.action.viewed.label.post.details.thread), { response: dist.constants.response.FAILURE }));\n  }\n  /**\n   * Computes if the post details are enriched\n   */\n  get isPostEnriched() {\n    const { postDetails: { creatorDetails, post } } = this;\n    const requiredEnrichments = [\n      creatorDetails === null || creatorDetails === void 0 ? void 0 : creatorDetails.username,\n      creatorDetails === null || creatorDetails === void 0 ? void 0 : creatorDetails.user,\n      creatorDetails === null || creatorDetails === void 0 ? void 0 : creatorDetails.organization\n    ];\n    const isNotUndefined = (val) => val !== undefined;\n    return (post === null) || requiredEnrichments.every(isNotUndefined);\n  }\n  /**\n   * Computes if the channel details are enriched\n   */\n  get isChannelEnriched() {\n    const { channelDetails: { channel, groups } } = this;\n    const isNotUndefined = (value) => value !== undefined;\n    const requiredValues = [channel, groups];\n    return requiredValues.every(isNotUndefined);\n  }\n  /**\n   * Computes if all required enrichments are present\n   */\n  get isEnriched() {\n    const { intl, isPostEnriched, isChannelEnriched } = this;\n    return Boolean(intl) && isPostEnriched && isChannelEnriched;\n  }\n  get views() {\n    const { renderEditor, renderDeleted, renderPost, renderSkeleton } = this;\n    return {\n      [PostView.Skeleton]: {\n        render: renderSkeleton\n      },\n      [PostView.Content]: {\n        render: renderPost\n      },\n      [PostView.Editor]: {\n        render: renderEditor\n      },\n      [PostView.Deleted]: {\n        render: renderDeleted\n      }\n    };\n  }\n  get view() {\n    const { views, postDetails, editing, loading } = this;\n    let target;\n    if (loading) {\n      target = PostView.Skeleton;\n    }\n    else if (!postDetails.post) {\n      target = PostView.Deleted;\n    }\n    else if (editing) {\n      target = PostView.Editor;\n    }\n    else {\n      target = PostView.Content;\n    }\n    return views[target];\n  }\n  renderEditor() {\n    const { context, hasMap, index, isHub, unsavedFeatures, unsavedRelatedFeatures, unsavedExistingFeatures, postDetails, channelDetails, discussionDetails, isMobile } = this;\n    return (h(\"arcgis-hub-discussions-post-editor\", { channelDetails: channelDetails, context: context, discussionDetails: discussionDetails, hasMap: hasMap, index: index, isHub: isHub, isMobile: isMobile, postDetails: postDetails, unsavedExistingFeatures: unsavedExistingFeatures, unsavedFeatures: unsavedFeatures, unsavedRelatedFeatures: unsavedRelatedFeatures }));\n  }\n  renderPost() {\n    var _a;\n    const { intl, errorMessage, hasMap, isHub, context, preview, postDetails, channelDetails, index, discussionDetails, unsavedFeatures, unsavedRelatedFeatures, unsavedExistingFeatures, isMobile } = this;\n    const isRtl = intl.direction === 'rtl';\n    const icon = isRtl ? 'arrow-left' : 'arrow-right';\n    (index === undefined)\n      ? this.capturePostDeepLinkImpression()\n      : this.capturePostListImpression();\n    return (h(\"article\", null, h(\"arcgis-hub-discussions-post-header\", { channelDetails: channelDetails, context: context, index: index, isHub: isHub, postDetails: postDetails }), h(\"header\", { innerHTML: this.computePostTitle() }), h(\"arcgis-multiline-ellipsis\", { \"expand-enabled\": preview, \"expand-icon\": icon, innerHTML: this.computePostBody(), lines: preview ? 4 : 0, onClick: this.handleLinkClicked }), preview && this.renderTextActions(), h(\"arcgis-hub-discussions-post-geography\", { channelDetails: channelDetails, context: context, discussionDetails: discussionDetails, expandable: preview, hasMap: hasMap, isMobile: isMobile, postDetails: postDetails, unsavedExistingFeatures: unsavedExistingFeatures, unsavedFeatures: unsavedFeatures, unsavedRelatedFeatures: unsavedRelatedFeatures, url: (_a = discussionDetails === null || discussionDetails === void 0 ? void 0 : discussionDetails.reference) === null || _a === void 0 ? void 0 : _a.url }), h(\"footer\", null, this.renderActionGroup(), this.renderActionMenu()), errorMessage && (h(\"calcite-notice\", {\n      // active\n      color: \"red\",\n      // dismissible\n      scale: \"s\"\n    }, h(\"div\", { slot: \"title\" }, intl.t('error')), h(\"div\", { slot: \"message\" }, intl.t(errorMessage))))));\n  }\n  renderTextActions() {\n    const { intl, channelDetails: { groups } } = this;\n    return (h(\"calcite-action-group\", { id: \"text-actions\", layout: \"horizontal\" }, Boolean(groups.length) && (h(\"calcite-action\", { onClick: this.handleReply, scale: 's', text: intl.t('actions.reply'), textEnabled: true })), h(\"calcite-action\", { onClick: this.handleViewReplies, scale: 's', text: intl.t('actions.view'), textEnabled: true })));\n  }\n  renderActionMenu() {\n    const { intl, context, postDetails: { post }, channelDetails: { channel, groups } } = this;\n    const actions = [];\n    if (groups.length && canModifyPost(post, context.currentUser)) {\n      actions.push({\n        icon: 'pencil',\n        text: intl.t('edit'),\n        fn: this.handleEdit\n      });\n    }\n    if (canDeletePost(post, channel, context.currentUser)) {\n      actions.push({\n        icon: 'trash',\n        text: intl.t('delete'),\n        fn: this.handleDelete\n      });\n    }\n    if (actions.length) {\n      return (h(Fragment, null, h(\"calcite-action\", { class: \"discussions-post-action-menu\", ref: (menuActionElement) => { this.menuActionElement = menuActionElement; }, text: intl.t('options') }, h(\"calcite-icon\", { class: \"discussions-post-action-menu-icon\", icon: \"ellipsis\", scale: \"s\" })), h(\"calcite-popover\", { autoClose: true,\n        // disablePointer\n        flipPlacements: [\"top\", \"bottom\"], label: intl.t('options'), offsetDistance: 0, placement: \"bottom-end\", ref: (menuPopoverElement) => { this.menuPopoverElement = menuPopoverElement; }, referenceElement: this.menuActionElement }, h(\"calcite-action-group\", { layout: \"vertical\" }, actions.map(({ text, fn, icon }) => (h(\"calcite-action\", { class: \"discussions-post-action-menu-options\", \"data-action\": text.toLowerCase(), id: \"discussions-post-action-menu-option-\" + icon, key: icon, onClick: fn, scale: \"m\", text: text, \"text-enabled\": \"true\" }, h(\"calcite-icon\", { class: \"discussions-post-action-menu-options-icon\", icon: icon, scale: \"s\" }))))))));\n    }\n  }\n  renderActionGroup() {\n    const { intl, preview, linkToThread, postDetails: { post } } = this;\n    // TODO: update calcite-action[text] attributes w/ localized strings\n    return (h(\"calcite-action-group\", { layout: \"horizontal\" }, h(\"calcite-action\", { appearance: \"solid\", class: \"discussions-post-replies\", disabled: !preview && !linkToThread, label: intl.t('numReplies'), onClick: this.handleViewThread, scale: \"m\", text: post.replyCount.toString(), \"text-enabled\": \"true\" }, h(\"calcite-icon\", { class: \"discussions-post-replies-icon\", icon: \"speech-bubble\", scale: \"s\" }))));\n  }\n  renderDeleted() {\n    const { intl, deletedDuringSession } = this;\n    if (!deletedDuringSession) {\n      this.capturePostDeletedImpression();\n    }\n    return (h(\"calcite-notice\", {\n      // active\n      color: \"red\", scale: \"m\"\n    }, h(\"div\", { slot: \"title\" }, intl.t('deleted.title')), h(\"div\", { slot: \"message\" }, intl.t('deleted.message'))));\n  }\n  renderSkeleton() {\n    return h(\"arcgis-hub-discussions-post-skeleton\", null);\n  }\n  render() {\n    return (h(Host, { \"data-element\": \"discussions-post\" }, this.view.render()));\n  }\n  static get assetsDirs() { return [\"locales\"]; }\n  get element() { return getElement(this); }\n  static get watchers() { return {\n    \"intl\": [\"handleDetailsUpdates\"],\n    \"postDetails\": [\"handleDetailsUpdates\"],\n    \"channelDetails\": [\"handleDetailsUpdates\"]\n  }; }\n};\n__decorate$3([\n  CacheDecoratorFactory({\n    scope: 'arcgis-hub-discussions-post-body',\n    getKey() {\n      const { postDetails: { postId, post: { body } } } = this;\n      return body !== null && body !== void 0 ? body : postId;\n    }\n  }),\n  AutoLinkDecoratorFactory({ calcite: true }),\n  MentionPopoverTransformDecoratorFactory(),\n  SanitizeDecoratorFactory({\n    filterOptions: {\n      whiteList: {\n        'calcite-link': ['href', 'data-mention']\n      }\n    },\n    extendDefaults: true\n  })\n], ArcgisHubDiscussionsPost.prototype, \"computePostBody\", null);\n__decorate$3([\n  CacheDecoratorFactory({\n    scope: 'arcgis-hub-discussions-post-title',\n    getKey() {\n      const { postDetails: { postId, post: { title } } } = this;\n      return title !== null && title !== void 0 ? title : postId;\n    }\n  }),\n  SanitizeDecoratorFactory()\n], ArcgisHubDiscussionsPost.prototype, \"computePostTitle\", null);\n__decorate$3([\n  callOnceFactory()\n], ArcgisHubDiscussionsPost.prototype, \"capturePostDeepLinkImpression\", null);\n__decorate$3([\n  callOnceFactory()\n], ArcgisHubDiscussionsPost.prototype, \"capturePostListImpression\", null);\n__decorate$3([\n  callOnceFactory()\n], ArcgisHubDiscussionsPost.prototype, \"capturePostDeletedImpression\", null);\nArcgisHubDiscussionsPost.style = arcgisHubDiscussionsPostCss;\n\n/**\n * Steps of original post authoring\n */\nvar STEP;\n(function (STEP) {\n  STEP[\"AUDIENCE\"] = \"audience\";\n  STEP[\"CONTENT\"] = \"content\";\n})(STEP || (STEP = {}));\n\nconst arcgisHubDiscussionsPostEditorCss = \".hub-discussions-post-editor{margin-top:1.5rem;margin-bottom:1.5rem;margin-left:0.75rem;margin-right:0.75rem;display:block;border-radius:0.25rem;padding:0.75rem;--tw-shadow:0 2px 8px 0 rgba(0, 0, 0, 0.12);--tw-shadow-colored:0 2px 8px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.hub-discussions-post-editor-header{margin-bottom:1.5rem;display:grid;grid-template-rows:repeat(1, minmax(0, 1fr));align-items:center;-moz-column-gap:0.75rem;column-gap:0.75rem;grid-template-columns:44px auto 44px}.hub-discussions-post-editor-header__title{margin:0px;text-align:center;font-size:var(--calcite-font-size-1);line-height:1.5rem;font-weight:var(--calcite-font-weight-bold);color:var(--calcite-ui-text-1)}.hub-discussions-post-editor-header__popover{padding:1rem;margin-top:revert;margin-bottom:revert}.hub-discussions-post-editor-recent__header{margin-top:1.5rem;margin-bottom:0.75rem;font-size:var(--calcite-font-size--1);line-height:1rem;font-weight:var(--calcite-font-weight-bold);color:var(--calcite-ui-text-1)}.hub-discussions-post-editor-groups__action{margin-top:0.75rem}.hub-discussions-post-editor-recent__list{margin-top:0px;margin-bottom:0px;list-style-type:none;padding:0px}.hub-discussions-post-editor-recent__item{margin-bottom:0.75rem;margin-top:0px;display:grid;grid-auto-flow:column;grid-template-rows:repeat(2, minmax(0, 1fr));-moz-column-gap:0.75rem;column-gap:0.75rem;grid-template-columns:44px auto 44px}.hub-discussions-post-editor-recent__item:last-child{margin-bottom:0px}.hub-discussions-post-editor-recent__avatar{grid-row:span 2 / span 2}.hub-discussions-post-editor-recent__title{font-weight:var(--calcite-font-weight-bold);overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}.hub-discussions-post-editor-recent__last-activity{font-size:var(--calcite-font-size--1);line-height:1rem;font-style:normal;color:var(--calcite-ui-text-2)}.hub-discussions-post-editor-recent__action{grid-row:span 2 / span 2}.hub-discussions-post-editor-post-actions,.hub-discussions-post-editor-geometry-actions{margin-top:1rem;display:flex;justify-content:flex-end}.hub-discussions-post-editor-post-actions>calcite-action{margin-right:auto}.hub-discussions-post-editor-geometry-actions__feature,.hub-discussions-post-editor-geometry-actions__related,.hub-discussions-post-editor-post-actions__primary,.hub-discussions-post-editor-post-actions__secondary{margin-left:0.75rem}.hub-discussions-post-editor__title{margin:0px;margin-top:1rem;height:auto;width:100%;resize:none;border-style:none;background-color:var(--calcite-ui-foreground-1);padding:0px;font-size:var(--calcite-font-size-1);line-height:1.5rem;font-weight:var(--calcite-font-weight-bold);color:var(--calcite-ui-text-1);--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.hub-discussions-post-editor__title:focus{--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);outline:2px solid transparent;outline-offset:2px}.hub-discussions-post-editor .hub-discussions-post-editor__title::-moz-placeholder{color:var(--calcite-ui-text-3);opacity:1}.hub-discussions-post-editor .hub-discussions-post-editor__title:-ms-input-placeholder{color:var(--calcite-ui-text-3);opacity:1}.hub-discussions-post-editor .hub-discussions-post-editor__title::placeholder{color:var(--calcite-ui-text-3);opacity:1}.hub-discussions-post-editor__body{margin-top:0.5rem}.hub-discussions-post-editor__body[scale=m] .ck.ck-editor__editable{border-style:none;background-color:var(--calcite-ui-foreground-1);padding:0px;font-size:var(--calcite-font-size-0);line-height:1.25rem;color:var(--calcite-ui-text-1);outline:2px solid transparent;outline-offset:2px;min-height:6rem}.hub-discussions-post-editor__body .ck.ck-editor__editable.ck-focused:not(.ck-editor__nested-editable){border-style:none;outline:2px solid transparent;outline-offset:2px}.hub-discussions-post-editor__body[scale=m] .ck.ck-editor__editable .ck-placeholder:before{color:var(--calcite-ui-text-3)}.hub-discussions-post-editor__body .ck.ck-editor__editable_inline>:first-child{margin-top:0px}.hub-discussions-post-editor__body .ck.ck-editor__editable_inline>:last-child{margin-bottom:0px}.hub-discussions-post-editor__message{margin-top:0.5rem}.hub-discussions-post-editor__empty,.hub-discussions-post-editor__load-error{margin-top:1rem}.hub-discussions-post-editor__crud-error,.hub-discussions-post-editor__not-discussable-notice{margin-top:1rem}.hub-discussions-post-editor-cancel-confirm__header{margin:0px;display:block;font-size:var(--calcite-font-size-1);line-height:1.5rem;font-weight:var(--calcite-font-weight-bold)}.hub-discussions-post-editor-cancel-confirm__message{margin-top:0.5rem;margin-bottom:0px}.hub-discussions-post-editor-cancel-confirm__footer{margin-top:1.5rem;display:grid;grid-auto-flow:column;grid-template-columns:repeat(2, minmax(0, 1fr));-moz-column-gap:0.75rem;column-gap:0.75rem}.hub-discussions-post-editor-recent__skeleton{margin-bottom:0.75rem;margin-top:0px}.hub-discussions-post-editor-recent__skeleton arcgis-skeleton-loader{display:flex}@-webkit-keyframes shimmer{0%{background-size:200% 100%;background-position:100% 0}100%{background-size:200% 100%;background-position:-100% 0}}@keyframes shimmer{0%{background-size:200% 100%;background-position:100% 0}100%{background-size:200% 100%;background-position:-100% 0}}.hub-discussions-post-editor-recent__skeleton arcgis-skeleton-loader>div:nth-of-type(1),.hub-discussions-post-editor-recent__skeleton arcgis-skeleton-loader>div:nth-of-type(2) div{-webkit-animation:shimmer 2s cubic-bezier(0.4, 0, 0.2, 0.8) infinite;animation:shimmer 2s cubic-bezier(0.4, 0, 0.2, 0.8) infinite;background-image:linear-gradient(90deg, rgba(255, 255, 255, 0) 0, rgba(255, 255, 255, 0) 40%, rgba(255, 255, 255, 0.6) 50%, rgba(255, 255, 255, 0) 60%, rgba(255, 255, 255, 0) 100%);background-color:var(--calcite-ui-foreground-2)}.hub-discussions-post-editor-recent__skeleton arcgis-skeleton-loader>div:nth-of-type(1){height:2.75rem;width:2.75rem;border-radius:50%}.hub-discussions-post-editor-recent__skeleton arcgis-skeleton-loader>div:nth-of-type(2){margin-left:1rem;display:flex;flex-grow:1;flex-direction:column;justify-content:center}.hub-discussions-post-editor-recent__skeleton arcgis-skeleton-loader>div:nth-of-type(2) div:nth-of-type(1){margin-bottom:0.5rem;height:0.75rem;border-radius:0.375rem}.hub-discussions-post-editor-recent__skeleton arcgis-skeleton-loader>div:nth-of-type(2) div:nth-of-type(2){height:0.5rem;border-radius:0.25rem}.location-popover>div.popover,.popover{max-width:20rem;padding-top:0.75rem;padding-bottom:0.75rem;padding-left:1.25rem;padding-right:1.25rem}.add-location-post:active .add-location-icon{--tw-text-opacity:1;color:rgb(21 21 21 / var(--tw-text-opacity))}.add-location-post[active] .add-location-icon{--tw-text-opacity:1;color:rgb(21 21 21 / var(--tw-text-opacity))}\";\n\nvar __decorate$2 = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\n  var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\")\n    r = Reflect.decorate(decorators, target, key, desc);\n  else\n    for (var i = decorators.length - 1; i >= 0; i--)\n      if (d = decorators[i])\n        r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nconst ArcgisHubDiscussionsPostEditor = class {\n  /**\n   * Constructor function, pre-binds context to relevant methods\n   */\n  constructor(hostRef) {\n    registerInstance(this, hostRef);\n    this.arcgisHubDiscussionsPostCancel = createEvent(this, \"arcgisHubDiscussionsPostCancel\", 7);\n    this.arcgisHubDiscussionsPostCreate = createEvent(this, \"arcgisHubDiscussionsPostCreate\", 7);\n    this.arcgisHubDiscussionsPostEdit = createEvent(this, \"arcgisHubDiscussionsPostEdit\", 7);\n    this.arcgisHubDiscussionsGeometryDrawCreate = createEvent(this, \"arcgisHubDiscussionsGeometryDrawCreate\", 7);\n    this.arcgisHubDiscussionsGeometryDrawTypeSelect = createEvent(this, \"arcgisHubDiscussionsGeometryDrawTypeSelect\", 7);\n    this.arcgisHubDiscussionsGeometryDrawEdit = createEvent(this, \"arcgisHubDiscussionsGeometryDrawEdit\", 7);\n    this.arcgisHubDiscussionsGeometryDrawReset = createEvent(this, \"arcgisHubDiscussionsGeometryDrawReset\", 7);\n    this.arcgisHubDiscussionsGeometrySelect = createEvent(this, \"arcgisHubDiscussionsGeometrySelect\", 7);\n    this.arcgisHubDiscussionsGeometryDeselect = createEvent(this, \"arcgisHubDiscussionsGeometryDeselect\", 7);\n    this.arcgisHubDiscussionsGeometryClearAll = createEvent(this, \"arcgisHubDiscussionsGeometryClearAll\", 7);\n    this.hubTelemetry = createEvent(this, \"hubTelemetry\", 7);\n    /**\n     * New features (geometry) unsaved for location updates\n     */\n    this.unsavedFeatures = [];\n    /**\n     * New related features unsaved for location updates\n     */\n    this.unsavedRelatedFeatures = [];\n    /**\n     * Feature geometry edits for existing post locations\n     */\n    this.unsavedExistingFeatures = [];\n    /**\n     * Internal feature state tracking\n     */\n    this._unsavedFeatures = [];\n    /**\n     * Internal related feature state tracking\n     */\n    this._unsavedRelatedFeatures = [];\n    /**\n     * Internal existing feature state tracking\n     */\n    this._unsavedExistingFeatures = [];\n    /**\n     * A create or edit XHR is currently in flight\n     */\n    this.pending = false;\n    /**\n     * Post title string\n     */\n    this.titleValue = '';\n    /**\n     * Post body string\n     */\n    this.bodyValue = '';\n    /**\n     * Initial Post discussion URI\n     */\n    this.discussionValue = '';\n    /**\n     * An event failed\n     */\n    this.errorMessage = null;\n    bind(this, 'handleSubmit', 'handleCancel', 'handleCancelOrConfirm', 'handleConfirmBackButtonClicked', 'updateTitleValue', 'handleSelectRecentChannel', 'handleChannelSelectedFromCombobox', 'handleBack', 'handleGroupSearchOpened', 'proceedToContentCreation', 'handleAddLocationToggle', 'setActiveGeometryDrawType');\n  }\n  /**\n   * Computes if cancel action should be confirmed\n   */\n  get shouldConfirmCancel() {\n    const { titleValue, bodyValue, postDetails } = this;\n    return !postDetails && (titleValue.length > 0 || bodyValue.length > 0);\n  }\n  /**\n   * Computes the mention feature config\n   */\n  get mentionConfig() {\n    const { context, channelDetails, selectedChannelDetails } = this;\n    return {\n      searchUsers: (query) => {\n        var _a;\n        return searchOtherTeamMembers(Object.assign({ id: (_a = channelDetails === null || channelDetails === void 0 ? void 0 : channelDetails.groups[0].id) !== null && _a !== void 0 ? _a : selectedChannelDetails.groups[0].id, currentUser: context.currentUser, query }, context.hubRequestOptions));\n      }\n    };\n  }\n  /**\n   * IPostDetails with augmented with current location edits\n   */\n  get postDetailsWithLocationEdits() {\n    const { postDetails } = this;\n    const { geometryValue, discussionValue } = this;\n    const _postDetails = cloneObject(postDetails);\n    if (_postDetails) {\n      _postDetails.post.geometry = geometryValue;\n      if (discussionValue !== postDetails.post.discussion) {\n        _postDetails.post.discussion = discussionValue;\n      }\n    }\n    return _postDetails;\n  }\n  /**\n   * Component will load lifecycle method, fetches translations and data\n   * needed to render the UI\n   */\n  async componentWillLoad() {\n    const { postDetails, channelDetails } = this;\n    if (postDetails) {\n      const { title, body, discussion, geometry } = postDetails.post;\n      this.bodyValue = body;\n      if (postDetails.post.title) {\n        this.titleValue = title;\n      }\n      this.discussionValue = discussion;\n      const geometryClone = cloneObject(geometry);\n      this.geometryValue = Object.keys(geometryClone).length\n        ? geometryClone\n        : null;\n    }\n    if (channelDetails) {\n      this.proceedToContentCreation();\n    }\n    else {\n      this.step = STEP.AUDIENCE;\n      this.fetchRecentChannelDetails();\n    }\n    this.intl = await intlManager.loadIntlForComponent(this.element);\n  }\n  /**\n   * Fetches a collection of channel detailss in which the user has most recently\n   * posted to and enforces a minimum delay of 300ms before the promise resolves\n   * so skeleton state can be observed\n   * @returns Promise that resolves IChannelDetails[]\n   */\n  async _fetchRecentChannelDetails() {\n    const { context } = this;\n    try {\n      const results = await fetchRecentChannelDetails(Object.assign({ user: context.currentUser }, context.hubRequestOptions));\n      const { items } = results;\n      if (items.length === 0) {\n        this.hubTelemetry.emit(dist.dictionary.category.interaction.action.viewed.label.empty);\n      }\n      else {\n        this.hubTelemetry.emit(Object.assign(Object.assign({}, dist.dictionary.category.interaction.action.viewed.label.recents), { response: dist.constants.response.SUCCESS }));\n      }\n      return items;\n    }\n    catch (e) {\n      this.hubTelemetry.emit(Object.assign(Object.assign({}, dist.dictionary.category.interaction.action.viewed.label.recents), { response: dist.constants.response.FAILURE }));\n      console.error('Failed to fetch recent channels:', e.message);\n      throw e;\n    }\n  }\n  /**\n   * Fetches a collection of channel details in which the user has most recently\n   * posted to and updates state\n   */\n  async fetchRecentChannelDetails() {\n    this.errorMessage = null;\n    this.recentChannelsDetails = undefined;\n    try {\n      this.recentChannelsDetails = await this._fetchRecentChannelDetails();\n    }\n    catch (e) {\n      this.errorMessage = 'error.load';\n      this.recentChannelsDetails = [];\n    }\n  }\n  /**\n   * Emits telemetry with default props\n   * @param telemetry\n   */\n  emitHubTelemetry(telemetry) {\n    var _a;\n    const { channelDetails, selectedChannelDetails } = this;\n    const details = selectedChannelDetails || channelDetails;\n    // will need to update this to channel.id and channel.access when support for non-private is added\n    this.hubTelemetry.emit(Object.assign(Object.assign({}, telemetry), { groupId: details.groups[0].id, groupAccess: details.groups[0].access, groupOrgId: details.groups[0].orgId, channelId: details.channelId, channelAccess: (_a = details.channel) === null || _a === void 0 ? void 0 : _a.access }));\n  }\n  /**\n   * Called when the user selects a group from the Recent Groups section\n   * @param evt A mouse click event object\n   */\n  handleSelectRecentChannel(evt) {\n    const target = evt.target;\n    const index = target.dataset.channelIndex;\n    this.selectedChannelDetails = this.recentChannelsDetails[index];\n    this.emitHubTelemetry(Object.assign(Object.assign({}, dist.dictionary.category.interaction.action.select.label.groups.details.recents), { position: index }));\n    this.proceedToContentCreation();\n  }\n  /**\n   * Handles users clicking the Select Group button after having selected\n   * a group from the combobox\n   */\n  handleChannelSelectedFromCombobox() {\n    this.emitHubTelemetry(dist.dictionary.category.interaction.action.select.label.groups);\n    this.proceedToContentCreation();\n  }\n  /**\n   * Change to the content creation step\n   */\n  proceedToContentCreation() {\n    this.step = STEP.CONTENT;\n  }\n  /**\n   * Handles the calcite-combobox calciteComboboxChange event, if a group is selected\n   * it fetches the group details to use for net new posts\n   * @param evt A CustomEvent that includes the items selected by the calcite-combobox\n   */\n  async handleComboboxChange(evt) {\n    const { context: { hubRequestOptions } } = this;\n    const { detail: { selectedItems } } = evt;\n    if (selectedItems.length) {\n      const [{ value: groupId }] = selectedItems;\n      const [group, { items: [channel] }] = await Promise.all([\n        fetchTeamFromCache(groupId, hubRequestOptions),\n        searchChannels(Object.assign({ params: {\n            num: 1,\n            groups: [groupId],\n            access: [SharingAccess.PRIVATE],\n          } }, hubRequestOptions))\n      ]);\n      this.selectedChannelDetails = channel\n        ? {\n          channelId: channel.id,\n          channel,\n          groups: [group],\n        }\n        : { groups: [group] };\n      this.emitHubTelemetry(dist.dictionary.category.interaction.action.select.label.groups);\n    }\n    else {\n      this.emitHubTelemetry(dist.dictionary.category.interaction.action.deselect.label.groups);\n      this.selectedChannelDetails = null;\n    }\n  }\n  handleGeometryValueUpdated() {\n    if (this.postDetails) {\n      const { postDetails: { post: { geometry } }, geometryValue } = this;\n      this.geometryValueHasChanges = JSON.stringify(geometryValue) !== JSON.stringify(geometry);\n    }\n  }\n  /**\n   * Updates internal _feature state when the unsavedFeatures prop value changes\n   * @param feature A Feature object\n   */\n  mapFeaturePropToState(unsavedFeatures) {\n    var _a;\n    // Used to discriminate between incoming props when multiple replies open (edit post || edit reply || create reply in thread)\n    const { postDetails } = this;\n    if (unsavedFeatures.length) {\n      const featureId = (_a = unsavedFeatures[0].properties) === null || _a === void 0 ? void 0 : _a.id;\n      const postId = postDetails === null || postDetails === void 0 ? void 0 : postDetails.postId;\n      const isRecipient = (postId === featureId) || (!postDetails && featureId === null);\n      if (isRecipient) {\n        this._unsavedFeatures = unsavedFeatures;\n      }\n    }\n    else {\n      this._unsavedFeatures = [];\n    }\n  }\n  /**\n   * Updates internal _feature state when the unsavedExistingFeatures prop value changes\n   * @param feature A Feature object\n   */\n  mapExistingFeaturePropToState(unsavedExistingFeatures) {\n    var _a;\n    // Used to discriminate between incoming props when multiple replies open (edit post || edit reply || create reply in thread)\n    const { postDetails } = this;\n    if (unsavedExistingFeatures.length) {\n      const featureId = (_a = unsavedExistingFeatures[0].properties) === null || _a === void 0 ? void 0 : _a.id;\n      const postId = postDetails === null || postDetails === void 0 ? void 0 : postDetails.postId;\n      const isRecipient = (postId === featureId);\n      if (isRecipient) {\n        this._unsavedExistingFeatures = unsavedExistingFeatures;\n      }\n    }\n    else {\n      this._unsavedExistingFeatures = [];\n    }\n  }\n  /**\n   * Updates internal _relatedFeature state when the relatedFeature prop value changes\n   * @param relatedFeature An IPostRelatedFeatureDetails object\n   */\n  mapRelatedFeaturePropToState(unsavedRelatedFeatures) {\n    // Used to discrimate between incoming props when multiple replies open (edit post || edit reply || create reply in thread)\n    const { postDetails } = this;\n    if (unsavedRelatedFeatures.length) {\n      const relatedFeatureId = unsavedRelatedFeatures[0].postId;\n      const postId = postDetails === null || postDetails === void 0 ? void 0 : postDetails.postId;\n      const isRecipient = (postId === relatedFeatureId) || (!postDetails && relatedFeatureId === null);\n      if (isRecipient) {\n        this._unsavedRelatedFeatures = unsavedRelatedFeatures;\n      }\n    }\n    else {\n      this._unsavedRelatedFeatures = [];\n    }\n  }\n  handleAddLocationsActiveGeometryTypeChanged(geometryType) {\n    if (geometryType) {\n      this.arcgisHubDiscussionsGeometryDrawTypeSelect.emit(geometryType);\n    }\n  }\n  /**\n   * Handles form submissions when editing or creating a net new post\n   * @param evt A form submit event\n   * @returns a Promise<IPost>\n   */\n  handleSubmit(evt) {\n    evt.preventDefault();\n    const promise = this.postDetails\n      ? this.handleEdit()\n      : this.handleCreate();\n    this.pending = true;\n    return promise\n      .finally(() => {\n      this.pending = false;\n      this.arcgisHubDiscussionsGeometryClearAll.emit();\n      this.canAddLocations = false;\n      this.addLocationsActiveGeometryType = null;\n    });\n  }\n  /**\n   * Creates a net new post\n   * @returns a Promise<IPost>\n   */\n  async handleCreate() {\n    var _a, _b, _c;\n    const { context, _unsavedFeatures, _unsavedRelatedFeatures, bodyValue, titleValue, channelDetails, discussionDetails: { discussion, reference: { url } }, arcgisHubDiscussionsPostCreate, selectedChannelDetails, titleElement } = this;\n    const details = channelDetails || selectedChannelDetails;\n    let uri = discussion;\n    if (_unsavedRelatedFeatures.length) {\n      const layerId = url.split('/').pop();\n      const objectIds = new Set(_unsavedRelatedFeatures.map(feature => feature.objectId));\n      uri = augmentDiscussionURIWithFeature(uri, layerId, Array.from(objectIds));\n    }\n    let geometry = null;\n    if (_unsavedFeatures.length) {\n      geometry = _unsavedFeatures.length > 1 ? featuresToGeometryCollection(_unsavedFeatures) : _unsavedFeatures[0].geometry;\n    }\n    this.errorMessage = null;\n    let post;\n    try {\n      post = await createPost(Object.assign({ params: {\n          access: SharingAccess.PRIVATE,\n          groups: details.groups.map(group => group.id),\n          discussion: uri,\n          title: titleValue.trim() || undefined,\n          body: bodyValue.trim(),\n          geometry\n        }, mentionUrl: window.location.href }, context.hubRequestOptions));\n      const channel = (_a = details.channel) !== null && _a !== void 0 ? _a : await fetchChannel(Object.assign({ channelId: post.channelId }, context.hubRequestOptions));\n      this.titleValue = '';\n      this.bodyValue = '';\n      this.hubTelemetry.emit(Object.assign(Object.assign({}, dist.dictionary.category.content.action.create), { response: dist.constants.response.SUCCESS, details: (_b = post.title) !== null && _b !== void 0 ? _b : null, groupId: details.groups[0].id, groupAccess: details.groups[0].access, postId: post.id, channelId: channel.id, channelAccess: channel.access }));\n      arcgisHubDiscussionsPostCreate.emit(post);\n      titleElement.focus();\n      return post;\n    }\n    catch (e) {\n      this.errorMessage = 'error.create';\n      this.hubTelemetry.emit(Object.assign(Object.assign({}, dist.dictionary.category.content.action.create), { response: dist.constants.response.FAILURE, groupId: details.groups[0].id, groupAccess: details.groups[0].access, channelId: details.channelId, channelAccess: (_c = details.channel) === null || _c === void 0 ? void 0 : _c.access }));\n      console.error('Failed to create post:', e.message);\n      return null;\n    }\n  }\n  /**\n   * Edits an existing post\n   * @returns a Promise<IPost>\n   */\n  handleEdit() {\n    const { context, bodyValue, titleValue, channelDetails, postDetails: { post }, _unsavedFeatures, _unsavedExistingFeatures, _unsavedRelatedFeatures, arcgisHubDiscussionsPostEdit, discussionDetails: { reference: { url } } } = this;\n    this.errorMessage = null;\n    let uri = this.discussionValue;\n    if (_unsavedRelatedFeatures.length) {\n      const layerId = url.split('/').pop();\n      const objectIds = _unsavedRelatedFeatures.map(feature => feature.objectId);\n      uri = augmentDiscussionURIWithFeature(uri, layerId, objectIds);\n    }\n    const originalPostFeatures = (this.geometryValue && Object.keys(this.geometryValue).length)\n      ? postToFeatures(Object.assign(Object.assign({}, post), { geometry: this.geometryValue }))\n      : [];\n    _unsavedExistingFeatures.forEach(feature => {\n      // Apply any existing geometry updates to originalPostFeatures\n      const { properties: { index }, geometry } = feature;\n      originalPostFeatures[+index].geometry = geometry;\n    });\n    let geometry = null;\n    const combinedFeatures = [...originalPostFeatures, ..._unsavedFeatures];\n    if (combinedFeatures.length) {\n      geometry = (combinedFeatures.length > 1)\n        ? featuresToGeometryCollection(combinedFeatures)\n        : combinedFeatures[0].geometry.coordinates.length ? combinedFeatures[0].geometry : null;\n    }\n    return updatePost(Object.assign({ postId: post.id, params: {\n        title: titleValue.trim() || null,\n        body: bodyValue.trim(),\n        discussion: uri,\n        geometry\n      }, mentionUrl: window.location.href }, context.hubRequestOptions))\n      .then(editedPost => {\n      this.hubTelemetry.emit(Object.assign(Object.assign({}, dist.dictionary.category.content.action.update), { response: dist.constants.response.SUCCESS, postId: post.id, channelId: channelDetails.channelId, channelAccess: channelDetails.channel.access }));\n      arcgisHubDiscussionsPostEdit.emit(editedPost);\n      return editedPost;\n    })\n      .catch(e => {\n      this.errorMessage = 'error.edit';\n      this.hubTelemetry.emit(Object.assign(Object.assign({}, dist.dictionary.category.content.action.update), { response: dist.constants.response.FAILURE, postId: post.id, channelId: channelDetails.channelId, channelAccess: channelDetails.channel.access }));\n      console.error('Failed to edit post:', e.message);\n      return null;\n    });\n  }\n  /**\n   * Called when the user elects to cancel creating a net new post or\n   * an editing an existing post. Emits arcgisHubDiscussionsPostCancel\n   * @param evt A mouse click event\n   */\n  handleCancel(evt) {\n    var _a, _b, _c, _d, _e, _f;\n    const { channelDetails, postDetails, selectedChannelDetails } = this;\n    const [group] = (_a = selectedChannelDetails === null || selectedChannelDetails === void 0 ? void 0 : selectedChannelDetails.groups) !== null && _a !== void 0 ? _a : [];\n    evt.preventDefault();\n    this.hubTelemetry.emit(Object.assign(Object.assign({}, dist.dictionary.category.interaction.action.close.label.editor), { groupId: (_b = group === null || group === void 0 ? void 0 : group.id) !== null && _b !== void 0 ? _b : null, groupAccess: (_c = group === null || group === void 0 ? void 0 : group.access) !== null && _c !== void 0 ? _c : null, postId: (_d = postDetails === null || postDetails === void 0 ? void 0 : postDetails.postId) !== null && _d !== void 0 ? _d : null, channelId: (_e = channelDetails === null || channelDetails === void 0 ? void 0 : channelDetails.channelId) !== null && _e !== void 0 ? _e : null, channelAccess: (_f = channelDetails === null || channelDetails === void 0 ? void 0 : channelDetails.channel.access) !== null && _f !== void 0 ? _f : null }));\n    this.arcgisHubDiscussionsPostCancel.emit();\n  }\n  /**\n   * Determines whether to confirm the cancellation or close the editor\n   */\n  handleCancelOrConfirm(evt) {\n    if (this.shouldConfirmCancel) {\n      this.confirmCancel = true;\n    }\n    else {\n      this.handleCancel(evt);\n    }\n    this.arcgisHubDiscussionsGeometryClearAll.emit();\n    this.canAddLocations = false;\n  }\n  /**\n   * Called when the cancel confirmation back button is clicked\n   */\n  handleConfirmBackButtonClicked() {\n    this.confirmCancel = false;\n  }\n  /**\n   * Called when the user elects to traverse from the content creation step\n   * back to the group selection step. Resets any previously selected groups\n   * from the combobox and refreshes the recent groups list\n   */\n  handleBack() {\n    if (this.shouldConfirmCancel) {\n      this.confirmCancel = true;\n    }\n    else {\n      this.emitHubTelemetry(Object.assign({}, dist.dictionary.category.interaction.action.close.label.editor.details.addPost));\n      this.selectedChannelDetails = null;\n      this.step = STEP.AUDIENCE;\n      this.fetchRecentChannelDetails();\n    }\n  }\n  handleAddLocationToggle() {\n    const { postDetails, channelDetails } = this;\n    this.canAddLocations = !this.canAddLocations;\n    if (this.canAddLocations) {\n      const id = postDetails && postDetails.postId;\n      this.arcgisHubDiscussionsGeometryDrawCreate.emit(id);\n    }\n    else {\n      this.arcgisHubDiscussionsGeometryDrawReset.emit();\n      this.addLocationsActiveGeometryType = null;\n    }\n    const type = this.canAddLocations ? 'enable' : 'disable';\n    this.hubTelemetry.emit(Object.assign(Object.assign({}, dist.dictionary.category.interaction.action[type].label.addLocation), { postId: postDetails === null || postDetails === void 0 ? void 0 : postDetails.postId, channelId: channelDetails === null || channelDetails === void 0 ? void 0 : channelDetails.channelId, channelAccess: channelDetails === null || channelDetails === void 0 ? void 0 : channelDetails.channel.access }));\n  }\n  /**\n   * Called when the help popover is opened\n   */\n  handleHelpOpened() {\n    this.hubTelemetry.emit(dist.dictionary.category.interaction.action.open.label.popover.details.help);\n  }\n  /**\n   * Called when the help popover is opened\n   */\n  handleHelpClosed() {\n    this.hubTelemetry.emit(dist.dictionary.category.interaction.action.close.label.popover.details.help);\n  }\n  /**\n   * Called when the group search combobox is opened\n   */\n  handleGroupSearchOpened() {\n    this.hubTelemetry.emit(dist.dictionary.category.interaction.action.open.label.search);\n  }\n  /**\n   * Called when the user changes the text of the post body content\n   * @param evt An onChange event for the post body calcite-input\n   */\n  updateBodyValue(evt) {\n    this.bodyValue = evt.target.value;\n  }\n  handleFeatureRemove(evt) {\n    var _a;\n    const { detail: { properties: { relatedFeatureId, index, unsaved } } } = evt;\n    if (!unsaved) {\n      if (relatedFeatureId) {\n        // remove relatedFeature from discsussion URI\n        const { features } = parseDiscussionURI(this.discussionValue);\n        const layerId = this.discussionDetails.reference.url.split('/').pop();\n        features.splice(features.indexOf(relatedFeatureId), 1);\n        this.discussionValue = augmentDiscussionURIWithFeature(this.discussionValue.split('?')[0], layerId, features);\n      }\n      else {\n        // remove feature from discussion geometry\n        if (((_a = this.geometryValue) === null || _a === void 0 ? void 0 : _a.type) === 'GeometryCollection') {\n          if (unsaved) {\n            this.geometryValue.geometries.splice(index, 1);\n          }\n          else {\n            this.geometryValue.geometries[index] = null;\n          }\n          this.geometryValue = Object.assign({}, this.geometryValue);\n        }\n        else {\n          this.geometryValue = null;\n        }\n      }\n    }\n  }\n  /**\n   * Called when the user changes the text of the post title content\n   * @param evt An onChange event for the reply body calcite-inpu\n   */\n  updateTitleValue(evt) {\n    this.titleValue = evt.target.value;\n  }\n  setActiveGeometryDrawType(evt) {\n    const { addLocationsActiveGeometryType } = this;\n    const { target } = evt;\n    const geometryType = target.dataset.type;\n    this.addLocationsActiveGeometryType = geometryType === addLocationsActiveGeometryType\n      ? undefined\n      : geometryType;\n  }\n  /**\n   * Computes if the title value is valid\n   */\n  get isTitleValid() {\n    const { titleValue } = this;\n    return titleValue.length <= MAX_TITLE_LENGTH;\n  }\n  /**\n   * Computes if the body value is valid\n   */\n  get isBodyValid() {\n    const { bodyValue } = this;\n    return bodyValue.trim().length > 0 && bodyValue.length <= MAX_BODY_LENGTH;\n  }\n  /**\n   * Returns true if post has new location changes or updates\n   */\n  get hasLocationChanges() {\n    if (this.postDetails) {\n      const { postDetails: { post: { discussion } }, discussionValue } = this;\n      return Boolean(this._unsavedFeatures.length + this._unsavedRelatedFeatures.length + this._unsavedExistingFeatures.length) || (discussionValue !== discussion || this.geometryValueHasChanges);\n    }\n    return false;\n  }\n  /**\n   * Computes title warning/error messages\n   */\n  get titleMessage() {\n    const { titleValue, isTitleValid, intl } = this;\n    const { length } = titleValue;\n    if (length >= MAX_TITLE_LENGTH - 5) {\n      return isTitleValid\n        ? {\n          status: 'idle',\n          text: intl.t('post.title.validation.warning')\n        }\n        : {\n          icon: 'exclamation-mark-circle',\n          status: 'invalid',\n          text: intl.t('post.title.validation.error', { characters: length - MAX_TITLE_LENGTH })\n        };\n    }\n  }\n  /**\n   * Computes body warning/error messages\n   */\n  get bodyMessage() {\n    const { bodyValue, isBodyValid, intl } = this;\n    const { length } = bodyValue;\n    if (length >= WARNING_BODY_LENGTH) {\n      return isBodyValid\n        ? {\n          status: 'idle',\n          text: intl.t('post.body.validation.warning')\n        }\n        : {\n          icon: 'exclamation-mark-circle',\n          status: 'invalid',\n          text: intl.t('post.body.validation.error')\n        };\n    }\n  }\n  /**\n   * Computes the blocked noticed variant\n   */\n  get blockedNotice() {\n    var _a;\n    let variant;\n    if (this.channelDetails) {\n      const isGroupDiscussable = isDiscussable((_a = this.channelDetails) === null || _a === void 0 ? void 0 : _a.groups[0]);\n      const isSubjectDiscussable = isDiscussable(this.discussionDetails.reference);\n      if (!isGroupDiscussable && !isSubjectDiscussable) {\n        variant = ArcgisHubDiscussionsBlockedNoticeVariant.EditPost;\n      }\n      else if (!isGroupDiscussable) {\n        variant = ArcgisHubDiscussionsBlockedNoticeVariant.EditPostGroup;\n      }\n      else if (!isSubjectDiscussable) {\n        variant = this.discussionDetails.type === 'group'\n          ? ArcgisHubDiscussionsBlockedNoticeVariant.EditPostGroup\n          : ArcgisHubDiscussionsBlockedNoticeVariant.EditPostItem;\n      }\n    }\n    return variant;\n  }\n  /**\n   * Renders the editor's primary action button for editing an existing\n   * or creating a net new post\n   */\n  renderPrimaryActionButton() {\n    const { postDetails, intl, titleValue, bodyValue, isBodyValid, isTitleValid, pending, hasLocationChanges, blockedNotice } = this;\n    let text;\n    let disabled;\n    const isInvalid = !isBodyValid || !isTitleValid;\n    if (postDetails) {\n      text = intl.t('post.save');\n      disabled = Boolean(blockedNotice) || isInvalid || (titleValue === postDetails.post.title && bodyValue === postDetails.post.body && !hasLocationChanges);\n    }\n    else {\n      text = intl.t('post.create');\n      disabled = Boolean(blockedNotice) || isInvalid;\n    }\n    return (h(\"calcite-button\", { class: \"hub-discussions-post-editor-post-actions__primary\", disabled: disabled, label: text, loading: pending, round: true, scale: \"l\", type: \"submit\" }, text));\n  }\n  /**\n   * Renders the editor's secondary action button, currently the cancel\n   * edit/create post button\n   */\n  renderSecondaryActionButton() {\n    const { intl, handleCancelOrConfirm } = this;\n    const text = intl.t('post.cancel');\n    return (h(\"calcite-button\", {\n      // appearance=\"clear\"\n      class: \"hub-discussions-post-editor-post-actions__secondary\", color: \"neutral\", label: text, onClick: handleCancelOrConfirm, round: true, scale: \"l\", type: \"button\"\n    }, text));\n  }\n  renderAddLocationsButton() {\n    const { hasMap, canAddLocations, blockedNotice, addLocationsActiveGeometryType, intl } = this;\n    const locationActionTypes = [\n      { type: 'select', icon: 'select' },\n      { type: 'point', icon: 'pin' },\n      { type: 'polyline', icon: 'freehand' },\n      { type: 'polygon', icon: 'freehand-area' }\n    ];\n    const locationActions = locationActionTypes.map(({ type, icon }) => {\n      return (h(\"calcite-action\", { active: addLocationsActiveGeometryType === type, \"data-type\": type, icon: icon, key: type, onClick: this.setActiveGeometryDrawType, text: intl.t(`location.action.${type}`), textEnabled: true }));\n    });\n    return (h(Fragment, null, h(\"calcite-popover\", {\n      // disablePointer\n      label: intl.t('location.heading'), open: canAddLocations && !Boolean(addLocationsActiveGeometryType), referenceElement: this.locationActionElement, triggerDisabled: true\n    }, locationActions), h(\"calcite-tooltip\", { closeOnClick: true, label: intl.t('location.tooltip'), referenceElement: !canAddLocations && this.locationActionElement }, h(\"span\", null, intl.t('location.tooltip'))), h(\"calcite-action\", { active: canAddLocations, appearance: 'solid', class: \"add-location-post\", disabled: !hasMap || Boolean(blockedNotice), onClick: this.handleAddLocationToggle, ref: (locationActionElement) => { this.locationActionElement = locationActionElement; }, text: intl.t('location.heading') }, h(\"calcite-icon\", { class: \"add-location-icon\", icon: \"pin-plus\", scale: \"s\" }))));\n  }\n  /**\n   * Renders the title field\n   */\n  renderTitleField() {\n    const { intl, titleValue, updateTitleValue, titleMessage, blockedNotice } = this;\n    return (h(Fragment, null, h(\"input\", { \"aria-label\": intl.t('post.title.label'), autofocus: true, class: \"hub-discussions-post-editor__title\", disabled: Boolean(blockedNotice), onInput: updateTitleValue, placeholder: intl.t('post.title.placeholder'), ref: (titleElement) => { this.titleElement = titleElement; }, type: \"text\", value: titleValue }), titleMessage && (h(\"calcite-input-message\", {\n      // active\n      class: \"hub-discussions-post-editor__message\", icon: titleMessage.icon, scale: \"l\", status: titleMessage.status\n    }, titleMessage.text))));\n  }\n  /**\n   * Renders the body field\n   */\n  renderBodyField() {\n    const { intl, bodyValue, bodyMessage, pending, mentionConfig, context, blockedNotice } = this;\n    return (h(Fragment, null, h(\"arcgis-hub-rich-text\", { class: \"hub-discussions-post-editor__body\", context: context, disabled: Boolean(blockedNotice) || pending, label: intl.t('post.body.label'), mention: mentionConfig, placeholder: intl.t('post.body.placeholder'), \"text-transform\": true, toolbar: \"\", value: bodyValue }), bodyMessage && (h(\"calcite-input-message\", {\n      // active\n      class: \"hub-discussions-post-editor__message\", icon: bodyMessage.icon, scale: \"l\", status: bodyMessage.status\n    }, bodyMessage.text))));\n  }\n  /**\n   * Renders the UI for creating/editing post content step\n   */\n  renderContentStep() {\n    var _a;\n    const { intl, hasMap, postDetails, channelDetails, discussionDetails, selectedChannelDetails, index, isHub, errorMessage, context, _unsavedFeatures, _unsavedRelatedFeatures, _unsavedExistingFeatures, postDetailsWithLocationEdits, blockedNotice, isMobile } = this;\n    return this.confirmCancel\n      ? this.renderConfirmCancel()\n      : (h(\"form\", { onSubmit: this.handleSubmit }, postDetails && channelDetails\n        ?\n          (h(\"arcgis-hub-discussions-post-header\", { channelDetails: channelDetails, class: \"hub-discussions-post-editor__header\", context: context, index: index, isHub: isHub, postDetails: postDetails }))\n        : (h(\"arcgis-hub-discussions-post-header\", { access: SharingAccess.PRIVATE, class: \"hub-discussions-post-editor__header\", context: context, groups: selectedChannelDetails.groups, index: index, isHub: isHub })), this.renderTitleField(), this.renderBodyField(), h(\"arcgis-hub-discussions-post-geography\", { channelDetails: channelDetails, context: context, disabled: Boolean(blockedNotice), discussionDetails: discussionDetails, hasMap: hasMap, isMobile: isMobile, postDetails: postDetailsWithLocationEdits, renderedInEditor: true, unsavedExistingFeatures: _unsavedExistingFeatures, unsavedFeatures: _unsavedFeatures, unsavedRelatedFeatures: _unsavedRelatedFeatures, url: (_a = discussionDetails === null || discussionDetails === void 0 ? void 0 : discussionDetails.reference) === null || _a === void 0 ? void 0 : _a.url }), h(\"div\", { class: \"hub-discussions-post-editor-post-actions\" }, this.renderAddLocationsButton(), this.renderSecondaryActionButton(), this.renderPrimaryActionButton()), blockedNotice && (h(\"arcgis-hub-discussions-blocked-notice\", { class: \"hub-discussions-post-editor__not-discussable-notice\", scale: \"s\", slot: \"list-before\", variant: blockedNotice })), errorMessage && (h(\"calcite-notice\", {\n        // active\n        class: \"hub-discussions-post-editor__crud-error\", color: \"red\", scale: \"s\"\n      }, h(\"div\", { slot: \"title\" }, intl.t('error.title')), h(\"div\", { slot: \"message\" }, errorMessage && intl.t(errorMessage))))));\n  }\n  /**\n   * Renders the header UI for the group selection and content creation steps\n   */\n  renderHeader() {\n    const { intl, handleCancelOrConfirm, handleBack, confirmCancel, step } = this;\n    let config = {\n      action: handleCancelOrConfirm,\n      icon: 'x'\n    };\n    if (step === STEP.CONTENT) {\n      config = {\n        action: handleBack,\n        icon: 'chevron-left'\n      };\n    }\n    return (h(\"header\", { class: \"hub-discussions-post-editor-header\" }, h(\"calcite-button\", {\n      // appearance=\"clear\"\n      color: \"neutral\", disabled: confirmCancel, \"icon-start\": config.icon, label: intl.t(`header.${step}.back`), onClick: config.action, round: true, scale: \"l\", type: \"button\"\n    }), h(\"p\", { class: \"hub-discussions-post-editor-header__title\" }, intl.t(`header.${step}.title`)), h(\"calcite-popover\", {\n      // dismissible\n      label: intl.t('header.help'), placement: \"bottom-end\", referenceElement: \"help\"\n    }, h(\"p\", { class: \"hub-discussions-post-editor-header__popover\" }, intl.t(`header.${step}.help`))), h(\"calcite-button\", { appearance: \"transparent\", color: \"neutral\", disabled: confirmCancel, \"icon-start\": \"lightbulb\", id: \"help\", label: intl.t('header.help'), round: true, scale: \"l\", type: \"button\" })));\n  }\n  /**\n   * Renders the UI for cancel confirmation\n   */\n  renderConfirmCancel() {\n    const { intl, handleConfirmBackButtonClicked, handleCancel } = this;\n    return (h(\"div\", { class: \"hub-discussions-post-editor-cancel-confirm\" }, h(\"header\", { class: \"hub-discussions-post-editor-cancel-confirm__header\" }, intl.t('confirm.header')), h(\"p\", { class: \"hub-discussions-post-editor-cancel-confirm__message\" }, intl.t('confirm.body')), h(\"footer\", { class: \"hub-discussions-post-editor-cancel-confirm__footer\" }, h(\"calcite-button\", {\n      // appearance=\"clear\"\n      color: \"neutral\", onClick: handleConfirmBackButtonClicked, round: true, scale: \"l\"\n    }, intl.t('confirm.back')), h(\"calcite-button\", { color: \"red\", onClick: handleCancel, round: true, scale: \"l\" }, intl.t('confirm.discard')))));\n  }\n  /**\n   * Renders the UI for the group selection step\n   */\n  renderGroupSelectionStep() {\n    const { intl, selectedChannelDetails, handleChannelSelectedFromCombobox, context } = this;\n    return (h(Fragment, null, h(\"calcite-combobox\", { label: intl.t('groups.label'), placeholder: intl.t('groups.placeholder'), scale: \"l\", \"selection-mode\": \"single\", value: selectedChannelDetails ? selectedChannelDetails.groups[0].id : null }, context.currentUser.groups.map((group) => {\n      const canDiscuss = isDiscussable(group);\n      return (h(\"calcite-combobox-item\", { disabled: !canDiscuss, icon: canDiscuss ? undefined : 'circle-disallowed', key: group.id, textLabel: group.title, value: group.id }));\n    })), selectedChannelDetails && (h(\"calcite-button\", { class: \"hub-discussions-post-editor-groups__action\", onClick: handleChannelSelectedFromCombobox, round: true, scale: \"l\", type: \"button\", width: \"full\" }, intl.t('groups.label'))), this.renderRecentChannels()));\n  }\n  /**\n   * Renders a channel details\n   * @param channelDetails An IChannelDetails object\n   * @param index The index to build the data-channel-index value\n   * @returns\n   */\n  renderRecentChannelDetails(channelDetails, index) {\n    const { intl, context, handleSelectRecentChannel } = this;\n    const { latestUserPost, groups: [group] } = channelDetails;\n    const delta = Date.now() - new Date(latestUserPost.createdAt).valueOf();\n    const days = Math.floor(delta / TIME_INTERVAL.DAY);\n    const timeStr = intl.formatRelativeTime(-days, TIME_UNIT.DAY);\n    return (h(\"li\", { class: \"hub-discussions-post-editor-recent__item\", key: group.id }, h(\"calcite-avatar\", { class: \"hub-discussions-post-editor-recent__avatar\", \"full-name\": group.title, scale: \"l\", thumbnail: getGroupThumbnailUrl(context.session.portal, group, context.session.token) }), h(\"b\", { class: \"hub-discussions-post-editor-recent__title\" }, group.title), h(\"i\", { class: \"hub-discussions-post-editor-recent__last-activity\" }, intl.t('groups.posted', { timeStr })), h(\"calcite-button\", {\n      // appearance=\"clear\"\n      class: \"hub-discussions-post-editor-recent__action\", color: \"neutral\", \"data-channel-index\": index, \"icon-start\": \"chevron-right\", onClick: handleSelectRecentChannel, round: true, scale: \"l\", type: \"button\"\n    })));\n  }\n  /**\n   * Renders a recent channel skeleton loader\n   * @param index The index to build the key\n   */\n  renderRecentChannelSkeleton(index) {\n    return (h(\"li\", { class: \"hub-discussions-post-editor-recent__skeleton\", key: `skeleton-${index}` }, h(\"arcgis-skeleton-loader\", { active: true, rows: 0, showFooter: false, showHeading: false, showThumbnail: false }, h(\"div\", null), h(\"div\", null, h(\"div\", null), h(\"div\", null)))));\n  }\n  /**\n   * Renders the empty state when no recent channels exist yet\n   */\n  renderRecentChannelsEmpty() {\n    const { intl } = this;\n    return (h(\"calcite-notice\", {\n      // active\n      class: \"hub-discussions-post-editor__empty\", scale: \"m\"\n    }, h(\"div\", { slot: \"title\" }, intl.t('empty.title')), h(\"div\", { slot: \"message\" }, intl.t('empty.message')), h(\"calcite-link\", { href: \"https://doc.arcgis.com/en/hub/team/how-discussions-work.htm\", iconEnd: \"launch\", slot: \"link\" }, intl.t('empty.link'))));\n  }\n  /**\n   * Renders the error when recent channels fail to load\n   */\n  renderRecentChannelsError() {\n    const { errorMessage, intl } = this;\n    return (h(\"calcite-notice\", {\n      // active\n      class: \"hub-discussions-post-editor__load-error\", color: \"red\"\n    }, h(\"div\", { slot: \"title\" }, intl.t('error.load.title')), h(\"div\", { slot: \"message\" }, errorMessage && intl.t(errorMessage))));\n  }\n  /**\n   * Renders the recent channels list\n   */\n  renderRecentChannels() {\n    const { intl, errorMessage, recentChannelsDetails = Array.from({ length: 4 }).map(_ => null) } = this;\n    let rendered;\n    if (errorMessage) {\n      rendered = this.renderRecentChannelsError();\n    }\n    else if (recentChannelsDetails.length) {\n      rendered = (h(\"ul\", { class: \"hub-discussions-post-editor-recent__list\" }, recentChannelsDetails.map((channelDetails, index) => channelDetails\n        ? this.renderRecentChannelDetails(channelDetails, index)\n        : this.renderRecentChannelSkeleton(index))));\n    }\n    else {\n      rendered = this.renderRecentChannelsEmpty();\n    }\n    return (h(Fragment, null, h(\"header\", { class: \"hub-discussions-post-editor-recent__header\" }, intl.t('groups.recent')), rendered));\n  }\n  /**\n   * Renders the UI for creating net new posts\n   */\n  renderCreate() {\n    return (h(Fragment, null, this.renderHeader(), this.step === STEP.AUDIENCE\n      ? this.renderGroupSelectionStep()\n      : this.renderContentStep()));\n  }\n  /**\n   * Renders a loading indicator\n   */\n  renderLoading() {\n    return (h(\"calcite-loader\", {\n      // active\n      label: this.intl.t('loading'), scale: \"m\", type: \"indeterminate\"\n    }));\n  }\n  /**\n   * Primary render entrypoint\n   */\n  render() {\n    const { postDetails } = this;\n    const view = postDetails\n      ? this.renderContentStep()\n      : this.renderCreate();\n    return (h(Host, { class: \"hub-discussions-post-editor\", \"data-element\": \"discussions-post-editor\" }, view));\n  }\n  static get assetsDirs() { return [\"locales\"]; }\n  get element() { return getElement(this); }\n  static get watchers() { return {\n    \"geometryValue\": [\"handleGeometryValueUpdated\"],\n    \"unsavedFeatures\": [\"mapFeaturePropToState\"],\n    \"unsavedExistingFeatures\": [\"mapExistingFeaturePropToState\"],\n    \"unsavedRelatedFeatures\": [\"mapRelatedFeaturePropToState\"],\n    \"addLocationsActiveGeometryType\": [\"handleAddLocationsActiveGeometryTypeChanged\"]\n  }; }\n};\n__decorate$2([\n  minPromiseDelayFactory({ delay: 300 })\n], ArcgisHubDiscussionsPostEditor.prototype, \"_fetchRecentChannelDetails\", null);\n__decorate$2([\n  CallWhenFactory({ when() { return !this.isMobile; } })\n], ArcgisHubDiscussionsPostEditor.prototype, \"renderAddLocationsButton\", null);\nArcgisHubDiscussionsPostEditor.style = arcgisHubDiscussionsPostEditorCss;\n\nconst arcgisHubDiscussionsPostHeaderCss = \":host{display:block}address{display:grid;grid-template-rows:repeat(2, minmax(0, 1fr));-moz-column-gap:0.5rem;column-gap:0.5rem;row-gap:0.25rem;font-style:normal;grid-template-columns:54px auto}arcgis-hub-discussions-popover{grid-row:span 2 / span 2}button{cursor:pointer;border-style:none;background-color:transparent;padding:0px}header{display:flex;align-items:flex-end;font-size:var(--calcite-font-size-0);line-height:1.25rem;font-weight:var(--calcite-font-weight-bold);text-transform:capitalize;color:var(--calcite-ui-text-1)}.avatars{position:relative;grid-row:span 2 / span 2;display:flex;height:54px}.avatars calcite-avatar+calcite-avatar{position:absolute;top:1rem;left:1rem;z-index:10;border-radius:9999px;border:3px solid var(--calcite-ui-foreground-1)}.metadata{display:flex;flex-wrap:nowrap;font-size:var(--calcite-font-size--1);line-height:1rem}.metadata b{max-height:1rem;word-break:break-all;font-weight:var(--calcite-font-weight-medium);font-style:normal;color:var(--calcite-ui-text-2);overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}.metadata span{display:flex;width:1rem;justify-content:center;font-size:var(--calcite-font-size--1);line-height:1rem;color:var(--calcite-ui-text-2)}.metadata arcgis-relative-date{white-space:nowrap}.metadata calcite-icon{margin-top:-0.125rem}\";\n\nconst ArcgisHubDiscussionsPostHeader = class {\n  constructor(hostRef) {\n    registerInstance(this, hostRef);\n  }\n  async componentWillLoad() {\n    this.intl = await intlManager.loadIntlForComponent(this.element);\n  }\n  get creator() {\n    var _a;\n    const { postDetails, context } = this;\n    return postDetails ? (_a = postDetails.creatorDetails) === null || _a === void 0 ? void 0 : _a.user : context.currentUser;\n  }\n  get group() {\n    const { channelDetails, groups } = this;\n    return channelDetails ? channelDetails.groups[0] : groups[0];\n  }\n  get creatorFullName() {\n    var _a;\n    const { intl, postDetails, creator } = this;\n    let fullName = intl.t('anonymous');\n    if (creator || ((_a = postDetails === null || postDetails === void 0 ? void 0 : postDetails.post) === null || _a === void 0 ? void 0 : _a.creator)) {\n      fullName = (creator === null || creator === void 0 ? void 0 : creator.fullName) || intl.t('privateUser');\n    }\n    return fullName;\n  }\n  get accessIcon() {\n    const { intl, channelDetails } = this;\n    const access = channelDetails ? channelDetails.channel.access : this.access;\n    let icon;\n    let label;\n    if (access === SharingAccess.PRIVATE) {\n      icon = 'lock';\n      label = intl.t('visiblePrivate');\n    }\n    else if (access === SharingAccess.ORG) {\n      icon = 'organization';\n      label = intl.t('visibleOrg');\n    }\n    else {\n      icon = 'globe';\n      label = intl.t('visibleAll');\n    }\n    return { icon, label };\n  }\n  renderAccessIcon() {\n    const { accessIcon } = this;\n    return (h(\"calcite-icon\", { icon: accessIcon.icon, scale: \"s\", \"text-label\": accessIcon.label }));\n  }\n  renderPopover(avatars) {\n    const { postDetails, channelDetails, index, context, isHub } = this;\n    return postDetails\n      ? (h(\"arcgis-hub-discussions-popover\", { channelDetails: channelDetails, context: context, index: index, isHub: isHub, postDetails: postDetails }, avatars))\n      : avatars;\n  }\n  renderAvatars() {\n    const { creator } = this;\n    let avatars = (h(\"div\", { class: \"avatars\" }, this.renderCreatorAvatar(), this.renderChannelAvatar()));\n    if (creator) {\n      avatars = this.renderPopover(avatars);\n    }\n    return avatars;\n  }\n  renderCreatorAvatar() {\n    var _a, _b;\n    const { postDetails, creator, context } = this;\n    const user = (!creator && (postDetails === null || postDetails === void 0 ? void 0 : postDetails.post))\n      ? { username: (_a = postDetails.post) === null || _a === void 0 ? void 0 : _a.creator }\n      : creator;\n    return (h(\"calcite-avatar\", { \"full-name\": user === null || user === void 0 ? void 0 : user.fullName, scale: \"l\", thumbnail: (user === null || user === void 0 ? void 0 : user.thumbnail) && getUserThumbnailUrl(context.session.portal, user, context.session.token), \"user-id\": (_b = user) === null || _b === void 0 ? void 0 : _b.id, username: user === null || user === void 0 ? void 0 : user.username }));\n  }\n  renderChannelAvatar() {\n    const { group, context } = this;\n    return (h(\"calcite-avatar\", { \"full-name\": group === null || group === void 0 ? void 0 : group.title, scale: \"m\", thumbnail: group && getGroupThumbnailUrl(context.session.portal, group, context.session.token) }));\n  }\n  render() {\n    var _a;\n    const { postDetails, group, creatorFullName, intl } = this;\n    return (h(Host, null, h(\"address\", null, this.renderAvatars(), h(\"header\", null, creatorFullName), h(\"div\", { class: {\n        metadata: true,\n        timestamp: Boolean(postDetails === null || postDetails === void 0 ? void 0 : postDetails.post)\n      } }, h(\"b\", null, (_a = group === null || group === void 0 ? void 0 : group.title) !== null && _a !== void 0 ? _a : intl.t('group.deleted')), (postDetails === null || postDetails === void 0 ? void 0 : postDetails.post) && (h(Fragment, null, h(\"span\", null, \"\\u00B7\"), h(\"arcgis-relative-date\", { dateTime: postDetails.post.createdAt, formatStyle: \"short\" }))), h(\"span\", null, \"\\u00B7\"), this.renderAccessIcon()))));\n  }\n  static get assetsDirs() { return [\"locales\"]; }\n  get element() { return getElement(this); }\n};\nArcgisHubDiscussionsPostHeader.style = arcgisHubDiscussionsPostHeaderCss;\n\nconst arcgisHubDiscussionsReplyCss = \".sc-arcgis-hub-discussions-reply-h{display:block;background-color:var(--calcite-ui-foreground-1)}article.sc-arcgis-hub-discussions-reply{position:relative;display:grid;grid-template-rows:repeat(1, minmax(0, 1fr));gap:0.75rem;grid-template-columns:2rem auto}div.sc-arcgis-hub-discussions-reply{overflow-x:auto}.reply-lead.sc-arcgis-hub-discussions-reply{padding-bottom:1.25rem}.reply-lead.sc-arcgis-hub-discussions-reply::before{position:absolute;top:2.25rem;display:block;width:0.125rem;border-radius:0.125rem;background-color:var(--calcite-ui-foreground-2);height:calc(100% - 2.25rem);left:15px;content:\\\"\\\"}arcgis-hub-discussions-reply-editor.reply-lead.sc-arcgis-hub-discussions-reply{padding-bottom:1.5rem}arcgis-hub-discussions-reply-editor.reply-lead.sc-arcgis-hub-discussions-reply::before{z-index:-10}address.sc-arcgis-hub-discussions-reply{margin-bottom:0.125rem;display:grid;font-size:var(--calcite-font-size--1);font-style:normal;line-height:1.25rem;grid-template-columns:minmax(0, -webkit-max-content) 1rem minmax(0, -webkit-max-content);grid-template-columns:minmax(0, max-content) 1rem minmax(0, max-content)}address.sc-arcgis-hub-discussions-reply b.sc-arcgis-hub-discussions-reply{font-size:var(--calcite-font-size-0);line-height:1.25rem;font-weight:var(--calcite-font-weight-bold);color:var(--calcite-ui-text-1)}address.sc-arcgis-hub-discussions-reply span.sc-arcgis-hub-discussions-reply{display:flex;justify-content:center;color:var(--calcite-ui-text-2)}address.sc-arcgis-hub-discussions-reply arcgis-relative-date.sc-arcgis-hub-discussions-reply{color:var(--calcite-ui-text-2)}arcgis-multiline-ellipsis.sc-arcgis-hub-discussions-reply{font-size:var(--calcite-font-size-0);line-height:1.375}calcite-action-group.sc-arcgis-hub-discussions-reply{margin-left:-0.5rem}.hidden.sc-arcgis-hub-discussions-reply{visibility:hidden}@-webkit-keyframes in-right{0%{opacity:0;transform:translate3D(-100%, 0, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-right{0%{opacity:0;transform:translate3D(-100%, 0, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}article.in.sc-arcgis-hub-discussions-reply{-webkit-animation:in-right 300ms ease-out forwards;animation:in-right 300ms ease-out forwards}@-webkit-keyframes out-left{0%{opacity:1;transform:translate3D(0, 0, 0)}100%{opacity:0;transform:translate3D(-100%, 0, 0)}}@keyframes out-left{0%{opacity:1;transform:translate3D(0, 0, 0)}100%{opacity:0;transform:translate3D(-100%, 0, 0)}}article.out.sc-arcgis-hub-discussions-reply{-webkit-animation:out-left 300ms ease-out forwards;animation:out-left 300ms ease-out forwards}arcgis-hub-discussions-reply-editor.sc-arcgis-hub-discussions-reply{padding-bottom:1rem}@-webkit-keyframes in-left{0%{opacity:0;transform:translate3D(100%, 0, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-left{0%{opacity:0;transform:translate3D(100%, 0, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}arcgis-hub-discussions-reply-editor.in.sc-arcgis-hub-discussions-reply{-webkit-animation:in-left 300ms ease-out forwards;animation:in-left 300ms ease-out forwards}@-webkit-keyframes out-right{0%{opacity:1;transform:translate3D(0, 0, 0)}100%{opacity:0;transform:translate3D(100%, 0, 0)}}@keyframes out-right{0%{opacity:1;transform:translate3D(0, 0, 0)}100%{opacity:0;transform:translate3D(100%, 0, 0)}}arcgis-hub-discussions-reply-editor.out.sc-arcgis-hub-discussions-reply{-webkit-animation:out-right 300ms ease-out forwards;animation:out-right 300ms ease-out forwards}arcgis-hub-discussions-reply-editor[data-editing].sc-arcgis-hub-discussions-reply{padding-left:0px;padding-right:0px}arcgis-multiline-ellipsis.sc-arcgis-hub-discussions-reply+calcite-notice.sc-arcgis-hub-discussions-reply{margin-top:1rem}.flipY.sc-arcgis-hub-discussions-reply{transform:scaleY(-1)}article.out-of-context.sc-arcgis-hub-discussions-reply{margin-left:1rem;margin-right:1rem;display:grid;gap:0.5rem;font-style:normal;grid-template-columns:1fr}article.out-of-context.sc-arcgis-hub-discussions-reply>div.reply-body.sc-arcgis-hub-discussions-reply{display:grid;gap:0.25rem}article.out-of-context.sc-arcgis-hub-discussions-reply>div.reply-body.sc-arcgis-hub-discussions-reply>arcgis-hub-discussions-post-geography.sc-arcgis-hub-discussions-reply{margin-left:-1rem}.reply-header.sc-arcgis-hub-discussions-reply{display:grid;grid-template-rows:repeat(2, minmax(0, 1fr));-moz-column-gap:0.5rem;column-gap:0.5rem;row-gap:0.25rem;font-style:normal;grid-template-columns:54px auto}arcgis-hub-discussions-popover.sc-arcgis-hub-discussions-reply{grid-row:span 2 / span 2}.reply-header.sc-arcgis-hub-discussions-reply header.sc-arcgis-hub-discussions-reply{display:flex;align-items:flex-end;font-size:var(--calcite-font-size-0);line-height:1.25rem;font-weight:var(--calcite-font-weight-bold);text-transform:capitalize;color:var(--calcite-ui-text-1)}.header-avatars.sc-arcgis-hub-discussions-reply{grid-row:span 2 / span 2;display:flex;height:54px}.header-avatars.sc-arcgis-hub-discussions-reply calcite-avatar.sc-arcgis-hub-discussions-reply+calcite-avatar.sc-arcgis-hub-discussions-reply{position:absolute;top:1rem;left:1rem;z-index:10;box-sizing:content-box;border-radius:9999px;border:3px solid var(--calcite-ui-foreground-1)}.reply-header.sc-arcgis-hub-discussions-reply .metadata.sc-arcgis-hub-discussions-reply{display:flex;flex-wrap:nowrap;gap:0.25rem;font-size:var(--calcite-font-size--1);line-height:1rem}.reply-header.sc-arcgis-hub-discussions-reply .metadata.sc-arcgis-hub-discussions-reply b.sc-arcgis-hub-discussions-reply{max-height:1rem;word-break:break-all;font-weight:var(--calcite-font-weight-medium);font-style:normal;color:var(--calcite-ui-text-2);overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}.reply-header.sc-arcgis-hub-discussions-reply .metadata.sc-arcgis-hub-discussions-reply span.sc-arcgis-hub-discussions-reply{display:flex;width:0.5rem;justify-content:center;font-size:var(--calcite-font-size--1);line-height:1rem;color:var(--calcite-ui-text-2)}\";\n\nvar __decorate$1 = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\n  var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\")\n    r = Reflect.decorate(decorators, target, key, desc);\n  else\n    for (var i = decorators.length - 1; i >= 0; i--)\n      if (d = decorators[i])\n        r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar ReplyView;\n(function (ReplyView) {\n  ReplyView[\"Skeleton\"] = \"skeleton\";\n  ReplyView[\"Content\"] = \"content\";\n  ReplyView[\"OutOfContext\"] = \"outOfContext\";\n  ReplyView[\"Editor\"] = \"editor\";\n  ReplyView[\"Deleted\"] = \"deleted\";\n})(ReplyView || (ReplyView = {}));\n/**\n * Classes used by this component to facilitate the animations\n * when transitioning between default reply and editor views\n */\nvar ANIMATION_CLASSES;\n(function (ANIMATION_CLASSES) {\n  ANIMATION_CLASSES[\"IN\"] = \"in\";\n  ANIMATION_CLASSES[\"OUT\"] = \"out\";\n  ANIMATION_CLASSES[\"HIDDEN\"] = \"hidden\";\n})(ANIMATION_CLASSES || (ANIMATION_CLASSES = {}));\nconst ArcgisHubDiscussionsReply = class {\n  constructor(hostRef) {\n    registerInstance(this, hostRef);\n    this.arcgisHubDiscussionsReplyDelete = createEvent(this, \"arcgisHubDiscussionsReplyDelete\", 7);\n    this.arcgisHubDiscussionsGeometryDrawReset = createEvent(this, \"arcgisHubDiscussionsGeometryDrawReset\", 7);\n    this.arcgisHubDiscussionsViewAllReplies = createEvent(this, \"arcgisHubDiscussionsViewAllReplies\", 7);\n    this.arcgisHubDiscussionsReplyUpdate = createEvent(this, \"arcgisHubDiscussionsReplyUpdate\", 7);\n    this.arcgisHubDiscussionsPostUpdate = createEvent(this, \"arcgisHubDiscussionsPostUpdate\", 7);\n    this.arcgisHubDiscusssionsChannelUpdate = createEvent(this, \"arcgisHubDiscusssionsChannelUpdate\", 7);\n    this.arcgisHubDiscussionsReplySelect = createEvent(this, \"arcgisHubDiscussionsReplySelect\", 7);\n    this.hubTelemetry = createEvent(this, \"hubTelemetry\", 7);\n    /**\n     * Feature geometry edits for existing post locations\n     */\n    this.unsavedExistingFeatures = [];\n    /**\n     * Whether the component should show it's skeleton state\n     */\n    this.loading = true;\n    /**\n     * Denotes that the reply editor should be rendered\n     */\n    this.editing = false;\n    /**\n     * An event failed\n     */\n    this.errorMessage = null;\n    /**\n     * Enforces minimum height for the component. This is used to prevent a janky user\n     * experience where this component briefly collapses down between transitions\n     * between the reply content and reply editor when a user elects to edit the\n     * reply.\n     */\n    this.minHeight = null;\n    /**\n     * Animation class to be applied to the article element when transitioning\n     * between reply and reply editor views\n     */\n    this.replyClass = null;\n    /**\n     * Animation class to be applied to the editor element when transitioning\n     * between reply and reply editor views\n     */\n    this.editorClass = ANIMATION_CLASSES.HIDDEN;\n    /**\n     * A reference to the article or reply editor component\n     */\n    this.renderedEl = null;\n    bind(this, 'handleSetComponentRef', 'handleDelete', 'handleEdit', 'handleAnimationEnd', 'handleLinkClicked', 'handleViewThread', 'renderReply', 'renderReplyOutOfContext', 'renderEditor', 'renderDeleted', 'handleViewAllReplies');\n  }\n  /**\n   * Component pre-render setup\n   */\n  componentWillLoad() {\n    this.initialize();\n  }\n  /**\n   * Connected callback lifecycle hook\n   */\n  connectedCallback() {\n    this.addAnimationEventListeners(this.renderedEl);\n  }\n  /**\n   * Disconnected callback lifecycle hook\n   */\n  disconnectedCallback() {\n    this.removeAnimationEventListeners(this.renderedEl);\n  }\n  /**\n   * Updates loading state when intl, replyDetails or postDetails\n   * are updated\n   */\n  handleDetailsUpdates() {\n    this.addEnrichments();\n  }\n  /**\n   * Watches for changes to the renderedEl (article or editor component) and wires\n   * up animationend directly on the element reference as animation events don't bubble\n   * up the DOM.\n   * @param renderedEl The currently rendered element\n   * @param prevRenderedEl The previously rendered element\n   */\n  handleRenderedElChange(renderedEl, prevRenderedEl) {\n    this.removeAnimationEventListeners(prevRenderedEl);\n    this.addAnimationEventListeners(renderedEl);\n  }\n  /**\n   * Initiates reply details enrichmentment, initializes\n   * loading state, and loads localizations\n   */\n  async initialize() {\n    const { element } = this;\n    this.addEnrichments();\n    this.intl = await intlManager.loadIntlForComponent(element);\n  }\n  addEnrichments() {\n    const { isPostEnriched, isReplyEnriched, isChannelEnriched, replyDetails: { postId: replyId }, postDetails: { postId }, channelDetails: { channelId } } = this;\n    if (!isReplyEnriched && replyId) {\n      this.enrichReplyDetails();\n    }\n    if (!isPostEnriched && postId) {\n      this.enrichPostDetails();\n    }\n    if (!isChannelEnriched && channelId) {\n      this.enrichChannelDetails();\n    }\n    this.updateLoading();\n  }\n  updateLoading() {\n    const { isEnriched } = this;\n    this.loading = !isEnriched;\n  }\n  /**\n   * Enriches reply details and emits arcgisHubDiscussionsReplyUpdate so\n   * upstream state is updated\n   */\n  async enrichReplyDetails() {\n    const { replyDetails: rawReplyDetails, context } = this;\n    const replyDetails = await enrichPostDetails(Object.assign({ postDetails: rawReplyDetails }, context.hubRequestOptions));\n    this.arcgisHubDiscussionsReplyUpdate.emit(replyDetails);\n  }\n  /**\n   * Enriches parent post details and emits arcgisHubDiscussionsReplyUpdate so\n   * upstream state is updated\n   */\n  async enrichPostDetails() {\n    const { postDetails: rawPostDetails, context } = this;\n    const postDetails = await enrichPostDetails(Object.assign({ postDetails: rawPostDetails, includeReplyCount: true }, context.hubRequestOptions));\n    this.arcgisHubDiscussionsPostUpdate.emit(postDetails);\n  }\n  /**\n   * Enriches channel details and emits arcgisHubDiscusssionsChannelUpdate so\n   * upstream state is updated\n   */\n  async enrichChannelDetails() {\n    const { context, replyDetails, channelDetails: _channelDetails } = this;\n    const channelDetails = await enrichChannelDetails(Object.assign({ channelDetails: _channelDetails }, context.hubRequestOptions));\n    this.arcgisHubDiscusssionsChannelUpdate.emit({\n      postId: replyDetails === null || replyDetails === void 0 ? void 0 : replyDetails.postId,\n      channelDetails\n    });\n  }\n  /**\n   * Adds relevant animation event listeners to the provided element reference\n   * @param el An HTMLElement reference\n   */\n  addAnimationEventListeners(el) {\n    if (el) {\n      el.addEventListener('animationend', this.handleAnimationEnd);\n    }\n  }\n  /**\n   * Removes relevant animation event listeners from the provided element reference\n   * @param el An HTMLElement reference\n   */\n  removeAnimationEventListeners(el) {\n    if (el) {\n      el.removeEventListener('animationend', this.handleAnimationEnd);\n    }\n  }\n  /**\n   * Sanitizes body text and renders urls as links. Caches reply body so operation is only performed as needed.\n   * @returns string: body text of a reply with urls rendered as calcite-links\n   */\n  computeReplyBody() {\n    return this.replyDetails.post.body;\n  }\n  /**\n   * Emits arcgisHubDiscussionsViewAllReplies when reply is deleted and\n   * user clicks View all replies link from calcite-notice\n   */\n  handleViewAllReplies() {\n    this.arcgisHubDiscussionsViewAllReplies.emit();\n  }\n  /**\n   * Computes if the reply details are enriched\n   */\n  get isReplyEnriched() {\n    const { replyDetails: { creatorDetails, post } } = this;\n    const requiredValues = [\n      creatorDetails === null || creatorDetails === void 0 ? void 0 : creatorDetails.username,\n      creatorDetails === null || creatorDetails === void 0 ? void 0 : creatorDetails.user,\n      creatorDetails === null || creatorDetails === void 0 ? void 0 : creatorDetails.organization\n    ];\n    const isNotUndefined = (val) => val !== undefined;\n    return (post === null) || requiredValues.every(isNotUndefined);\n  }\n  /**\n   * Computes if the post details are enriched\n   */\n  get isPostEnriched() {\n    const { postDetails: { creatorDetails, post } } = this;\n    const requiredEnrichments = [\n      creatorDetails === null || creatorDetails === void 0 ? void 0 : creatorDetails.username,\n      creatorDetails === null || creatorDetails === void 0 ? void 0 : creatorDetails.user,\n      creatorDetails === null || creatorDetails === void 0 ? void 0 : creatorDetails.organization\n    ];\n    const isNotUndefined = (val) => val !== undefined;\n    return (post === null) || requiredEnrichments.every(isNotUndefined);\n  }\n  /**\n   * Computes if the channel details are enriched\n   */\n  get isChannelEnriched() {\n    const { channelDetails: { channel, groups } } = this;\n    const isNotUndefined = (value) => value !== undefined;\n    const requiredValues = [channel, groups];\n    return requiredValues.every(isNotUndefined);\n  }\n  /**\n   * Computes if all enrichments have been satisfied\n   */\n  get isEnriched() {\n    const { intl, isPostEnriched, isReplyEnriched, isChannelEnriched } = this;\n    return Boolean(intl) && isPostEnriched && isReplyEnriched && isChannelEnriched;\n  }\n  /**\n   * Computes creator full name string\n   */\n  get creatorFullName() {\n    const { intl, replyDetails: { creatorDetails: { user: creator }, post: reply } } = this;\n    let fullName = intl.t('anonymous');\n    if (creator || (reply === null || reply === void 0 ? void 0 : reply.creator)) {\n      fullName = (creator === null || creator === void 0 ? void 0 : creator.fullName) || intl.t('privateUser');\n    }\n    return fullName;\n  }\n  get group() {\n    const { channelDetails } = this;\n    return channelDetails ? channelDetails.groups[0] : undefined;\n  }\n  /**\n   * If this component is rendered out of context of parent post (post-list vs thread)\n   */\n  get outOfContext() {\n    const { index, lead } = this;\n    return lead === undefined && index !== undefined;\n  }\n  /**\n   * Computes styles object\n   */\n  get styles() {\n    const { minHeight, editing } = this;\n    const styles = {\n      zIndex: editing ? '20' : '10'\n    };\n    if (minHeight) {\n      styles.minHeight = `${minHeight}px`;\n    }\n    return styles;\n  }\n  /**\n   * Assigns a reference to the article element so we\n   * can calculate it's height\n   * @param article A reference to the article element\n   */\n  handleSetComponentRef(renderedEl) {\n    if (renderedEl) {\n      this.renderedEl = renderedEl;\n    }\n  }\n  /**\n   * Handles users clicking the Cancel button\n   * from the reply editor\n   */\n  handleReplyCancel() {\n    this.transitionToReply();\n    this.arcgisHubDiscussionsGeometryDrawReset.emit();\n  }\n  /**\n   * Handles animationend events for the renderedEl. Used to initiate\n   * secondary animation when transitioning between reply and reply editor\n   * views. Additionally removes temporarily enforced min height after chained\n   * animations complete.\n   * @param evt  An AnimationEvent\n   */\n  handleAnimationEnd(evt) {\n    if (evt.animationName === 'out-left') {\n      this.editing = true;\n      this.editorClass = ANIMATION_CLASSES.IN;\n      this.replyClass = ANIMATION_CLASSES.HIDDEN;\n    }\n    else if (evt.animationName === 'out-right') {\n      this.editing = false;\n      this.editorClass = ANIMATION_CLASSES.HIDDEN;\n      this.replyClass = ANIMATION_CLASSES.IN;\n    }\n    else {\n      this.minHeight = null;\n    }\n  }\n  /**\n   * Handles users clicking the Delete reply action menu action\n   */\n  handleDelete() {\n    const { replyDetails: { post: reply }, context } = this;\n    this.errorMessage = null;\n    return removePost(Object.assign({ postId: reply.id }, context.hubRequestOptions))\n      .then(() => {\n      this.deletedDuringSession = true;\n      this.emitHubTelemetry(Object.assign(Object.assign({}, dist.dictionary.category.content.action.delete), { response: dist.constants.response.SUCCESS }));\n      this.arcgisHubDiscussionsReplyDelete.emit(reply);\n    })\n      .catch(e => {\n      this.errorMessage = 'deleteFailure';\n      this.emitHubTelemetry(Object.assign(Object.assign({}, dist.dictionary.category.content.action.delete), { response: dist.constants.response.FAILURE }));\n      console.error(`Could not delete reply:`, e.message);\n    });\n  }\n  /**\n   * Handles users clicking the Edit action menu action\n   */\n  handleEdit() {\n    this.transitionEditorView(true);\n  }\n  handleViewThread() {\n    this.arcgisHubDiscussionsReplySelect.emit();\n  }\n  /**\n   * Handles users successfully editing a reply and clicking the Save button\n   */\n  transitionToReply() {\n    this.transitionEditorView(false);\n  }\n  /**\n   * Initiates the animations related to showing and hiding\n   * the reply editor\n   * @param showEditor  Whether to show or hide the reply editor\n   */\n  transitionEditorView(showEditor) {\n    var _a, _b;\n    this.minHeight = (_b = (_a = this.renderedEl) === null || _a === void 0 ? void 0 : _a.offsetHeight) !== null && _b !== void 0 ? _b : null;\n    this.editorClass = showEditor\n      ? ANIMATION_CLASSES.HIDDEN\n      : ANIMATION_CLASSES.OUT;\n    this.replyClass = showEditor\n      ? ANIMATION_CLASSES.OUT\n      : ANIMATION_CLASSES.HIDDEN;\n  }\n  /**\n   * Emits hubTelemetry event, augmenting provided telemetry info with additional, common telemetry details\n   * @param telemetry\n   */\n  emitHubTelemetry(telemetry) {\n    const { postDetails: { postId: parentId }, replyDetails: { postId }, channelDetails: { channel } } = this;\n    this.hubTelemetry.emit(Object.assign(Object.assign({}, telemetry), { postId,\n      parentId, channelId: channel.id, channelAccess: channel.access }));\n  }\n  /**\n   * When reply body is clicked, determines if a link was clicked and emits appropriate telemetry\n   * @param evt a pointer event\n   */\n  handleLinkClicked(evt) {\n    const el = evt.target;\n    if (['CALCITE-LINK'].includes(el.nodeName) && !el.hasAttribute(\"data-mention\")) {\n      const { replyDetails: { postId: replyId }, postDetails: { postId }, channelDetails: { channel }, index } = this;\n      this.hubTelemetry.emit(Object.assign(Object.assign({}, dist.dictionary.category.navigation.action.external.label.link), { details: el.href, postId: replyId, parentId: postId, channelId: channel.id, channelAccess: channel.access, position: index }));\n    }\n  }\n  captureReplyDeepLinkImpression() {\n    this.emitHubTelemetry(Object.assign(Object.assign({}, dist.dictionary.category.interaction.action.viewed.label.post.details.thread), { response: dist.constants.response.SUCCESS }));\n  }\n  captureReplyListImpression() {\n    this.emitHubTelemetry(Object.assign(Object.assign({}, dist.dictionary.category.interaction.action.viewed.label.post.details.thread), { position: this.index }));\n  }\n  captureReplyDeletedImpression() {\n    this.emitHubTelemetry(Object.assign(Object.assign({}, dist.dictionary.category.interaction.action.viewed.label.post.details.thread), { response: dist.constants.response.FAILURE }));\n  }\n  get views() {\n    const { renderReply, renderReplyOutOfContext, renderEditor, renderDeleted, renderSkeleton } = this;\n    return {\n      [ReplyView.Skeleton]: {\n        render: renderSkeleton,\n      },\n      [ReplyView.Content]: {\n        render: renderReply,\n      },\n      [ReplyView.OutOfContext]: {\n        render: renderReplyOutOfContext,\n      },\n      [ReplyView.Editor]: {\n        render: renderEditor,\n      },\n      [ReplyView.Deleted]: {\n        render: renderDeleted,\n      }\n    };\n  }\n  get view() {\n    const { views, editing, outOfContext, replyDetails: { post: reply }, loading } = this;\n    let target;\n    if (loading) {\n      target = ReplyView.Skeleton;\n    }\n    else if (editing) {\n      target = ReplyView.Editor;\n    }\n    else if (outOfContext) {\n      target = ReplyView.OutOfContext;\n    }\n    else if (reply) {\n      target = ReplyView.Content;\n    }\n    else {\n      target = ReplyView.Deleted;\n    }\n    return views[target];\n  }\n  /**\n   * Renders the reply editor component\n   */\n  renderEditor() {\n    const { context, hasMap, unsavedFeatures, unsavedRelatedFeatures, unsavedExistingFeatures, editorClass, lead, postDetails, channelDetails, replyDetails, discussionDetails, isMobile } = this;\n    const classes = { \"reply-lead\": lead };\n    if (editorClass) {\n      classes[editorClass] = true;\n    }\n    return (h(\"arcgis-hub-discussions-reply-editor\", { channelDetails: channelDetails, class: classes, context: context, discussionDetails: discussionDetails, hasMap: hasMap, isMobile: isMobile, postDetails: postDetails, ref: this.handleSetComponentRef, replyDetails: replyDetails, unsavedExistingFeatures: unsavedExistingFeatures, unsavedFeatures: unsavedFeatures, unsavedRelatedFeatures: unsavedRelatedFeatures }));\n  }\n  /**\n   * Renders the reply creator avatar and optionally the channel avatar\n   */\n  renderAvatars() {\n    var _a;\n    const { context, isHub, postDetails, replyDetails, channelDetails, index, outOfContext, group } = this;\n    const { portal, token } = context.session;\n    const user = (!replyDetails.creatorDetails.user && replyDetails.post)\n      ? { username: replyDetails.post.creator }\n      : replyDetails.creatorDetails.user;\n    const scale = outOfContext ? 'l' : 'm';\n    let el = [(h(\"calcite-avatar\", { \"full-name\": user === null || user === void 0 ? void 0 : user.fullName, key: 'creator', scale: scale, thumbnail: (user === null || user === void 0 ? void 0 : user.thumbnail) && getUserThumbnailUrl(portal, user, token), \"user-id\": (_a = user) === null || _a === void 0 ? void 0 : _a.id, username: user === null || user === void 0 ? void 0 : user.username }))];\n    if (outOfContext && group) {\n      el.push(h(\"calcite-avatar\", { \"full-name\": group.title, scale: \"m\", thumbnail: getGroupThumbnailUrl(context.session.portal, group, context.session.token) }));\n    }\n    if (replyDetails.creatorDetails) {\n      el = (h(\"arcgis-hub-discussions-popover\", { channelDetails: channelDetails, context: context, index: index, isHub: isHub, originalPostDetails: postDetails, postDetails: replyDetails }, el));\n    }\n    return el;\n  }\n  renderActions() {\n    const { intl, context, channelDetails: { channel, groups }, replyDetails: { post: reply } } = this;\n    const actions = [];\n    if (groups.length && canModifyPost(reply, context.currentUser)) {\n      actions.push({\n        text: intl.t('edit'),\n        onClick: this.handleEdit,\n      });\n    }\n    if (canDeletePost(reply, channel, context.currentUser)) {\n      actions.push({\n        text: intl.t('delete'),\n        onClick: this.handleDelete,\n      });\n    }\n    if (actions.length) {\n      return (h(\"calcite-action-group\", { layout: \"horizontal\" }, actions.map(action => (h(\"calcite-action\", { appearance: action.appearance, \"data-action\": action.text.toLowerCase(), icon: action.icon, key: action.text || action.pin, onClick: action.onClick, onMouseOver: action.onMouseOver, scale: \"s\", text: action.text, \"text-enabled\": Boolean(action.text) })))));\n    }\n  }\n  /**\n   * Render the reply out of context\n   */\n  renderReplyOutOfContext() {\n    var _a;\n    const { intl, errorMessage, replyDetails, postDetails, channelDetails, creatorFullName, hasMap, index, discussionDetails, context, replyClass, isMobile } = this;\n    const { creatorDetails: { user: { fullName } } } = postDetails;\n    const isRtl = intl.direction === 'rtl';\n    const icon = isRtl ? 'arrow-left' : 'arrow-right';\n    const classes = { \"out-of-context\": true };\n    if (replyClass) {\n      classes[replyClass] = true;\n    }\n    (index === undefined)\n      ? this.captureReplyDeepLinkImpression()\n      : this.captureReplyListImpression();\n    return (h(\"article\", { class: classes, ref: this.handleSetComponentRef }, h(\"div\", { class: \"reply-header\" }, h(\"div\", { class: \"header-avatars\" }, this.renderAvatars()), h(\"header\", null, creatorFullName), h(\"div\", { class: \"metadata\" }, h(\"calcite-icon\", { class: \"flipY\", icon: \"right\", scale: \"s\" }), h(\"b\", null, intl.t('replyingTo', { fullName })), h(\"span\", null, \"\\u00B7\"), h(\"calcite-link\", { onClick: this.handleViewThread }, intl.t('viewPost')))), h(\"div\", { class: \"reply-body\" }, h(\"arcgis-multiline-ellipsis\", { \"collapse-enabled\": true, \"expand-enabled\": true, \"expand-icon\": icon, innerHTML: this.computeReplyBody(), lines: 4, onClick: this.handleViewThread }), this.renderActions(), h(\"arcgis-hub-discussions-post-geography\", { channelDetails: channelDetails, context: context, discussionDetails: discussionDetails, hasMap: hasMap, isMobile: isMobile, parentDetails: postDetails, postDetails: replyDetails, toggleable: true, url: (_a = discussionDetails === null || discussionDetails === void 0 ? void 0 : discussionDetails.reference) === null || _a === void 0 ? void 0 : _a.url }), errorMessage && (h(\"calcite-notice\", {\n      // active\n      color: \"red\",\n      // dismissible\n      scale: \"s\"\n    }, h(\"div\", { slot: \"title\" }, intl.t('error')), h(\"div\", { slot: \"message\" }, intl.t(errorMessage)))))));\n  }\n  /**\n   * Renders the reply view\n   */\n  renderReply() {\n    var _a;\n    const { intl, errorMessage, postDetails, replyDetails, channelDetails, replyClass, creatorFullName, lead, hasMap, index, discussionDetails, context, isMobile } = this;\n    const classes = { \"reply-lead\": lead };\n    if (replyClass) {\n      classes[replyClass] = true;\n    }\n    (index === undefined)\n      ? this.captureReplyDeepLinkImpression()\n      : this.captureReplyListImpression();\n    return (h(\"article\", { class: classes, ref: this.handleSetComponentRef }, this.renderAvatars(), h(\"div\", null, h(\"address\", null, h(\"b\", null, creatorFullName), h(\"span\", null, \"\\u00B7\"), h(\"arcgis-relative-date\", { dateTime: replyDetails.post.createdAt, formatStyle: \"short\" })), h(\"arcgis-multiline-ellipsis\", { \"collapse-enabled\": true, \"expand-enabled\": true, innerHTML: this.computeReplyBody(), lines: 4 }), this.renderActions(), h(\"arcgis-hub-discussions-post-geography\", { channelDetails: channelDetails, context: context, discussionDetails: discussionDetails, hasMap: hasMap, isMobile: isMobile, parentDetails: postDetails, postDetails: replyDetails, toggleable: true, url: (_a = discussionDetails === null || discussionDetails === void 0 ? void 0 : discussionDetails.reference) === null || _a === void 0 ? void 0 : _a.url }), errorMessage && (h(\"calcite-notice\", {\n      // active\n      color: \"red\",\n      // dismissible\n      scale: \"s\"\n    }, h(\"div\", { slot: \"title\" }, intl.t('error')), h(\"div\", { slot: \"message\" }, intl.t(errorMessage)))))));\n  }\n  renderDeleted() {\n    const { intl, handleViewAllReplies, deletedDuringSession } = this;\n    if (!deletedDuringSession) {\n      this.captureReplyDeletedImpression();\n    }\n    return (h(\"calcite-notice\", {\n      // active\n      color: \"red\", scale: \"m\"\n    }, h(\"div\", { slot: \"title\" }, intl.t('deleted.title')), h(\"div\", { slot: \"message\" }, intl.t('deleted.message')), h(\"calcite-link\", { onClick: handleViewAllReplies, slot: \"link\" }, intl.t('delete.action'))));\n  }\n  renderSkeleton() {\n    return h(\"arcgis-hub-discussions-post-skeleton\", null);\n  }\n  /**\n   * Render entrypoint method\n   */\n  render() {\n    const { view, styles } = this;\n    return (h(Host, { \"data-element\": \"discussions-reply\", style: styles }, view.render()));\n  }\n  static get assetsDirs() { return [\"locales\"]; }\n  get element() { return getElement(this); }\n  static get watchers() { return {\n    \"intl\": [\"handleDetailsUpdates\"],\n    \"postDetails\": [\"handleDetailsUpdates\"],\n    \"replyDetails\": [\"handleDetailsUpdates\"],\n    \"channelDetails\": [\"handleDetailsUpdates\"],\n    \"renderedEl\": [\"handleRenderedElChange\"]\n  }; }\n};\n__decorate$1([\n  CacheDecoratorFactory({\n    getKey() {\n      return this.replyDetails.post.body;\n    }\n  }),\n  AutoLinkDecoratorFactory({ calcite: true }),\n  MentionPopoverTransformDecoratorFactory(),\n  SanitizeDecoratorFactory({\n    filterOptions: {\n      whiteList: {\n        'calcite-link': ['href', 'data-mention']\n      }\n    },\n    extendDefaults: true\n  })\n], ArcgisHubDiscussionsReply.prototype, \"computeReplyBody\", null);\n__decorate$1([\n  callOnceFactory()\n], ArcgisHubDiscussionsReply.prototype, \"captureReplyDeepLinkImpression\", null);\n__decorate$1([\n  callOnceFactory()\n], ArcgisHubDiscussionsReply.prototype, \"captureReplyListImpression\", null);\n__decorate$1([\n  callOnceFactory()\n], ArcgisHubDiscussionsReply.prototype, \"captureReplyDeletedImpression\", null);\nArcgisHubDiscussionsReply.style = arcgisHubDiscussionsReplyCss;\n\nconst arcgisHubDiscussionsReplyEditorCss = \".hub-discussions-reply-editor{display:block;padding-left:0.75rem;padding-right:0.75rem}.hub-discussions-reply-editor__form{border-radius:0.25rem;background-color:var(--calcite-ui-foreground-1);padding:0.75rem;--tw-shadow:0 2px 8px 0 rgba(0, 0, 0, 0.12);--tw-shadow-colored:0 2px 8px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.hub-discussions-reply-editor__button-group{margin-top:1rem;display:flex;justify-content:flex-end}.hub-discussions-reply-editor__button{margin-left:0.75rem}.hub-discussions-reply-editor__button-group>calcite-action{margin-right:auto}.hub-discussions-reply-editor-user-details{margin:0px;display:grid;align-items:center;-moz-column-gap:0.75rem;column-gap:0.75rem;grid-template-columns:32px auto}.hub-discussions-reply-editor-user-details__name{font-size:var(--calcite-font-size-0);line-height:1.25rem;font-weight:var(--calcite-font-weight-bold);font-style:normal}.hub-discussions-reply-editor__notice,.hub-discussions-reply-editor__not-discussable-notice{margin-left:0px;margin-right:0px;margin-top:1rem}.hub-discussions-reply-editor-confirmation{display:block}.hub-discussions-reply-editor-confirmation__header{margin-top:0.5rem;font-size:var(--calcite-font-size-1);line-height:1.5rem;font-weight:var(--calcite-font-weight-bold)}.hub-discussions-reply-editor-confirmation__text{margin-top:0.5rem;font-size:var(--calcite-font-size-0);line-height:1.25rem}.hub-discussions-reply-editor-footer{display:grid;grid-auto-flow:column;grid-template-columns:repeat(2, minmax(0, 1fr));-moz-column-gap:0.75rem;column-gap:0.75rem}.hub-discussions-reply-editor-footer__button{margin:0px}.hub-discussions-reply-editor__body{margin-top:0.75rem}.hub-discussions-reply-editor__body[scale=m] .ck.ck-editor__editable{border-style:none;background-color:var(--calcite-ui-foreground-1);padding:0px;font-size:var(--calcite-font-size-0);line-height:1.25rem;color:var(--calcite-ui-text-1);outline:2px solid transparent;outline-offset:2px;min-height:6rem}.hub-discussions-reply-editor__body .ck.ck-editor__editable.ck-focused:not(.ck-editor__nested-editable){border-style:none;outline:2px solid transparent;outline-offset:2px}.hub-discussions-reply-editor__body[scale=m] .ck.ck-editor__editable .ck-placeholder:before{color:var(--calcite-ui-text-3)}.hub-discussions-reply-editor__body .ck.ck-editor__editable_inline>:first-child{margin-top:0px}.hub-discussions-reply-editor__body .ck.ck-editor__editable_inline>:last-child{margin-bottom:0px}.hub-discussions-reply-editor__message{margin-top:0.5rem}.hub-discussions-reply-editor__location-popover>div.hub-discussions-reply-editor__location-popover__content,.hub-discussions-reply-editor__location-popover__content{max-width:20rem;padding-top:0.75rem;padding-bottom:0.75rem;padding-left:1.25rem;padding-right:1.25rem}.add-location-post:active .add-location-icon{--tw-text-opacity:1;color:rgb(21 21 21 / var(--tw-text-opacity))}.add-location-post[active] .add-location-icon{--tw-text-opacity:1;color:rgb(21 21 21 / var(--tw-text-opacity))}\";\n\nvar __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\n  var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\")\n    r = Reflect.decorate(decorators, target, key, desc);\n  else\n    for (var i = decorators.length - 1; i >= 0; i--)\n      if (d = decorators[i])\n        r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nconst ArcgisHubDiscussionsReplyEditor = class {\n  /**\n   * Constructor function\n   */\n  constructor(hostRef) {\n    registerInstance(this, hostRef);\n    this.arcgisHubDiscussionsReplyCreate = createEvent(this, \"arcgisHubDiscussionsReplyCreate\", 7);\n    this.arcgisHubDiscussionsReplyEdit = createEvent(this, \"arcgisHubDiscussionsReplyEdit\", 7);\n    this.arcgisHubDiscussionsReplyCancel = createEvent(this, \"arcgisHubDiscussionsReplyCancel\", 7);\n    this.arcgisHubDiscussionsGeometryDrawCreate = createEvent(this, \"arcgisHubDiscussionsGeometryDrawCreate\", 7);\n    this.arcgisHubDiscussionsGeometryDrawTypeSelect = createEvent(this, \"arcgisHubDiscussionsGeometryDrawTypeSelect\", 7);\n    this.arcgisHubDiscussionsGeometryDrawEdit = createEvent(this, \"arcgisHubDiscussionsGeometryDrawEdit\", 7);\n    this.arcgisHubDiscussionsGeometryDrawReset = createEvent(this, \"arcgisHubDiscussionsGeometryDrawReset\", 7);\n    this.arcgisHubDiscussionsGeometrySelect = createEvent(this, \"arcgisHubDiscussionsGeometrySelect\", 7);\n    this.arcgisHubDiscussionsGeometryDeselect = createEvent(this, \"arcgisHubDiscussionsGeometryDeselect\", 7);\n    this.arcgisHubDiscussionsGeometryClearAll = createEvent(this, \"arcgisHubDiscussionsGeometryClearAll\", 7);\n    this.arcgisHubDiscussionsScrollTo = createEvent(this, \"arcgisHubDiscussionsScrollTo\", 7);\n    this.hubTelemetry = createEvent(this, \"hubTelemetry\", 7);\n    /**\n     * A Feature selected from a map\n     */\n    this.unsavedFeatures = [];\n    /**\n     * A related Feature from a map\n     */\n    this.unsavedRelatedFeatures = [];\n    /**\n     * Feature geometry edits for existing post locations\n     */\n    this.unsavedExistingFeatures = [];\n    /**\n     * A Feature selected from a map for internal state management\n     */\n    this._unsavedFeatures = [];\n    /**\n     * A related Feature from a map for internal state management\n     */\n    this._unsavedRelatedFeatures = [];\n    /**\n     * Internal existing feature state tracking\n     */\n    this._unsavedExistingFeatures = [];\n    /**\n     * The text input value\n     */\n    this.inputValue = '';\n    /**\n     * A reply submission is processing\n     */\n    this.pending = false;\n    /**\n     * Initial Post discussion URI\n     */\n    this.discussionValue = '';\n    /**\n     * An event failed\n     */\n    this.errorMessage = null;\n    bind(this, 'focusInput', 'handleReplySubmit', 'handleCancel', 'handleCancelOrConfirm', 'handleConfirmBackButtonClicked', 'handleInputChange', 'handleInputRef', 'handleAddLocationToggle', 'setActiveGeometryDrawType');\n  }\n  /**\n   * Component pre-render setup\n   */\n  async componentWillLoad() {\n    const { replyDetails } = this;\n    if (replyDetails === null || replyDetails === void 0 ? void 0 : replyDetails.post) {\n      this.inputValue = replyDetails.post.body;\n      this.discussionValue = replyDetails.post.discussion;\n      const geometryClone = cloneObject(replyDetails.post.geometry);\n      this.geometryValue = Object.keys(geometryClone).length\n        ? geometryClone\n        : null;\n    }\n    this._unsavedFeatures = this.unsavedFeatures;\n    this._unsavedRelatedFeatures = this.unsavedRelatedFeatures;\n    this.intl = await intlManager.loadIntlForComponent(this.element);\n  }\n  componentDidLoad() {\n    this.focusInput();\n    if (this.autoScroll) {\n      this.arcgisHubDiscussionsScrollTo.emit();\n    }\n  }\n  /**\n   * Called when the user changes the text of the post body content\n   * @param evt An onChange event for the post body calcite-input\n   */\n  updateBodyValue(evt) {\n    this.inputValue = evt.target.value;\n  }\n  /**\n   * Computes the mention feature config\n   */\n  get mentionConfig() {\n    const { context, channelDetails } = this;\n    return {\n      searchUsers: (query) => searchOtherTeamMembers(Object.assign({ id: channelDetails.groups[0].id, currentUser: context.currentUser, query }, context.hubRequestOptions))\n    };\n  }\n  /**\n   * Computes if cancel action should be confirmed\n   */\n  get shouldConfirmCancel() {\n    const { replyDetails, inputValue } = this;\n    return inputValue !== replyDetails.post.body;\n  }\n  /**\n   * Computes if input value is valid\n   */\n  get isInputValid() {\n    const { inputValue } = this;\n    return inputValue.trim().length > 0 && inputValue.length <= MAX_BODY_LENGTH;\n  }\n  /**\n   * Computes input warning/error messages\n   */\n  get inputMessage() {\n    const { inputValue, isInputValid, intl } = this;\n    const { length } = inputValue;\n    if (length >= WARNING_BODY_LENGTH) {\n      return isInputValid\n        ? {\n          status: 'idle',\n          text: intl.t('reply.body.validation.warning')\n        }\n        : {\n          icon: 'exclamation-mark-circle',\n          status: 'invalid',\n          text: intl.t('reply.body.validation.error')\n        };\n    }\n  }\n  /**\n   * IPostDetails with augmented with current location edits\n   */\n  get replyDetailsWithLocationEdits() {\n    const { replyDetails } = this;\n    const { geometryValue, discussionValue } = this;\n    const _replyDetails = cloneObject(replyDetails);\n    if (_replyDetails) {\n      _replyDetails.post.geometry = geometryValue;\n      if (discussionValue !== replyDetails.post.discussion) {\n        _replyDetails.post.discussion = discussionValue;\n      }\n    }\n    return _replyDetails;\n  }\n  /**\n   * Computes the blocked noticed variant\n   */\n  get blockedNotice() {\n    const isGroupDiscussable = isDiscussable(this.channelDetails.groups[0]);\n    const isSubjectDiscussable = isDiscussable(this.discussionDetails.reference);\n    let variant;\n    if (!isGroupDiscussable && !isSubjectDiscussable) {\n      variant = ArcgisHubDiscussionsBlockedNoticeVariant.EditReply;\n    }\n    else if (!isGroupDiscussable) {\n      variant = ArcgisHubDiscussionsBlockedNoticeVariant.EditReplyGroup;\n    }\n    else if (!isSubjectDiscussable) {\n      variant = this.discussionDetails.type === 'group'\n        ? ArcgisHubDiscussionsBlockedNoticeVariant.EditReplyGroup\n        : ArcgisHubDiscussionsBlockedNoticeVariant.EditReplyItem;\n    }\n    return variant;\n  }\n  /**\n   * Sets focus on the calcite-input text input\n   */\n  focusInput() {\n    const { input } = this;\n    // input.setFocus is undefined in spec tests for some reason...\n    if (input && input.setFocus) {\n      input.setFocus();\n    }\n  }\n  handleGeometryValueUpdated() {\n    if (this.replyDetails) {\n      const { replyDetails: { post: { geometry } }, geometryValue } = this;\n      this.geometryValueHasChanges = JSON.stringify(geometryValue) !== JSON.stringify(geometry);\n    }\n  }\n  /**\n   * Handles changes to the `unsavedFeatures` property\n   * @param unsavedFeatures A array of Feature objects representing drawings on the map\n   */\n  handleFeatureChange(unsavedFeatures) {\n    var _a, _b, _c;\n    // Used to discrimate between incoming props when multiple replies open (edit post || edit reply || create reply in thread)\n    const { replyDetails } = this;\n    if (unsavedFeatures.length) {\n      const featureId = (_b = (_a = unsavedFeatures[0]) === null || _a === void 0 ? void 0 : _a.properties) === null || _b === void 0 ? void 0 : _b.id;\n      const replyId = (_c = replyDetails === null || replyDetails === void 0 ? void 0 : replyDetails.post) === null || _c === void 0 ? void 0 : _c.id;\n      const isRecipient = (replyId === featureId) || (!(replyDetails === null || replyDetails === void 0 ? void 0 : replyDetails.post) && featureId === null);\n      if (isRecipient) {\n        this._unsavedFeatures = unsavedFeatures;\n      }\n    }\n    else {\n      this._unsavedFeatures = [];\n    }\n  }\n  /**\n   * Handles changes to the `unsavedRelatedFeatures` property\n   * @param unsavedRelatedFeature A IPostRelatedFeatureDetails object representing a selected feature on a map\n   */\n  handleRelatedFeatureChange(unsavedRelatedFeatures) {\n    var _a;\n    // Used to discrimate between incoming props when multiple replies open (edit post || edit reply || create reply in thread)\n    const { replyDetails } = this;\n    if (unsavedRelatedFeatures.length) {\n      const relatedFeatureId = unsavedRelatedFeatures[0].postId;\n      const replyId = (_a = replyDetails === null || replyDetails === void 0 ? void 0 : replyDetails.post) === null || _a === void 0 ? void 0 : _a.id;\n      const isRecipient = (replyId === relatedFeatureId) || (!(replyDetails === null || replyDetails === void 0 ? void 0 : replyDetails.post) && relatedFeatureId === null);\n      if (isRecipient) {\n        this._unsavedRelatedFeatures = unsavedRelatedFeatures;\n      }\n    }\n    else {\n      this._unsavedRelatedFeatures = [];\n    }\n  }\n  /**\n   * Updates internal _feature state when the unsavedExistingFeatures prop value changes\n   * @param feature A Feature object\n   */\n  handleExistingFeatureChange(unsavedExistingFeatures) {\n    var _a;\n    // Used to discriminate between incoming props when multiple replies open (edit post || edit reply || create reply in thread)\n    const { replyDetails } = this;\n    if (unsavedExistingFeatures.length) {\n      const featureId = (_a = unsavedExistingFeatures[0].properties) === null || _a === void 0 ? void 0 : _a.id;\n      const replyId = replyDetails === null || replyDetails === void 0 ? void 0 : replyDetails.postId;\n      const isRecipient = (replyId === featureId);\n      if (isRecipient) {\n        this._unsavedExistingFeatures = unsavedExistingFeatures;\n      }\n    }\n    else {\n      this._unsavedExistingFeatures = [];\n    }\n  }\n  handleAddLocationsActiveGeometryTypeChanged(geometryType) {\n    if (geometryType) {\n      this.arcgisHubDiscussionsGeometryDrawTypeSelect.emit(geometryType);\n    }\n  }\n  /**\n   * Handles reply create/edit form submissions and performs actions common to both\n   * @param evt An onsubmit event\n   */\n  handleReplySubmit(evt) {\n    evt.preventDefault();\n    this.pending = true;\n    const promise = this.replyDetails\n      ? this.handleEdit()\n      : this.handleCreate();\n    return promise\n      .catch((e) => {\n      console.error(`Could not create reply:`, e.message);\n      return null;\n    })\n      .finally(async () => {\n      this.pending = false;\n      this.arcgisHubDiscussionsGeometryClearAll.emit();\n      this.canAddLocations = false;\n      this.addLocationsActiveGeometryType = null;\n      setTimeout(this.focusInput, 100);\n    });\n  }\n  /**\n   * Handles reply create form submissions\n   */\n  handleCreate() {\n    const { context, _unsavedFeatures, _unsavedRelatedFeatures, inputValue, postDetails: { post }, channelDetails: { channel }, discussionDetails: { discussion, reference: { url } }, arcgisHubDiscussionsReplyCreate } = this;\n    let uri = discussion;\n    if (_unsavedRelatedFeatures.length) {\n      const layerId = url.split('/').pop();\n      const objectIds = new Set(_unsavedRelatedFeatures.map(feature => feature.objectId));\n      uri = augmentDiscussionURIWithFeature(uri, layerId, Array.from(objectIds));\n    }\n    let geometry = null;\n    if (_unsavedFeatures.length) {\n      geometry = _unsavedFeatures.length > 1 ? featuresToGeometryCollection(_unsavedFeatures) : _unsavedFeatures[0].geometry;\n    }\n    this.errorMessage = null;\n    return createReply(Object.assign({ postId: post.id, params: {\n        access: channel.access,\n        groups: channel.groups,\n        channelId: channel.id,\n        discussion: uri,\n        body: inputValue.trim(),\n        geometry\n      }, mentionUrl: window.location.href }, context.hubRequestOptions)).then(reply => {\n      this.inputValue = '';\n      this.hubTelemetry.emit(Object.assign(Object.assign({}, dist.dictionary.category.content.action.create), { response: dist.constants.response.SUCCESS, postId: reply.id, parentId: post.id, channelId: channel.id, channelAccess: channel.access }));\n      arcgisHubDiscussionsReplyCreate.emit(reply);\n      return reply;\n    }).catch(e => {\n      console.error(\"ERROR:\", e);\n      this.errorMessage = 'createFailure';\n      this.hubTelemetry.emit(Object.assign(Object.assign({}, dist.dictionary.category.content.action.create), { response: dist.constants.response.FAILURE, parentId: post.id, channelId: channel.id, channelAccess: channel.access }));\n      console.error('Failed to create reply:', e.message);\n      return null;\n    });\n  }\n  /**\n   * Handles reply edit form submissions\n   */\n  handleEdit() {\n    const { context, inputValue, replyDetails: { post: reply }, postDetails: { postId }, channelDetails: { channel }, arcgisHubDiscussionsReplyEdit, _unsavedFeatures, _unsavedRelatedFeatures, _unsavedExistingFeatures, discussionDetails: { reference: { url } } } = this;\n    this.errorMessage = null;\n    let uri = this.discussionValue;\n    if (_unsavedRelatedFeatures.length) {\n      const layerId = url.split('/').pop();\n      const objectIds = _unsavedRelatedFeatures.map(feature => feature.objectId);\n      uri = augmentDiscussionURIWithFeature(uri, layerId, objectIds);\n    }\n    const originalPostFeatures = (this.geometryValue && Object.keys(this.geometryValue).length)\n      ? postToFeatures(Object.assign(Object.assign({}, reply), { geometry: this.geometryValue }))\n      : [];\n    _unsavedExistingFeatures.forEach(feature => {\n      // Apply any existing geometry updates to originalPostFeatures\n      const { properties: { index }, geometry } = feature;\n      originalPostFeatures[+index].geometry = geometry;\n    });\n    let geometry = null;\n    const combinedFeatures = [...originalPostFeatures, ..._unsavedFeatures];\n    if (combinedFeatures.length) {\n      if (combinedFeatures.length > 1) {\n        geometry = featuresToGeometryCollection(combinedFeatures);\n      }\n      else {\n        geometry = combinedFeatures[0].geometry.coordinates.length\n          ? combinedFeatures[0].geometry\n          : null;\n      }\n    }\n    return updatePost(Object.assign({ postId: reply.id, params: {\n        body: inputValue.trim(),\n        discussion: uri,\n        geometry\n      }, mentionUrl: window.location.href }, context.hubRequestOptions)).then(updatedReply => {\n      this.hubTelemetry.emit(Object.assign(Object.assign({}, dist.dictionary.category.content.action.update), { response: dist.constants.response.SUCCESS, postId: reply.id, parentId: postId, channelId: channel.id, channelAccess: channel.access }));\n      arcgisHubDiscussionsReplyEdit.emit(updatedReply);\n      return updatedReply;\n    }).catch(e => {\n      this.errorMessage = 'editFailure';\n      this.hubTelemetry.emit(Object.assign(Object.assign({}, dist.dictionary.category.content.action.update), { response: dist.constants.response.FAILURE, postId: reply.id, parentId: postId, channelId: channel.id, channelAccess: channel.access }));\n      console.error('Failed to edit reply:', e.message);\n      return null;\n    });\n  }\n  /**\n   * Handles clicks to the cancel button in the edit reply form\n   */\n  handleCancel() {\n    const { replyDetails: { post: reply }, postDetails: { post }, channelDetails: { channel } } = this;\n    this.hubTelemetry.emit(Object.assign(Object.assign({}, dist.dictionary.category.interaction.action.close.label.editor), { postId: reply === null || reply === void 0 ? void 0 : reply.id, parentId: post === null || post === void 0 ? void 0 : post.id, channelId: channel.id, channelAccess: channel.access }));\n    this.arcgisHubDiscussionsReplyCancel.emit();\n  }\n  /**\n   * Handles clicks to the cancel action\n   */\n  handleCancelOrConfirm() {\n    if (this.shouldConfirmCancel) {\n      this.confirmCancel = true;\n    }\n    else {\n      this.handleCancel();\n    }\n    this.arcgisHubDiscussionsGeometryClearAll.emit();\n    this.canAddLocations = false;\n  }\n  /**\n   * Called when the cancel confirmation back button is clicked\n   */\n  handleConfirmBackButtonClicked() {\n    this.confirmCancel = false;\n  }\n  /**\n   * Handles calcite-input text changes\n   * @param evt An on change event\n   */\n  handleInputChange(evt) {\n    evt.preventDefault();\n    this.inputValue = evt.target.value;\n  }\n  handleAddLocationToggle() {\n    const { replyDetails, postDetails, channelDetails } = this;\n    this.canAddLocations = !this.canAddLocations;\n    if (this.canAddLocations) {\n      const id = replyDetails === null || replyDetails === void 0 ? void 0 : replyDetails.postId;\n      this.arcgisHubDiscussionsGeometryDrawCreate.emit(id);\n      this.hubTelemetry.emit(Object.assign(Object.assign({}, dist.dictionary.category.interaction.action.enable.label.addLocation), { postId: replyDetails === null || replyDetails === void 0 ? void 0 : replyDetails.postId, parentId: postDetails.postId, channelId: channelDetails.channelId, channelAccess: channelDetails.channel.access }));\n    }\n    else {\n      this.arcgisHubDiscussionsGeometryDrawReset.emit();\n      this.addLocationsActiveGeometryType = null;\n      this.hubTelemetry.emit(Object.assign(Object.assign({}, dist.dictionary.category.interaction.action.disable.label.addLocation), { postId: replyDetails === null || replyDetails === void 0 ? void 0 : replyDetails.postId, parentId: postDetails.postId, channelId: channelDetails.channelId, channelAccess: channelDetails.channel.access }));\n    }\n  }\n  handleFeatureRemove(evt) {\n    var _a;\n    const { detail: { properties: { relatedFeatureId, index, unsaved } } } = evt;\n    if (!unsaved) {\n      if (relatedFeatureId) {\n        // remove relatedFeature from discsussion URI\n        const { features } = parseDiscussionURI(this.discussionValue);\n        const layerId = this.discussionDetails.reference.url.split('/').pop();\n        features.splice(features.indexOf(relatedFeatureId), 1);\n        this.discussionValue = augmentDiscussionURIWithFeature(this.discussionValue.split('?')[0], layerId, features);\n      }\n      else {\n        // remove feature from discussion geometry\n        if (((_a = this.geometryValue) === null || _a === void 0 ? void 0 : _a.type) === 'GeometryCollection') {\n          if (unsaved) {\n            this.geometryValue.geometries.splice(index, 1);\n          }\n          else {\n            this.geometryValue.geometries[index] = null;\n          }\n          this.geometryValue = Object.assign({}, this.geometryValue);\n        }\n        else {\n          this.geometryValue = null;\n        }\n      }\n    }\n  }\n  setActiveGeometryDrawType(evt) {\n    const { addLocationsActiveGeometryType } = this;\n    const { target } = evt;\n    const geometryType = target.dataset.type;\n    this.addLocationsActiveGeometryType = geometryType === addLocationsActiveGeometryType\n      ? undefined\n      : geometryType;\n  }\n  /**\n   * Returns true if post has new location changes or updates\n   */\n  get hasLocationChanges() {\n    if (this.replyDetails) {\n      const { replyDetails: { post: { discussion } }, discussionValue } = this;\n      return Boolean(this._unsavedFeatures.length + this._unsavedRelatedFeatures.length + this._unsavedExistingFeatures.length) || (discussionValue !== discussion || this.geometryValueHasChanges);\n    }\n    return false;\n  }\n  /**\n   * Handles assignment of the calcite-input element reference\n   * @param input An HTMLCalciteInputElement reference\n   */\n  handleInputRef(input) {\n    this.input = input;\n  }\n  /**\n   * Renders the user details for the currently authenticated user\n   */\n  renderUserDetails() {\n    const { context } = this;\n    let avatar = (h(\"calcite-icon\", { icon: \"user\", scale: \"l\" }));\n    let fullName = this.intl.t('anonymous');\n    if (context.currentUser) {\n      fullName = context.currentUser.fullName;\n      const { username, id } = context.currentUser;\n      avatar = (h(\"calcite-avatar\", { \"full-name\": fullName, scale: \"m\", slot: \"header-actions-start\", thumbnail: getUserThumbnailUrl(context.session.portal, context.currentUser, context.session.token), \"user-id\": id, username: username }));\n    }\n    return (h(\"address\", { class: \"hub-discussions-reply-editor-user-details\" }, avatar, h(\"b\", { class: \"hub-discussions-reply-editor-user-details__name\" }, fullName)));\n  }\n  renderAddLocationsButton() {\n    const { hasMap, canAddLocations, blockedNotice, addLocationsActiveGeometryType, intl } = this;\n    const locationActionTypes = [\n      { type: 'select', icon: 'select' },\n      { type: 'point', icon: 'pin' },\n      { type: 'polyline', icon: 'freehand' },\n      { type: 'polygon', icon: 'freehand-area' }\n    ];\n    const locationActions = locationActionTypes.map(({ type, icon }) => {\n      return (h(\"calcite-action\", { active: addLocationsActiveGeometryType === type, \"data-type\": type, icon: icon, key: type, onClick: this.setActiveGeometryDrawType, text: intl.t(`location.action.${type}`), textEnabled: true }));\n    });\n    return (h(Fragment, null, h(\"calcite-popover\", {\n      // disablePointer\n      label: intl.t('location.heading'), open: canAddLocations && !Boolean(addLocationsActiveGeometryType), referenceElement: this.locationActionElement, triggerDisabled: true\n    }, locationActions), h(\"calcite-tooltip\", { closeOnClick: true, label: intl.t('location.tooltip'), referenceElement: !canAddLocations && this.locationActionElement }, h(\"span\", null, intl.t('location.tooltip'))), h(\"calcite-action\", { active: canAddLocations, appearance: 'solid', class: \"add-location-post\", disabled: !hasMap || Boolean(blockedNotice), onClick: this.handleAddLocationToggle, ref: (locationActionElement) => { this.locationActionElement = locationActionElement; }, text: intl.t('location.heading') }, h(\"calcite-icon\", { class: \"add-location-icon\", icon: \"pin-plus\", scale: \"s\" }))));\n  }\n  /**\n   * Renders the primary action button for the create/edit forms\n   */\n  renderPrimaryActionButton() {\n    const { replyDetails, intl, inputValue, pending, isInputValid, hasLocationChanges, blockedNotice } = this;\n    let text;\n    let disabled;\n    if (replyDetails) {\n      text = intl.t('saveReply');\n      disabled = Boolean(blockedNotice) || !isInputValid || inputValue === replyDetails.post.body && !hasLocationChanges;\n    }\n    else {\n      text = intl.t('createReply');\n      disabled = Boolean(blockedNotice) || !isInputValid;\n    }\n    return (h(\"calcite-button\", { class: \"hub-discussions-reply-editor__button\", disabled: disabled, label: text, loading: pending, round: true, scale: \"l\", type: \"submit\", width: \"auto\" }, text));\n  }\n  /**\n   * Renders the secondary action button for the create/edit forms\n   */\n  renderSecondaryActionButton() {\n    const { replyDetails, intl } = this;\n    if (replyDetails) {\n      const text = intl.t('cancel');\n      return (h(\"calcite-button\", {\n        // appearance=\"clear\"\n        class: \"hub-discussions-reply-editor__button\", color: \"neutral\", disabled: false, label: text, onClick: this.handleCancelOrConfirm, round: true, scale: \"l\", type: \"reset\", width: \"auto\"\n      }, text));\n    }\n  }\n  /**\n   * Renders the calcite-input element\n   */\n  renderInput() {\n    const { inputValue, inputMessage, pending, intl, postDetails: { creatorDetails: { user: creator } }, context, mentionConfig, blockedNotice } = this;\n    let placeholder = intl.t('replyToPost');\n    // verify private profile\n    if (creator) {\n      placeholder = intl.t('replyToUserPost', { firstName: creator.firstName });\n    }\n    return (h(Fragment, null, h(\"arcgis-hub-rich-text\", { class: \"hub-discussions-reply-editor__body\", context: context, disabled: Boolean(blockedNotice) || pending, label: intl.t('inputLabel'), mention: mentionConfig, placeholder: placeholder, \"text-transform\": true, toolbar: \"\", value: inputValue }), inputMessage && (h(\"calcite-input-message\", {\n      // active\n      class: \"hub-discussions-reply-editor__message\", icon: inputMessage.icon, scale: \"l\", status: inputMessage.status\n    }, inputMessage.text))));\n  }\n  /**\n   * Renders the editor form controls\n   */\n  renderEditor() {\n    var _a;\n    const { intl, errorMessage, channelDetails, context, hasMap, replyDetailsWithLocationEdits, _unsavedFeatures, _unsavedRelatedFeatures, _unsavedExistingFeatures, discussionDetails, postDetails, blockedNotice, isMobile } = this;\n    return (h(Fragment, null, this.renderInput(), h(\"arcgis-hub-discussions-post-geography\", { channelDetails: channelDetails, context: context, disabled: Boolean(blockedNotice), discussionDetails: discussionDetails, hasMap: hasMap, isMobile: isMobile, parentDetails: postDetails, postDetails: replyDetailsWithLocationEdits, renderedInEditor: true, unsavedExistingFeatures: _unsavedExistingFeatures, unsavedFeatures: _unsavedFeatures, unsavedRelatedFeatures: _unsavedRelatedFeatures, url: (_a = discussionDetails === null || discussionDetails === void 0 ? void 0 : discussionDetails.reference) === null || _a === void 0 ? void 0 : _a.url }), h(\"div\", { class: \"hub-discussions-reply-editor__button-group\" }, this.renderAddLocationsButton(), this.renderSecondaryActionButton(), this.renderPrimaryActionButton()), blockedNotice && (h(\"arcgis-hub-discussions-blocked-notice\", { class: \"hub-discussions-reply-editor__not-discussable-notice\", scale: \"s\", slot: \"list-before\", variant: blockedNotice })), errorMessage && (h(\"calcite-notice\", {\n      // active\n      class: \"hub-discussions-reply-editor__notice\", color: \"red\", scale: \"s\"\n    }, h(\"div\", { slot: \"title\" }, intl.t('error')), h(\"div\", { slot: \"message\" }, intl.t(errorMessage))))));\n  }\n  /**\n   * Renders the UI for cancel confirmation\n   */\n  renderConfirmCancel() {\n    const { intl } = this;\n    return (h(Fragment, null, h(\"div\", { class: \"hub-discussions-reply-editor-confirmation\" }, h(\"header\", { class: \"hub-discussions-reply-editor-confirmation__header\" }, intl.t('confirmHeader')), h(\"p\", { class: \"hub-discussions-reply-editor-confirmation__text\" }, intl.t('confirm'))), h(\"footer\", { class: \"hub-discussions-reply-editor-footer\" }, h(\"calcite-button\", {\n      // appearance=\"clear\"\n      class: \"hub-discussions-reply-editor-footer__button\", color: \"neutral\", onClick: this.handleConfirmBackButtonClicked, round: true, scale: \"l\"\n    }, intl.t('back')), h(\"calcite-button\", { class: \"hub-discussions-reply-editor-footer__button\", color: \"red\", onClick: this.handleCancel, round: true, scale: \"l\" }, intl.t('discard')))));\n  }\n  /**\n   * Main render entrypoint\n   */\n  render() {\n    const { replyDetails, confirmCancel } = this;\n    return (h(Host, { class: \"hub-discussions-reply-editor\", \"data-editing\": Boolean(replyDetails) }, h(\"form\", { class: \"hub-discussions-reply-editor__form\", onSubmit: this.handleReplySubmit }, this.renderUserDetails(), confirmCancel\n      ? this.renderConfirmCancel()\n      : this.renderEditor())));\n  }\n  static get assetsDirs() { return [\"locales\"]; }\n  get element() { return getElement(this); }\n  static get watchers() { return {\n    \"geometryValue\": [\"handleGeometryValueUpdated\"],\n    \"unsavedFeatures\": [\"handleFeatureChange\"],\n    \"unsavedRelatedFeatures\": [\"handleRelatedFeatureChange\"],\n    \"unsavedExistingFeatures\": [\"handleExistingFeatureChange\"],\n    \"addLocationsActiveGeometryType\": [\"handleAddLocationsActiveGeometryTypeChanged\"]\n  }; }\n};\n__decorate([\n  CallWhenFactory({ when() { return !this.isMobile; } })\n], ArcgisHubDiscussionsReplyEditor.prototype, \"renderAddLocationsButton\", null);\nArcgisHubDiscussionsReplyEditor.style = arcgisHubDiscussionsReplyEditorCss;\n\nconst arcgisLoadMoreButtonCss = \":host{display:block}\";\n\nconst ArcgisLoadMoreButton = class {\n  constructor(hostRef) {\n    registerInstance(this, hostRef);\n    this.arcgisLoadMoreChange = createEvent(this, \"arcgisLoadMoreChange\", 7);\n    /**\n     * The calcite-button color\n     *\n     * @type {ButtonColor}\n     * @memberof ArcgisLoadMoreButton\n     */\n    this.color = \"neutral\";\n    /**\n     * The calcite-button appearance\n     *\n     * @type {ButtonAppearance}\n     * @memberof ArcgisLoadMoreButton\n     */\n    this.appearance = \"clear\";\n    /**\n     * The calcite-button scale\n     *\n     * @type {Scale}\n     * @memberof ArcgisLoadMoreButton\n     */\n    this.scale = \"l\";\n    /**\n     * The calcite-button width\n     *\n     * @type {Width}\n     * @memberof ArcgisLoadMoreButton\n     */\n    this.width = \"full\";\n    /**\n     * The calcite-button applied round style\n     *\n     * @type {boolean}\n     * @memberof ArcgisLoadMoreButton\n     */\n    this.round = true;\n    /**\n     *\n     * @type {boolean}\n     * @memberof ArcgisLoadMoreButton\n     */\n    this.loading = false;\n    bind(this, 'handleLoadMore');\n  }\n  get hasMoreResults() {\n    const { nextStart } = this;\n    return nextStart !== -1;\n  }\n  get disabled() {\n    const { loading, hasMoreResults } = this;\n    return loading || !hasMoreResults;\n  }\n  async componentWillLoad() {\n    this.intl = await intlManager.loadIntlForComponent(this.el);\n  }\n  handleLoadMore() {\n    const { nextStart } = this;\n    this.arcgisLoadMoreChange.emit(nextStart);\n  }\n  render() {\n    const { loading, handleLoadMore, round, scale, width, intl, hasMoreResults, disabled } = this;\n    const text = intl.t('loadMore');\n    return (h(Host, null, hasMoreResults &&\n      h(\"calcite-button\", {\n        // appearance={appearance}\n        // color={color}\n        disabled: disabled, label: text, loading: loading, onClick: handleLoadMore, round: round, scale: scale, width: width\n      }, text)));\n  }\n  static get assetsDirs() { return [\"locales\"]; }\n  get el() { return getElement(this); }\n};\nArcgisLoadMoreButton.style = arcgisLoadMoreButtonCss;\n\nexport { ArcgisHubDiscussionsPost as arcgis_hub_discussions_post, ArcgisHubDiscussionsPostEditor as arcgis_hub_discussions_post_editor, ArcgisHubDiscussionsPostHeader as arcgis_hub_discussions_post_header, ArcgisHubDiscussionsReply as arcgis_hub_discussions_reply, ArcgisHubDiscussionsReplyEditor as arcgis_hub_discussions_reply_editor, ArcgisLoadMoreButton as arcgis_load_more_button };\n","/**\n * A decorator factory function for the callOnce decorator\n *\n * @returns The callOnce decorator function\n */\nfunction callOnceFactory() {\n  /**\n   * A decorator function that augments a class method with functionality that ensures it is only ever called once.\n   *\n   * @param target A reference to the class prototype\n   * @param propertyKey The name of the method being decorated\n   * @param descriptor A PropertyDescriptor for the method being decorated\n   * @returns A new PropertyDescriptor that aguments the decorated method with functionality that ensures it is only ever called once.\n   */\n  function callOnce(target, propertyKey, descriptor) {\n    // reference to the decorated function\n    const { value: original } = descriptor;\n    // companion prop to track if the decorated function has been called\n    const companionCalledKey = `_${propertyKey}Called`;\n    Object.defineProperty(target, companionCalledKey, {\n      writable: true,\n      value: false\n    });\n    // companion prop to cache the return value of the decorated function\n    const companionCacheKey = `_${propertyKey}Cache`;\n    Object.defineProperty(target, companionCacheKey, {\n      writable: true\n    });\n    // decorator method, calls decorated method only once, subsequent\n    // calls to decorator method return cached\n    const value = function callOnce(...args) {\n      if (!this[companionCalledKey]) {\n        this[companionCalledKey] = true;\n        this[companionCacheKey] = original.apply(this, args);\n      }\n      return this[companionCacheKey];\n    };\n    return Object.assign(Object.assign({}, descriptor), { value });\n  }\n  return callOnce;\n}\n\nexport { callOnceFactory as c };\n","/**\n * A method decorator factory function for the callWhen decorator\n * @param params An ICallWhenDecoratorParams object\n * @returns The callWhen method decorator function\n */\nfunction CallWhenFactory(params) {\n  /**\n   * A decorator function that conditionally call a method if when function returns truthy\n   *\n   * @param _target A reference to the class prototype\n   * @param _propertyKey The name of the method being decorated\n   * @param descriptor A PropertyDescriptor for the method being decorated\n   * @returns A new PropertyDescriptor that aguments the decorated method with conditional call behavior\n   */\n  function callWhen(_target, _propertyKey, descriptor) {\n    const { value: original } = descriptor;\n    const { when } = params;\n    const value = function callWhen(...args) {\n      const isTruthy = when.apply(this, args);\n      if (isTruthy) {\n        // when() condition passed, so call method\n        return original.apply(this, args);\n      }\n    };\n    return Object.assign(Object.assign({}, descriptor), { value });\n  }\n  return callWhen;\n}\n\nexport { CallWhenFactory as C };\n","var TIME_INTERVAL;\n(function (TIME_INTERVAL) {\n  TIME_INTERVAL[TIME_INTERVAL[\"SECOND\"] = 1000] = \"SECOND\";\n  TIME_INTERVAL[TIME_INTERVAL[\"MINUTE\"] = 60000] = \"MINUTE\";\n  TIME_INTERVAL[TIME_INTERVAL[\"HOUR\"] = 3600000] = \"HOUR\";\n  TIME_INTERVAL[TIME_INTERVAL[\"DAY\"] = 86400000] = \"DAY\";\n  TIME_INTERVAL[TIME_INTERVAL[\"WEEK\"] = 604800000] = \"WEEK\";\n  TIME_INTERVAL[TIME_INTERVAL[\"MONTH\"] = 2629800000] = \"MONTH\";\n  TIME_INTERVAL[TIME_INTERVAL[\"YEAR\"] = 31536000000] = \"YEAR\";\n})(TIME_INTERVAL || (TIME_INTERVAL = {}));\nvar TIME_UNIT;\n(function (TIME_UNIT) {\n  TIME_UNIT[\"SECOND\"] = \"second\";\n  TIME_UNIT[\"MINUTE\"] = \"minute\";\n  TIME_UNIT[\"HOUR\"] = \"hour\";\n  TIME_UNIT[\"DAY\"] = \"day\";\n  TIME_UNIT[\"WEEK\"] = \"week\";\n  TIME_UNIT[\"MONTH\"] = \"month\";\n  TIME_UNIT[\"QUARTER\"] = \"quarter\";\n  TIME_UNIT[\"YEAR\"] = \"year\";\n})(TIME_UNIT || (TIME_UNIT = {}));\n\nexport { TIME_UNIT as T, TIME_INTERVAL as a };\n","/**\n * A decorator factory function that accepts the minPromiseDelay decorator\n * configuration params\n * @param options An IMinPromiseDelayOptions object\n * @returns minPromiseDelay decorator\n */\nfunction minPromiseDelayFactory(options) {\n  const { delay } = options;\n  if (!Number.isInteger(delay) || delay < 0) {\n    throw new Error('delay must be a positive integer');\n  }\n  /**\n   * A decorator function that augments a class method with an artificially imposed wait/delay so\n   * that the promise is guaranteed to resolve/reject after a minimum amount of time has ellapsed.\n   */\n  return (_target, _name, descriptor) => {\n    const { value: original } = descriptor;\n    const value = async function minPromiseDelay(...args) {\n      const delayPromise = new Promise(resolve => setTimeout(resolve, delay));\n      const resultPromise = original.apply(this, args);\n      return delayPromise.then(() => resultPromise);\n    };\n    return Object.assign(Object.assign({}, descriptor), { value });\n  };\n}\n\nexport { minPromiseDelayFactory as m };\n","var ArcgisHubDiscussionsBlockedNoticeVariant;\n(function (ArcgisHubDiscussionsBlockedNoticeVariant) {\n  ArcgisHubDiscussionsBlockedNoticeVariant[\"Item\"] = \"item\";\n  ArcgisHubDiscussionsBlockedNoticeVariant[\"EditPost\"] = \"edit.post\";\n  ArcgisHubDiscussionsBlockedNoticeVariant[\"EditPostGroup\"] = \"edit.post.group\";\n  ArcgisHubDiscussionsBlockedNoticeVariant[\"EditPostItem\"] = \"edit.post.item\";\n  ArcgisHubDiscussionsBlockedNoticeVariant[\"EditReply\"] = \"reply.post\";\n  ArcgisHubDiscussionsBlockedNoticeVariant[\"EditReplyGroup\"] = \"edit.reply.group\";\n  ArcgisHubDiscussionsBlockedNoticeVariant[\"EditReplyItem\"] = \"edit.reply.item\";\n  ArcgisHubDiscussionsBlockedNoticeVariant[\"Group\"] = \"group\";\n  ArcgisHubDiscussionsBlockedNoticeVariant[\"Reply\"] = \"reply\";\n})(ArcgisHubDiscussionsBlockedNoticeVariant || (ArcgisHubDiscussionsBlockedNoticeVariant = {}));\nconst ArcgisHubDiscussionsBlockedNoticeConfigs = {\n  [ArcgisHubDiscussionsBlockedNoticeVariant.Item]: {\n    title: 'item.title',\n    message: 'item.message',\n  },\n  [ArcgisHubDiscussionsBlockedNoticeVariant.EditPost]: {\n    title: 'post.title',\n    message: 'post.message',\n  },\n  [ArcgisHubDiscussionsBlockedNoticeVariant.EditPostGroup]: {\n    title: 'post.title',\n    message: 'post.message.group',\n  },\n  [ArcgisHubDiscussionsBlockedNoticeVariant.EditPostItem]: {\n    title: 'post.title',\n    message: 'post.message.item',\n  },\n  [ArcgisHubDiscussionsBlockedNoticeVariant.EditReply]: {\n    title: 'reply.title',\n    message: 'reply.message',\n  },\n  [ArcgisHubDiscussionsBlockedNoticeVariant.EditReplyGroup]: {\n    title: 'reply.title',\n    message: 'reply.message.group',\n  },\n  [ArcgisHubDiscussionsBlockedNoticeVariant.EditReplyItem]: {\n    title: 'reply.title',\n    message: 'reply.message.item',\n  },\n  [ArcgisHubDiscussionsBlockedNoticeVariant.Group]: {\n    title: 'group.title',\n    message: 'group.message',\n  },\n  [ArcgisHubDiscussionsBlockedNoticeVariant.Reply]: {\n    title: 'reply.title.generic',\n    message: 'reply.message.generic',\n  },\n};\n\nexport { ArcgisHubDiscussionsBlockedNoticeVariant as A, ArcgisHubDiscussionsBlockedNoticeConfigs as a };\n","import { c as cloneObject } from './util-2150bd9e.js';\nimport { U as UserSession } from './UserSession-d3a97494.js';\n\n/* Copyright (c) 2018-2021 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\n/**\n * Well known APIs\n * Short-forms for specifying common APIs\n * We will likely deprecate this\n */\nconst SEARCH_APIS = {\n    arcgis: {\n        label: \"ArcGIS Online\",\n        url: \"https://www.arcgis.com\",\n        type: \"arcgis\",\n    },\n    arcgisQA: {\n        label: \"ArcGIS Online QAEXT\",\n        url: \"https://qaext.arcgis.com\",\n        type: \"arcgis\",\n    },\n    arcgisDEV: {\n        label: \"ArcGIS Online DEVEXT\",\n        url: \"https://devext.arcgis.com\",\n        type: \"arcgis\",\n    },\n    hub: {\n        label: \"ArcGIS Hub\",\n        url: \"https://hub.arcgis.com/api\",\n        type: \"arcgis-hub\",\n    },\n    hubDEV: {\n        label: \"ArcGIS Hub DEV\",\n        url: \"https://hubdev.arcgis.com/api\",\n        type: \"arcgis-hub\",\n    },\n    hubQA: {\n        label: \"ArcGIS Hub QA\",\n        url: \"https://hubqa.arcgis.com/api\",\n        type: \"arcgis-hub\",\n    },\n};\n/**\n * @private\n * Convert an api \"name\" into a full ApiDefinition\n * @param api\n * @returns\n */\nfunction expandApi(api) {\n    if (typeof api === \"string\" && api in SEARCH_APIS) {\n        return SEARCH_APIS[api];\n    }\n    else {\n        // it's an object, so we trust that it's well formed\n        return api;\n    }\n}\n/**\n * @private\n * Convert a field value into a MatchOptions if it's not already one\n * @param value\n * @returns\n */\nfunction valueToMatchOptions(value) {\n    let result = {};\n    if (Array.isArray(value)) {\n        result = {\n            any: value,\n        };\n    }\n    else {\n        if (typeof value === \"string\") {\n            result = {\n                any: [value],\n            };\n        }\n        if (typeof value === \"object\") {\n            result = value;\n        }\n    }\n    return result;\n}\n/**\n * @private\n * Convert a RelativeDate to a DateRange<number>\n * @param relative\n * @returns\n */\nfunction relativeDateToDateRange(relative) {\n    // hash of offsets\n    const offsetMs = {\n        min: 1000 * 60,\n        hours: 1000 * 60 * 60,\n        days: 1000 * 60 * 60 * 24,\n        weeks: 1000 * 60 * 60 * 24 * 7,\n    };\n    const now = new Date();\n    // default\n    const result = {\n        type: \"date-range\",\n        from: now.getTime(),\n        to: now.getTime(),\n    };\n    //\n    switch (relative.unit) {\n        case \"hours\":\n        case \"days\":\n        case \"weeks\":\n            result.from = result.to - offsetMs[relative.unit] * relative.num;\n            break;\n        case \"months\":\n            // get the current month and subtract num\n            // NOTE: when the previous month has fewer days than this month\n            // setMonth() will return a date w/in the current month\n            // example: 3/30 -> 3/2 b/c there is no 2/28\n            now.setMonth(now.getMonth() - relative.num);\n            result.from = now.getTime();\n            break;\n        case \"years\":\n            now.setFullYear(now.getFullYear() - relative.num);\n            result.from = now.getTime();\n            break;\n    }\n    return result;\n}\n/**\n * Create a `.next()` function for a type\n * @param request\n * @param nextStart\n * @param total\n * @param fn\n * @returns\n */\nfunction getNextFunction(request, nextStart, total, fn) {\n    const clonedRequest = cloneObject(request);\n    // clone will not handle authentication so we do it manually\n    if (request.authentication) {\n        clonedRequest.authentication = UserSession.deserialize(request.authentication.serialize());\n    }\n    // figure out the start\n    clonedRequest.start = nextStart > -1 ? nextStart : total + 1;\n    return (authentication) => {\n        if (authentication) {\n            clonedRequest.authentication = authentication;\n        }\n        return fn(clonedRequest);\n    };\n}\n/**\n * Construct a the full url to a group thumbnail\n *\n * - If the group has a thumbnail, construct the full url\n * - If the group is not public, append on the token (if passed in)\n * @param portalUrl\n * @param group\n * @param token\n * @returns\n */\nfunction getGroupThumbnailUrl(portalUrl, group, token) {\n    let thumbnailUrl = null;\n    if (group.thumbnail) {\n        thumbnailUrl = `${portalUrl}/community/groups/${group.id}/info/${group.thumbnail}`;\n        if (token && group.access !== \"public\") {\n            thumbnailUrl = `${thumbnailUrl}?token=${token}`;\n        }\n    }\n    return thumbnailUrl;\n}\n/**\n * Construct a the full url to a user thumbnail\n *\n * - If the user has a thumbnail, construct the full url\n * - If the user is not public, append on the token\n * @param portalUrl\n * @param user\n * @param token\n * @returns\n */\nfunction getUserThumbnailUrl(portalUrl, user, token) {\n    let thumbnailUrl = null;\n    if (user.thumbnail) {\n        thumbnailUrl = `${portalUrl}/community/users/${user.username}/info/${user.thumbnail}`;\n        if (token && user.access !== \"public\") {\n            thumbnailUrl = `${thumbnailUrl}?token=${token}`;\n        }\n    }\n    return thumbnailUrl;\n}\n\nexport { getUserThumbnailUrl as a, getNextFunction as b, expandApi as e, getGroupThumbnailUrl as g, relativeDateToDateRange as r, valueToMatchOptions as v };\n","import arrayWithHoles from \"./arrayWithHoles.js\";\nimport iterableToArray from \"./iterableToArray.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableRest from \"./nonIterableRest.js\";\nexport default function _toArray(arr) {\n  return arrayWithHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableRest();\n}"],"names":["CacheDecoratorFactory","params","_target","_propertyKey","descriptor","value","cache","Object","assign","AutoLinkDecoratorFactory","options","original","args","result","apply","this","autoLink","SanitizeDecoratorFactory","sanitizer","Sanitizer","filterOptions","extendDefaults","sanitize","MENTION_ELEMENTS_PATTERN","RegExp","getMentionedUser","match","mentionedUsers","username","parseMentionedUsers","find","userDetails","user","mentionPopoverTransform","input","postDetails","channel","session","originalPostId","transform","_a","matches","startIdx","indexOf","endIdx","length","before","substring","toReplace","mentionedUser","replaced","replace","access","id","creatorDetails","post","creator","fullName","organization","name","portal","region","thumbnail","token","MentionPopoverTransformDecoratorFactory","replyDetails","channelDetails","context","postId","PostView","__decorate$3","decorators","target","key","desc","d","c","arguments","r","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","STEP","ArcgisHubDiscussionsPost","hostRef","registerInstance","arcgisHubDiscussionsPostDelete","createEvent","arcgisHubDiscussionsPostSelect","arcgisHubDiscussionsGeometryDrawReset","arcgisHubDiscussionsGeometryDeselect","arcgisHubDiscussionsPostUpdate","arcgisHubDiscusssionsChannelUpdate","arcgisHubDiscussionsScrollTo","hubTelemetry","unsavedExistingFeatures","loading","editing","errorMessage","bind","initialize","autoFocus","emit","addEnrichments","evt","stopPropagation","preventDefault","handleViewThread","open","menuPopoverElement","toggle","index","emitHubTelemetry","dist","position","telemetry","channelId","channelAccess","element","intlManager","intl","isPostEnriched","isChannelEnriched","enrichPostDetails","enrichChannelDetails","updateLoading","isEnriched","rawPostDetails","includeReplyCount","hubRequestOptions","_channelDetails","body","title","removePost","then","deletedDuringSession","response","catch","e","console","error","message","undefined","el","includes","nodeName","hasAttribute","details","href","requiredEnrichments","every","val","groups","Boolean","renderEditor","renderDeleted","renderPost","renderSkeleton","Skeleton","render","Content","Editor","Deleted","views","hasMap","isHub","unsavedFeatures","unsavedRelatedFeatures","discussionDetails","isMobile","h","preview","icon","direction","capturePostDeepLinkImpression","capturePostListImpression","innerHTML","computePostTitle","computePostBody","lines","onClick","handleLinkClicked","renderTextActions","expandable","url","reference","renderActionGroup","renderActionMenu","color","scale","slot","t","layout","handleReply","text","textEnabled","handleViewReplies","actions","canModifyPost","currentUser","push","fn","handleEdit","canDeletePost","handleDelete","Fragment","class","ref","menuActionElement","autoClose","flipPlacements","label","offsetDistance","placement","referenceElement","map","toLowerCase","linkToThread","appearance","disabled","replyCount","toString","capturePostDeletedImpression","Host","view","getElement","scope","getKey","calcite","whiteList","prototype","callOnceFactory","style","__decorate$2","ArcgisHubDiscussionsPostEditor","arcgisHubDiscussionsPostCancel","arcgisHubDiscussionsPostCreate","arcgisHubDiscussionsPostEdit","arcgisHubDiscussionsGeometryDrawCreate","arcgisHubDiscussionsGeometryDrawTypeSelect","arcgisHubDiscussionsGeometryDrawEdit","arcgisHubDiscussionsGeometrySelect","arcgisHubDiscussionsGeometryClearAll","_unsavedFeatures","_unsavedRelatedFeatures","_unsavedExistingFeatures","pending","titleValue","bodyValue","discussionValue","selectedChannelDetails","searchUsers","query","searchOtherTeamMembers","geometryValue","_postDetails","cloneObject","geometry","discussion","geometryClone","keys","proceedToContentCreation","step","AUDIENCE","fetchRecentChannelDetails","results","items","recentChannelsDetails","_fetchRecentChannelDetails","groupId","groupAccess","groupOrgId","orgId","dataset","channelIndex","CONTENT","selectedItems","detail","Promise","all","fetchTeamFromCache","searchChannels","num","SharingAccess","group","geometryValueHasChanges","JSON","stringify","featureId","properties","relatedFeatureId","geometryType","promise","handleCreate","finally","canAddLocations","addLocationsActiveGeometryType","titleElement","uri","layerId","split","pop","objectIds","Set","feature","objectId","augmentDiscussionURIWithFeature","Array","from","featuresToGeometryCollection","createPost","trim","mentionUrl","window","location","fetchChannel","_b","focus","_c","originalPostFeatures","postToFeatures","forEach","combinedFeatures","coordinates","updatePost","editedPost","_d","_e","_f","shouldConfirmCancel","confirmCancel","handleCancel","type","addLocation","unsaved","features","parseDiscussionURI","splice","geometries","MAX_TITLE_LENGTH","MAX_BODY_LENGTH","isTitleValid","status","characters","isBodyValid","WARNING_BODY_LENGTH","variant","isGroupDiscussable","isDiscussable","isSubjectDiscussable","ArcgisHubDiscussionsBlockedNoticeVariant","hasLocationChanges","blockedNotice","isInvalid","round","handleCancelOrConfirm","locationActions","active","setActiveGeometryDrawType","locationActionElement","triggerDisabled","closeOnClick","handleAddLocationToggle","updateTitleValue","titleMessage","autofocus","onInput","placeholder","bodyMessage","mentionConfig","mention","toolbar","postDetailsWithLocationEdits","renderConfirmCancel","onSubmit","handleSubmit","renderTitleField","renderBodyField","renderedInEditor","renderAddLocationsButton","renderSecondaryActionButton","renderPrimaryActionButton","handleBack","config","action","handleConfirmBackButtonClicked","handleChannelSelectedFromCombobox","canDiscuss","textLabel","width","renderRecentChannels","handleSelectRecentChannel","latestUserPost","delta","Date","now","createdAt","valueOf","days","Math","floor","TIME_INTERVAL","timeStr","formatRelativeTime","TIME_UNIT","getGroupThumbnailUrl","rows","showFooter","showHeading","showThumbnail","iconEnd","rendered","_","renderRecentChannelsError","renderRecentChannelDetails","renderRecentChannelSkeleton","renderRecentChannelsEmpty","renderHeader","renderGroupSelectionStep","renderContentStep","renderCreate","minPromiseDelayFactory","delay","CallWhenFactory","when","ArcgisHubDiscussionsPostHeader","accessIcon","avatars","renderCreatorAvatar","renderChannelAvatar","renderPopover","getUserThumbnailUrl","creatorFullName","renderAvatars","metadata","timestamp","dateTime","formatStyle","renderAccessIcon","ReplyView","ANIMATION_CLASSES","__decorate$1","ArcgisHubDiscussionsReply","arcgisHubDiscussionsReplyDelete","arcgisHubDiscussionsViewAllReplies","arcgisHubDiscussionsReplyUpdate","arcgisHubDiscussionsReplySelect","minHeight","replyClass","editorClass","HIDDEN","renderedEl","addAnimationEventListeners","removeAnimationEventListeners","prevRenderedEl","isReplyEnriched","replyId","enrichReplyDetails","rawReplyDetails","addEventListener","handleAnimationEnd","removeEventListener","requiredValues","reply","lead","styles","zIndex","transitionToReply","animationName","IN","transitionEditorView","showEditor","offsetHeight","OUT","parentId","renderReply","renderReplyOutOfContext","OutOfContext","outOfContext","classes","handleSetComponentRef","originalPostDetails","pin","onMouseOver","captureReplyDeepLinkImpression","captureReplyListImpression","computeReplyBody","renderActions","parentDetails","toggleable","handleViewAllReplies","captureReplyDeletedImpression","__decorate","ArcgisHubDiscussionsReplyEditor","arcgisHubDiscussionsReplyCreate","arcgisHubDiscussionsReplyEdit","arcgisHubDiscussionsReplyCancel","inputValue","focusInput","autoScroll","isInputValid","_replyDetails","setFocus","setTimeout","createReply","updatedReply","avatar","inputMessage","firstName","replyDetailsWithLocationEdits","renderInput","handleReplySubmit","renderUserDetails","ArcgisLoadMoreButton","arcgisLoadMoreChange","nextStart","hasMoreResults","handleLoadMore","propertyKey","companionCalledKey","writable","companionCacheKey","isTruthy","Number","isInteger","Error","_name","delayPromise","resolve","resultPromise","ArcgisHubDiscussionsBlockedNoticeConfigs","Item","EditPost","EditPostGroup","EditPostItem","EditReply","EditReplyGroup","EditReplyItem","Group","Reply","SEARCH_APIS","arcgis","arcgisQA","arcgisDEV","hub","hubDEV","hubQA","expandApi","api","valueToMatchOptions","isArray","any","relativeDateToDateRange","relative","getTime","to","unit","min","hours","weeks","setMonth","getMonth","setFullYear","getFullYear","getNextFunction","request","total","clonedRequest","authentication","UserSession","serialize","start","portalUrl","thumbnailUrl","_toArray","arr"],"sourceRoot":""}