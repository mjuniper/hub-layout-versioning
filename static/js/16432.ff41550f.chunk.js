"use strict";(self.webpackChunkhub_layout_versioning=self.webpackChunkhub_layout_versioning||[]).push([[16432],{25810:function(e,t,n){n.d(t,{Z:function(){return _}});var i=n(43144),a=n(15671),r=n(60136),o=n(92572),s=n(27366),l=(n(59486),n(48805)),u=n(11582),c=n(17768),d=n(46784),p=n(49861),f=n(89125),h=(n(63780),n(69912)),v=n(25243),m=n(585),y=function(e){(0,r.Z)(n,e);var t=(0,o.Z)(n);function n(e){var i;return(0,a.Z)(this,n),(i=t.call(this,e)).type="length",i.startPoint=null,i.endPoint=null,i.measureType=l.n.Direct,i.offset=0,i.orientation=0,i}return(0,i.Z)(n)}((0,d.eC)(u.j));(0,s._)([(0,p.Cb)({type:["length"],json:{write:{isRequired:!0}}})],y.prototype,"type",void 0),(0,s._)([(0,p.Cb)({type:m.Z,json:{write:!0}})],y.prototype,"startPoint",void 0),(0,s._)([(0,p.Cb)({type:m.Z,json:{write:!0}})],y.prototype,"endPoint",void 0),(0,s._)([(0,p.Cb)({type:l.V,nonNullable:!0,json:{write:{isRequired:!0}}})],y.prototype,"measureType",void 0),(0,s._)([(0,p.Cb)({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}})],y.prototype,"offset",void 0),(0,s._)([(0,p.Cb)({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),(0,f.p)((function(e){return c.BV.normalize((0,v.q9)(e),0,!0)}))],y.prototype,"orientation",void 0);var _=y=(0,s._)([(0,h.j)("esri.analysis.LengthDimension")],y)},48805:function(e,t,n){var i;n.d(t,{V:function(){return a},n:function(){return i}}),function(e){e.Horizontal="horizontal",e.Vertical="vertical",e.Direct="direct"}(i||(i={}));var a=[i.Horizontal,i.Vertical,i.Direct]},16432:function(e,t,n){n.r(t),n.d(t,{default:function(){return _n}});var i,a=n(74165),r=n(15861),o=n(37762),s=n(15671),l=n(43144),u=n(60136),c=n(92572),d=n(27366),p=n(85015),f=n(80987),h=n(32718),v=n(92026),m=n(94172),y=n(49861),_=(n(25243),n(63780),n(69912)),g=n(98074),S=n(48805),C=n(100),w=n(68860),b=n(74177),M=n(29439),P=n(16889),k=n(47898),x=n(14226),Z=n(81949),T=n(11186),R=n(71353),D=n(14320),O=n(51378),z=n(65618),A=n(37818),H=n(9052),W=n(4914);function I(e){var t=e.elevationAlignedStartPoint,n=e.elevationAlignedEndPoint,i=e.dimension;return{elevationAlignedStartPoint:t,elevationAlignedEndPoint:n,offset:i.offset,measureType:i.measureType,orientation:i.orientation}}function V(e,t){var n=e.elevationAlignedStartPoint,i=e.elevationAlignedEndPoint,a=e.offset,r=e.measureType,o=e.orientation,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if((0,v.Wi)(n)||(0,v.Wi)(i))return null;var l=j((0,v.pC)(s)?s.directSegment:new H.y,{elevationAlignedStartPoint:n,elevationAlignedEndPoint:i},t),u=(0,v.pC)(s)?s.primaryOffsetAxis:(0,R.c)();Y(u,{measureType:r,elevationAlignedStartPoint:n,elevationAlignedEndPoint:i,directSegment:l,orientation:o,renderCoordsHelper:t});var c=(0,v.pC)(s)?s.dimensionSegment:new H.y;return U({elevationAlignedStartPoint:n,elevationAlignedEndPoint:i})&&r===S.n.Vertical?((0,T.c)(c.startRenderSpace,l.startRenderSpace),(0,T.c)(c.endRenderSpace,l.endRenderSpace)):B(c,{offsetAxis:u,offset:a,relativeToSegment:l,renderCoordsHelper:t}),{directSegment:l,dimensionSegment:c,primaryOffsetAxis:u,spatialReference:t.spatialReference}}function L(e,t,n,a){return t===i.Start?((0,T.c)(e.startRenderSpace,n.startRenderSpace),(0,T.c)(e.endRenderSpace,a.startRenderSpace)):((0,T.c)(e.startRenderSpace,n.endRenderSpace),(0,T.c)(e.endRenderSpace,a.endRenderSpace)),e}function E(e,t,n,i){switch(t){case S.n.Direct:return j(e,n,i);case S.n.Horizontal:case S.n.Vertical:var a,r=n.elevationAlignedStartPoint,o=n.elevationAlignedEndPoint,s=n.dimension,l=n.geometry;s.measureType===S.n.Direct?(a=function(e,t){var n=e.directSegment.eval(.5,O.WM.get()),i=t.worldUpAtPosition(n,O.WM.get()),a=e.dimensionSegment.eval(.5,O.WM.get()),r=(0,T.w)(O.WM.get(),a,n);return!(0,T.F)(r,R.Z)&&(0,T.e)(r,i)>0}(l,i)===r.z>o.z,t===S.n.Horizontal&&(a=!a)):a=!function(e){var t=e.dimensionSegment,n=t.startRenderSpace,i=t.endRenderSpace,a=e.directSegment,r=a.startRenderSpace,o=a.endRenderSpace;return(0,T.E)(r,n)<(0,T.E)(o,i)}(l);var u=a?[r,o]:[o,r],c=(0,M.Z)(u,2),d=c[0],p=c[1],f=(0,A.WG)(p,G);return t===S.n.Horizontal?f.z=d.z:(f.x=d.x,f.y=d.y),i.toRenderCoords(d,e.startRenderSpace),i.toRenderCoords(f,e.endRenderSpace),e}}function j(e,t,n){return n.toRenderCoords(t.elevationAlignedStartPoint,e.startRenderSpace),n.toRenderCoords(t.elevationAlignedEndPoint,e.endRenderSpace),e}!function(e){e[e.Start=0]="Start",e[e.End=1]="End"}(i||(i={}));var G=(0,z.Tx)(0,0,0,null);var F=new H.y;function Y(e,t){var n=t.measureType,i=t.elevationAlignedStartPoint,a=t.elevationAlignedEndPoint,r=t.directSegment,o=r.startRenderSpace,s=r.endRenderSpace,l=t.directSegment,u=t.renderCoordsHelper,c=l.eval(.5,O.WM.get()),d=u.worldUpAtPosition(c,O.WM.get()),p=u.worldBasisAtPosition(c,D.R.Y,O.WM.get());switch(n){case S.n.Horizontal:(0,T.c)(e,d);break;case S.n.Vertical:(0,T.e)(o,d)<(0,T.e)(s,d)?(0,T.w)(e,s,o):(0,T.w)(e,o,s),(0,T.f)(e,e,d),(0,T.f)(e,e,d);break;case S.n.Direct:var f=(0,v.Pt)(t.orientation,0);if(U({elevationAlignedStartPoint:i,elevationAlignedEndPoint:a}))(0,x.d)(X,-(0,P.Vl)(f),d),(0,T.m)(e,p,X);else{var h=(0,T.w)(O.WM.get(),s,o),m=(0,T.f)(O.WM.get(),h,d);(0,T.f)(m,m,h),(0,x.d)(X,(0,P.Vl)(f),h),(0,T.m)(e,m,X)}}return(0,T.F)(e,R.Z)?(0,T.c)(e,p):(0,T.n)(e,e)}var X=(0,Z.c)();function U(e){var t=e.elevationAlignedStartPoint,n=e.elevationAlignedEndPoint;return(0,v.pC)(t)&&(0,v.pC)(n)&&t.x===n.x&&t.y===n.y}function B(e,t){var n=t.offsetAxis,i=t.offset,a=t.relativeToSegment,r=a.startRenderSpace,o=a.endRenderSpace,s=t.relativeToSegment,l=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=(0,T.e)(t,n),r=(0,T.e)(e,n),o=Math.abs(a-r)+i;return a>r?[o,i]:[i,o]}(r,o,n,i/t.renderCoordsHelper.unitInMeters),u=(0,M.Z)(l,2),c=u[0],d=u[1];return(0,T.z)(e.startRenderSpace,s.startRenderSpace,n,c),(0,T.z)(e.endRenderSpace,s.endRenderSpace,n,d),e}function q(e,t,n){var i=t.directSegment.eval(.5,O.WM.get());return n.worldUpAtPosition(i,e)}function N(e,t){var n=t.directSegment,i=n.startRenderSpace,a=n.endRenderSpace;return(0,T.w)(e,a,i)}function J(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{invert:!1},i=t.dimensionSegment,a=i.startRenderSpace,r=i.endRenderSpace;return n.invert?(0,T.w)(e,a,r):(0,T.w)(e,r,a)}function Q(e,t){var n=e.directSegment.eval(.5,O.WM.get());return t.headingAtPosition(n,e.primaryOffsetAxis)}var $=(0,R.c)();function K(e){var t=e.elevationAlignedStartPoint,n=e.elevationAlignedEndPoint;if((0,v.Wi)(t)||(0,v.Wi)(n))return!1;var i=(0,W.Z1)(t,n);return(0,v.pC)(i)&&(0,k.nn)(i,"meters").value>ee}var ee=1e5;function te(e){return(0,v.pC)(e.geometry)}var ne=function(e){(0,u.Z)(n,e);var t=(0,c.Z)(n);function n(e){var i;return(0,s.Z)(this,n),(i=t.call(this,e))._handles=new C.Z,i}return(0,l.Z)(n,[{key:"initialize",value:function(){var e,t=this,n=this.analysisViewData.computations,i=(0,o.Z)(n);try{for(i.s();!(e=i.n()).done;){var a=e.value;this._addComputation(a)}}catch(r){i.e(r)}finally{i.f()}this.addHandles(n.on("change",(function(e){var n,i=e.added,a=e.removed,s=(0,o.Z)(a);try{for(s.s();!(n=s.n()).done;){var l=n.value;t._removeComputation(l)}}catch(r){s.e(r)}finally{s.f()}var u,c=(0,o.Z)(i);try{for(c.s();!(u=c.n()).done;){var d=u.value;t._addComputation(d)}}catch(r){c.e(r)}finally{c.f()}})))}},{key:"destroy",value:function(){this._handles=(0,v.SC)(this._handles)}},{key:"analysis",get:function(){return this.analysisViewData.analysis}},{key:"_defaultUnit",get:function(){return(0,b.R)(this.view)}},{key:"_addComputation",value:function(e){var t=this;this._handles.has(e)||this._handles.add((0,m.YP)((function(){return I(e)}),(function(n){var i=n.measureType;if(K(n)&&i!==S.n.Direct){var a=Math.round((0,w.En)(ee,"meters","kilometers"));return h.Z.getLogger(t.declaredClass).warnOnce("A ".concat(i," dimension in the analysis (id: '").concat(t.analysis.id,"') will not display, because only direct dimensions can measure lengths greater than ").concat(a,' km. Update the measureType of the affected dimension to "direct" to display it.')),void(e.geometry=null)}var r=V(n,t.view.renderCoordsHelper,e.geometry);e.geometry=r,e.result.length=function(e,t,n){if((0,v.Wi)(e))return null;var i=e.dimensionSegment.startRenderSpace,a=e.dimensionSegment.endRenderSpace,r=(0,W.FN)(i,a,e.spatialReference);if((0,v.Wi)(r))return null;var o=t===S.n.Vertical?(0,w.ov)(r.value,r.unit,n):(0,w.iS)(r.value,r.unit,n);return(0,k.nn)(r,o)}(r,i,t._defaultUnit)}),m.tX),e)}},{key:"_removeComputation",value:function(e){this._handles.remove(e)}}]),n}(p.Z);(0,d._)([(0,y.Cb)({constructOnly:!0})],ne.prototype,"analysisViewData",void 0),(0,d._)([(0,y.Cb)({constructOnly:!0})],ne.prototype,"view",void 0),(0,d._)([(0,y.Cb)()],ne.prototype,"analysis",null),(0,d._)([(0,y.Cb)()],ne.prototype,"_defaultUnit",null),ne=(0,d._)([(0,_.j)("esri.views.3d.analysis.Dimension.support.DimensionController")],ne);var ie=n(1413),ae=n(84702),re=n(42537),oe=n(93433),se=n(51995),le=(n(59486),n(17768)),ue=n(17842),ce=n(55652),de={main:new se.Z([255,127,0])},pe=(0,l.Z)((function e(){(0,s.Z)(this,e),this.color=de.main,this.opacity=.5,this.radius=5})),fe=(0,l.Z)((function e(){(0,s.Z)(this,e),this.color=new se.Z([127,127,127]),this.opacity=.5,this.radius=5})),he=(0,l.Z)((function e(){(0,s.Z)(this,e),this.lineSizeFraction=.8})),ve=(0,l.Z)((function e(){(0,s.Z)(this,e),this.color=de.main,this.opacity=.5,this.linePaddingPx=4,this.focusedLinePaddingPx=6,this.lengthFraction=.5,this.minLengthMeters=.1})),me=(0,l.Z)((function e(){(0,s.Z)(this,e),this.calloutOffsetPx=18,this.calloutOpacity=.5,this.calloutWidth=2,this.discScale=.3,this.focusMultiplier=2})),ye=(0,l.Z)((function e(){(0,s.Z)(this,e),this.lineSizeFraction=.25})),_e=(0,l.Z)((function e(){(0,s.Z)(this,e),this.marginPx=20,this.minScreenLengthFontSizeFactor=5})),ge=(0,l.Z)((function e(){(0,s.Z)(this,e),this.color=new se.Z([255,127,0,.5])})),Se=new((0,l.Z)((function e(){(0,s.Z)(this,e),this.pointManipulators=new pe,this.offsetManipulator=new ve,this.orientationManipulator=new me,this.markers=new he,this.labels=new _e,this.offsetLine=new ye,this.constraint=new ge,this.constraintThresholdPx=10,this.initialOffsetPx=50,this.orientationSnapThresholdDegrees=5,this.disabledPointIndicator=new fe,this.smallScreenLengthLineSizeFactor=2,this.pointerMoveTimeoutMs=2500}))),Ce=n(35284),we=n(83639),be=n(40508),Me=n(51328),Pe=n(2522),ke=n(70619),xe=n(74229),Ze=n(99034),Te=n(585),Re=function(){function e(t){(0,s.Z)(this,e),this.start=t.start,this.end=t.end,this.offset=t.offset,this.heading=t.heading,this.rotation=t.rotation,this.direct=t.direct,this.horizontal=t.horizontal,this.vertical=t.vertical}return(0,l.Z)(e,[{key:"manipulatorName",value:function(e){var t=this;return Object.keys(this).find((function(n){return t.hasOwnProperty(n)&&e===t[n]}))}},{key:"values",value:function(){return[this.start,this.end,this.offset,this.heading,this.rotation,this.direct,this.horizontal,this.vertical]}},{key:"forEachMeasureTypeManipulator",value:function(e){var t,n=(0,o.Z)(S.V);try{for(n.s();!(t=n.n()).done;){var i=t.value;e(this.manipulatorForMeasureType(i),i)}}catch(a){n.e(a)}finally{n.f()}}},{key:"manipulatorForMeasureType",value:function(e){switch(e){case S.n.Direct:return this.direct;case S.n.Horizontal:return this.horizontal;case S.n.Vertical:return this.vertical}}}]),e}();function De(e,t){var n=t.lineSizePt,i=t.material,a=Se.orientationManipulator,r=a.calloutOffsetPx,o=a.calloutOpacity,s=a.calloutWidth,l=a.discScale,u=a.focusMultiplier;return{calloutLength:.25*Pe._Z*Se.markers.lineSizeFraction*(0,ue.F2)(n)+r,calloutOpacity:o,calloutWidth:s,customStateMask:Qe,discScale:l,focusMultiplier:u,material:i,metadata:e}}function Oe(e,t){return(0,we.Ju)(e,De(t.metadata,t))}function ze(e,t){(0,we.Bz)(e,De(e.metadata,t))}function Ae(e,t){var n=t.computation,i=t.view;return[(0,xe.Xd)(e,(function(e,t,a){He({cancel:a,computation:n,settingHeading:!1,steps:t,view:i})})),e.events.on("immediate-click",(function(e){!function(e,t,n){var i=t.dimension,a=t.geometry;if(90===i.orientation||270===i.orientation)return i.orientation=0,void e.stopPropagation();if((0,v.Wi)(a))return;var r=n.renderCoordsHelper,o=V((0,ie.Z)((0,ie.Z)({},I(t)),{},{orientation:90}),r),s=V((0,ie.Z)((0,ie.Z)({},I(t)),{},{orientation:270}),r);if((0,v.Wi)(o)||(0,v.Wi)(s))return;var l=Q(o,r),u=Q(s,r),c=Ve(a,n),d=le.BV.shortestSignedDiff(c,l),p=le.BV.shortestSignedDiff(c,u);i.orientation=Math.abs(d)<Math.abs(p)?90:270,e.stopPropagation()}(e,n,i)}))]}function He(e){var t=e.cancel,n=e.computation,i=e.settingHeading,a=e.steps,r=e.view;if(te(n)){var o=r.renderCoordsHelper,s=n.dimension,l=n.geometry,u=(0,R.c)(),c=Ue((0,R.c)(),l,l.directSegment,o),d=Be(O.WM.get(),{forHeading:i,geometry:l,renderCoordsHelper:o}),p=(0,ce.Yq)(c,d,(0,ce.Ue)()),f=(0,v.Pt)(s.orientation,i?function(){return Q(l,r.renderCoordsHelper)}:0);a.next((0,Me._N)(r,p)).next((function(e){"start"===e.action&&(0,T.c)(u,e.renderStart);var t=(0,ce.mJ)(p),n=(0,we.Gd)(u,e.renderEnd,c,t),a=f-(0,P.BV)(n);i||(a=function(e){var t=le.BV.normalize(e)%90;return t<Se.orientationSnapThresholdDegrees?e-t:90-t<Se.orientationSnapThresholdDegrees?e+(90-t):e}(a)),s.orientation=a})),t.next((0,xe.di)(s,["orientation"]))}}function We(e,t){var n=t.computation,i=t.manipulatorMeasureType,a=t.view,r=S.n.Direct,o=0,s=0;return[e.events.on("grab-changed",(function(t){if("start"===t.action&&te(n)){var l=n.dimension,u=n.geometry;r=l.measureType,o=l.offset,s=l.orientation;var c=(0,T.c)(O.WM.get(),e.renderLocation);l.measureType=i,l.offset=function(e,t,n,i){var a=n.directSegment,r=Y(O.WM.get(),{measureType:t,directSegment:a,renderCoordsHelper:i}),o=B(F,{offsetAxis:r,offset:0,relativeToSegment:a,renderCoordsHelper:i}).eval(.5,O.WM.get()),s=(0,T.w)(O.WM.get(),e,o);return(0,T.e)(s,r)*i.unitInMeters}(c,i,u,a.renderCoordsHelper),l.orientation=0}})),(0,xe.Xd)(e,(function(e,t,l){if(te(n)){var u=n.geometry,c=n.dimension,d=a.renderCoordsHelper,p=E(tt,i,n,d),f=Y(O.WM.get(),{measureType:i,directSegment:u.directSegment,renderCoordsHelper:d}),h=(0,Me.J4)(e);t.next(h).next(Ie(a,c,p,f)),l.next(h).next((function(e){return c.measureType=r,c.offset=o,c.orientation=s,e}))}}))]}function Ie(e,t,n,i){var a=(0,T.b)(O.WM.get(),n.endRenderSpace,n.startRenderSpace);(0,T.f)(a,a,i);var r,o=(0,ce.Yq)(n.startRenderSpace,a,(0,ce.Ue)()),s=(0,ce.Yq)(n.startRenderSpace,i,(0,ce.Ue)()),l=t.offset,u=0,c=new xe.hM;return c.next((0,Me._N)(e,o)).next((function(n){"start"===n.action&&(u=(0,ce.jH)(s,n.renderStart));var i=((0,ce.jH)(s,n.renderEnd)-u)*e.renderCoordsHelper.unitInMeters;t.offset=l+i,r=n})),function(e){return c.execute(e),r}}function Ve(e,t){var n=e.directSegment,i=t.renderCoordsHelper,a=q(O.WM.get(),e,i),r=N(O.WM.get(),e),o=(0,T.f)(O.WM.get(),r,a),s=t.state.camera.viewForward;(0,T.e)(o,s)>0&&(0,T.g)(o,o,-1);var l=n.eval(.5,O.WM.get());return i.headingAtPosition(l,o)}function Le(e,t,n){var i=t.dimensionSegment,a=t.primaryOffsetAxis,r=J($e,t),o=(0,T.k)(r,R.Z)?(0,x.i)(et):(0,we.Aq)(r,a,R.Z,et),s=Math.max((0,T.l)(r),Se.offsetManipulator.minLengthMeters/n.unitInMeters);(0,x.k)(o,o,(0,T.s)($e,s,s,s)),e.modelTransform=o,e.renderLocation=i.eval(.5,$e)}function Ee(e,t,n){Ge(e,t,n,{forHeading:!0})}function je(e,t,n){Ge(e,t,n,{forHeading:!1})}function Ge(e,t,n,i){var a=i.forHeading,r=t.dimension,o=t.geometry,s=o.primaryOffsetAxis,l=(0,T.g)(Fe,s,r.offset>=0?1:-1),u=Be(Ye,{forHeading:a,geometry:o,renderCoordsHelper:n});(0,T.f)(u,u,l);var c=(0,we.Aq)(l,u,R.Z,et);e.modelTransform=c,e.renderLocation=Ue($e,o,o.dimensionSegment,n)}var Fe=(0,R.c)(),Ye=(0,R.c)();function Xe(e,t,n,i){var a=t.geometry,r=E(tt,n,t,i),o=Y($e,{measureType:n,directSegment:a.directSegment,renderCoordsHelper:i}),s=(0,T.w)(Ke,r.endRenderSpace,r.startRenderSpace),l=(0,we.Aq)(s,o,R.Z,et),u=(0,T.l)(s);(0,x.k)(l,l,(0,T.s)(Ke,u,u,u)),e.modelTransform=l,e.renderLocation=r.eval(.5,Ke)}function Ue(e,t,n,i){var a=n.startRenderSpace,r=n.endRenderSpace,o=function(e,t){var n=N(qe,e),i=q(Ne,e,t);return(0,T.e)(n,i)>0}(t,i)?a:r;return(0,T.c)(e,o)}function Be(e,t){var n=t.forHeading,i=t.geometry,a=t.renderCoordsHelper;return n?q(e,i,a):J(e,i,{invert:!0})}var qe=(0,R.c)(),Ne=(0,R.c)();function Je(e){return(0,ue.F2)(e)+Se.offsetManipulator.focusedLinePaddingPx}var Qe=Ze.jg.Custom1,$e=(0,R.c)(),Ke=(0,R.c)(),et=(0,Z.c)(),tt=new H.y,nt=n(25810),it=n(41691),at=n(84652);function rt(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}var ot,st=n(66978);n(93169);function lt(e,t,n){var i=n.constraint,a=n.elevationAlignedStartPoint,r=n.elevationAlignedEndPoint,o=n.unconstrainedGeometry,s=n.view,l=e.dimension,u=e.previousConstraint,c=e.preConstraintProperties;if(!(0,v.Wi)(a)&&!(0,v.Wi)(r)){var d=function(){"startPoint"in t?l.startPoint=t.startPoint:"endPoint"in t&&(l.endPoint=t.endPoint)};if((0,v.Wi)(i))d(),(0,v.pC)(u)&&(0,v.pC)(c)&&(l.measureType=c.measureType,l.orientation=c.orientation);else switch(l.measureType=S.n.Direct,i){case ot.Horizontal:if(i!==u&&(l.orientation=0),"startPoint"in t){var p=t.startPoint;(0,v.pC)(p)&&(p.z=r.z),l.startPoint=p}else if("endPoint"in t){var f=t.endPoint;(0,v.pC)(f)&&(f.z=a.z),l.endPoint=f}break;case ot.Vertical:if(i!==u&&(l.orientation=Ve(o,s)),"startPoint"in t){var h=t.startPoint;(0,v.pC)(h)&&(h.x=r.x,h.y=r.y),l.startPoint=h}else if("endPoint"in t){var m=t.endPoint;(0,v.pC)(m)&&(m.x=a.x,m.y=a.y),l.endPoint=m}break;case ot.Direct:i!==u&&(0,v.pC)(c)&&(l.orientation=c.orientation),d()}e.previousConstraint=i,e.unconstrainedGeometry=o}}!function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical",e[e.Direct=2]="Direct"}(ot||(ot={}));var ut=n(96664),ct=n(79311),dt=n(33837),pt=n(27676),ft=n(56529),ht=n(66156),vt=n(86700),mt=n(58901),yt=n(14813),_t=n(84954),gt=n(87268),St=n(70758),Ct=n(22006),wt=n(76014),bt=n(98173);var Mt=n(61394),Pt=n(38856),kt=new Map;function xt(e){if(!kt.has(e)){var t=function(e,t){var n,i,a=new bt.Z({enabled:!0,selfEnabled:!1,featureEnabled:!0,distance:null!==(n=null===t||void 0===t?void 0:t.distance)&&void 0!==n?n:wt.c.distance,touchSensitivityMultiplier:null!==(i=null===t||void 0===t?void 0:t.touchSensitivityMultiplier)&&void 0!==i?i:wt.c.touchSensitivityMultiplier});return(0,ie.Z)((0,ie.Z)({},(0,m.YP)((function(){var t,n,i;return null!==(t=null===(n=e.map)||void 0===n||null===(i=n.allLayers)||void 0===i?void 0:i.toArray())&&void 0!==t?t:[]}),(function(e){a.featureSources=new f.Z(e.map((function(e){return new Ct.Z({layer:e,enabled:!0})})))}),m.nn)),{},{options:a})}(e,{distance:10}),n=function(e,t){return new Pt.N({view:e,options:t,snappingEnginesFactory:function(t,n){return[new Mt.U({view:e,spatialReference:e.spatialReference,options:n})]}})}(e,t.options);kt.set(e,{referenceCount:0,snappingManager:n,remove:function(){t.remove(),n.destroy()}})}var i=kt.get(e);i.referenceCount++;var a=(0,re.kB)((function(){return function(e,t){t.referenceCount--,t.referenceCount>0||(0,St.Y)((function(){0===t.referenceCount&&(t.remove(),kt.delete(e))}))}(e,i)}));return(0,ie.Z)({snappingManager:i.snappingManager},a)}var Zt=n(34019),Tt=n(80151),Rt=n(71040),Dt=n(64674),Ot=function(e){(0,u.Z)(n,e);var t=(0,c.Z)(n);function n(e){var i;(0,s.Z)(this,n),(i=t.call(this,e))._stagedDimension=null,i._computationManipulators=new Map,i._computationHandles=new C.Z,i._getSnappingContext=function(e){var t,n,i=[],a=!1;return function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return a&&t===this&&rt(o,i)||(n=e.apply(this,o),t=this,i=o,a=!0),n}}((function(e){return new Zt.N({elevationInfo:{mode:"absolute-height",offset:0},pointer:e,editGeometryOperations:new gt.c(new _t.XE("point",(0,yt.Y6)(!0,!1,i.view.spatialReference))),visualizer:new ct._})})),i._snappingManagerResult=xt(e.view),i.addHandles(i._snappingManagerResult),i._unfocusedOffsetManipulatorMaterial=zt(),i._focusedOffsetManipulatorMaterial=zt(),i._thinOffsetManipulatorMaterial=zt(),i._thinOffsetManipulatorMaterial.setParameters({stipplePattern:(0,vt.z5)(2)}),i._constraintSnappingIndicator=new dt.r({view:e.view,attached:!0,width:1,color:se.Z.toUnitRGBA(Se.constraint.color),renderOccluded:ft.yD.OccludeAndTransparent,stipplePattern:(0,vt.z5)(5)});var a=se.Z.toUnitRGBA(Se.disabledPointIndicator.color);return a[3]*=Se.disabledPointIndicator.opacity,i._stagedStartIndicator=new pt.j({view:e.view,attached:!1,color:a,size:2*Se.disabledPointIndicator.radius,elevationInfo:{mode:"absolute-height",offset:0},spatialReference:e.view.renderCoordsHelper.spatialReference,outlineSize:0,renderOccluded:ft.yD.OccludeAndTransparent}),i}return(0,l.Z)(n,[{key:"initialize",value:function(){var e=this;this._snappingOperation=new Rt.y({view:this.view}),this._orientationManipulatorTexture=(0,ut.O)(this.view.toolViewManager.textures),this._orientationManipulatorMaterial=new ht.j({transparent:!0,writeDepth:!1,textureId:this._orientationManipulatorTexture.texture.id,renderOccluded:ft.yD.Opaque});var t,n=this.analysisViewData.computations,i=(0,o.Z)(n);try{for(i.s();!(t=i.n()).done;){var a=t.value;this._addComputation(a)}}catch(r){i.e(r)}finally{i.f()}this.addHandles([n.on("after-add",(function(t){return e._addComputation(t.item)})),n.on("after-remove",(function(t){return e._removeComputation(t.item)}))]),this.addHandles([(0,m.YP)((function(){return{stagedPoint:e._snappingOperation.stagedPoint,stagedComputation:e._stagedComputation}}),(function(t){var n=t.stagedPoint,i=t.stagedComputation;if(!(0,v.Wi)(i)&&!(0,v.Wi)(n)){var a=(0,A.WG)(n,new Te.Z);e._applyPointUpdate(i,{endPoint:a})}}),m.Z_),(0,m.YP)((function(){return{stagedDimension:e._stagedDimension,selectedComputation:e.analysisViewData.selectedComputation,firstGrabbedManipulator:e.firstGrabbedManipulator}}),(function(t,n){var i=t.stagedDimension,a=t.selectedComputation,s=t.firstGrabbedManipulator;if(i===(null===n||void 0===n?void 0:n.stagedDimension)&&s===(null===n||void 0===n?void 0:n.firstGrabbedManipulator))for(var l=0,u=[a,null===n||void 0===n?void 0:n.selectedComputation];l<u.length;l++){var c=u[l];if((0,v.pC)(c)){var d=e._computationManipulators.get(c);e._updateManipulators(c,d,t)}}else{var p,f=(0,o.Z)(e._computationManipulators);try{for(f.s();!(p=f.n()).done;){var h=(0,M.Z)(p.value,2),m=h[0],y=h[1];e._updateManipulators(m,y,t)}}catch(r){f.e(r)}finally{f.f()}}}),m.tX),(0,m.YP)((function(){return e.analysis.style.lineSize}),(function(t){e._updateManipulatorStyle(t)}),m.nn),(0,m.YP)((function(){return e.view.state.camera}),(function(){(0,v.pC)(e._stagedComputation)&&e._updateStagedDimensionOffset(e._stagedComputation)})),(0,m.YP)((function(){return(0,v.yw)(e._stagedComputation,(function(t){var n=t.elevationAlignedStartPoint,i=(0,R.c)();return(0,v.pC)(n)&&e.view.renderCoordsHelper.toRenderCoords(n,i)?i:null}))}),(function(t){(0,v.pC)(t)?(e._stagedStartIndicator.vertices=[t],e._stagedStartIndicator.attached=!0):e._stagedStartIndicator.attached=!1}))]),this.addHandles(this._constraintHandles),this.addHandles(this._snappingIndicatorHandles),(0,Dt.Ob)(this,(function(){var t=e._activeComputation,n=e._stagedComputation;if((0,v.Wi)(t)||(0,v.pC)(n)){var i=(0,v.Pt)(e.view.inputManager.latestPointerType,"mouse"),a=e._getSnappingContext(i);e.updatingHandles.addPromise((0,st.R8)(e._snappingOperation.resnap(e._snappingManager,a)))}if((0,v.pC)(t)){var r=e._computationManipulators.get(t),o=r.start,s=r.end;if(o.grabbing||s.grabbing)!function(e,t,n){var i=n.constraint,a=n.view,r=e.unconstrainedGeometry;if(!(0,v.Wi)(r)){var o=a.renderCoordsHelper,s=a.spatialReference,l=r.directSegment,u=l.startRenderSpace,c=l.endRenderSpace,d=o.fromRenderCoords(u,new Te.Z,s),p=o.fromRenderCoords(c,new Te.Z,s);lt(e,"start"===t?{startPoint:d}:{endPoint:p},{constraint:i,elevationAlignedStartPoint:e.elevationAlignedStartPoint,elevationAlignedEndPoint:e.elevationAlignedEndPoint,unconstrainedGeometry:r,view:a})}}(t,o.grabbing?"start":"end",{constraint:e._computeConstraint(t),view:e.view})}}))}},{key:"destroy",value:function(){this._snappingOperation=(0,v.SC)(this._snappingOperation),this._computationHandles.destroy(),this._constraintSnappingIndicator.destroy(),this._stagedStartIndicator.destroy(),this._orientationManipulatorMaterial.dispose(),this._orientationManipulatorTexture.release()}},{key:"updating",get:function(){return this.updatingHandles.updating||this._snappingManager.updating}},{key:"firstGrabbedManipulator",get:function(){return this.parentTool.firstGrabbedManipulator}},{key:"hasGrabbedManipulators",get:function(){return this.parentTool.hasGrabbedManipulators}},{key:"snappingOptions",get:function(){return this._snappingManager.options}},{key:"_snappingManager",get:function(){return this._snappingManagerResult.snappingManager}},{key:"_activeComputation",get:function(){if((0,v.pC)(this._stagedComputation))return this._stagedComputation;var e=this.analysisViewData.selectedComputation;return this.hasGrabbedManipulators&&(0,v.pC)(e)?e:null}},{key:"_stagedComputation",get:function(){var e=this._stagedDimension,t=this.analysisViewData.computations.at(-1);return(0,v.Wi)(e)||(0,v.Wi)(t)||t.dimension!==e?null:t}},{key:"_constraintHandles",get:function(){var e=this;return[(0,m.gx)((function(){return e.analysisViewData.selectedComputation}),(function(t){t.previousConstraint=e._computeConstraint(t)}),(0,ie.Z)((0,ie.Z)({},m.tX),{},{equals:at.fS})),(0,m.YP)((function(){var t=e._activeComputation;if((0,v.Wi)(t))return null;var n=t.dimension;return{measureType:n.measureType,orientation:n.orientation,computation:t}}),(function(e,t){if((0,v.pC)(e)&&(0,v.Wi)(t)){var n=e.measureType,i=e.orientation,a=e.computation;switch(a.previousConstraint){case ot.Horizontal:a.preConstraintProperties={measureType:S.n.Horizontal,orientation:0};break;case ot.Vertical:a.preConstraintProperties={measureType:S.n.Vertical,orientation:0};break;case ot.Direct:a.preConstraintProperties={measureType:S.n.Direct,orientation:i};break;default:a.preConstraintProperties={measureType:n,orientation:i}}}(0,v.Wi)(e)&&(0,v.pC)(t)&&(t.computation.preConstraintProperties=null)}),m.Z_)]}},{key:"_snappingIndicatorHandles",get:function(){var e=this,t="snapping-indicator-event-handles";return[(0,m.YP)((function(){return{stagedComputation:e._stagedComputation,activeComputation:e._activeComputation}}),(function(n){var i=n.stagedComputation,a=n.activeComputation,r=e._constraintSnappingIndicator;if(e.removeHandles(t),(0,v.Wi)(a))r.attached=!1;else if(a===i)r.attached=!0;else{var o=e._computationManipulators.get(a),s=o.start,l=o.end,u=function(){r.attached=s.grabbing||l.grabbing};u(),e.addHandles([s.events.on("grab-changed",u),l.events.on("grab-changed",u)],t)}})),(0,m.YP)((function(){var t=e._activeComputation;return(0,v.pC)(t)?{geometry:t.geometry,constraint:t.previousConstraint}:{}}),(function(t){var n=t.geometry,i=t.constraint,a=e._constraintSnappingIndicator;(0,v.pC)(n)&&(0,v.pC)(i)&&i!==ot.Direct?(a.visible=!0,a.setGeometryFromSegment(n.directSegment)):a.visible=!1}))]}},{key:"removeStaged",value:function(){return!!(0,v.pC)(this._stagedDimension)&&(this.analysis.dimensions.remove(this._stagedDimension),this._stagedDimension=null,!0)}},{key:"onDeactivate",value:function(){this.removeStaged(),this._resetSnappingState()}},{key:"onClick",value:function(e){var t=this._stagedDimension;if((0,v.Wi)(t)){var n=this._onUnstagedClick(e);return this.analysis.dimensions.add(n),null}return this._onStagedClick(e),t}},{key:"onPointerMove",value:function(e){var t=e.mapPoint,n=e.pointerType;if("touch"!==n){var i=this._getSnappingContext(n);this.updatingHandles.addPromise((0,st.R8)(this._snappingOperation.snap({point:t},this._snappingManager,i)))}}},{key:"onManipulatorSelectionChanged",value:function(){(0,v.pC)(this.analysisViewData.selectedComputation)&&(this._computationManipulators.get(this.analysisViewData.selectedComputation).offset.selected||(this.analysisViewData.selectedDimension=null))}},{key:"_onUnstagedClick",value:function(e){var t=e.mapPoint,n=e.pointerType,i=t;if("mouse"===n){var a=this._getSnappingContext(n);i=this._snappingManager.update({point:t,context:a})}var r=new nt.Z({startPoint:(0,A.WG)(i,new Te.Z),endPoint:null,measureType:S.n.Horizontal});return this._stagedDimension=r,this._resetSnappingState(),r}},{key:"_onStagedClick",value:function(e){var t=e.mapPoint,n=e.pointerType,i=this._stagedComputation;if(!(0,v.Wi)(i)){var a=t;if("mouse"===n){var r=this._getSnappingContext(n);a=this._snappingManager.update({point:t,context:r})}var o=(0,A.WG)(a,new Te.Z);this._applyPointUpdate(i,{endPoint:o}),this._stagedDimension=null,this._resetSnappingState()}}},{key:"_resetSnappingState",value:function(){this._snappingManager.doneSnapping(),this._snappingOperation.abort(),this._snappingOperation.stagedPoint=null}},{key:"_addComputation",value:function(e){if(!this._computationManipulators.has(e)){var t=this._setupPointManipulator(e,{isStart:!0}),n=this._setupPointManipulator(e,{isStart:!1}),i=this._setupOffsetManipulator(e),a=this._setupHeadingManipulator(e),r=this._setupRotationManipulator(e),o=this._setupMeasureTypeManipulator(e,S.n.Direct),s=this._setupMeasureTypeManipulator(e,S.n.Horizontal),l=this._setupMeasureTypeManipulator(e,S.n.Vertical),u=new Re({start:t,end:n,offset:i,heading:a,rotation:r,direct:o,horizontal:s,vertical:l});this._setupComputationToManipulatorsSync(e,u),this._computationManipulators.set(e,u),this.manipulators.addMany(u.values())}}},{key:"_removeComputation",value:function(e){var t=this._computationManipulators.get(e);if(!(0,v.Wi)(t)){this._computationHandles.remove(e),this._computationManipulators.delete(e);var n,i=(0,o.Z)(t.values());try{for(i.s();!(n=i.n()).done;){var a=n.value;this.manipulators.remove(a)}}catch(r){i.e(r)}finally{i.f()}}}},{key:"_setupComputationToManipulatorsSync",value:function(e,t){var n=this;this._computationHandles.add([(0,m.YP)((function(){return e.geometry}),(function(){return n._updateManipulators(e,t)}),(0,ie.Z)((0,ie.Z)({},m.tX),{},{equals:at.fS}))],e)}},{key:"_setupPointManipulator",value:function(e,t){var n=this,i=this.view,a=e.dimension,r=function(e,t){var n=(0,we.aD)(e,se.Z.toUnitRGB(Se.pointManipulators.color),Se.pointManipulators.opacity,Qe);return n.available=!1,n.grabCursor="crosshair",n.radius=Se.pointManipulators.radius,n.metadata=t.metadata,n.collisionPriority=1,n}(i,{metadata:a}),o=function(e,t){var n=t.isStart,i=t.createSnappingPipelineStep,a=t.dimension,r=t.onUpdate,o=t.view,s=n?"startPoint":"endPoint",l=(0,xe.Xd)(e,(function(e,t,n,l){var u,c=(0,Me.J4)(e),d=i(l),p=d.snappingStep,f=d.cancelSnapping;n=n.next(c).next((0,xe.di)(a,[s,"measureType","orientation"])).next(f),(u=t.next(c).next((0,Me.gv)(o))).next.apply(u,(0,oe.Z)(p)).next((function(e){var t=(0,A.WG)(e.mapEnd,new Te.Z);r("startPoint"===s?{startPoint:t}:{endPoint:t})}))}));return[l]}(r,{isStart:t.isStart,createSnappingPipelineStep:function(e){return(0,Tt.W)({snappingContext:n._getSnappingContext(e),snappingManager:n._snappingManager,updatingHandles:n.updatingHandles})},dimension:a,onUpdate:function(t){return n._applyPointUpdate(e,t)},view:i});return this._computationHandles.add(o,e),r}},{key:"_setupOffsetManipulator",value:function(e){var t=this.view,n=function(e,t){var n=[(0,R.f)(-.5,0,0),(0,R.f)(.5,0,0)],i=Se.offsetManipulator.lengthFraction,a=(0,ke.rh)(t.unfocusedMaterial,n.map((function(e){return(0,T.g)((0,R.c)(),e,i)}))),r=a.instantiate({material:t.focusedMaterial});return new Ce.Z((0,ie.Z)({view:e,renderObjects:[new be.r(a,Ze.Q9.Unfocused|Ze.Q9.Selected|Qe),new be.r(r,Ze.Q9.Focused|Qe)],collisionType:{type:"line",paths:[n]},radius:Je(t.lineSizePt)/2,metadata:t.metadata,available:!1},we.X9))}(t,{lineSizePt:this.analysis.style.lineSize,unfocusedMaterial:this._unfocusedOffsetManipulatorMaterial,focusedMaterial:this._focusedOffsetManipulatorMaterial,metadata:e.dimension}),i=function(e,t){var n=t.computation,i=t.view;return[(0,xe.Xd)(e,(function(e,t,a){if(te(n)&&e.selected){var r=n.geometry,o=n.dimension,s=(0,Me.J4)(e);t.next(s).next(Ie(i,o,r.dimensionSegment,r.primaryOffsetAxis)),a.next(s).next((0,xe.di)(o,["offset"]))}}))]}(n,{computation:e,view:t});return this._computationHandles.add(i,e),n}},{key:"_setupHeadingManipulator",value:function(e){var t=this.view,n=Oe(t,{lineSizePt:this.analysis.style.lineSize,material:this._orientationManipulatorMaterial,metadata:e.dimension}),i=function(e,t){var n=t.computation,i=t.view;return[(0,xe.Xd)(e,(function(e,t,a){He({cancel:a,computation:n,settingHeading:!0,steps:t,view:i})}))]}(n,{computation:e,view:t});return this._computationHandles.add(i,e),n}},{key:"_setupRotationManipulator",value:function(e){var t=this.view,n=Oe(t,{lineSizePt:this.analysis.style.lineSize,material:this._orientationManipulatorMaterial,metadata:e.dimension}),i=Ae(n,{computation:e,view:t});return this._computationHandles.add(i,e),n}},{key:"_setupMeasureTypeManipulator",value:function(e,t){var n=this.view,i=function(e,t){var n=[(0,R.f)(-.5,0,0),(0,R.f)(.5,0,0)],i=Se.offsetManipulator.lengthFraction,a=(0,ke.rh)(t.thinOffsetManipulatorMaterial,n),r=(0,ke.rh)(t.unfocusedMaterial,n.map((function(e){return(0,T.g)((0,R.c)(),e,i)}))),o=r.instantiate({material:t.focusedMaterial});return new Ce.Z((0,ie.Z)({view:e,renderObjects:[new be.r(r,Ze.Q9.Unfocused|Qe),new be.r(o,Ze.Q9.Focused|Qe),new be.r(a,Qe)],collisionType:{type:"line",paths:[n]},radius:Je(t.lineSizePt)/2,available:!1,metadata:t.metadata},we.X9))}(n,{lineSizePt:this.analysis.style.lineSize,unfocusedMaterial:this._unfocusedOffsetManipulatorMaterial,focusedMaterial:this._focusedOffsetManipulatorMaterial,thinOffsetManipulatorMaterial:this._thinOffsetManipulatorMaterial,metadata:e.dimension}),a=We(i,{computation:e,manipulatorMeasureType:t,view:n});return this._computationHandles.add(a,e),i}},{key:"_updateManipulators",value:function(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{stagedDimension:this._stagedDimension,selectedComputation:this.analysisViewData.selectedComputation,firstGrabbedManipulator:this.firstGrabbedManipulator},a=i.stagedDimension,r=i.selectedComputation,s=i.firstGrabbedManipulator,l=t.start,u=t.end,c=t.offset,d=t.heading,p=t.rotation,f=r===e,h=te(e),m=e.dimension,y=(0,o.Z)(t.values());try{for(y.s();!(n=y.n()).done;){var _=n.value,g=h&&(0,v.Wi)(a)&&((0,v.Wi)(s)||_===s);_===c?(_.available=g,_.selected=f):_.available=g&&f}}catch(k){y.e(k)}finally{y.f()}if(h){(0,v.pC)(this._computeConstraint(e))?t.forEachMeasureTypeManipulator((function(e){return e.available=!1})):t.manipulatorForMeasureType(m.measureType).available=!1;for(var C=0,w=[d,p];C<w.length;C++){var b=w[C];m.measureType===S.n.Direct&&0!==m.offset||(b.available=!1)}U(e)?p.available=!1:d.available=!1;var M=e.geometry;l.renderLocation=M.directSegment.startRenderSpace,u.renderLocation=M.directSegment.endRenderSpace;var P=this.view.renderCoordsHelper;Le(c,M,P),d.available&&Ee(d,e,P),p.available&&je(p,e,P),t.forEachMeasureTypeManipulator((function(t,n){t.available&&Xe(t,e,n,P)}))}}},{key:"_updateManipulatorStyle",value:function(e){var t,n=function(e){return(0,ue.F2)(e)+Se.offsetManipulator.linePaddingPx}(e),i=Je(e),a={lineSizePt:e,material:this._orientationManipulatorMaterial},r=(0,o.Z)(this._computationManipulators.values());try{for(r.s();!(t=r.n()).done;){var s=t.value,l=s.offset,u=s.heading,c=s.rotation;l.radius=i/2,ze(u,a),ze(c,a)}}catch(d){r.e(d)}finally{r.f()}this._unfocusedOffsetManipulatorMaterial.setParameters({width:n}),this._focusedOffsetManipulatorMaterial.setParameters({width:i})}},{key:"_applyPointUpdate",value:function(e,t){var n=this.view,i=I(e);"startPoint"in t&&(i.elevationAlignedStartPoint=t.startPoint),"endPoint"in t&&(i.elevationAlignedEndPoint=t.endPoint);var a=V(i,n.renderCoordsHelper);if(!(0,v.Wi)(a)){var r=this._computeConstraint((0,ie.Z)((0,ie.Z)({},i),{},{geometry:a}));lt(e,t,(0,ie.Z)((0,ie.Z)({},i),{},{constraint:r,unconstrainedGeometry:a,view:n})),e===this._stagedComputation&&this._updateStagedDimensionOffset(e)}}},{key:"_updateStagedDimensionOffset",value:function(e){if(!(0,v.Wi)(e.geometry)){e.geometry.directSegment.eval(.5,Ht);var t=this.view.state.camera.computeRenderPixelSizeAt(Ht);e.dimension.offset=Se.initialOffsetPx*t}}},{key:"_computeConstraint",value:function(e){return function(e,t){if(K(e))return ot.Direct;if(!e.enabled)return null;var n=e.geometry;if((0,v.Wi)(n)||(0,T.k)(n.directSegment.startRenderSpace,n.directSegment.endRenderSpace))return null;var i=Se.constraintThresholdPx,a=t.state.camera,r=q(O.WM.get(),n,t.renderCoordsHelper),o=N(O.WM.get(),n),s=(0,T.g)(O.WM.get(),r,(0,T.e)(o,r)),l=(0,T.b)(O.WM.get(),o,s),u=(0,T.p)(l),c=(0,T.p)(s),d=n.directSegment,p=d.startRenderSpace,f=d.endRenderSpace,h=Math.pow(Math.max(a.computeRenderPixelSizeAt(p)*i,a.computeRenderPixelSizeAt(f)*i),2);return u<h?ot.Vertical:c<h?ot.Horizontal:null}(function(e,t){return{enabled:t.effectiveFeatureEnabled,elevationAlignedStartPoint:e.elevationAlignedStartPoint,elevationAlignedEndPoint:e.elevationAlignedEndPoint,geometry:e.geometry}}(e,this._snappingManager.options),this.view)}},{key:"testInfo",get:function(){var e=this,t=function(t){return e.analysisViewData.computations.find((function(e){return e.dimension===t}))};return{disableManipulatorPartialOcclusion:function(){e._stagedStartIndicator.renderOccluded=ft.yD.Occlude,e.manipulators.forEach((function(e){var t,n=e.manipulator,i=(0,o.Z)(n.renderObjects);try{for(i.s();!(t=i.n()).done;){t.value.geometry.material.setParameters({renderOccluded:ft.yD.Occlude})}}catch(a){i.e(a)}finally{i.f()}}))},getManipulatorsForDimension:function(n){return e._computationManipulators.get(t(n))},getComputationForDimension:function(e){return t(e)},getConstraintForDimension:function(n){var i=t(n);return(0,v.pC)(i)?e._computeConstraint(i):null},stagedDimension:this._stagedDimension,stagedStartIndicator:this._stagedStartIndicator,constraintSnappingIndicator:this._constraintSnappingIndicator,snappingManager:this._snappingManager}}}]),n}(it.r);function zt(){var e=Se.offsetManipulator,t=e.color,n=e.opacity;return new mt.U({color:[].concat((0,oe.Z)(se.Z.toUnitRGB(t)),[n]),width:1,renderOccluded:ft.yD.OccludeAndTransparent,writeDepth:!1,hasPolygonOffset:!0})}(0,d._)([(0,y.Cb)({constructOnly:!0})],Ot.prototype,"analysis",void 0),(0,d._)([(0,y.Cb)({constructOnly:!0})],Ot.prototype,"analysisViewData",void 0),(0,d._)([(0,y.Cb)({constructOnly:!0})],Ot.prototype,"manipulators",void 0),(0,d._)([(0,y.Cb)({constructOnly:!0})],Ot.prototype,"parentTool",void 0),(0,d._)([(0,y.Cb)({constructOnly:!0,nonNullable:!0})],Ot.prototype,"view",void 0),(0,d._)([(0,y.Cb)({readOnly:!0})],Ot.prototype,"updating",null),(0,d._)([(0,y.Cb)()],Ot.prototype,"firstGrabbedManipulator",null),(0,d._)([(0,y.Cb)()],Ot.prototype,"hasGrabbedManipulators",null),(0,d._)([(0,y.Cb)()],Ot.prototype,"snappingOptions",null),(0,d._)([(0,y.Cb)()],Ot.prototype,"_stagedDimension",void 0),(0,d._)([(0,y.Cb)()],Ot.prototype,"_activeComputation",null),(0,d._)([(0,y.Cb)()],Ot.prototype,"_stagedComputation",null),Ot=(0,d._)([(0,_.j)("esri.views.3d.analysis.Dimension.LengthDimensionSubTool")],Ot);var At,Ht=(0,R.c)(),Wt=n(88153),It=n(54463),Vt=n(86509),Lt=n(87888),Et=n(72612);!function(e){e.Ready="ready",e.Creating="creating",e.Created="created"}(At||(At={}));var jt=function(e){(0,u.Z)(n,e);var t=(0,c.Z)(n);function n(e){var i;return(0,s.Z)(this,n),(i=t.call(this,e)).automaticManipulatorSelection=!1,i.removeIncompleteOnCancel=!1,i._pointerMoveTimerMs=Se.pointerMoveTimeoutMs,i._prevPointerMoveTimeout=null,i}return(0,l.Z)(n,[{key:"initialize",value:function(){var e=this;this._intersector=(0,Wt.Z8)(this.view.state.viewingMode),this._intersector.options.store=It.eC.MIN,this._lengthDimensionSubTool=new Ot({analysis:this.analysis,analysisViewData:this.analysisViewData,manipulators:this.manipulators,parentTool:this,view:this.view}),this.addHandles([(0,re.ed)(this._lengthDimensionSubTool),(0,re.kB)((function(){return e._clearPointerMoveTimeout()})),(0,m.YP)((function(){return e.state}),(function(t){t===At.Created&&e.finishToolCreation()}),m.tX),(0,m.gx)((function(){return e.firstGrabbedManipulator}),(function(t){e.selectedDimension=t.metadata}),m.tX),(0,m.YP)((function(){return e.selectedDimension}),(function(){return e._resetPointerMoveTimeout()}),m.tX)])}},{key:"state",get:function(){return this.analysis.dimensions.some((function(e){return"length"===e.type}))?(0,v.pC)(this._activeSubTool)?At.Creating:At.Created:At.Ready}},{key:"updating",get:function(){return this._lengthDimensionSubTool.updating}},{key:"cursor",get:function(){return this.active?"crosshair":null}},{key:"selectedDimension",get:function(){return this.analysisViewData.selectedDimension},set:function(e){this.analysisViewData.selectedDimension=e}},{key:"onInputEvent",value:function(e){switch(e.type){case"immediate-click":this._clickHandler(e);break;case"immediate-double-click":this._doubleClickHandler(e);break;case"pointer-move":this._pointerMoveHandler(e);break;case"key-down":if(Lt.j.cancel===e.key){if((0,v.pC)(this._activeSubTool)&&this._activeSubTool.removeStaged())return void e.stopPropagation();this.active||(this.selectedDimension=null)}else Lt.j.delete.includes(e.key)&&this._deleteKeyHandler()}}},{key:"onActivate",value:function(){this._activeSubTool=this._lengthDimensionSubTool}},{key:"onDeactivate",value:function(){(0,v.pC)(this._activeSubTool)&&(this._activeSubTool.onDeactivate(),this._activeSubTool=null)}},{key:"onShow",value:function(){this._resetPointerMoveTimeout()}},{key:"onManipulatorSelectionChanged",value:function(){this._lengthDimensionSubTool.onManipulatorSelectionChanged()}},{key:"onHide",value:function(){this.selectedDimension=null}},{key:"_clickHandler",value:function(e){if(this.hasFocusedManipulators)e.stopPropagation();else if(!(0,v.Wi)(this._activeSubTool)){var t=this._intersectScreen(e);(0,v.Wi)(t)||(this.selectedDimension=this._activeSubTool.onClick({mapPoint:t,pointerType:e.pointerType}),e.stopPropagation())}}},{key:"_doubleClickHandler",value:function(e){this.active&&(this.view.activeTool=null,e.stopPropagation())}},{key:"_pointerMoveHandler",value:function(e){if(this._resetPointerMoveTimeout(),!(0,v.Wi)(this._activeSubTool)&&!this.hasFocusedManipulators){var t=this._intersectScreen(e);(0,v.Wi)(t)||this._activeSubTool.onPointerMove({mapPoint:t,pointerType:e.pointerType})}}},{key:"_deleteKeyHandler",value:function(){(0,v.pC)(this._activeSubTool)&&this._activeSubTool.removeStaged(),this._removeSelected()}},{key:"_intersectScreen",value:function(e){var t=(0,Et.Sj)(e);this.view.sceneIntersectionHelper.intersectToolIntersectorScreen(t,this._intersector);var n=this._intersector.results.min,i=O.WM.get();return n.getIntersectionPoint(i)?this.view.renderCoordsHelper.fromRenderCoords(i,this.view.spatialReference):null}},{key:"_removeSelected",value:function(){(0,v.pC)(this.selectedDimension)&&(this.analysis.dimensions.remove(this.selectedDimension),this.selectedDimension=null)}},{key:"_clearPointerMoveTimeout",value:function(){this._prevPointerMoveTimeout=(0,v.hw)(this._prevPointerMoveTimeout)}},{key:"_resetPointerMoveTimeout",value:function(){var e=this;this._clearPointerMoveTimeout(),this.manipulators.forEach((function(e){e.manipulator.state|=Qe})),this._prevPointerMoveTimeout=ae.m.setTimeout((function(){e.manipulators.forEach((function(e){e.manipulator.state&=~Qe}))}),this._pointerMoveTimerMs)}},{key:"testInfo",get:function(){var e=this;return(0,ie.Z)((0,ie.Z)({},this._lengthDimensionSubTool.testInfo),{},{setManipulatorAutoHideDelay:function(t){e._pointerMoveTimerMs=t,e._resetPointerMoveTimeout()}})}}]),n}(Vt.f);(0,d._)([(0,y.Cb)({constructOnly:!0})],jt.prototype,"view",void 0),(0,d._)([(0,y.Cb)({constructOnly:!0})],jt.prototype,"analysis",void 0),(0,d._)([(0,y.Cb)({readOnly:!0})],jt.prototype,"state",null),(0,d._)([(0,y.Cb)({readOnly:!0})],jt.prototype,"updating",null),(0,d._)([(0,y.Cb)({readOnly:!0})],jt.prototype,"cursor",null),(0,d._)([(0,y.Cb)({constructOnly:!0})],jt.prototype,"analysisViewData",void 0),(0,d._)([(0,y.Cb)()],jt.prototype,"selectedDimension",null),(0,d._)([(0,y.Cb)()],jt.prototype,"automaticManipulatorSelection",void 0),(0,d._)([(0,y.Cb)()],jt.prototype,"_activeSubTool",void 0),(0,d._)([(0,y.Cb)()],jt.prototype,"_lengthDimensionSubTool",void 0),jt=(0,d._)([(0,_.j)("esri.views.3d.analysis.Dimension.DimensionTool")],jt);n(59166);var Gt=n(67077),Ft=n(58935),Yt=n(27210),Xt=n(151),Ut=n(52168),Bt=n(79685),qt=n(21317),Nt=function(e){(0,u.Z)(n,e);var t=(0,c.Z)(n);function n(e,i){var a;return(0,s.Z)(this,n),(a=t.call(this,e))._hasExternalMaterial=!1,a._renderOccluded=ft.yD.OccludeAndTransparent,a._width=1,a._color=(0,Xt.f)(1,0,1,1),a._placement="end",a._textureId=null,a._material=i,a._hasExternalMaterial=(0,v.pC)(i),a.applyProps(e),a}return(0,l.Z)(n,[{key:"setGeometryFromSegment",value:function(e,t){var n=e.endRenderSpace;this.transform=(0,x.f)(Jt,n),this._normal=t;var i=e.createRenderGeometry(n,this.view.renderCoordsHelper).points;this.geometry=[i]}},{key:"renderOccluded",get:function(){return(0,v.pC)(this._material)?this._material.parameters.renderOccluded:this._renderOccluded},set:function(e){this._renderOccluded=e,(0,v.pC)(this._material)&&this._material.setParameters({renderOccluded:e})}},{key:"geometry",get:function(){return this._geometry},set:function(e){this._geometry=e,this.recreateGeometry()}},{key:"normal",get:function(){return this._normal},set:function(e){this._normal=e,this.recreateGeometry()}},{key:"width",get:function(){return(0,v.pC)(this._material)?this._material.parameters.width:this._width},set:function(e){this._width=e,(0,v.pC)(this._material)&&this._material.setParameters({width:e})}},{key:"color",get:function(){return(0,v.pC)(this._material)?this._material.parameters.color:this._color},set:function(e){this._color=(0,Xt.c)(e),(0,v.pC)(this._material)&&this._material.setParameters({color:this._color})}},{key:"placement",get:function(){return(0,v.pC)(this._material)?this._material.parameters.placement:this._placement},set:function(e){this._placement=e,(0,v.pC)(this._material)&&this._material.setParameters({placement:this._placement})}},{key:"textureId",get:function(){return(0,v.pC)(this._material)?this._material.parameters.textureId:this._textureId},set:function(e){this._textureId=e,(0,v.pC)(this._material)&&this._material.setParameters({textureId:e})}},{key:"createExternalResources",value:function(){this._hasExternalMaterial||(this._material=new qt.X({width:this._width,color:this._color,placement:this._placement,renderOccluded:this._renderOccluded,textureId:this._textureId}))}},{key:"destroyExternalResources",value:function(){this._hasExternalMaterial||(this._material=null)}},{key:"createGeometries",value:function(e){var t,n=(0,o.Z)((0,Bt.c)(this.geometry,this.normal));try{for(n.s();!(t=n.n()).done;){var i=t.value,a=(0,Bt.Y)((0,v.Wg)(this._material),i);e.addGeometry(a)}}catch(r){n.e(r)}finally{n.f()}}},{key:"forEachExternalMaterial",value:function(e){this._hasExternalMaterial||e((0,v.Wg)(this._material))}}]),n}(Ut._),Jt=(0,Z.c)(),Qt=function(){function e(t){var n=this;(0,s.Z)(this,e),this.destroyed=!1,this._handles=new C.Z,this._messages=null,this._labelSegment=new H.y;var i=t.analysis,a=t.computation,r=t.view,o=t.messages;this.analysis=i,this.computation=a,this.view=r,this._messages=o;var l=t.visible,u={view:r,attached:l},c=i.style,d=c.fontSize,p=c.textColor,f=c.textBackgroundColor;this._visualElements=new tn({marker:new Nt(u,t.markerMaterial),dimension:new dt.r(u,t.dimensionLineMaterial),startOffset:new dt.r(u,t.offsetLineMaterial),endOffset:new dt.r(u,t.offsetLineMaterial),dimensionSmall:new dt.r(u,t.smallDimensionLineMaterial),startOffsetSmall:new dt.r(u,t.smallOffsetLineMaterial),endOffsetSmall:new dt.r(u,t.smallOffsetLineMaterial),label:new Yt.Kc({view:r,attached:l,distance:0,geometry:{type:"segment",sampleLocation:"center",segment:this._labelSegment,callout:!1},fontSize:(0,ue.F2)(d),textColor:p.clone(),backgroundColor:f.clone()})}),this._handles.add([(0,m.YP)((function(){return a.geometry}),(function(e){n.updateCameraDependentElements(r.state.camera,e,i.style),(0,v.pC)(a.geometry)&&n._updateLines(a.geometry)}),(0,ie.Z)((0,ie.Z)({},m.nn),{},{equals:at.fS})),(0,m.YP)((function(){return a.length}),(function(e){return n._updateLabelContent(e)}),m.nn)])}return(0,l.Z)(e,[{key:"visible",set:function(e){var t,n=(0,o.Z)(this._visualElements.values());try{for(n.s();!(t=n.n()).done;){t.value.attached=e}}catch(i){n.e(i)}finally{n.f()}}},{key:"destroy",value:function(){this.destroyed=!0,this._handles=(0,v.SC)(this._handles);var e,t=(0,o.Z)(this._visualElements.values());try{for(t.s();!(e=t.n()).done;){e.value.destroy()}}catch(n){t.e(n)}finally{t.f()}}},{key:"testInfo",get:function(){return{dimensionVisualElement:this._visualElements.dimension,label:this._visualElements.label}}},{key:"_updateLines",value:function(e){var t=L($t,i.Start,e.directSegment,e.dimensionSegment),n=L(Kt,i.End,e.directSegment,e.dimensionSegment),a=this._visualElements;a.marker.setGeometryFromSegment(e.dimensionSegment,e.primaryOffsetAxis),a.dimension.setGeometryFromSegment(e.dimensionSegment),a.startOffset.setGeometryFromSegment(t),a.endOffset.setGeometryFromSegment(n),a.dimensionSmall.setGeometryFromSegment(e.dimensionSegment),a.startOffsetSmall.setGeometryFromSegment(t),a.endOffsetSmall.setGeometryFromSegment(n)}},{key:"updateCameraDependentElements",value:function(e,t,n){var i=this._visualElements;if((0,v.Wi)(t)){var a,r=(0,o.Z)(i.values());try{for(r.s();!(a=r.n()).done;){a.value.visible=!1}}catch(_){r.e(_)}finally{r.f()}}else{var s=e.computeScreenPixelSizeAt(t.dimensionSegment.eval(.5,en)),l=function(e,t){return(0,T.p)(J($,e))/Math.pow(t,2)}(t,s),u=l<Math.pow((0,ue.F2)(n.lineSize)*Se.smallScreenLengthLineSizeFactor,2),c=!u;i.marker.visible=c,i.dimension.visible=c,i.startOffset.visible=c,i.endOffset.visible=c,i.dimensionSmall.visible=u,i.startOffsetSmall.visible=u,i.endOffsetSmall.visible=u;var d=(0,ue.F2)(n.fontSize)*Se.labels.minScreenLengthFontSizeFactor,p=i.label;if(p.visible=l>=Math.pow(d,2),p.visible){var f=t.dimensionSegment,h=t.primaryOffsetAxis,m=this.computation.dimension.offset,y=(Math.sign(m)>=0?1:-1)*function(e){return 1.5*(0,ue.F2)(e.fontSize)+Se.labels.marginPx+(0,ue.F2)(e.lineSize/2)}(n)*s;(function(e,t,n,i){(0,T.z)(e.startRenderSpace,t.startRenderSpace,n,i),(0,T.z)(e.endRenderSpace,t.endRenderSpace,n,i)})(this._labelSegment,f,h,y),p.updateLabelPosition()}}}},{key:"updateLabelStyle",value:function(e){var t=this._visualElements.label;t.fontSize=(0,ue.F2)(e.fontSize),t.textColor=e.textColor,t.backgroundColor=e.textBackgroundColor}},{key:"updateUnitsMessages",value:function(e){this._messages=e;var t=this.computation.length;this._updateLabelContent(t)}},{key:"_updateLabelContent",value:function(e){var t=this._visualElements.label;(0,v.Wi)(e)||(0,v.Wi)(this._messages)?t.text="":t.text=(0,Ft.VG)(this._messages,e,e.unit)}}]),e}();var $t=new H.y,Kt=new H.y,en=(0,R.c)(),tn=function(){function e(t){(0,s.Z)(this,e),this.marker=t.marker,this.dimension=t.dimension,this.startOffset=t.startOffset,this.endOffset=t.endOffset,this.dimensionSmall=t.dimensionSmall,this.startOffsetSmall=t.startOffsetSmall,this.endOffsetSmall=t.endOffsetSmall,this.label=t.label}return(0,l.Z)(e,[{key:"values",value:function(){return[this.marker,this.dimension,this.startOffset,this.endOffset,this.dimensionSmall,this.startOffsetSmall,this.endOffsetSmall,this.label]}}]),e}(),nn=n(89261),an=function(){function e(t,n){(0,s.Z)(this,e),this._textures=t,this._textureRepository=n,this._texturesByPrimitive=new Map}return(0,l.Z)(e,[{key:"acquire",value:function(e){if(!this._texturesByPrimitive.has(e)){var t=(0,Pe.uM)(this._textures,e),n=new nn.T(this._textureRepository,t.texture.id);return this._texturesByPrimitive.set(e,{result:t,reference:n}),t.texture}return this._texturesByPrimitive.get(e).result.texture}},{key:"destroy",value:function(){this._texturesByPrimitive.forEach((function(e){var t=e.result;e.reference.dispose(),t.release()})),this._texturesByPrimitive.clear()}}]),e}(),rn=n(33720),on=n(36257),sn=n(41201),ln=function(e){(0,u.Z)(n,e);var t=(0,c.Z)(n);function n(e){var i;return(0,s.Z)(this,n),(i=t.call(this,e)).loadingMessages=!1,i._messages=null,i._dimensionVisualizations=new Map,i._markerMaterial=new qt.X({width:1,anchor:rn.i5.Tip,color:Gt.Z,placement:"begin-end",worldSpace:!0,hideOnShortSegments:!0,hasTip:!0,renderOccluded:ft.yD.OccludeAndTransparent}),i._dimensionLineMaterial=new mt.U({width:1,color:Gt.Z,renderOccluded:ft.yD.OccludeAndTransparent,markerParameters:i._markerMaterial.parameters}),i._offsetLineMaterial=new mt.U({width:1,color:Gt.Z,renderOccluded:ft.yD.OccludeAndTransparent,stipplePattern:(0,vt.z5)(5),stippleScaleWithLineWidth:!0}),i._smallDimensionLineMaterial=new mt.U({width:1,color:Gt.Z,renderOccluded:ft.yD.OccludeAndTransparent}),i._smallOffsetLineMaterial=new mt.U({width:1,color:Gt.Z,renderOccluded:ft.yD.OccludeAndTransparent,stipplePattern:(0,vt.z5)(5),stippleScaleWithLineWidth:!0}),i}return(0,l.Z)(n,[{key:"analysis",get:function(){return this.analysisViewData.analysis}},{key:"visible",get:function(){return this.analysisViewData.visible}},{key:"initialize",value:function(){var e,t=this,n=null===(e=this.view.sharedSymbolResources)||void 0===e?void 0:e.textures;if((0,v.pC)(n)){var i=this.view._stage.renderView.textureRepository,a=new an(n,i),r=a.acquire("triangle");this.addHandles((0,re.kB)((function(){return a.destroy()}))),this._markerMaterial.setParameters({textureId:r.id})}var s,l=(0,o.Z)(this._lineMaterials());try{var u=function(){var e=s.value;t.view._stage.add(e),t.addHandles((0,re.kB)((function(){t.view._stage.remove(e),e.dispose()})))};for(l.s();!(s=l.n()).done;)u()}catch(h){l.e(h)}finally{l.f()}var c,d=this.analysisViewData.computations,p=(0,o.Z)(d);try{for(p.s();!(c=p.n()).done;){var f=c.value;this._addComputation(f)}}catch(h){p.e(h)}finally{p.f()}this.addHandles([d.on("change",(function(e){var n,i=e.added,a=e.removed,r=(0,o.Z)(a);try{for(r.s();!(n=r.n()).done;){var s=n.value;t._removeComputation(s)}}catch(h){r.e(h)}finally{r.f()}var l,u=(0,o.Z)(i);try{for(u.s();!(l=u.n()).done;){var c=l.value;t._addComputation(c)}}catch(h){u.e(h)}finally{u.f()}})),(0,m.YP)((function(){return se.Z.toUnitRGBA(t.analysis.style.color)}),(function(e){var n,i=(0,o.Z)(t._lineMaterials());try{for(i.s();!(n=i.n()).done;){n.value.setParameters({color:e})}}catch(h){i.e(h)}finally{i.f()}}),m.tX),(0,m.YP)((function(){return t.analysis.style.lineSize}),(function(e){var n=(0,ue.F2)(e);t._markerMaterial.setParameters({width:n*Se.markers.lineSizeFraction}),t._dimensionLineMaterial.setParameters({width:n,markerParameters:t._markerMaterial.parameters});var i=Math.max(n*Se.offsetLine.lineSizeFraction,1);t._offsetLineMaterial.setParameters({width:i})}),m.tX),(0,m.YP)((function(){return{camera:t.view.state.camera,style:un(t.analysis)}}),(function(e){var n,i=e.camera,a=e.style,r=(0,o.Z)(t._dimensionVisualizations);try{for(r.s();!(n=r.n()).done;){var s=(0,M.Z)(n.value,2),l=s[0],u=s[1];u.updateCameraDependentElements(i,l.geometry,a),u.updateLabelStyle(a)}}catch(h){r.e(h)}finally{r.f()}})),(0,m.YP)((function(){return t.visible}),(function(e){var n,i=(0,o.Z)(t._dimensionVisualizations.values());try{for(i.s();!(n=i.n()).done;){n.value.visible=e}}catch(h){i.e(h)}finally{i.f()}}))]),this.addHandles([(0,on.qe)((function(){return t._updateMessageBundle()})),(0,m.gx)((function(){return!t.loadingMessages}),(function(){var e,n=(0,o.Z)(t._dimensionVisualizations.values());try{for(n.s();!(e=n.n()).done;){e.value.updateUnitsMessages(t._messages)}}catch(h){n.e(h)}finally{n.f()}}),m.Z_)]),this._updateMessageBundle()}},{key:"destroy",value:function(){this._dimensionVisualizations.forEach((function(e){e.destroy()})),this._dimensionVisualizations.clear()}},{key:"testInfo",get:function(){var e=this;return{visualizations:Array.from(this._dimensionVisualizations.values()),disablePartialOcclusion:function(){var t,n=(0,o.Z)(e._lineMaterials());try{for(n.s();!(t=n.n()).done;){t.value.setParameters({renderOccluded:ft.yD.Occlude})}}catch(i){n.e(i)}finally{n.f()}}}}},{key:"_addComputation",value:function(e){this._dimensionVisualizations.has(e)||this._dimensionVisualizations.set(e,new Qt({analysis:this.analysis,computation:e,view:this.view,visible:this.visible,markerMaterial:this._markerMaterial,dimensionLineMaterial:this._dimensionLineMaterial,offsetLineMaterial:this._offsetLineMaterial,smallDimensionLineMaterial:this._smallDimensionLineMaterial,smallOffsetLineMaterial:this._smallOffsetLineMaterial,messages:this._messages}))}},{key:"_removeComputation",value:function(e){var t=this._dimensionVisualizations.get(e);(0,v.Wi)(t)||(t.destroy(),this._dimensionVisualizations.delete(e))}},{key:"_lineMaterials",value:function(){return[this._markerMaterial,this._dimensionLineMaterial,this._offsetLineMaterial,this._smallDimensionLineMaterial,this._smallOffsetLineMaterial]}},{key:"_updateMessageBundle",value:function(){var e=(0,r.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadingMessages=!0,e.prev=1,e.next=4,(0,sn.ME)("esri/core/t9n/Units");case 4:this._messages=e.sent;case 5:return e.prev=5,this.loadingMessages=!1,e.finish(5);case 8:case"end":return e.stop()}}),e,this,[[1,,5,8]])})));return function(){return e.apply(this,arguments)}}()}]),n}(p.Z);function un(e){var t=e.style,n=t.fontSize,i=t.lineSize,a=t.textColor;return{fontSize:n,lineSize:i,textBackgroundColor:t.textBackgroundColor.clone(),textColor:a.clone()}}(0,d._)([(0,y.Cb)({constructOnly:!0})],ln.prototype,"analysisViewData",void 0),(0,d._)([(0,y.Cb)({constructOnly:!0,nonNullable:!0})],ln.prototype,"view",void 0),(0,d._)([(0,y.Cb)()],ln.prototype,"analysis",null),(0,d._)([(0,y.Cb)()],ln.prototype,"visible",null),(0,d._)([(0,y.Cb)()],ln.prototype,"loadingMessages",void 0),ln=(0,d._)([(0,_.j)("esri.views.3d.analysis.Dimension.DimensionVisualization")],ln);var cn=n(44925),dn=function(e){(0,u.Z)(n,e);var t=(0,c.Z)(n);function n(e){var i;return(0,s.Z)(this,n),(i=t.call(this,e)).dimension=null,i.length=null,i}return(0,l.Z)(n)}(p.Z);(0,d._)([(0,y.Cb)({constructOnly:!0,nonNullable:!0})],dn.prototype,"dimension",void 0),(0,d._)([(0,y.Cb)()],dn.prototype,"length",void 0);var pn=dn=(0,d._)([(0,_.j)("esri.views.3d.analysis.LengthDimensionResult")],dn),fn=["dimension"],hn=function(e){(0,u.Z)(n,e);var t=(0,c.Z)(n);function n(e){var i;return(0,s.Z)(this,n),(i=t.call(this,e)).geometry=null,i.unconstrainedGeometry=null,i.elevationAlignedStartPoint=null,i.elevationAlignedEndPoint=null,i}return(0,l.Z)(n,[{key:"normalizeCtorArgs",value:function(e){var t=e.dimension,n=(0,cn.Z)(e,fn);return(0,ie.Z)({result:new pn({dimension:t})},n)}},{key:"initialize",value:function(){var e=this;this.addHandles([(0,m.YP)((function(){return e.dimension.startPoint}),(function(t){return e.elevationAlignedStartPoint=e.projectAndAlignPoint(t)}),m.tX),(0,m.YP)((function(){return e.dimension.endPoint}),(function(t){return e.elevationAlignedEndPoint=e.projectAndAlignPoint(t)}),m.tX)])}},{key:"dimension",get:function(){return this.result.dimension}},{key:"length",get:function(){return this.result.length}}]),n}(p.Z);(0,d._)([(0,y.Cb)({constructOnly:!0,nonNullable:!0})],hn.prototype,"result",void 0),(0,d._)([(0,y.Cb)({constructOnly:!0,nonNullable:!0})],hn.prototype,"projectAndAlignPoint",void 0),(0,d._)([(0,y.Cb)()],hn.prototype,"dimension",null),(0,d._)([(0,y.Cb)()],hn.prototype,"length",null),(0,d._)([(0,y.Cb)()],hn.prototype,"geometry",void 0),(0,d._)([(0,y.Cb)()],hn.prototype,"unconstrainedGeometry",void 0),(0,d._)([(0,y.Cb)()],hn.prototype,"elevationAlignedStartPoint",void 0),(0,d._)([(0,y.Cb)()],hn.prototype,"elevationAlignedEndPoint",void 0),(0,d._)([(0,y.Cb)()],hn.prototype,"preConstraintProperties",void 0),(0,d._)([(0,y.Cb)()],hn.prototype,"previousConstraint",void 0),hn=(0,d._)([(0,_.j)("esri.views.3d.analysis.LengthDimensionComputation")],hn);var vn=n(33906),mn=n(70209),yn=function(e){(0,u.Z)(n,e);var t=(0,c.Z)(n);function n(e){var i;return(0,s.Z)(this,n),(i=t.call(this,e)).type="dimension-view-3d",i.tool=null,i.computations=new f.Z,i.selectedDimension=null,i._dimensionsToComputations=new Map,i._placementTask=null,i._projectAndAlignPoint=null,i}return(0,l.Z)(n,[{key:"initialize",value:function(){var e=this;this._projectAndAlignPoint=function(t){if((0,v.Wi)(t))return null;var n=e.view,i=n.spatialReference,a=n.elevationProvider,r=(0,vn.G)(t,i,a);return(0,v.Wi)(r)&&(0,vn.e)(e.analysis,t.spatialReference,h.Z.getLogger(e.declaredClass)),r},this.addHandles([(0,mn.Lp)(this,jt),(0,m.on)((function(){return e.analysis.dimensions}),"after-add",(function(t){return e._onDimensionAdd(t.item)}),{onListenerAdd:function(t){var n,i=(0,o.Z)(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;e._onDimensionAdd(a)}}catch(r){i.e(r)}finally{i.f()}},onListenerRemove:function(){e._onDimensionsClear()}}),(0,m.on)((function(){return e.analysis.dimensions}),"after-remove",(function(t){return e._onDimensionRemove(t.item)}))]),this._analysisVisualization=new ln({analysisViewData:this,view:this.view}),this._analysisController=new ne({analysisViewData:this,view:this.view})}},{key:"destroy",value:function(){this._placementTask=(0,v.IM)(this._placementTask),this._analysisVisualization=(0,v.SC)(this._analysisVisualization),(0,mn.Yq)(this)}},{key:"updating",get:function(){var e,t;return null!==(e=null===(t=this._analysisVisualization)||void 0===t?void 0:t.loadingMessages)&&void 0!==e&&e}},{key:"results",get:function(){var e=this;return this.analysis.dimensions.map((function(t){return e._dimensionsToComputations.get(t).result}))}},{key:"selectedComputation",get:function(){var e=this.selectedDimension;return(0,v.Wi)(e)?null:this._dimensionsToComputations.get(e)}},{key:"testInfo",get:function(){return{visualization:this._analysisVisualization,controller:this._analysisController}}},{key:"createLengthDimensions",value:function(){var e=(0,r.Z)((0,a.Z)().mark((function e(t){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.selectedDimension=null,this._placementTask=(0,v.IM)(this._placementTask),this._placementTask=(0,mn.Er)(this,t),this._placementTask.promise));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_onDimensionAdd",value:function(e){var t=this.computations,n=this._dimensionsToComputations;if(!n.has(e)){var i=new hn({dimension:e,projectAndAlignPoint:this._projectAndAlignPoint});t.add(i),n.set(e,i)}}},{key:"_onDimensionRemove",value:function(e){var t=this.computations,n=this._dimensionsToComputations,i=t.findIndex((function(t){return t.dimension===e})),a=t.getItemAt(i);a.dimension===this.selectedDimension&&(this.selectedDimension=null),t.removeAt(i),n.delete(e),(0,v.SC)(a)}},{key:"_onDimensionsClear",value:function(){this.computations.drain((function(e){return e.destroy()})),this._dimensionsToComputations.clear()}}]),n}(function(e){var t=function(e){(0,u.Z)(n,e);var t=(0,c.Z)(n);function n(){var e;(0,s.Z)(this,n);for(var i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).analysis=null,e.tool=null,e.selectedDimension=null,e.interactive=!1,e.visible=null,e}return(0,l.Z)(n,[{key:"results",get:function(){return new f.Z}},{key:"createLengthDimensions",value:function(e){throw new Error("Method not implemented.")}}]),n}(e);return(0,d._)([(0,y.Cb)({constructOnly:!0})],t.prototype,"view",void 0),(0,d._)([(0,y.Cb)({constructOnly:!0,nonNullable:!0})],t.prototype,"analysis",void 0),(0,d._)([(0,y.Cb)()],t.prototype,"tool",void 0),(0,d._)([(0,y.Cb)({readOnly:!0})],t.prototype,"results",null),(0,d._)([(0,y.Cb)()],t.prototype,"selectedDimension",void 0),(0,d._)([(0,y.Cb)()],t.prototype,"interactive",void 0),(0,d._)([(0,y.Cb)()],t.prototype,"visible",void 0),t=(0,d._)([(0,_.j)("esri.views.analysis.DimensionAnalysisView")],t)}((0,g.p)(p.Z)));(0,d._)([(0,y.Cb)({readOnly:!0})],yn.prototype,"type",void 0),(0,d._)([(0,y.Cb)()],yn.prototype,"tool",void 0),(0,d._)([(0,y.Cb)()],yn.prototype,"updating",null),(0,d._)([(0,y.Cb)({readOnly:!0})],yn.prototype,"results",null),(0,d._)([(0,y.Cb)({readOnly:!0})],yn.prototype,"computations",void 0),(0,d._)([(0,y.Cb)()],yn.prototype,"selectedDimension",void 0),(0,d._)([(0,y.Cb)()],yn.prototype,"selectedComputation",null),(0,d._)([(0,y.Cb)()],yn.prototype,"_analysisVisualization",void 0),(0,d._)([(0,y.Cb)()],yn.prototype,"_analysisController",void 0),(0,d._)([(0,y.Cb)()],yn.prototype,"_dimensionsToComputations",void 0),(0,d._)([(0,y.Cb)()],yn.prototype,"_placementTask",void 0);var _n=yn=(0,d._)([(0,_.j)("esri.views.3d.analysis.DimensionAnalysisView3D")],yn)},27210:function(e,t,n){n.d(t,{Kc:function(){return k},jB:function(){return Z}});var i=n(15671),a=n(43144),r=n(60136),o=n(92572),s=n(51995),l=n(100),u=n(92026),c=n(94172),d=n(17842),p=n(88396),f=n(11186),h=n(71353),v=n(86244),m=n(11208),y=n(27366),_=n(85015),g=n(49861),S=(n(25243),n(63780),n(69912)),C=(n(42877),n(11422)),w=(n(88367),function(e){(0,r.Z)(n,e);var t=(0,o.Z)(n);function n(e){var a;return(0,i.Z)(this,n),(a=t.call(this,e)).startX=0,a.startY=0,a.endX=0,a.endY=0,a.width=1,a.color=[0,0,0,.5],a.visible=!0,a}return(0,a.Z)(n,[{key:"startPosition",get:function(){return[this.startX,this.startY]},set:function(e){this._set("startX",e[0]),this._set("startY",e[1])}},{key:"endPosition",get:function(){return[this.endX,this.endY]},set:function(e){this._set("endX",e[0]),this._set("endY",e[1])}},{key:"_strokeStyle",get:function(){var e=this.color;return"rgba(".concat(e[0],", ").concat(e[1],", ").concat(e[2],", ").concat(e[3],")")}},{key:"_lineCap",get:function(){return"round"}},{key:"render",value:function(){var e=this._calculateCoordinates(b),t=e.height,n=e.left,i=e.top,a=e.width,r=e.x1,o=e.x2,s=e.y1,l=e.y2,u="stroke: ".concat(this._strokeStyle,"; stroke-width: ").concat(this.width,"; stroke-linecap: ").concat(this._lineCap,";");return(0,C.h)("div",{classes:{"esri-line-overlay-item":!0},styles:{left:n+"px",top:i+"px",width:a+"px",height:t+"px",visibility:this.visible?"visible":"hidden"}},[(0,C.h)("svg",{width:a,height:t},[(0,C.h)("line",{x1:r,y1:s,x2:o,y2:l,style:u})])])}},{key:"renderCanvas",value:function(e){if(this.visible){e.strokeStyle=this._strokeStyle,e.lineWidth=this.width,e.lineCap=this._lineCap;var t=this._calculateCoordinates(b);e.beginPath(),e.moveTo(t.left+t.x1,t.top+t.y1),e.lineTo(t.left+t.x2,t.top+t.y2),e.stroke()}}},{key:"_calculateCoordinates",value:function(e){var t=Math.min(this.startX,this.endX),n=Math.max(this.startX,this.endX),i=Math.min(this.startY,this.endY),a=Math.max(this.startY,this.endY),r=this.width;return e.left=t-r,e.top=i-r,e.width=n-t+2*r,e.height=Math.max(20,a-i+2*r),e.x1=this.startX-t+r,e.y1=this.startY-i+r,e.x2=this.endX-t+r,e.y2=this.endY-i+r,e}}]),n}(_.Z));(0,y._)([(0,g.Cb)()],w.prototype,"startX",void 0),(0,y._)([(0,g.Cb)()],w.prototype,"startY",void 0),(0,y._)([(0,g.Cb)()],w.prototype,"endX",void 0),(0,y._)([(0,g.Cb)()],w.prototype,"endY",void 0),(0,y._)([(0,g.Cb)()],w.prototype,"startPosition",null),(0,y._)([(0,g.Cb)()],w.prototype,"endPosition",null),(0,y._)([(0,g.Cb)()],w.prototype,"width",void 0),(0,y._)([(0,g.Cb)()],w.prototype,"color",void 0),(0,y._)([(0,g.Cb)()],w.prototype,"visible",void 0),(0,y._)([(0,g.Cb)({readOnly:!0})],w.prototype,"_strokeStyle",null),w=(0,y._)([(0,S.j)("esri.views.overlay.LineOverlayItem")],w);var b={left:0,top:0,width:0,height:0,x1:0,y1:0,x2:0,y2:0},M=w,P=n(36444),k=function(e){(0,r.Z)(n,e);var t=(0,o.Z)(n);function n(e){var a;return(0,i.Z)(this,n),(a=t.call(this,e.view))._handles=new l.Z,a._textItem=null,a._calloutItem=null,a._showCallout=!0,a._showText=!0,a._geometry=null,a._text="-",a._fontSize=14,a._backgroundColor=new s.Z([0,0,0,.6]),a._textColor=new s.Z([255,255,255]),a._distance=25,a._anchor="right",a.updatePositionOnCameraMove=!0,a.applyProps(e),a}return(0,a.Z)(n,[{key:"geometry",get:function(){return this._geometry},set:function(e){this._geometry=e,this.updateLabelPosition()}},{key:"textItem",get:function(){return this._textItem}},{key:"text",get:function(){return this._text},set:function(e){this._text=e,this.attached&&(this._textItem.text=this._text)}},{key:"fontSize",get:function(){return this._fontSize},set:function(e){this._fontSize=e,this.attached&&(this._textItem.fontSize=this._fontSize)}},{key:"backgroundColor",get:function(){return this._backgroundColor},set:function(e){this._backgroundColor=e,this.attached&&(this._textItem.backgroundColor=this._backgroundColor)}},{key:"textColor",get:function(){return this._textColor},set:function(e){this._textColor=e,this.attached&&(this._textItem.textColor=this._textColor)}},{key:"distance",get:function(){return this._distance},set:function(e){this._distance!==e&&(this._distance=e,this.updateLabelPosition())}},{key:"anchor",get:function(){return this._anchor},set:function(e){this._anchor!==e&&(this._anchor=e,this.updateLabelPosition())}},{key:"overlaps",value:function(e){var t;return!!this.attached&&this.textItem.visible&&e.textItem.visible&&!(null===(t=this.view.overlay)||void 0===t||!t.overlaps(this._textItem,e.textItem))}},{key:"updateLabelPosition",value:function(){if(this.attached){this._showText=!1,this._showCallout=!1;var e=this.geometry,t=this.view,n=this.visible;if((0,u.pC)(e)&&t._stage)switch(e.type){case"point":if(!this._computeLabelPositionFromPoint(e.point,I))break;if(e.callout){var i=t.state.camera,a=e.callout.distance;(0,p.j)(W,W,[0,e.callout.offset]),i.renderToScreen(W,I),(0,p.s)(A,0,1),(0,p.b)(A,A,a*i.pixelRatio),(0,p.j)(A,A,W),i.renderToScreen(A,V),this._showCallout=this._updatePosition(I,V)}else this._textItem.position=[I[0],I[1]],this._textItem.anchor="center";this._showText=!0;break;case"corner":if(!this._computeLabelPositionFromCorner(e,this._distance,I,V))break;this._showCallout=this._updatePosition(I,V),this._showText=!0;break;case"segment":if(!this._computeLabelPositionFromSegment(e,this._distance,this._anchor,I,V))break;this._showText=!0;var r=this._updatePosition(I,V);this._showCallout=!1!==e.callout&&r,this._showCallout||(this._textItem.anchor="center")}this.updateVisibility(n)}}},{key:"_computeLabelPositionFromPoint",value:function(e,t){var n=this.view.state.camera;return n.projectToRenderScreen(e,W),!(W[2]<0||W[2]>1)&&(n.renderToScreen(W,t),!0)}},{key:"_computeLabelPositionFromCorner",value:function(e,t,n,i){if(!e)return!1;var a=this.view.state.camera;return x(e.left,1,a,O),(0,p.n)(O,O),x(e.right,0,a,z),(0,p.j)(A,O,z),(0,p.n)(A,A),(0,p.f)(A,A),a.projectToRenderScreen(e.left.endRenderSpace,W),!(W[2]<0||W[2]>1)&&(a.renderToScreen(W,n),(0,p.b)(A,A,t*a.pixelRatio),(0,p.j)(A,A,W),a.renderToScreen(A,i),!0)}},{key:"_computeLabelPositionFromSegment",value:function(e,t,n,i,a){if(!e)return!1;var r=e.segment,o=this.view.state.camera;(0,m.CM)(r.startRenderSpace,r.endRenderSpace,o,O),(0,p.s)(A,-O[1],O[0]);var s=!1;switch(n){case"top":s=A[1]<0;break;case"bottom":s=A[1]>0;break;case"left":s=A[0]>0;break;case"right":s=A[0]<0}if(s&&(0,p.n)(A,A),0===(0,p.i)(A))switch(n){case"top":A[1]=1;break;case"bottom":A[1]=-1;break;case"left":A[0]=-1;break;case"right":A[0]=1}return r.eval(F[e.sampleLocation],H),o.projectToRenderScreen(H,W),!(W[2]<0||W[2]>1)&&(o.renderToScreen(W,i),(0,p.b)(A,A,t*o.pixelRatio),(0,p.j)(A,A,W),o.renderToScreen(A,a),!0)}},{key:"_updatePosition",value:function(e,t){if(t){var n=t[0]-e[0],i=t[1]-e[1];return this._textItem.position=[t[0],t[1]],this._textItem.anchor=Math.abs(n)>Math.abs(i)?n>0?"left":"right":i>0?"top":"bottom",this._calloutItem.startPosition=[e[0],e[1]],this._calloutItem.endPosition=[t[0],t[1]],!0}return this._textItem.position=[e[0],e[1]],this._textItem.anchor="center",!1}},{key:"createResources",value:function(){var e,t=this;this._textItem=new P.Z({visible:!0,text:this._text,fontSize:this._fontSize,backgroundColor:this._backgroundColor,textColor:this._textColor}),this._calloutItem=new M({visible:!0,width:2}),this.updateLabelPosition(),null!==(e=this.view.overlay)&&void 0!==e&&e.items.addMany([this._textItem,this._calloutItem]),this.updatePositionOnCameraMove&&this._handles.add((0,c.YP)((function(){return t.view.state.camera}),(function(){return t.updateLabelPosition()})))}},{key:"destroyResources",value:function(){this.view.overlay&&!this.view.overlay.destroyed&&this.view.overlay.items.removeMany([this._textItem,this._calloutItem]),this._handles.removeAll()}},{key:"updateVisibility",value:function(e){this._textItem.visible=this._showText&&e,this._calloutItem.visible=this._showCallout&&e}}]),n}(v.l);function x(e,t,n,i){e.eval(t,T,D),(0,f.a)(R,T,D),n.projectToRenderScreen(T,L),n.projectToRenderScreen(R,j),(0,p.a)(i,G,E),(0,p.f)(i,i)}function Z(e){switch(e){case"top":return"bottom";case"right":return"left";case"bottom":return"top";case"left":return"right"}}var T=(0,h.c)(),R=(0,h.c)(),D=(0,h.c)(),O=(0,d.gX)(),z=(0,d.gX)(),A=(0,d.gX)(),H=(0,h.c)(),W=(0,d.J$)(),I=(0,d.s1)(),V=(0,d.s1)(),L=(0,d.J$)(),E=L,j=(0,d.J$)(),G=j,F={start:0,center:.5,end:1}},9052:function(e,t,n){n.d(t,{u:function(){return p},y:function(){return d}});var i=n(15671),a=n(43144),r=n(11186),o=n(71353),s=n(79803),l=n(29691),u=n(51378),c=n(80064),d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,o.c)(),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,o.c)();(0,i.Z)(this,e),this.startRenderSpace=t,this.endRenderSpace=n,this.type="euclidean"}return(0,a.Z)(e,[{key:"eval",value:function(e,t,n){return(0,r.h)(t,this.startRenderSpace,this.endRenderSpace,e),n&&((0,r.b)(n,this.endRenderSpace,this.startRenderSpace),(0,r.n)(n,n)),t}},{key:"createRenderGeometry",value:function(e,t){var n=[],i=[],a=function(t,a){var o=h;(0,r.b)(o,t,e),n.push([o[0],o[1],o[2]]),i.push([a[0],a[1],a[2]])},o=t.worldUpAtPosition(this.eval(.5,f),u.WM.get());return a(this.startRenderSpace,o),a(this.endRenderSpace,o),{points:n,normals:i}}}],[{key:"fromPositionAndVector",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return(0,r.g)(f,n,i),(0,r.a)(f,t,f),new e((0,o.a)(t),(0,o.a)(f))}}]),e}(),p=function(){function e(t,n,a){(0,i.Z)(this,e),this.startRenderSpace=t,this.endRenderSpace=n,this.renderSpatialReference=a,this.type="geodesic",this._start=(0,o.c)(),this._end=(0,o.c)(),this._pcpf=(0,l.rS)(a),this._project=(0,s.Up)(a,this._pcpf),this._projectIn(t,this._start),this._projectIn(n,this._end)}return(0,a.Z)(e,[{key:"_projectIn",value:function(e,t){this._project?(0,s.SH)(e,this.renderSpatialReference,t,this._pcpf):(0,r.c)(t,e)}},{key:"eval",value:function(e,t,n){if(this._project)if(n){var i=h;(0,c.ek)(this._start,this._end,e,t,i),(0,r.a)(v,t,i),(0,s.SH)(t,this._pcpf,t,this.renderSpatialReference),(0,s.SH)(v,this._pcpf,v,this.renderSpatialReference),(0,r.b)(n,v,t),(0,r.n)(n,n)}else(0,c.ZA)(this._start,this._end,e,t),(0,s.SH)(t,this._pcpf,t,this.renderSpatialReference);else(0,r.h)(t,this._start,this._end,e),n&&((0,r.b)(n,this._end,this._start),(0,r.n)(n,n));return t}},{key:"createRenderGeometry",value:function(e,t){for(var n=[],i=[],a=function(t,a){var o=v;(0,r.b)(o,t,e),n.push([o[0],o[1],o[2]]),i.push([a[0],a[1],a[2]])},o=0;o<128;++o){var s=o/127,l=f,u=h;this.eval(s,l),t.worldUpAtPosition(l,u),a(l,u)}return{points:n,normals:i}}}]),e}(),f=(0,o.c)(),h=(0,o.c)(),v=(0,o.c)()},89261:function(e,t,n){n.d(t,{T:function(){return s}});var i=n(15671),a=n(43144),r=n(92026),o=n(66978),s=function(){function e(t,n){var a=this;(0,i.Z)(this,e),this._textureRep=t,this.loadPromise=null,this._disposed=!1;var s=this._textureRep.acquire(n);(0,o.y8)(s)?(s.then((function(e){a._disposed?(0,r.RY)(e):a._textureRef=e})),this.loadPromise=s):this._textureRef=s}return(0,a.Z)(e,[{key:"dispose",value:function(){this._textureRef=(0,r.RY)(this._textureRef),this._disposed=!0}},{key:"glTexture",get:function(){return(0,r.pC)(this._textureRef)?this._textureRef.glTexture:null}}]),e}()},70209:function(e,t,n){n.d(t,{Er:function(){return u},Lp:function(){return c},Yq:function(){return d}});var i=n(74165),a=n(15861),r=n(14921),o=n(92026),s=n(66978),l=n(94172);function u(e,t){e.interactive=!0;var n=e.tool,u=e.view;u.activeTool=n;var c=(0,s.fu)(t,(function(){u.activeTool===n&&(u.activeTool=null)}));return(0,r.vr)(function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.N1)((function(){return(0,o.Wi)(n)||!n.active}),t);case 2:c=(0,o.hw)(c);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t)}function c(e,t){return(0,l.YP)((function(){return e.interactive}),(function(){return function(e,t){e.interactive?function(e,t){d(e);var n=e.view,i=e.analysis,a=new t({view:n,analysis:i,analysisViewData:e});e.tool=a,n.tools.add(a)}(e,t):d(e)}(e,t)}),l.tX)}function d(e){var t=e.view,n=e.tool;(0,o.Wi)(n)||(t.tools.remove(n),e.tool=null)}},86509:function(e,t,n){n.d(t,{f:function(){return d}});var i=n(15671),a=n(43144),r=n(60136),o=n(92572),s=n(27366),l=n(94172),u=n(49861),c=(n(25243),n(63780),n(69912)),d=function(e){(0,r.Z)(n,e);var t=(0,o.Z)(n);function n(e){return(0,i.Z)(this,n),t.call(this,e)}return(0,a.Z)(n,[{key:"initialize",value:function(){var e=this;this.addHandles((0,l.YP)((function(){return e.analysisViewData.visible}),(function(t){return e.visible=t}),l.tX))}},{key:"deactivate",value:function(){this.onDeactivate(),this.created||this.analysis.clear()}},{key:"resetCreated",value:function(){this._set("created",!1)}}]),n}(n(29919).m);(0,s._)([(0,u.Cb)({constructOnly:!0})],d.prototype,"analysis",void 0),(0,s._)([(0,u.Cb)()],d.prototype,"analysisViewData",void 0),d=(0,s._)([(0,c.j)("esri.views.interactive.AnalysisToolBase")],d)},11208:function(e,t,n){n.d(t,{CM:function(){return u},RS:function(){return c},Rs:function(){return d}});var i=n(17842),a=n(88396),r=n(11186),o=n(71353),s=n(65618),l=n(74509);function u(e,t,n,i){n.projectToRenderScreen(e,h),n.projectToRenderScreen(t,v),(0,a.a)(i,v,h),(0,a.f)(i,i)}function c(e,t,n,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:(0,o.c)(),s=(0,r.c)(f,e);return s[2]=(0,l.zx)(i,s,t,n)||0,i.renderCoordsHelper.toRenderCoords(s,t,a),a}function d(e,t,n,a){return"2d"===a.type?(p.x=e[0],p.y=e[1],p.spatialReference=t,a.toScreen(p)):(c(e,t,n,a,f),a.state.camera.projectToScreen(f,m),(0,i.vW)(m[0],m[1]))}var p=(0,s.Tx)(0,0,0,null),f=(0,o.c)(),h=(0,i.J$)(),v=(0,i.J$)(),m=(0,i.s1)()},4914:function(e,t,n){n.d(t,{Cr:function(){return b},FN:function(){return C},Sx:function(){return v},Z1:function(){return y},_e:function(){return g},g1:function(){return S},qS:function(){return h},qj:function(){return w},xI:function(){return _}});var i,a,r=n(37762),o=n(92026),s=n(47898),l=n(68860),u=n(11186),c=n(71353),d=n(79803),p=n(92975),f=n(25003);function h(e){return m(e,i.Direct)}function v(e){return m(e,i.Horizontal)}function m(e,t){var n=e.hasZ,a=e.spatialReference,u=(0,f.m)(a),c=0,d=(0,l.j5)(u);if((0,o.Wi)(d))return null;var p,h=t===i.Direct?C:w,v=(0,r.Z)(e.paths);try{for(v.s();!(p=v.n()).done;){var m=p.value;if(!(m.length<2))for(var y=m.length-1,_=0;_<y;++_){var g=m[_];P[0]=g[0],P[1]=g[1],P[2]=n?g[2]:0;var S=m[_+1];k[0]=S[0],k[1]=S[1],k[2]=n?S[2]:0;var b=h(P,k,a);if((0,o.Wi)(b))return null;c+=b.value}}}catch(M){v.e(M)}finally{v.f()}return(0,s.yG)(c,d)}function y(e,t){var n=e.spatialReference;return(0,p.fS)(n,t.spatialReference)?(P[0]=e.x,P[1]=e.y,P[2]=e.hasZ?e.z:0,k[0]=t.x,k[1]=t.y,k[2]=t.hasZ?t.z:0,C(P,k,n)):null}function _(e,t){var n=e.spatialReference;return(0,p.fS)(n,t.spatialReference)?(P[0]=e.x,P[1]=e.y,P[2]=e.hasZ?e.z:0,k[0]=t.x,k[1]=t.y,k[2]=t.hasZ?t.z:0,w(P,k,n)):null}function g(e,t){var n=e.spatialReference;return(0,p.fS)(n,t.spatialReference)?(P[0]=e.x,P[1]=e.y,P[2]=e.hasZ?e.z:0,k[0]=t.x,k[1]=t.y,k[2]=t.hasZ?t.z:0,b(P,k,n)):null}function S(e){return P[0]=e.x,P[1]=e.y,P[2]=e.hasZ?e.z:0,function(e,t){var n=(0,l.y)(t);return(0,o.pC)(n)?(0,s.yG)(e[2],n):null}(P,e.spatialReference)}function C(e,t,n){var a=M(e,t,n,i.Direct);return(0,o.pC)(a)?(0,s.yG)(a.direct,a.unit):null}function w(e,t,n){var a=M(e,t,n,i.Horizontal);return(0,o.pC)(a)?(0,s.yG)(a.horizontal,a.unit):null}function b(e,t,n){var a=M(e,t,n,i.Vertical);return(0,o.pC)(a)?(0,s.yG)(a.verticalSigned,a.unit):null}function M(e,t,n,a){var r=(0,f.m)(n),s=(0,l.j5)(r);if((0,o.Wi)(s))return null;var c=t[2]-e[2];if(a===i.Vertical)return{verticalSigned:c,unit:s};if(!(0,d.SH)(e,n,x,r)||!(0,d.SH)(t,n,Z,r))return null;if(a===i.Direct)return{direct:(0,u.i)(Z,x),unit:s};if((0,u.s)(T,e[0],e[1],t[2]),!(0,d.SH)(T,n,T,r))return null;var p=(0,u.i)(T,Z);return a===i.Horizontal?{horizontal:p,unit:s}:{direct:(0,u.i)(Z,x),horizontal:p,vertical:Math.abs(c),unit:s}}(a=i||(i={}))[a.Direct=0]="Direct",a[a.Horizontal=1]="Horizontal",a[a.Vertical=2]="Vertical";var P=(0,c.c)(),k=(0,c.c)(),x=(0,c.c)(),Z=(0,c.c)(),T=(0,c.c)()}}]);
//# sourceMappingURL=16432.ff41550f.chunk.js.map