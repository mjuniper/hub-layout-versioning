"use strict";(self.webpackChunkhub_layout_versioning=self.webpackChunkhub_layout_versioning||[]).push([[75781],{42388:function(e,t,r){r.d(t,{j:function(){return c}});var i=r(15671),n=r(43144),a=r(60136),s=r(92572),o=r(27366),u=r(85015),l=r(41691),y=r(49861),h=(r(25243),r(63780),r(69912)),p={visible:"visibleSublayers"},c=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).scale=0,n}return(0,n.Z)(r,[{key:"layer",set:function(e){var t=this;this._get("layer")!==e&&(this._set("layer",e),this.handles.remove("layer"),e&&this.handles.add([e.sublayers.on("change",(function(){return t.notifyChange("visibleSublayers")})),e.on("wms-sublayer-update",(function(e){return t.notifyChange(p[e.propertyName])}))],"layer"))}},{key:"layers",get:function(){return this.visibleSublayers.filter((function(e){return e.name})).map((function(e){return e.name})).join()}},{key:"version",get:function(){this.commitProperty("layers");var e=this.layer;return e&&e.commitProperty("imageTransparency"),(this._get("version")||0)+1}},{key:"visibleSublayers",get:function(){var e=this.layer,t=this.scale,r=null===e||void 0===e?void 0:e.sublayers,i=[];return null!==r&&void 0!==r&&r.forEach((function e(r){var n=r.minScale,a=r.maxScale,s=r.sublayers;r.visible&&(0===t||(0===n||t<=n)&&(0===a||t>=a))&&(s?s.forEach(e):i.push(r))})),i}},{key:"toJSON",value:function(){var e=this.layer,t=this.layers;return{format:e.imageFormat,request:"GetMap",service:"WMS",styles:"",transparent:e.imageTransparency?"TRUE":"FALSE",version:e.version,layers:t}}}]),r}((0,l.p)(u.Z));(0,o._)([(0,y.Cb)()],c.prototype,"layer",null),(0,o._)([(0,y.Cb)({readOnly:!0})],c.prototype,"layers",null),(0,o._)([(0,y.Cb)({type:Number})],c.prototype,"scale",void 0),(0,o._)([(0,y.Cb)({readOnly:!0})],c.prototype,"version",null),(0,o._)([(0,y.Cb)({readOnly:!0})],c.prototype,"visibleSublayers",null),c=(0,o._)([(0,h.j)("esri.layers.support.ExportWMSImageParameters")],c)},69121:function(e,t,r){r.r(t),r.d(t,{default:function(){return c}});var i=r(15671),n=r(43144),a=r(60136),s=r(92572),o=r(27366),u=r(10064),l=(r(32718),r(25243),r(63780),r(93169),r(69912)),y=r(53866),h=r(69229),p=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(){var e;return(0,i.Z)(this,r),(e=t.apply(this,arguments)).type="wms-3d",e}return(0,n.Z)(r,[{key:"initialize",value:function(){var e=this;this.layer.serviceSupportsSpatialReference(this.view.spatialReference)||this.addResolvingPromise(Promise.reject(new u.Z("layerview:spatial-reference-incompatible","The spatial references supported by this WMS layer are incompatible with the spatial reference of the view"))),this.updatingHandles.add((function(){var t;return null===(t=e.exportImageParameters)||void 0===t?void 0:t.version}),(function(){e.updatingHandles.addPromise(e.refreshDebounced())}))}},{key:"createFetchPopupFeaturesQuery",value:function(e){var t=this.findExtentInfoAt(e),r=t.extent,i=new y.Z(r[0],r[1],r[2],r[3],this._spatialReference),n=t.imageSize,a=n.width,s=n.height,o=i.width/a;return{extent:i,width:a,height:s,x:Math.round((e.x-i.xmin)/o),y:Math.round((i.ymax-e.y)/o)}}},{key:"getFetchOptions",value:function(){return{timeExtent:this.timeExtent}}}]),r}((0,r(29431).Z)(h.Z)),c=p=(0,o._)([(0,l.j)("esri.views.3d.layers.WMSLayerView3D")],p)},13107:function(e,t,r){r.d(t,{Z:function(){return c}});var i=r(15671),n=r(43144),a=r(60136),s=r(92572),o=r(27366),u=r(32718),l=r(66978),y=r(94172),h=r(49861),p=(r(25243),r(63780),r(69912)),c=function(e){var t=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(){return(0,i.Z)(this,r),t.apply(this,arguments)}return(0,n.Z)(r,[{key:"initialize",value:function(){var e=this;this.handles.add((0,y.on)((function(){return e.layer}),"refresh",(function(t){e.doRefresh(t.dataChanged).catch((function(t){(0,l.D_)(t)||u.Z.getLogger(e.declaredClass).error(t)}))})),"RefreshableLayerView")}}]),r}(e);return(0,o._)([(0,h.Cb)()],t.prototype,"layer",void 0),t=(0,o._)([(0,p.j)("esri.layers.mixins.RefreshableLayerView")],t)}},29431:function(e,t,r){r.d(t,{Z:function(){return f}});var i=r(15671),n=r(43144),a=r(60136),s=r(92572),o=r(27366),u=r(10064),l=r(92026),y=r(49861),h=(r(25243),r(63780),r(69912)),p=r(70361),c=r(42388),f=function(e){var t=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(){return(0,i.Z)(this,r),t.apply(this,arguments)}return(0,n.Z)(r,[{key:"initialize",value:function(){this.exportImageParameters=new c.j({layer:this.layer})}},{key:"destroy",value:function(){this.exportImageParameters=(0,l.SC)(this.exportImageParameters)}},{key:"exportImageVersion",get:function(){var e;return null!==(e=this.exportImageParameters)&&void 0!==e&&e.commitProperty("version"),this.commitProperty("timeExtent"),(this._get("exportImageVersion")||0)+1}},{key:"fetchPopupFeatures",value:function(e){var t=this.layer;if(!e)return Promise.reject(new u.Z("wmslayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:t}));var r=t.popupEnabled;if(!r)return Promise.reject(new u.Z("wmslayerview:fetchPopupFeatures","popupEnabled should be true",{popupEnabled:r}));var i=this.createFetchPopupFeaturesQuery(e);if(!i)return Promise.resolve([]);var n=i.extent,a=i.width,s=i.height,o=i.x,l=i.y;if(!(n&&a&&s))throw new u.Z("wmslayerview:fetchPopupFeatures","WMSLayer does not support fetching features.",{extent:n,width:a,height:s});return t.fetchFeatureInfo(n,a,s,o,l)}}]),r}(e);return(0,o._)([(0,y.Cb)()],t.prototype,"exportImageParameters",void 0),(0,o._)([(0,y.Cb)({readOnly:!0})],t.prototype,"exportImageVersion",null),(0,o._)([(0,y.Cb)()],t.prototype,"layer",void 0),(0,o._)([(0,y.Cb)(p.qG)],t.prototype,"timeExtent",void 0),t=(0,o._)([(0,h.j)("esri.layers.mixins.WMSLayerView")],t)}}}]);
//# sourceMappingURL=75781.d9261861.chunk.js.map