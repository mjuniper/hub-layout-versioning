"use strict";(self.webpackChunkhub_layout_versioning=self.webpackChunkhub_layout_versioning||[]).push([[71004],{34019:function(n,t,e){e.d(t,{N:function(){return a}});var i=e(15671),r=e(43144),a=function(){function n(t){(0,i.Z)(this,n),this.vertexHandle=null,this.excludeFeature=null,this.visualizer=null,this.selfSnappingZ=null,this.editGeometryOperations=t.editGeometryOperations,this.elevationInfo=t.elevationInfo,this.pointer=t.pointer,this.vertexHandle=t.vertexHandle,this.excludeFeature=t.excludeFeature,this.visualizer=t.visualizer,this.selfSnappingZ=t.selfSnappingZ}return(0,r.Z)(n,[{key:"coordinateHelper",get:function(){return this.editGeometryOperations.data.coordinateHelper}},{key:"spatialReference",get:function(){return this.coordinateHelper.spatialReference}}]),n}()},80151:function(n,t,e){e.d(t,{W:function(){return g}});var i=e(37762),r=e(29439),a=e(74165),o=e(15861),s=e(1413),u=e(92026),l=e(66978),c=e(94172),p=e(70178),f=e(37818),v=e(74229),d=e(34019),h=e(93463);function g(n){var t=n.predicate,e=void 0===t?function(){return!0}:t,r=n.snappingManager,f=n.snappingContext,g=n.updatingHandles,k=n.useZ,_=void 0===k||k,C=new v.hM;if((0,u.Wi)(r))return{snappingStep:[x,C],cancelSnapping:x};var b,m,w,S,z=null,T=null,H=null,W=function(){z=(0,u.IM)(z),r.doneSnapping(),(0,u.pC)(T)&&T.frameTask.remove(),T=null,b=(0,u.hw)(b),H=null},I=(m=r,w=_,S=C,(0,l.Ds)(function(){var n=(0,o.Z)((0,a.Z)().mark((function n(t,e){var i,r,o,s,l,c,f,v,d,h;return(0,a.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=t.frameTask,r=t.point,o=t.scenePoint,s=t.context,l=t.event,c=t.delta,f=t.getLastState,n.next=3,i.schedule((function(){return m.snap({point:r,scenePoint:o,context:s,signal:e})}),e);case 3:if(!(v=n.sent).valid){n.next=10;break}return n.next=7,i.schedule((function(){return v.apply()}),e);case 7:d=n.sent,h=f(),(0,u.pC)(h.point)&&r!==h.point&&(d=m.update({point:h.point,scenePoint:h.scenePoint,context:s})),!(0,u.Wi)(h.updatePoint)&&(0,p.k)(d,h.updatePoint)||(Z(l.mapEnd,d,c,w),S.execute(l));case 10:case"end":return n.stop()}}),n)})));return function(t,e){return n.apply(this,arguments)}}())),O=null,q=null,G=null;return{snappingStep:[function(n){if(!e(n))return n;var t,a=n.action;if("start"===a){var o=n.info,p="3d"===(t=r.view).type?t.resourceController.scheduler.registerTask(h.T8.SNAPPING):h.sq;if(T=function(n,t,e){return{context:new d.N({editGeometryOperations:n.editGeometryOperations,elevationInfo:n.elevationInfo,pointer:n.pointer,vertexHandle:(0,u.pC)(t.info)?t.info.handle:null,excludeFeature:n.excludeFeature,visualizer:n.visualizer}),originalPos:(0,u.pC)(t.snapOrigin)?n.coordinateHelper.vectorToDehydratedPoint(t.snapOrigin):t.mapStart,originalScenePos:(0,u.pC)(t.scenePoints)?t.scenePoints.sceneStart:null,frameTask:e}}(f,n,p),T.context.selfSnappingZ=null,!_&&(0,u.pC)(o)){var v=function(n,t){if(!n.hasZ())return null;var e,r=t.vertices,a=null,o=(0,i.Z)(r);try{for(o.s();!(e=o.n()).done;){var s=e.value,l=n.getZ(s.pos);if((0,u.pC)(a)&&(0,u.pC)(l)&&Math.abs(l-a)>1e-6)return null;(0,u.Wi)(a)&&(a=l)}}catch(c){o.e(c)}finally{o.f()}return a}(f.coordinateHelper,o.handle.component);(0,u.pC)(v)&&(T.context.selfSnappingZ={value:v,elevationInfo:f.elevationInfo})}}if((0,u.pC)(T)){var x=T,k=x.context,C=x.originalScenePos,m=x.originalPos,w=n.mapEnd,S=n.mapStart,R=n.scenePoints,U=y(m,P(w,S)),A=P(S,m),M=(0,s.Z)((0,s.Z)({},n),{},{action:"update"}),N=T.context,F=function(n,t){return(0,u.Wi)(n)||(0,u.Wi)(t)?null:y(n,P(t.sceneEnd,t.sceneStart))}(C,R),L=r.update({point:U,scenePoint:F,context:k});if(G=L,Z(w,L,A,_),O=U,q=F,"end"!==a){var E=T.frameTask;(0,u.Wi)(z)&&(z=new AbortController),H=function(n){g.addPromise((0,l.R8)(I({frameTask:E,event:M,context:N,point:U,scenePoint:F,delta:A,getLastState:function(){return{point:O,scenePoint:q,updatePoint:n.forceUpdate?null:G}}},(0,u.Wg)(z).signal)))},H({forceUpdate:!1}),(0,u.Wi)(b)&&(b=(0,c.YP)((function(){return r.options.effectiveEnabled}),(function(){var n;return null===(n=H)||void 0===n?void 0:n({forceUpdate:!0})})))}}return"end"===a&&W(),n},C],cancelSnapping:function(n){return W(),n}}}function y(n,t){var e=(0,r.Z)(t,3),i=e[0],a=e[1],o=e[2],s=(0,f.WG)(n);return s.x+=i,s.y+=a,s.hasZ&&(s.z+=o),s}function P(n,t){var e=n.hasZ&&t.hasZ?n.z-t.z:0;return[n.x-t.x,n.y-t.y,e]}function Z(n,t,e,i){var a=(0,r.Z)(e,3),o=a[0],s=a[1],u=a[2];n.x=t.x+o,n.y=t.y+s,i&&n.hasZ&&t.hasZ&&(n.z=t.z+u)}function x(n){return n}},71040:function(n,t,e){e.d(t,{y:function(){return y}});var i=e(74165),r=e(1413),a=e(15861),o=e(15671),s=e(43144),u=e(60136),l=e(92572),c=e(27366),p=e(85015),f=e(92026),v=e(66978),d=e(49861),h=(e(25243),e(63780),e(69912)),g=e(93463),y=function(n){(0,u.Z)(e,n);var t=(0,l.Z)(e);function e(n){var s;return(0,o.Z)(this,e),(s=t.call(this,n)).constrainResult=function(n){return n},s._snapPoints=null,s._frameTask=null,s._abortController=null,s._stagedPoint=null,s._snap=(0,v.Ds)(function(){var n=(0,a.Z)((0,i.Z)().mark((function n(t,e,a,o){var u,l;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(u=s._frameTask,!(0,f.Wi)(u)){n.next=3;break}return n.abrupt("return");case 3:return n.next=5,u.schedule((function(){return e.snap((0,r.Z)((0,r.Z)({},t),{},{context:a,signal:o}))}),o);case 5:if(l=n.sent,n.t0=l.valid,!n.t0){n.next=10;break}return n.next=10,u.schedule((function(){s.stagedPoint=l.apply(),t!==s._snapPoints&&(0,f.pC)(s._snapPoints)&&(s.stagedPoint=e.update((0,r.Z)((0,r.Z)({},s._snapPoints),{},{context:a})))}),o);case 10:case"end":return n.stop()}}),n)})));return function(t,e,i,r){return n.apply(this,arguments)}}()),s}return(0,s.Z)(e,[{key:"stagedPoint",get:function(){return this._stagedPoint},set:function(n){this._stagedPoint=this.constrainResult(n)}},{key:"initialize",value:function(){var n,t,e="3d"===this.view.type?null===(n=this.view)||void 0===n||null===(t=n.resourceController)||void 0===t?void 0:t.scheduler:null;this._frameTask=(0,f.pC)(e)?e.registerTask(g.T8.SNAPPING):g.sq}},{key:"destroy",value:function(){this._abortController=(0,f.IM)(this._abortController),this._frameTask=(0,f.hw)(this._frameTask)}},{key:"update",value:function(n,t,e){this._snapPoints=n;var i=n.point,r=n.scenePoint,a=t.update({point:i,scenePoint:r,context:e});return this.stagedPoint=a,a}},{key:"snap",value:function(){var n=(0,a.Z)((0,i.Z)().mark((function n(t,e,r){var a,o;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=t.point,o=t.scenePoint,n.abrupt("return",(this.stagedPoint=e.update({point:a,scenePoint:o,context:r}),this._snapPoints=t,(0,f.Wi)(this._abortController)&&(this._abortController=new AbortController),this._snap(t,e,r,this._abortController.signal)));case 2:case"end":return n.stop()}}),n,this)})));return function(t,e,i){return n.apply(this,arguments)}}()},{key:"resnap",value:function(){var n=(0,a.Z)((0,i.Z)().mark((function n(t,e){return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.t0=(0,f.Wi)(this._snapPoints),n.t0){n.next=4;break}return n.next=4,this.snap(this._snapPoints,t,e);case 4:case"end":return n.stop()}}),n,this)})));return function(t,e){return n.apply(this,arguments)}}()},{key:"abort",value:function(){this._abortController=(0,f.IM)(this._abortController),this._snapPoints=null}}]),e}(p.Z);(0,c._)([(0,d.Cb)({constructOnly:!0})],y.prototype,"view",void 0),(0,c._)([(0,d.Cb)()],y.prototype,"stagedPoint",null),(0,c._)([(0,d.Cb)()],y.prototype,"constrainResult",void 0),(0,c._)([(0,d.Cb)()],y.prototype,"_stagedPoint",void 0),y=(0,c._)([(0,h.j)("esri.views.interactive.snapping.SnappingOperation")],y)},38561:function(n,t,e){e.d(t,{a:function(){return f}});var i=e(37762),r=e(15671),a=e(43144),o=e(42537),s=e(90609),u=e(53397),l=e(5916),c=e(61309),p=e(41216),f=function(){function n(){(0,r.Z)(this,n)}return(0,a.Z)(n,[{key:"draw",value:function(n,t){var e,r=this._getUniqueHints(n),a=this.sortUniqueHints(r),f=[],v=(0,i.Z)(a);try{for(v.s();!(e=v.n()).done;){var d=e.value;d instanceof s.w&&f.push(this.visualizeIntersectionPoint(d,t)),d instanceof u.w&&f.push(this.visualizeLine(d,t)),d instanceof l.L&&f.push(this.visualizeParallelSign(d,t)),d instanceof p.y&&f.push(this.visualizeRightAngleQuad(d,t)),d instanceof c.n&&f.push(this.visualizePoint(d,t))}}catch(h){v.e(h)}finally{v.f()}return(0,o.AL)(f)}},{key:"sortUniqueHints",value:function(n){return n}},{key:"_getUniqueHints",value:function(n){var t,e=[],r=(0,i.Z)(n);try{for(r.s();!(t=r.n()).done;){var a,o=t.value,s=!0,u=(0,i.Z)(e);try{for(u.s();!(a=u.n()).done;){var l=a.value;if(o.equals(l)){s=!1;break}}}catch(c){u.e(c)}finally{u.f()}s&&e.push(o)}}catch(c){r.e(c)}finally{r.f()}return e}}]),n}()},61309:function(n,t,e){e.d(t,{n:function(){return u}});var i=e(15671),r=e(43144),a=e(60136),o=e(92572),s=e(11186),u=function(n){(0,a.Z)(e,n);var t=(0,o.Z)(e);function e(n,r,a){var o;return(0,i.Z)(this,e),(o=t.call(this,r,a)).point=n,o}return(0,r.Z)(e,[{key:"equals",value:function(n){return n instanceof e&&(0,s.k)(this.point,n.point)}}]),e}(e(55054).r)}}]);
//# sourceMappingURL=71004.a6ade32f.chunk.js.map