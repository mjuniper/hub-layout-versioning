/*! For license information please see 82507.6ef4a61b.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkhub_layout_versioning=self.webpackChunkhub_layout_versioning||[]).push([[82507],{80046:function(e,t,n){n.d(t,{a:function(){return i}});var r=n(77843);function i(e,t,n){var i=(0,r._)((0,r._)({params:{}},n),e);return i.params=t.reduce((function(t,n){return(e[n]||"boolean"===typeof e[n])&&(t[n]=e[n]),t}),i.params),["params","httpMethod","rawResponse","authentication","portal","fetch","maxUrlLength","headers"].reduce((function(e,t){return i[t]&&(e[t]=i[t]),e}),{})}},82507:function(e,t,n){n.r(t),n.d(t,{arcgis_hub_versions:function(){return m}});var r=n(74165),i=n(15671),a=n(43144),o=n(15861),s=n(72585),c=n(12868),u=n(32836),l=n(69207);n(84371),n(77843),n(80046);function f(e){var t,n=e.access,r=e.resource,i=e.size,a=e.properties||"{}";try{t=JSON.parse(a)}catch(o){t={}}return Object.assign(Object.assign({},t),{access:n,path:r,size:i})}function h(e,t){return d.apply(this,arguments)}function d(){return(d=(0,o.Z)((0,r.Z)().mark((function e(t,n){var i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.f)(t,Object.assign(Object.assign({},n),{params:{sortField:"created",sortOrder:"desc"}}));case 2:return i=e.sent,e.abrupt("return",i.resources.filter((function(e){return e.resource.match(/^hubVersion_[a-zA-Z0-9_\s]*\/version.json/)})).map(f));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var p={month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric"},m=function(){function e(t){(0,i.Z)(this,e),(0,s.r)(this,t),this.arcgisHubVersionsVersionSelected=(0,s.c)(this,"arcgisHubVersionsVersionSelected",7),this.versions=[],this.loading=!0,(0,u.b)(this,"renderListItem","onSelectVersion")}return(0,a.Z)(e,[{key:"componentWillLoad",value:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.i.loadIntlForComponent(this.element);case 2:return this.intl=e.sent,e.abrupt("return",this.fetchVersions());case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"fetchVersions",value:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(){var t,n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.context||!this.itemId){e.next=6;break}return e.next=3,h(this.itemId,null===(t=this.context)||void 0===t?void 0:t.requestOptions);case 3:n=e.sent,this.versions=n,this.loading=!1;case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onSelectVersion",value:function(e){e.stopPropagation();var t=e.detail.keys().next().value;this.activeVersionId=t.id,this.arcgisHubVersionsVersionSelected.emit(t)}},{key:"onDeleteItemClick",value:function(e){e.stopPropagation();var t=e.target.dataset.id;alert("Delete ".concat(t))}},{key:"getVersionMetadata",value:function(e){return{name:this.getVersionName(e),createdBy:e.creator}}},{key:"getVersionName",value:function(e){var t=e.name||this.intl.formatDate(e.created,p),n="";return this.activeVersionId===e.id&&(n="\u226b "),"".concat(n).concat(t)}},{key:"getCreatedDate",value:function(e){var t="";return e.name&&(t=this.intl.formatDate(e.created,p)),t}},{key:"renderLoading",value:function(){if(this.loading)return(0,s.h)(s.F,null,(0,s.h)("arcgis-skeleton-loader",{active:!0,rows:1,"show-heading":!0}),(0,s.h)("arcgis-skeleton-loader",{active:!0,rows:1,"show-heading":!0}),(0,s.h)("arcgis-skeleton-loader",{active:!0,rows:1,"show-heading":!0}))}},{key:"getDescription",value:function(e){var t=[this.intl.t("createdBy",e)],n=this.getCreatedDate(e);return n&&t.push(n),this.publishedVersionId===e.id&&t.push(this.intl.t("publishedBadge")),t.join(" | ")}},{key:"renderListItem",value:function(e){return(0,s.h)("calcite-value-list-item",{description:this.getDescription(e),key:e.id,label:this.getVersionName(e),metadata:this.getVersionMetadata(e),selected:this.activeVersionId===e.id,value:e})}},{key:"render",value:function(){return(0,s.h)(s.H,{"data-element":"versions"},(0,s.h)("calcite-value-list",{onCalciteListChange:this.onSelectVersion,"selection-appearance":"border","selection-mode":"single"},this.renderLoading(),this.versions.map(this.renderListItem)))}},{key:"element",get:function(){return(0,s.g)(this)}}],[{key:"assetsDirs",get:function(){return["locales"]}},{key:"watchers",get:function(){return{context:["fetchVersions"],itemId:["fetchVersions"]}}}]),e}();m.style=':host{display:block}arcgis-skeleton-loader{margin:1.25rem;margin-bottom:0}.version-title{margin-block:0.25rem;font-size:1rem;color:var(--calcite-ui-brand)}calcite-list-item[selected] .version-title calcite-link{color:transparent;--calcite-ui-text-link:black;--calcite-link-blue-underline:transparent;text-decoration:none}calcite-list-item[selected] .version-title:before{content:"\u226b ";color:black}calcite-value-list-item:not([selected]){--calcite-ui-text-1:var(--calcite-ui-brand-hover)}.badges-container{min-height:1.5rem;display:flex;gap:0.25rem}.viewing-badge{--calcite-ui-foreground-2:var(--calcite-ui-foreground-current)}'},30678:function(e,t,n){function r(e){return"string"!==typeof e||"/"===(e=e.trim())[e.length-1]&&(e=e.slice(0,-1)),e}n.d(t,{c:function(){return r}})},32836:function(e,t,n){n.d(t,{b:function(){return r}});var r=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n.forEach((function(t){if("function"!==typeof e[t])throw new Error("Cannot bind context. ".concat(t," must be a function"));e[t]=e[t].bind(e)}))}},69207:function(e,t,n){n.d(t,{a:function(){return g},b:function(){return l},c:function(){return p},d:function(){return c},e:function(){return b},f:function(){return m},g:function(){return h},h:function(){return v},i:function(){return u},j:function(){return y},s:function(){return s}});var r=n(63613),i=n(98825),a=n(77843),o=n(80046);function s(e){var t=JSON.parse(JSON.stringify(e));return t.data&&("undefined"!==typeof Blob&&e.data instanceof Blob||"ReadStream"===e.data.constructor.name?t.file=e.data:t.text=e.data,delete t.data),t}function c(e){return e.owner?Promise.resolve(e.owner):e.item&&e.item.owner?Promise.resolve(e.item.owner):e.authentication&&e.authentication.getUsername?e.authentication.getUsername():Promise.reject(new Error("Could not determine the owner of this item. Pass the `owner`, `item.owner`, or `authentication` option."))}function u(e){return Array.isArray(e)&&Array.isArray(e[0])&&Array.isArray(e[1])}function l(e){return e.join(",")}var f=/[\x00-\x1F\x7F-\x9F\xA0]/g;function h(e,t){var n=d(e,t),i=(0,r._)({httpMethod:"GET"},t);return(0,a.r)(n,i)}var d=function(e,t){return("string"===typeof t?t:(0,i.g)(t))+"/content/items/"+e};function p(e,t){var n=d(e,t)+"/data",i=(0,r._)({httpMethod:"GET",params:{}},t);return i.file&&(i.params.f=null),(0,a.r)(n,i).catch((function(e){if(!RegExp(/The string did not match the expected pattern|(Unexpected end of (JSON input|data at line 1 column 1))/i).test(e.message))throw e}))}function m(e,t){var n=d(e,t)+"/resources",i=(0,r._)({},t);return i.params=(0,r._)({num:1e3},i.params),(0,a.r)(n,i)}function v(e,t){var n=t.readAs||"blob";return k(e,"/resources/"+t.fileName,n,t)}function g(e,t){var n=d(e,t)+"/groups";return(0,a.r)(n,t)}function y(e){return c(e).then((function(t){var n=(0,i.g)(e)+"/content/users/"+t+"/items/"+e.id+"/status",s=(0,o.a)(e,["jobId","jobType"],{params:(0,r._)({},e.params)});return(0,a.r)(n,s)}))}function b(e,t){return function(e,t){var n=t||{},i=n.fileName,a=void 0===i?"iteminfo.xml":i,o=n.readAs;return k(e,"/info/"+a,void 0===o?"text":o,(0,r._)({httpMethod:"GET"},t))}(e,(0,r._)((0,r._)({},t),{fileName:"metadata/metadata.xml"}))}function k(e,t,n,i){var o=""+d(e,i)+t,s=(0,r._)({params:{}},i),c=s.rawResponse;return s.rawResponse=!0,s.params.f=null,(0,a.r)(o,s).then((function(e){return c?e:"json"!==n?e[n]():e.text().then((function(e){return JSON.parse(e.replace(f,""))}))}))}},98825:function(e,t,n){n.d(t,{g:function(){return i}});var r=n(30678);function i(e){return void 0===e&&(e={}),e.portal?(0,r.c)(e.portal):e.authentication?e.authentication.portal:"https://www.arcgis.com/sharing/rest"}},63613:function(e,t,n){n.d(t,{_:function(){return r},a:function(){return i}});var r=function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};function i(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var a=arguments[t],o=0,s=a.length;o<s;o++,i++)r[i]=a[o];return r}}}]);
//# sourceMappingURL=82507.6ef4a61b.chunk.js.map