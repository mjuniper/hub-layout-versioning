"use strict";(self.webpackChunkhub_layout_versioning=self.webpackChunkhub_layout_versioning||[]).push([[99303],{95101:function(e,t,n){n.d(t,{a:function(){return i},b:function(){return r},c:function(){return a},g:function(){return o}});var i="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{};function r(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function a(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}},n.exports),n.exports}function o(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})})),t}},29479:function(e,t,n){n.r(t),n.d(t,{default:function(){return D}});var i,r=n(74165),a=n(15861),o=n(1413),s=n(37762),l=n(15671),u=n(43144),c=n(97326),d=n(11752),p=n(61120),h=n(60136),f=n(92572),v=n(27366),y=n(80987),g=n(60354),m=n(44927),_=n(46784),b=n(84652),w=n(54472),k=n(93002),C=n(32718),M=n(92026),Z=n(66978),x=n(35995),I=n(49861),T=(n(25243),n(69912)),S=n(31201),A=n(78952),F=n(70032),P=n(98995),L=n(68954),E=n(41190),R=0,V="esri.Basemap",O=i=function(e){(0,h.Z)(v,e);var t=(0,f.Z)(v);function v(e){var n;(0,l.Z)(this,v),(n=t.call(this,e)).id=null,n.portalItem=null,n.spatialReference=null,n.thumbnailUrl=null,n.title="Basemap",n.id=Date.now().toString(16)+"-basemap-"+R++,n.baseLayers=new y.Z,n.referenceLayers=new y.Z;var i=function(e){e.parent&&e.parent!==(0,c.Z)(n)&&"remove"in e.parent&&e.parent.remove(e),e.parent=(0,c.Z)(n),"elevation"===e.type&&C.Z.getLogger(n.declaredClass).error("Layer '".concat(e.title,", id:").concat(e.id,"' of type '").concat(e.type,"' is not supported as a basemap layer and will therefore be ignored."))},r=function(e){e.parent=null};return n.baseLayers.on("after-add",(function(e){return i(e.item)})),n.referenceLayers.on("after-add",(function(e){return i(e.item)})),n.baseLayers.on("after-remove",(function(e){return r(e.item)})),n.referenceLayers.on("after-remove",(function(e){return r(e.item)})),n}return(0,u.Z)(v,[{key:"initialize",value:function(){var e=this;this.when().catch((function(t){C.Z.getLogger(e.declaredClass).error("#load()","Failed to load basemap (title: '".concat(e.title,"', id: '").concat(e.id,"')"),t)})),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}},{key:"destroy",value:function(){var e,t,n=this.baseLayers.removeAll(),i=(0,s.Z)(n);try{for(i.s();!(t=i.n()).done;){t.value.destroy()}}catch(l){i.e(l)}finally{i.f()}var r,a=this.referenceLayers.removeAll(),o=(0,s.Z)(a);try{for(o.s();!(r=o.n()).done;){r.value.destroy()}}catch(l){o.e(l)}finally{o.f()}this.baseLayers.destroy(),this.referenceLayers.destroy(),null!==(e=this.portalItem)&&void 0!==e&&e.destroy(),this.portalItem=null}},{key:"normalizeCtorArgs",value:function(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e=(0,o.Z)({},e)).resourceInfo),e}},{key:"baseLayers",set:function(e){this._set("baseLayers",(0,g.Z)(e,this._get("baseLayers")))}},{key:"_writeBaseLayers",value:function(e,t,n){var i=[];e?(n=(0,o.Z)((0,o.Z)({},n),{},{layerContainerType:"basemap"}),this.baseLayers.forEach((function(e){var t=(0,E.Nw)(e,n.webmap?n.webmap.getLayerJSONFromResourceInfo(e):null,n);(0,M.pC)(t)&&i.push(t)})),this.referenceLayers.forEach((function(e){var t=(0,E.Nw)(e,n.webmap?n.webmap.getLayerJSONFromResourceInfo(e):null,n);(0,M.pC)(t)&&("scene"!==e.type&&(t.isReference=!0),i.push(t))})),t.baseMapLayers=i):t.baseMapLayers=i}},{key:"referenceLayers",set:function(e){this._set("referenceLayers",(0,g.Z)(e,this._get("referenceLayers")))}},{key:"writeTitle",value:function(e,t){t.title=e||"Basemap"}},{key:"load",value:function(e){return this.addResolvingPromise(this._loadFromSource(e)),Promise.resolve(this)}},{key:"loadAll",value:function(){var e=this;return(0,k.G)(this,(function(t){t(e.baseLayers,e.referenceLayers)}))}},{key:"clone",value:function(){var e={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.slice(),referenceLayers:this.referenceLayers.slice()};return this.loaded&&(e.loadStatus="loaded"),new i({resourceInfo:this.resourceInfo}).set(e)}},{key:"read",value:function(e,t){this.resourceInfo||this._set("resourceInfo",{data:e,context:t}),(0,d.Z)((0,p.Z)(v.prototype),"read",this).call(this,e,t)}},{key:"write",value:function(e,t){return e=e||{},t&&t.origin||(t=(0,o.Z)({origin:"web-map"},t)),(0,d.Z)((0,p.Z)(v.prototype),"write",this).call(this,e,t),!this.loaded&&this.resourceInfo&&this.resourceInfo.data.baseMapLayers&&(e.baseMapLayers=this.resourceInfo.data.baseMapLayers.map((function(e){var t=(0,b.d9)(e);return t.url&&(0,x.oC)(t.url)&&(t.url="https:".concat(t.url)),t.templateUrl&&(0,x.oC)(t.templateUrl)&&(t.templateUrl="https:".concat(t.templateUrl)),t}))),e}},{key:"_loadFromSource",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n,i,a,o,s,l=this;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.resourceInfo,i=this.portalItem,(0,Z.k_)(t),a=[],n?(o=n.context?n.context.url:null,a.push(this._loadLayersFromJSON(n.data,o,t)),n.data.id&&!n.data.title&&(s=n.data.id,a.push((0,L.g)(s).then((function(e){e&&l.read({title:e},n.context)}))))):i&&a.push(this._loadFromItem(i,t)),e.next=6,Promise.all(a);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_loadLayersFromJSON",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t,i,a){var o,s,l,u,c,d,p,h,f,v;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.resourceInfo&&this.resourceInfo.context,s=this.portalItem&&this.portalItem.portal||o&&o.portal||null,l=o&&"web-scene"===o.origin?"web-scene":"web-map",e.next=5,Promise.all([n.e(79803),n.e(14226),n.e(46727),n.e(43139),n.e(45263)]).then(n.bind(n,20519));case 5:return u=e.sent,c=u.populateOperationalLayers,d=[],(0,Z.k_)(a),t.baseMapLayers&&Array.isArray(t.baseMapLayers)&&(p={context:{origin:l,url:i,portal:s,layerContainerType:"basemap"},defaultLayerType:"DefaultTileLayer"},h=function(e){return"web-scene"===l&&"ArcGISSceneServiceLayer"===e.layerType||e.isReference},f=c(this.baseLayers,t.baseMapLayers.filter((function(e){return!h(e)})),p),d.push(f),v=c(this.referenceLayers,t.baseMapLayers.filter(h),p),d.push(v)),e.next=11,(0,Z.as)(d);case 11:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}()},{key:"_loadFromItem",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t,n){var i,a,o,s,l;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.load(n);case 2:return o=e.sent,e.next=5,o.fetchData("json",n);case 5:return s=e.sent,l=(0,x.mN)(null!==(i=t.itemUrl)&&void 0!==i?i:""),e.abrupt("return",(this._set("resourceInfo",{data:null!==(a=s.baseMap)&&void 0!==a?a:{},context:{origin:"Web Scene"===t.type?"web-scene":"web-map",portal:t.portal||F.Z.getDefault(),url:l}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:s.spatialReference},this.resourceInfo.context),this.read({title:t.title,thumbnailUrl:t.thumbnailUrl},{origin:"portal-item",portal:t.portal||F.Z.getDefault(),url:l}),this._loadLayersFromJSON(this.resourceInfo.data,l,n)));case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}],[{key:"fromId",value:function(e){var t=L.s[e];if(t){if(t.deprecated){var n=null;"dark-gray"===e?n="dark-gray-vector":"gray"===e?n="gray-vector":"streets"===e?n="streets-vector":"topo"===e&&(n="topo-vector"),(0,m.x9)(C.Z.getLogger(V),"The ".concat(e," basemap has entered mature support and is no longer being updated."),{replacement:n,see:"https://arcg.is/1iq8aD",warnOnce:!0})}return i.fromJSON(t)}return null}}]),v}((0,_.eC)(w.Z));(0,v._)([(0,I.Cb)({json:{write:{ignoreOrigin:!0,target:"baseMapLayers",writer:function(e,t,n,i){this._writeBaseLayers(e,t,i)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:y.Z}},writer:function(e,t,n,i){this._writeBaseLayers(e,t,i)}}}}}})],O.prototype,"baseLayers",null),(0,v._)([(0,I.Cb)({type:String,json:{origins:{"web-scene":{write:!0}}}})],O.prototype,"id",void 0),(0,v._)([(0,I.Cb)({type:P.default})],O.prototype,"portalItem",void 0),(0,v._)([(0,I.Cb)()],O.prototype,"referenceLayers",null),(0,v._)([(0,I.Cb)({readOnly:!0})],O.prototype,"resourceInfo",void 0),(0,v._)([(0,I.Cb)({type:A.Z})],O.prototype,"spatialReference",void 0),(0,v._)([(0,I.Cb)()],O.prototype,"thumbnailUrl",void 0),(0,v._)([(0,I.Cb)({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],O.prototype,"title",void 0),(0,v._)([(0,S.c)("title")],O.prototype,"writeTitle",null);var D=O=i=(0,v._)([(0,T.j)(V)],O)},13058:function(e,t,n){n.d(t,{Z:function(){return w}});var i=n(15671),r=n(43144),a=n(60136),o=n(92572),s=n(27366),l=n(11582),u=n(17768),c=n(46784),d=n(16889),p=n(92026),h=n(49861),f=n(89125),v=(n(63780),n(38511)),y=n(69912),g=n(31201),m=n(25243),_=n(585),b=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(){var e;(0,i.Z)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).position=new _.Z([0,0,0]),e.heading=0,e.tilt=0,e.fov=55,e}return(0,r.Z)(n,[{key:"normalizeCtorArgs",value:function(e,t,n,i){if(e&&"object"==typeof e&&("x"in e||Array.isArray(e))){var r={position:e};return null!=t&&(r.heading=t),null!=n&&(r.tilt=n),null!=i&&(r.fov=i),r}return e}},{key:"writePosition",value:function(e,t,n,i){var r=e.clone();r.x=(0,m.q9)(e.x||0),r.y=(0,m.q9)(e.y||0),r.z=e.hasZ?(0,m.q9)(e.z||0):e.z,t[n]=r.write({},i)}},{key:"readPosition",value:function(e,t){var n=new _.Z;return n.read(e,t),n.x=(0,m.q9)(n.x||0),n.y=(0,m.q9)(n.y||0),n.z=n.hasZ?(0,m.q9)(n.z||0):n.z,n}},{key:"equals",value:function(e){return!(0,p.Wi)(e)&&this.tilt===e.tilt&&this.heading===e.heading&&this.fov===e.fov&&this.position.equals(e.position)}}]),n}((0,l.J)(c.wq));(0,s._)([(0,h.Cb)({type:_.Z,json:{write:{isRequired:!0}}})],b.prototype,"position",void 0),(0,s._)([(0,g.c)("position")],b.prototype,"writePosition",null),(0,s._)([(0,v.r)("position")],b.prototype,"readPosition",null),(0,s._)([(0,h.Cb)({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),(0,f.p)((function(e){return u.BV.normalize((0,m.q9)(e))}))],b.prototype,"heading",void 0),(0,s._)([(0,h.Cb)({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),(0,f.p)((function(e){return(0,d.uZ)((0,m.q9)(e),-180,180)}))],b.prototype,"tilt",void 0),(0,s._)([(0,h.Cb)({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],b.prototype,"fov",void 0);var w=b=(0,s._)([(0,y.j)("esri.Camera")],b)},41649:function(e,t,n){n.d(t,{Z:function(){return X}});var i,r=n(15671),a=n(43144),o=n(97326),s=n(60136),l=n(92572),u=n(27366),c=n(29479),d=n(74165),p=n(15861),h=n(1413),f=n(37762),v=n(11752),y=n(61120),g=n(51995),m=n(80987),_=n(60354),b=n(41644),w=n(10064),k=n(46784),C=n(84652),M=n(54472),Z=n(93002),x=n(32718),I=n(66978),T=n(49861),S=n(25243),A=n(69912),F=n(31201),P=(n(63780),n(93169),n(27135)),L=i=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e){var i;return(0,r.Z)(this,n),(i=t.call(this,e)).type="none",i}return(0,a.Z)(n,[{key:"clone",value:function(){return new i({type:this.type})}}]),n}(k.wq);(0,u._)([(0,P.J)({none:"none",stayAbove:"stay-above"})],L.prototype,"type",void 0),L=i=(0,u._)([(0,A.j)("esri.ground.NavigationConstraint")],L);var E,R=n(94463),V=n(81219),O=E=function(e){(0,s.Z)(i,e);var t=(0,l.Z)(i);function i(e){var n;(0,r.Z)(this,i),(n=t.call(this,e)).opacity=1,n.shading=!R.Z.TERRAIN_USE_LEGACY_SHADING,n.surfaceColor=null,n.navigationConstraint=null,n.layers=new m.Z;return n.layers.on("after-add",(function(e){return function(e){e.parent&&e.parent!==(0,o.Z)(n)&&"remove"in e.parent&&e.parent.remove(e),e.parent=(0,o.Z)(n),"elevation"!==e.type&&"base-elevation"!==e.type&&x.Z.getLogger(n.declaredClass).error("Layer '".concat(e.title,", id:").concat(e.id,"' of type '").concat(e.type,"' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported."))}(e.item)})),n.layers.on("after-remove",(function(e){return function(e){e.parent=null}(e.item)})),n}return(0,a.Z)(i,[{key:"initialize",value:function(){var e=this;this.when().catch((function(t){x.Z.getLogger(e.declaredClass).error("#load()","Failed to load ground",t)})),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}},{key:"destroy",value:function(){var e,t=this.layers.removeAll(),n=(0,f.Z)(t);try{for(n.s();!(e=n.n()).done;){e.value.destroy()}}catch(i){n.e(i)}finally{n.f()}this.layers.destroy()}},{key:"normalizeCtorArgs",value:function(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e=(0,h.Z)({},e)).resourceInfo),e}},{key:"layers",set:function(e){this._set("layers",(0,_.Z)(e,this._get("layers")))}},{key:"writeLayers",value:function(e,t,n,i){var r=[];e?(i=(0,h.Z)((0,h.Z)({},i),{},{layerContainerType:"ground"}),e.forEach((function(e){if("write"in e){var t={};(0,b.sM)(e)().write(t,i)&&r.push(t)}else i&&i.messages&&i.messages.push(new w.Z("layer:unsupported","Layers (".concat(e.title,", ").concat(e.id,") of type '").concat(e.declaredClass,"' cannot be persisted in the ground"),{layer:e}))})),t.layers=r):t.layers=r}},{key:"load",value:function(e){return this.addResolvingPromise(this._loadFromSource(e)),Promise.resolve(this)}},{key:"loadAll",value:function(){var e=this;return(0,Z.G)(this,(function(t){t(e.layers)}))}},{key:"queryElevation",value:function(){var e=(0,p.Z)((0,d.Z)().mark((function e(t,i){var r,a,o,s;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load({signal:null===i||void 0===i?void 0:i.signal});case 2:return e.next=4,n.e(67165).then(n.bind(n,67165));case 4:return r=e.sent,a=r.ElevationQuery,(0,I.k_)(i),o=new a,s=this.layers.filter(D).toArray(),e.abrupt("return",o.queryAll(s,t,i));case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createElevationSampler",value:function(){var e=(0,p.Z)((0,d.Z)().mark((function e(t,i){var r,a,o,s;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load({signal:null===i||void 0===i?void 0:i.signal});case 2:return e.next=4,n.e(67165).then(n.bind(n,67165));case 4:return r=e.sent,a=r.ElevationQuery,(0,I.k_)(i),o=new a,s=this.layers.filter(D).toArray(),e.abrupt("return",o.createSamplerAll(s,t,i));case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"clone",value:function(){var e={opacity:this.opacity,surfaceColor:(0,C.d9)(this.surfaceColor),navigationConstraint:(0,C.d9)(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(e.loadStatus="loaded"),new E({resourceInfo:this.resourceInfo}).set(e)}},{key:"read",value:function(e,t){this.resourceInfo||this._set("resourceInfo",{data:e,context:t}),(0,v.Z)((0,y.Z)(i.prototype),"read",this).call(this,e,t)}},{key:"_loadFromSource",value:function(e){var t=this.resourceInfo;return t?this._loadLayersFromJSON(t.data,t.context,e):Promise.resolve()}},{key:"_loadLayersFromJSON",value:function(e,t,i){var r=this,a=t&&t.origin||"web-scene",o=t&&t.portal||null,s=t&&t.url||null;return Promise.all([n.e(46727),n.e(43139),n.e(20519)]).then(n.bind(n,20519)).then((function(t){var n=t.populateOperationalLayers;(0,I.k_)(i);var l=[];if(e.layers&&Array.isArray(e.layers)){var u={context:{origin:a,url:s,portal:o,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};l.push(n(r.layers,e.layers,u))}return(0,I.as)(l)})).then((function(){}))}}]),i}((0,k.eC)(M.Z));function D(e){return"elevation"===e.type||function(e){return e&&"createElevationSampler"in e}(e)}(0,u._)([(0,T.Cb)({json:{read:!1}})],O.prototype,"layers",null),(0,u._)([(0,F.c)("layers")],O.prototype,"writeLayers",null),(0,u._)([(0,T.Cb)({readOnly:!0})],O.prototype,"resourceInfo",void 0),(0,u._)([(0,T.Cb)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:S.z8,read:{reader:V.b,source:"transparency"},write:{writer:function(e,t){t.transparency=(0,V.a)(e)},target:"transparency"}}})],O.prototype,"opacity",void 0),(0,u._)([(0,T.Cb)({type:Boolean,nonNullable:!0,json:{read:!1}})],O.prototype,"shading",void 0),(0,u._)([(0,T.Cb)({type:g.Z,json:{type:[S.z8],write:function(e,t){t.surfaceColor=e.toJSON().slice(0,3)}}})],O.prototype,"surfaceColor",void 0),(0,u._)([(0,T.Cb)({type:L,json:{write:!0}})],O.prototype,"navigationConstraint",void 0);var N=O=E=(0,u._)([(0,A.j)("esri.Ground")],O),z=n(85015),B=n(77178),G=n(91505),q=n(92026),U=n(89125),W=n(37933);function j(e){var t,n;return!(null===e||void 0===e||!e.loaded||null===(t=(0,W.S1)(e))||void 0===t||null===(n=t.operations)||void 0===n||!n.supportsEditing||"editingEnabled"in e&&!(0,W.ln)(e))}var H=n(23037),Y=n(30219),K={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};var Q=n(84938),J=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e){var i;return(0,r.Z)(this,n),(i=t.call(this,e)).allLayers=new B.Z({getCollections:function(){var e,t,n;return[null===(e=i.basemap)||void 0===e?void 0:e.baseLayers,null===(t=i.ground)||void 0===t?void 0:t.layers,i.layers,null===(n=i.basemap)||void 0===n?void 0:n.referenceLayers]},getChildrenFunction:function(e){return"layers"in e?e.layers:null}}),i.allTables=(0,Y.a)((0,o.Z)(i)),i.basemap=null,i.editableLayers=new B.Z({getCollections:function(){return[i.allLayers]},itemFilterFunction:j}),i.ground=new N,i._basemapCache=(0,H.Df)(),i}return(0,a.Z)(n,[{key:"destroy",value:function(){var e,t;this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),null!==(e=this.ground)&&void 0!==e&&e.destroy(),null!==(t=this.basemap)&&void 0!==t&&t.destroy(),(0,H.Bf)(this._basemapCache),this._basemapCache=null}},{key:"castBasemap",value:function(e){return(0,H.se)(e,this._basemapCache)}},{key:"castGround",value:function(e){var t=function(e){var t=null;return"string"==typeof e?e in K?t=new N({resourceInfo:{data:{layers:[K[e]]}}}):x.Z.getLogger("esri.support.groundUtils").warn("Unable to find ground definition for: ".concat(e,'. Try "world-elevation"')):t=(0,S.se)(N,e),t}(e);return(0,q.Wi)(t)?this._get("ground"):t}},{key:"findLayerById",value:function(e){return this.allLayers.find((function(t){return t.id===e}))}},{key:"findTableById",value:function(e){return this.allTables.find((function(t){return t.id===e}))}}]),n}((0,n(16791).Q)((0,Q.K)(G.Z.EventedMixin(z.Z))));(0,u._)([(0,T.Cb)({readOnly:!0,dependsOn:[]})],J.prototype,"allLayers",void 0),(0,u._)([(0,T.Cb)({readOnly:!0})],J.prototype,"allTables",void 0),(0,u._)([(0,T.Cb)({type:c.default})],J.prototype,"basemap",void 0),(0,u._)([(0,U.p)("basemap")],J.prototype,"castBasemap",null),(0,u._)([(0,T.Cb)({readOnly:!0})],J.prototype,"editableLayers",void 0),(0,u._)([(0,T.Cb)({type:N,nonNullable:!0})],J.prototype,"ground",void 0),(0,u._)([(0,U.p)("ground")],J.prototype,"castGround",null);var X=J=(0,u._)([(0,A.j)("esri.Map")],J)},36721:function(e,t,n){n.d(t,{Z:function(){return _}});var i,r=n(15671),a=n(43144),o=n(60136),s=n(92572),l=n(27366),u=n(13058),c=n(59486),d=n(46784),p=n(92026),h=n(49861),f=n(89125),v=(n(63780),n(69912)),y=n(77981),g=i=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(e){var i;return(0,r.Z)(this,n),(i=t.call(this,e)).rotation=0,i.scale=0,i.targetGeometry=null,i.camera=null,i}return(0,a.Z)(n,[{key:"castRotation",value:function(e){return(e%=360)<0&&(e+=360),e}},{key:"clone",value:function(){return new i({rotation:this.rotation,scale:this.scale,targetGeometry:(0,p.pC)(this.targetGeometry)?this.targetGeometry.clone():null,camera:(0,p.pC)(this.camera)?this.camera.clone():null})}}]),n}(d.wq);function m(){return{enabled:!this.camera}}(0,l._)([(0,h.Cb)({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:m}}}}})],g.prototype,"rotation",void 0),(0,l._)([(0,f.p)("rotation")],g.prototype,"castRotation",null),(0,l._)([(0,h.Cb)({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:m}}}}})],g.prototype,"scale",void 0),(0,l._)([(0,h.Cb)({types:c.qM,json:{read:y.im,write:!0,origins:{"web-scene":{read:y.im,write:{overridePolicy:m}}}}})],g.prototype,"targetGeometry",void 0),(0,l._)([(0,h.Cb)({type:u.Z,json:{write:!0}})],g.prototype,"camera",void 0);var _=g=i=(0,l._)([(0,v.j)("esri.Viewpoint")],g)},89494:function(e,t,n){function i(){return[1,0,0,1,0,0]}function r(e){return[e[0],e[1],e[2],e[3],e[4],e[5]]}n.d(t,{a:function(){return r},c:function(){return i}});Object.freeze(Object.defineProperty({__proto__:null,clone:r,create:i,createView:function(e,t){return new Float64Array(e,t,6)},fromValues:function(e,t,n,i,r,a){return[e,t,n,i,r,a]}},Symbol.toStringTag,{value:"Module"}))},22753:function(e,t,n){n.d(t,{a:function(){return u},b:function(){return m},c:function(){return y},d:function(){return h},e:function(){return l},f:function(){return r},g:function(){return o},h:function(){return d},i:function(){return b},j:function(){return v},k:function(){return f},m:function(){return c},n:function(){return g},r:function(){return p},s:function(){return a},t:function(){return s}});var i=n(26277);function r(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function a(e,t,n,i,r,a,o,s,l,u){return e[0]=t,e[1]=n,e[2]=i,e[3]=r,e[4]=a,e[5]=o,e[6]=s,e[7]=l,e[8]=u,e}function o(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function s(e,t){if(e===t){var n=t[1],i=t[2],r=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=i,e[7]=r}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function l(e,t){var n=t[0],i=t[1],r=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],d=c*o-s*u,p=-c*a+s*l,h=u*a-o*l,f=n*d+i*p+r*h;return f?(f=1/f,e[0]=d*f,e[1]=(-c*i+r*u)*f,e[2]=(s*i-r*o)*f,e[3]=p*f,e[4]=(c*n-r*l)*f,e[5]=(-s*n+r*a)*f,e[6]=h*f,e[7]=(-u*n+i*l)*f,e[8]=(o*n-i*a)*f,e):null}function u(e,t){var n=t[0],i=t[1],r=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8];return e[0]=o*c-s*u,e[1]=r*u-i*c,e[2]=i*s-r*o,e[3]=s*l-a*c,e[4]=n*c-r*l,e[5]=r*a-n*s,e[6]=a*u-o*l,e[7]=i*l-n*u,e[8]=n*o-i*a,e}function c(e,t,n){var i=t[0],r=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],d=t[8],p=n[0],h=n[1],f=n[2],v=n[3],y=n[4],g=n[5],m=n[6],_=n[7],b=n[8];return e[0]=p*i+h*o+f*u,e[1]=p*r+h*s+f*c,e[2]=p*a+h*l+f*d,e[3]=v*i+y*o+g*u,e[4]=v*r+y*s+g*c,e[5]=v*a+y*l+g*d,e[6]=m*i+_*o+b*u,e[7]=m*r+_*s+b*c,e[8]=m*a+_*l+b*d,e}function d(e,t,n){var i=t[0],r=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],d=t[8],p=n[0],h=n[1];return e[0]=i,e[1]=r,e[2]=a,e[3]=o,e[4]=s,e[5]=l,e[6]=p*i+h*o+u,e[7]=p*r+h*s+c,e[8]=p*a+h*l+d,e}function p(e,t,n){var i=t[0],r=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],d=t[8],p=Math.sin(n),h=Math.cos(n);return e[0]=h*i+p*o,e[1]=h*r+p*s,e[2]=h*a+p*l,e[3]=h*o-p*i,e[4]=h*s-p*r,e[5]=h*l-p*a,e[6]=u,e[7]=c,e[8]=d,e}function h(e,t,n){var i=n[0],r=n[1],a=n[2];return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=r*t[3],e[4]=r*t[4],e[5]=r*t[5],e[6]=a*t[6],e[7]=a*t[7],e[8]=a*t[8],e}function f(e,t,n){var i=n[0],r=n[1];return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=r*t[3],e[4]=r*t[4],e[5]=r*t[5],e}function v(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function y(e,t){var n=t[0],i=t[1],r=t[2],a=t[3],o=n+n,s=i+i,l=r+r,u=n*o,c=i*o,d=i*s,p=r*o,h=r*s,f=r*l,v=a*o,y=a*s,g=a*l;return e[0]=1-d-f,e[3]=c-g,e[6]=p+y,e[1]=c+g,e[4]=1-u-f,e[7]=h-v,e[2]=p-y,e[5]=h+v,e[8]=1-u-d,e}function g(e,t){var n=t[0],i=t[1],r=t[2],a=t[4],o=t[5],s=t[6],l=t[8],u=t[9],c=t[10],d=c*o-s*u,p=-c*a+s*l,h=u*a-o*l,f=n*d+i*p+r*h;if(!f)return null;var v=1/f;return e[0]=d*v,e[1]=(-c*i+r*u)*v,e[2]=(s*i-r*o)*v,e[3]=p*v,e[4]=(c*n-r*l)*v,e[5]=(-s*n+r*a)*v,e[6]=h*v,e[7]=(-u*n+i*l)*v,e[8]=(o*n-i*a)*v,e}function m(e,t){var n=t[0],i=t[1],r=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],d=t[9],p=t[10],h=t[11],f=t[12],v=t[13],y=t[14],g=t[15],m=n*s-i*o,_=n*l-r*o,b=n*u-a*o,w=i*l-r*s,k=i*u-a*s,C=r*u-a*l,M=c*v-d*f,Z=c*y-p*f,x=c*g-h*f,I=d*y-p*v,T=d*g-h*v,S=p*g-h*y,A=m*S-_*T+b*I+w*x-k*Z+C*M;return A?(A=1/A,e[0]=(s*S-l*T+u*I)*A,e[1]=(l*x-o*S-u*Z)*A,e[2]=(o*T-s*x+u*M)*A,e[3]=(r*T-i*S-a*I)*A,e[4]=(n*S-r*x+a*Z)*A,e[5]=(i*x-n*T-a*M)*A,e[6]=(v*C-y*k+g*w)*A,e[7]=(y*b-f*C-g*_)*A,e[8]=(f*k-v*b+g*m)*A,e):null}function _(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e}function b(e){var t=(0,i.g)(),n=e[0],r=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],d=e[8];return Math.abs(1-(n*n+o*o+u*u))<=t&&Math.abs(1-(r*r+s*s+c*c))<=t&&Math.abs(1-(a*a+l*l+d*d))<=t}var w=c,k=_;Object.freeze(Object.defineProperty({__proto__:null,add:function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e},adjoint:u,copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},determinant:function(e){var t=e[0],n=e[1],i=e[2],r=e[3],a=e[4],o=e[5],s=e[6],l=e[7],u=e[8];return t*(u*a-o*l)+n*(-u*r+o*s)+i*(l*r-a*s)},equals:function(e,t){var n=e[0],r=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],d=e[8],p=t[0],h=t[1],f=t[2],v=t[3],y=t[4],g=t[5],m=t[6],_=t[7],b=t[8],w=(0,i.g)();return Math.abs(n-p)<=w*Math.max(1,Math.abs(n),Math.abs(p))&&Math.abs(r-h)<=w*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(a-f)<=w*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(o-v)<=w*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(s-y)<=w*Math.max(1,Math.abs(s),Math.abs(y))&&Math.abs(l-g)<=w*Math.max(1,Math.abs(l),Math.abs(g))&&Math.abs(u-m)<=w*Math.max(1,Math.abs(u),Math.abs(m))&&Math.abs(c-_)<=w*Math.max(1,Math.abs(c),Math.abs(_))&&Math.abs(d-b)<=w*Math.max(1,Math.abs(d),Math.abs(b))},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},frob:function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))},fromMat2d:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},fromMat4:r,fromQuat:y,fromRotation:function(e,t){var n=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=n,e[2]=0,e[3]=-n,e[4]=i,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},fromScaling:function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},fromTranslation:v,identity:o,invert:l,isOrthoNormal:b,mul:w,multiply:c,multiplyScalar:function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e},multiplyScalarAndAdd:function(e,t,n,i){return e[0]=t[0]+n[0]*i,e[1]=t[1]+n[1]*i,e[2]=t[2]+n[2]*i,e[3]=t[3]+n[3]*i,e[4]=t[4]+n[4]*i,e[5]=t[5]+n[5]*i,e[6]=t[6]+n[6]*i,e[7]=t[7]+n[7]*i,e[8]=t[8]+n[8]*i,e},normalFromMat4:m,normalFromMat4Legacy:g,projection:function(e,t,n){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/n,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e},rotate:p,scale:h,scaleByVec2:f,set:a,str:function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},sub:k,subtract:_,translate:d,transpose:s},Symbol.toStringTag,{value:"Module"}))},77178:function(e,t,n){n.d(t,{Z:function(){return v}});var i=n(37762),r=n(15671),a=n(43144),o=n(60136),s=n(92572),l=n(27366),u=n(80987),c=n(92026),d=(n(93169),n(10064),n(32718),n(3073),n(27088)),p=n(49861),h=(n(25243),n(63780),n(69912)),f=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(e){var i;return(0,r.Z)(this,n),(i=t.call(this,e)).getCollections=null,i}return(0,a.Z)(n,[{key:"initialize",value:function(){var e=this;this.own((0,d.EH)((function(){return e._refresh()})))}},{key:"destroy",value:function(){this.getCollections=null}},{key:"_refresh",value:function(){var e=(0,c.pC)(this.getCollections)?this.getCollections():null;if((0,c.Wi)(e))this.removeAll();else{var t,n=0,r=(0,i.Z)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;(0,c.pC)(a)&&(n=this._processCollection(n,a))}}catch(o){r.e(o)}finally{r.f()}this.splice(n,this.length)}}},{key:"_createNewInstance",value:function(e){return new u.Z(e)}},{key:"_processCollection",value:function(e,t){if(!t)return e;var n,r=this.itemFilterFunction?this.itemFilterFunction:function(e){return!!e},a=(0,i.Z)(t);try{for(a.s();!(n=a.n()).done;){var o=n.value;if(o){if(r(o)){var s=this.indexOf(o,e);s>=0?s!==e&&this.reorder(o,e):this.add(o,e),++e}if(this.getChildrenFunction){var l=this.getChildrenFunction(o);if(Array.isArray(l)){var u,c=(0,i.Z)(l);try{for(c.s();!(u=c.n()).done;){var d=u.value;e=this._processCollection(e,d)}}catch(p){c.e(p)}finally{c.f()}}else e=this._processCollection(e,l)}}}}catch(p){a.e(p)}finally{a.f()}return e}}]),n}(u.Z);(0,l._)([(0,p.Cb)()],f.prototype,"getCollections",void 0),(0,l._)([(0,p.Cb)()],f.prototype,"getChildrenFunction",void 0),(0,l._)([(0,p.Cb)()],f.prototype,"itemFilterFunction",void 0);var v=f=(0,l._)([(0,h.j)("esri.core.CollectionFlattener")],f)},17768:function(e,t,n){n.d(t,{BV:function(){return c},Q4:function(){return u},c5:function(){return l},pE:function(){return o}});var i=n(15671),r=n(43144),a=n(16889),o=function(){function e(t,n){(0,i.Z)(this,e),this.min=t,this.max=n,this.range=n-t}return(0,r.Z)(e,[{key:"ndiff",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Math.ceil((e-t)/this.range)*this.range+t}},{key:"_normalize",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return(n-=i)<e?n+=this.ndiff(e-n):n>t&&(n-=this.ndiff(n-t)),r&&n===t&&(n=e),n+i}},{key:"normalize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this._normalize(this.min,this.max,e,t,n)}},{key:"clamp",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(0,a.uZ)(e-t,this.min,this.max)+t}},{key:"monotonic",value:function(e,t,n){return e<t?t:t+this.ndiff(e-t,n)}},{key:"minimalMonotonic",value:function(e,t,n){return this._normalize(e,e+this.range,t,n)}},{key:"center",value:function(e,t,n){return t=this.monotonic(e,t,n),this.normalize((e+t)/2,n)}},{key:"diff",value:function(e,t,n){return this.monotonic(e,t,n)-e}},{key:"shortestSignedDiff",value:function(e,t){e=this.normalize(e);var n=(t=this.normalize(t))-e,i=t<e?this.minimalMonotonic(e,t)-e:t-this.minimalMonotonic(t,e);return Math.abs(n)<Math.abs(i)?n:i}},{key:"contains",value:function(e,t,n){return t=this.minimalMonotonic(e,t),(n=this.minimalMonotonic(e,n))>e&&n<t}}]),e}();function s(e){for(var t in e){var n=e[t];n instanceof Function&&(e[t]=n.bind(e))}return e}var l=s(new o(0,2*Math.PI)),u=s(new o(-Math.PI,Math.PI)),c=s(new o(0,360))},93002:function(e,t,n){n.d(t,{G:function(){return c},w:function(){return p}});var i=n(93433),r=n(74165),a=n(15861),o=n(14921),s=n(80987),l=n(54472),u=n(92026);function c(e,t){return d.apply(this,arguments)}function d(){return(d=(0,a.Z)((0,r.Z)().mark((function e(t,n){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.load();case 2:return e.abrupt("return",p(t,n));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e,t){return h.apply(this,arguments)}function h(){return h=(0,a.Z)((0,r.Z)().mark((function e(t,n){var c,d,p;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=[],d=function e(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var a=0,o=n;a<o.length;a++){var d=o[a];(0,u.Wi)(d)||(Array.isArray(d)?e.apply(void 0,(0,i.Z)(d)):s.Z.isCollection(d)?d.forEach((function(t){return e(t)})):l.Z.isLoadable(d)&&c.push(d))}},n(d),p=null,e.next=5,(0,o.UI)(c,function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,o.q6)(f(t)?t.loadAll():t.load());case 2:!1!==(n=e.sent).ok||p||(p=n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:if(!p){e.next=7;break}throw p.error;case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)}))),h.apply(this,arguments)}function f(e){return"loadAll"in e&&"function"==typeof e.loadAll}},14916:function(e,t,n){function i(e,t,n,i){var r=null,a=1e3;"number"==typeof t?(a=t,i=n):(r=null!==t&&void 0!==t?t:null,a=n);var o,s=0,l=function(){s=0,e.apply(i,o)},u=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r&&r.apply(i,t),o=t,a?s||(s=setTimeout(l,a)):l()};return u.remove=function(){s&&(clearTimeout(s),s=0)},u.forceUpdate=function(){s&&(clearTimeout(s),l())},u.hasPendingUpdates=function(){return!!s},u}n.d(t,{P:function(){return i}})},5163:function(e,t,n){n.d(t,{L4:function(){return C},LO:function(){return p},Rd:function(){return h},Ud:function(){return g},VG:function(){return d},Wv:function(){return v},Zv:function(){return _},_o:function(){return M},aC:function(){return b},h9:function(){return y},ld:function(){return w},mg:function(){return f},q6:function(){return m},sS:function(){return T},yc:function(){return k}});var i=n(59896),r=n(17768),a=n(16889),o=n(92026),s=n(643),l=n(68860),u=n(6291);function c(e,t,n){return e.units[t][n]}function d(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";return"".concat((0,u.uf)(t,{minimumFractionDigits:i,maximumFractionDigits:i,signDisplay:t>0?"never":"exceptZero"})," ").concat(c(e,n,r))}function p(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";return"".concat((0,u.uf)(t,{minimumFractionDigits:i,maximumFractionDigits:i,signDisplay:"exceptZero"})," ").concat(c(e,n,r))}function h(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr",a=(0,l.KU)(t,n);return d(e,(0,l.En)(t,n,a),a,i,r)}function f(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr",a=(0,l.KU)(t,n);return p(e,(0,l.En)(t,n,a),a,i,r)}function v(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr",a=(0,l.OG)(t,n);return d(e,(0,l.En)(t,n,a),a,i,r)}function y(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr",a=(0,l.OG)(t,n);return p(e,(0,l.En)(t,n,a),a,i,r)}function g(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr",a=(0,l.FN)(t,n);return d(e,(0,l.En)(t,n,a),a,i,r)}function m(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr",a=(0,l.FN)(t,n);return p(e,(0,l.En)(t,n,a),a,i,r)}function _(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr",a=(0,l.qv)(t,n);return d(e,(0,l.En)(t,n,a),a,i,r)}function b(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr",a=(0,l.qv)(t,n);return p(e,(0,l.En)(t,n,a),a,i,r)}function w(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr",a=(0,l.tQ)(t,n);return d(e,(0,l.En)(t,n,a),a,i,r)}function k(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr",a=(0,l.Yl)(t,n);return d(e,(0,l.En)(t,n,a),a,i,r)}function C(e,t,n,i,a){a=(0,o.Pt)(a,2);var s=r.BV.normalize(function(e,t,n){if(t===n)return e;switch(n){case"arithmetic":return function(e){return 90-e}(e);case"geographic":return function(e){return-e-90}(e)}}((0,l.En)(e,t,"degrees"),n,i),0,!0),c={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:a,minimumFractionDigits:a,signDisplay:s>0?"never":"exceptZero"};return s=x(s,c),(0,u.uf)(s,c)}function M(e,t,n,i,r){n!==i&&(e=-e);var a={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:r=(0,o.Pt)(r,2),minimumFractionDigits:r,signDisplay:"exceptZero"},s=(0,l.En)(e,t,"degrees")%360;return s=x(s,a),(0,u.uf)(s,a)}var Z=new Map;function x(e,t){var n=JSON.stringify(t),i=Z.get(n);return i||(i=new Intl.NumberFormat("en-US",t),Z.set(n,i)),/\-?\+?360/.test(i.format(e))?0:e}var I=["B","kB","MB","GB","TB"];function T(e,t){var n=0===t?0:Math.floor(Math.log(t)/Math.log(i.Y8.KILOBYTES));n=(0,a.uZ)(n,0,I.length-1);var r=(0,u.uf)(t/Math.pow(i.Y8.KILOBYTES,n),{maximumFractionDigits:2});return(0,s.gx)(e.units.bytes[I[n]],{fileSize:r})}},5354:function(e,t,n){n.d(t,{Ku:function(){return d},Wt:function(){return l},qC:function(){return v}});n(93169);var i,r=n(10064),a=n(92026),o=n(90724),s=n(25899);function l(e,t,n){var a=d(e),s=t,l=u(a,s,n);if(a){var c=o.Z.deriveUnitFromSR(a,e.spatialReference).heightUnit;if(!n&&c!==a.heightUnit){var p=new r.Z("layerview:unmatched-height-unit","The vertical units of the layer must match the horizontal units (".concat(c,")"),{horizontalUnit:c});return new r.Z("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:a,error:p})}}if(!function(e){return"heightModelInfo"in e&&null!=e.heightModelInfo||null!=e.spatialReference||!f(e)}(e)||l===i.Unsupported)return new r.Z("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:a});switch(l){case i.Units:var h=(null===a||void 0===a?void 0:a.heightUnit)||"unknown",v=(null===s||void 0===s?void 0:s.heightUnit)||"unknown",y=new r.Z("layerview:incompatible-height-unit","The vertical units of the layer (".concat(h,") must match the vertical units of the scene (").concat(v,")"),{layerUnit:h,sceneUnit:v});return new r.Z("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:a,sceneHeightModelInfo:s,error:y});case i.HeightModel:var g=(null===a||void 0===a?void 0:a.heightModel)||"unknown",m=(null===s||void 0===s?void 0:s.heightModel)||"unknown",_=new r.Z("layerview:incompatible-height-model","The height model of the layer (".concat(g,") must match the height model of the scene (").concat(m,")"),{layerHeightModel:g,sceneHeightModel:m});return new r.Z("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:a,sceneHeightModelInfo:s,error:_});case i.CRS:var b=(null===a||void 0===a?void 0:a.vertCRS)||"unknown",w=(null===s||void 0===s?void 0:s.vertCRS)||"unknown",k=new r.Z("layerview:incompatible-vertical-datum","The vertical datum of the layer (".concat(b,") must match the vertical datum of the scene (").concat(w,")"),{layerDatum:b,sceneDatum:w});return new r.Z("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:a,sceneHeightModelInfo:s,error:k})}return null}function u(e,t,n){if(!c(e)||!c(t))return i.Unsupported;if(null==e||null==t)return i.Ok;if(!n&&e.heightUnit!==t.heightUnit)return i.Units;if(e.heightModel!==t.heightModel)return i.HeightModel;switch(e.heightModel){case"gravity-related-height":return i.Ok;case"ellipsoidal":return e.vertCRS===t.vertCRS?i.Ok:i.CRS;default:return i.Unsupported}}function c(e){return null==e||null!=e.heightModel&&null!=e.heightUnit}function d(e){var t,n=e.url?(0,s.Qc)(e.url):void 0;return null==(null===(t=e.spatialReference)||void 0===t?void 0:t.vcsWkid)&&(0,a.pC)(n)&&"ImageServer"===n.serverType||!p(e)||!e.heightModelInfo?f(e)?o.Z.deriveUnitFromSR(g,e.spatialReference):null:e.heightModelInfo}function p(e){return"heightModelInfo"in e}function h(e){if("unknown"===e.type||!("capabilities"in e))return!1;switch(e.type){case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"oriented-imagery":case"wfs":case"knowledge-graph-sublayer":return!0;default:return!1}}function f(e){return h(e)?!!(e.capabilities&&e.capabilities.data&&e.capabilities.data.supportsZ):y(e)}function v(e){return null!=e.layers||y(e)||h(e)||p(e)}function y(e){switch(e.type){case"building-scene":case"elevation":case"integrated-mesh":case"point-cloud":case"scene":case"voxel":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"csv":case"dimension":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"knowledge-graph":case"link-chart":case"knowledge-graph-sublayer":case"line-of-sight":case"map-image":case"map-notes":case"media":case"ogc-feature":case"open-street-map":case"oriented-imagery":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}!function(e){e[e.Ok=0]="Ok",e[e.Units=1]="Units",e[e.HeightModel=2]="HeightModel",e[e.CRS=3]="CRS",e[e.Unsupported=4]="Unsupported"}(i||(i={}));var g=new o.Z({heightModel:"gravity-related-height"})},28970:function(e,t,n){n.d(t,{d:function(){return i}});var i="OBJECTID"},87165:function(e,t,n){n.d(t,{Z:function(){return g}});var i=n(15671),r=n(43144),a=n(60136),o=n(92572),s=n(27366),l=n(11582),u=n(46784),c=n(49861),d=(n(25243),n(63780),n(38511)),p=n(69912),h=n(31201),f=n(67755),v=n(12224),y=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).id=null,r.name=null,r.domains=null,r.templates=null,r}return(0,r.Z)(n,[{key:"readDomains",value:function(e){for(var t={},n=0,i=Object.keys(e);n<i.length;n++){var r=i[n];t[r]=(0,f.im)(e[r])}return t}},{key:"writeDomains",value:function(e,t){for(var n={},i=0,r=Object.keys(e);i<r.length;i++){var a,o=r[i];e[o]&&(n[o]=null===(a=e[o])||void 0===a?void 0:a.toJSON())}t.domains=n}}]),n}((0,l.J)(u.wq));(0,s._)([(0,c.Cb)({json:{write:!0}})],y.prototype,"id",void 0),(0,s._)([(0,c.Cb)({json:{write:!0}})],y.prototype,"name",void 0),(0,s._)([(0,c.Cb)({json:{write:!0}})],y.prototype,"domains",void 0),(0,s._)([(0,d.r)("domains")],y.prototype,"readDomains",null),(0,s._)([(0,h.c)("domains")],y.prototype,"writeDomains",null),(0,s._)([(0,c.Cb)({type:[v.Z],json:{write:!0}})],y.prototype,"templates",void 0);var g=y=(0,s._)([(0,p.j)("esri.layers.support.FeatureType")],y)},52410:function(e,t,n){n.d(t,{Z:function(){return c}});var i=n(37762),r=n(15671),a=n(43144),o=n(80031);function s(e){return"date"===e.type||"esriFieldTypeDate"===e.type}function l(e){return"oid"===e.type||"esriFieldTypeOID"===e.type}function u(e){return"global-id"===e.type||"esriFieldTypeGlobalID"===e.type}var c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if((0,r.Z)(this,e),this.fields=[],this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this.dateFields=[],this.numericFields=[],this._requiredFields=null,t){this.fields=t;var n,a=[],c=(0,i.Z)(t);try{for(c.s();!(n=c.n()).done;){var h=n.value,f=null===h||void 0===h?void 0:h.name,v=p(null===h||void 0===h?void 0:h.name);if(f&&v){var y=d(f);this._fieldsMap.set(f,h),this._fieldsMap.set(y,h),this._normalizedFieldsMap.set(v,h),a.push(y),s(h)?(this.dateFields.push(h),this._dateFieldsSet.add(h)):(0,o.H7)(h)&&(this._numericFieldsSet.add(h),this.numericFields.push(h)),l(h)||u(h)||(h.editable=null==h.editable||!!h.editable,h.nullable=null==h.nullable||!!h.nullable)}}}catch(g){c.e(g)}finally{c.f()}a.sort(),this.uid=a.join(",")}}return(0,a.Z)(e,[{key:"destroy",value:function(){this._fieldsMap.clear()}},{key:"requiredFields",get:function(){if(!this._requiredFields){this._requiredFields=[];var e,t=(0,i.Z)(this.fields);try{for(t.s();!(e=t.n()).done;){var n=e.value;l(n)||u(n)||n.nullable||void 0!==(0,o.os)(n)||this._requiredFields.push(n)}}catch(r){t.e(r)}finally{t.f()}}return this._requiredFields}},{key:"has",value:function(e){return null!=this.get(e)}},{key:"get",value:function(e){var t;if(e){var n=this._fieldsMap.get(e);return n||((n=null!==(t=this._fieldsMap.get(d(e)))&&void 0!==t?t:this._normalizedFieldsMap.get(p(e)))&&this._fieldsMap.set(e,n),n)}}},{key:"isDateField",value:function(e){return this._dateFieldsSet.has(this.get(e))}},{key:"isNumericField",value:function(e){return this._numericFieldsSet.has(this.get(e))}},{key:"normalizeFieldName",value:function(e){var t,n=this.get(e);if(n)return null!==(t=n.name)&&void 0!==t?t:void 0}}]),e}();function d(e){return e.trim().toLowerCase()}function p(e){var t,n;return null!==(t=null===(n=(0,o.q6)(e))||void 0===n?void 0:n.toLowerCase())&&void 0!==t?t:""}},77946:function(e,t,n){n.d(t,{F:function(){return p},e:function(){return c}});var i=n(1413),r=n(74165),a=n(15861),o=n(23084),s=n(5192),l=n(49818),u=n(21149);function c(e,t,n){return d.apply(this,arguments)}function d(){return d=(0,a.Z)((0,r.Z)().mark((function e(t,n,i){var a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p(t,n,i);case 2:return a=e.sent,e.abrupt("return",l.Z.fromJSON(a));case 4:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}function p(e,t,n){return h.apply(this,arguments)}function h(){return h=(0,a.Z)((0,r.Z)().mark((function e(t,n,a){var l,c,d,p,h;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=(0,o.en)(t),c=(0,i.Z)({},a),d=u.Z.from(n),e.next=5,(0,s.JT)(l,d,d.sourceSpatialReference,c);case 5:return p=e.sent,h=p.data,e.abrupt("return",h);case 8:case"end":return e.stop()}}),e)}))),h.apply(this,arguments)}},11812:function(e,t,n){n.d(t,{Z:function(){return y}});var i,r=n(15671),a=n(43144),o=n(60136),s=n(92572),l=n(27366),u=n(46784),c=n(49861),d=n(25243),p=(n(63780),n(69912));function h(e){var t=e.exifInfo,n=e.exifName,i=e.tagName;if(!t||!n||!i)return null;var r=t.find((function(e){return e.name===n}));return r?function(e){var t=e.tagName,n=e.tags;if(!n||!t)return null;var i=n.find((function(e){return e.name===t}));return i&&i.value||null}({tagName:i,tags:r.tags}):null}var f={1:{id:1,rotation:0,mirrored:!1},2:{id:2,rotation:0,mirrored:!0},3:{id:3,rotation:180,mirrored:!1},4:{id:4,rotation:180,mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}},v=i=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(e){var i;return(0,r.Z)(this,n),(i=t.call(this,e)).contentType=null,i.exifInfo=null,i.id=null,i.globalId=null,i.keywords=null,i.name=null,i.parentGlobalId=null,i.parentObjectId=null,i.size=null,i.url=null,i}return(0,a.Z)(n,[{key:"orientationInfo",get:function(){var e=h({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:this.exifInfo});return f[e]||null}},{key:"clone",value:function(){return new i({contentType:this.contentType,exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})}}]),n}(u.wq);(0,l._)([(0,c.Cb)({type:String})],v.prototype,"contentType",void 0),(0,l._)([(0,c.Cb)()],v.prototype,"exifInfo",void 0),(0,l._)([(0,c.Cb)({readOnly:!0})],v.prototype,"orientationInfo",null),(0,l._)([(0,c.Cb)({type:d.z8})],v.prototype,"id",void 0),(0,l._)([(0,c.Cb)({type:String})],v.prototype,"globalId",void 0),(0,l._)([(0,c.Cb)({type:String})],v.prototype,"keywords",void 0),(0,l._)([(0,c.Cb)({type:String})],v.prototype,"name",void 0),(0,l._)([(0,c.Cb)({json:{read:!1}})],v.prototype,"parentGlobalId",void 0),(0,l._)([(0,c.Cb)({json:{read:!1}})],v.prototype,"parentObjectId",void 0),(0,l._)([(0,c.Cb)({type:d.z8})],v.prototype,"size",void 0),(0,l._)([(0,c.Cb)({json:{read:!1}})],v.prototype,"url",void 0);var y=v=i=(0,l._)([(0,p.j)("esri.layers.support.AttachmentInfo")],v)},49818:function(e,t,n){n.d(t,{Z:function(){return x}});var i,r=n(29439),a=n(37762),o=n(15671),s=n(43144),l=n(60136),u=n(92572),c=n(27366),d=n(59486),p=n(52639),h=n(43404),f=n(46784),v=n(84652),y=n(92026),g=n(49861),m=(n(25243),n(38511)),_=n(69912),b=n(31201),w=n(78952),k=n(77981),C=n(83040),M=new h.X({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null}),Z=i=function(e){(0,l.Z)(n,e);var t=(0,u.Z)(n);function n(e){var i;return(0,o.Z)(this,n),(i=t.call(this,e)).displayFieldName=null,i.exceededTransferLimit=!1,i.features=[],i.fields=null,i.geometryType=null,i.hasM=!1,i.hasZ=!1,i.queryGeometry=null,i.spatialReference=null,i}return(0,s.Z)(n,[{key:"readFeatures",value:function(e,t){for(var n=w.Z.fromJSON(t.spatialReference),i=[],r=0;r<e.length;r++){var a=e[r],o=p.Z.fromJSON(a),s=a.geometry&&a.geometry.spatialReference;(0,y.pC)(o.geometry)&&!s&&(o.geometry.spatialReference=n);var l=a.aggregateGeometries,u=o.aggregateGeometries;if(l&&(0,y.pC)(u))for(var c in u){var d,h=u[c],f=null===(d=l[c])||void 0===d?void 0:d.spatialReference;(0,y.pC)(h)&&!f&&(h.spatialReference=n)}i.push(o)}return i}},{key:"writeGeometryType",value:function(e,t,n,i){if(e)M.write(e,t,n,i);else{var r=this.features;if(r){var o,s=(0,a.Z)(r);try{for(s.s();!(o=s.n()).done;){var l=o.value;if(l&&(0,y.pC)(l.geometry))return void M.write(l.geometry.type,t,n,i)}}catch(u){s.e(u)}finally{s.f()}}}}},{key:"readQueryGeometry",value:function(e,t){if(!e)return null;var n=!!e.spatialReference,i=(0,k.im)(e);return i&&!n&&t.spatialReference&&(i.spatialReference=w.Z.fromJSON(t.spatialReference)),i}},{key:"writeSpatialReference",value:function(e,t){if(e)t.spatialReference=e.toJSON();else{var n=this.features;if(n){var i,r=(0,a.Z)(n);try{for(r.s();!(i=r.n()).done;){var o=i.value;if(o&&(0,y.pC)(o.geometry)&&o.geometry.spatialReference)return void(t.spatialReference=o.geometry.spatialReference.toJSON())}}catch(s){r.e(s)}finally{r.f()}}}}},{key:"clone",value:function(){return new i(this.cloneProperties())}},{key:"cloneProperties",value:function(){return(0,v.d9)({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}},{key:"toJSON",value:function(e){var t=this.write();if(t.features&&Array.isArray(e)&&e.length>0)for(var n=0;n<t.features.length;n++){var i=t.features[n];if(i.geometry){var r=e&&e[n];i.geometry=r&&r.toJSON()||i.geometry}}return t}},{key:"quantize",value:function(e){for(var t=(0,r.Z)(e.scale,2),n=t[0],i=t[1],a=(0,r.Z)(e.translate,2),o=a[0],s=a[1],l=this.features,u=this._getQuantizationFunction(this.geometryType,(function(e){return Math.round((e-o)/n)}),(function(e){return Math.round((s-e)/i)})),c=0,d=l.length;c<d;c++)(null===u||void 0===u?void 0:u((0,y.Wg)(l[c].geometry)))||(l.splice(c,1),c--,d--);return this.transform=e,this}},{key:"unquantize",value:function(){var e=this.geometryType,t=this.features,n=this.transform;if(!n)return this;var i,o=(0,r.Z)(n.translate,2),s=o[0],l=o[1],u=(0,r.Z)(n.scale,2),c=u[0],d=u[1],p=this._getHydrationFunction(e,(function(e){return e*c+s}),(function(e){return l-e*d})),h=(0,a.Z)(t);try{for(h.s();!(i=h.n()).done;){var f=i.value.geometry;(0,y.pC)(f)&&p&&p(f)}}catch(v){h.e(v)}finally{h.f()}return this.transform=null,this}},{key:"_quantizePoints",value:function(e,t,n){for(var i,r,a=[],o=0,s=e.length;o<s;o++){var l=e[o];if(o>0){var u=t(l[0]),c=n(l[1]);u===i&&c===r||(a.push([u-i,c-r]),i=u,r=c)}else i=t(l[0]),r=n(l[1]),a.push([i,r])}return a.length>0?a:null}},{key:"_getQuantizationFunction",value:function(e,t,n){var i=this;return"point"===e?function(e){return e.x=t(e.x),e.y=n(e.y),e}:"polyline"===e||"polygon"===e?function(e){for(var r=(0,k.oU)(e)?e.rings:e.paths,a=[],o=0,s=r.length;o<s;o++){var l=r[o],u=i._quantizePoints(l,t,n);u&&a.push(u)}return a.length>0?((0,k.oU)(e)?e.rings=a:e.paths=a,e):null}:"multipoint"===e?function(e){var r=i._quantizePoints(e.points,t,n);return r&&r.length>0?(e.points=r,e):null}:"extent"===e?function(e){return e}:null}},{key:"_getHydrationFunction",value:function(e,t,n){return"point"===e?function(e){e.x=t(e.x),e.y=n(e.y)}:"polyline"===e||"polygon"===e?function(e){for(var i,r,a=(0,k.oU)(e)?e.rings:e.paths,o=0,s=a.length;o<s;o++)for(var l=a[o],u=0,c=l.length;u<c;u++){var d=l[u];u>0?(i+=d[0],r+=d[1]):(i=d[0],r=d[1]),d[0]=t(i),d[1]=n(r)}}:"extent"===e?function(e){e.xmin=t(e.xmin),e.ymin=n(e.ymin),e.xmax=t(e.xmax),e.ymax=n(e.ymax)}:"multipoint"===e?function(e){for(var i,r,a=e.points,o=0,s=a.length;o<s;o++){var l=a[o];o>0?(i+=l[0],r+=l[1]):(i=l[0],r=l[1]),l[0]=t(i),l[1]=n(r)}}:null}}]),n}(f.wq);(0,c._)([(0,g.Cb)({type:String,json:{write:!0}})],Z.prototype,"displayFieldName",void 0),(0,c._)([(0,g.Cb)({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],Z.prototype,"exceededTransferLimit",void 0),(0,c._)([(0,g.Cb)({type:[p.Z],json:{write:!0}})],Z.prototype,"features",void 0),(0,c._)([(0,m.r)("features")],Z.prototype,"readFeatures",null),(0,c._)([(0,g.Cb)({type:[C.Z],json:{write:!0}})],Z.prototype,"fields",void 0),(0,c._)([(0,g.Cb)({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:M.read}}})],Z.prototype,"geometryType",void 0),(0,c._)([(0,b.c)("geometryType")],Z.prototype,"writeGeometryType",null),(0,c._)([(0,g.Cb)({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],Z.prototype,"hasM",void 0),(0,c._)([(0,g.Cb)({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],Z.prototype,"hasZ",void 0),(0,c._)([(0,g.Cb)({types:d.qM,json:{write:!0}})],Z.prototype,"queryGeometry",void 0),(0,c._)([(0,m.r)("queryGeometry")],Z.prototype,"readQueryGeometry",null),(0,c._)([(0,g.Cb)({type:w.Z,json:{write:!0}})],Z.prototype,"spatialReference",void 0),(0,c._)([(0,b.c)("spatialReference")],Z.prototype,"writeSpatialReference",null),(0,c._)([(0,g.Cb)({json:{write:!0}})],Z.prototype,"transform",void 0),(Z=i=(0,c._)([(0,_.j)("esri.rest.support.FeatureSet")],Z)).prototype.toJSON.isDefaultToJSON=!0;var x=Z},37319:function(e,t,n){n.d(t,{J:function(){return d}});var i=n(15671),r=n(43144),a=n(60136),o=n(92572),s=n(27366),l=n(32718),u=n(92026),c=(n(25243),n(63780),n(10064),n(93169),n(69912)),d=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).handles.add(r.on("before-add",(function(e){(0,u.Wi)(e.item)||e.item.parent===r.owner&&(l.Z.getLogger(r.declaredClass).warn("Analysis inside the collection must be unique. Not adding this element again."),e.preventDefault())}))),r}return(0,r.Z)(n,[{key:"_own",value:function(e){e.parent=this.owner}},{key:"_release",value:function(e){e.parent=null}}]),n}(n(68748).a);d=(0,s._)([(0,c.j)("esri.support.AnalysesCollection")],d)},84938:function(e,t,n){n.d(t,{K:function(){return m}});var i=n(37762),r=n(15671),a=n(43144),o=n(97326),s=n(60136),l=n(92572),u=n(27366),c=n(80987),d=n(60354),p=n(32718),h=n(66978),f=n(49861),v=(n(25243),n(63780),n(69912)),y=n(30651);function g(e,t,n){var i,r;if(e)for(var a=0,o=e.length;a<o;a++){var s;if((i=e.getItemAt(a))[t]===n)return i;if("group"===(null===(s=i)||void 0===s?void 0:s.type)&&(r=g(i.layers,t,n)))return r}}var m=function(e){var t=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];(e=t.call.apply(t,[this].concat(a))).layers=new c.Z;var l=function(e){e.parent&&"remove"in e.parent&&e.parent.remove(e)},u=function(t){t.parent=(0,o.Z)(e),e.layerAdded(t),"elevation"!==t.type&&"base-elevation"!==t.type||p.Z.getLogger(e.declaredClass).error("Layer 'title:".concat(t.title,", id:").concat(t.id,"' of type '").concat(t.type,"' is not supported as an operational layer and will therefore be ignored."))},d=function(t){t.parent=null,e.layerRemoved(t)};return e.layers.on("before-add",(function(e){return l(e.item)})),e.layers.on("after-add",(function(e){return u(e.item)})),e.layers.on("after-remove",(function(e){return d(e.item)})),e}return(0,a.Z)(n,[{key:"destroy",value:function(){var e,t=this.layers.removeAll(),n=(0,i.Z)(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;this.layerRemoved(r),r.destroy()}}catch(a){n.e(a)}finally{n.f()}this.layers.destroy()}},{key:"layers",set:function(e){this._set("layers",(0,d.Z)(e,this._get("layers")))}},{key:"add",value:function(e,t){var n=this,i=this.layers;if(t=i.getNextIndex(t),e instanceof y.Z){var r=e;r.parent===this?this.reorder(r,t):i.add(r,t)}else(0,h.y8)(e)?e.then((function(e){n.destroyed||n.add(e,t)})):p.Z.getLogger(this.declaredClass).error("#add()","The item being added is not a Layer or a Promise that resolves to a Layer.")}},{key:"addMany",value:function(e,t){var n=this,i=this.layers,r=i.getNextIndex(t);e.slice().forEach((function(e){e.parent!==n?(i.add(e,r),r+=1):n.reorder(e,r)}))}},{key:"findLayerById",value:function(e){return g(this.layers,"id",e)}},{key:"findLayerByUid",value:function(e){return g(this.layers,"uid",e)}},{key:"remove",value:function(e){return this.layers.remove(e)}},{key:"removeMany",value:function(e){return this.layers.removeMany(e)}},{key:"removeAll",value:function(){return this.layers.removeAll()}},{key:"reorder",value:function(e,t){return this.layers.reorder(e,t)}},{key:"layerAdded",value:function(e){}},{key:"layerRemoved",value:function(e){}}]),n}(e);return(0,u._)([(0,f.Cb)()],t.prototype,"layers",null),t=(0,u._)([(0,v.j)("esri.support.LayersMixin")],t)}},16791:function(e,t,n){n.d(t,{Q:function(){return y}});var i=n(37762),r=n(15671),a=n(43144),o=n(97326),s=n(60136),l=n(92572),u=n(27366),c=n(80987),d=n(60354),p=n(32718),h=n(49861),f=(n(25243),n(63780),n(69912));function v(e,t,n){if(e)for(var i=0,r=e.length;i<r;i++){var a=e.getItemAt(i);if(a[t]===n)return a;if("group"===(null===a||void 0===a?void 0:a.type)){var o=v(a.tables,t,n);if(o)return o}}}var y=function(e){var t=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).tables=new c.Z,e.tables.on("after-add",(function(t){var n=t.item;n.parent&&n.parent!==(0,o.Z)(e)&&"tables"in n.parent&&n.parent.tables.remove(n),n.parent=(0,o.Z)(e),"feature"!==n.type&&p.Z.getLogger(e.declaredClass).error("Layer 'title:".concat(n.title,", id:").concat(n.id,"' of type '").concat(n.type,"' is not supported as a table and will therefore be ignored."))})),e.tables.on("after-remove",(function(e){e.item.parent=null})),e}return(0,a.Z)(n,[{key:"destroy",value:function(){var e,t=this.tables.removeAll(),n=(0,i.Z)(t);try{for(n.s();!(e=n.n()).done;){e.value.destroy()}}catch(r){n.e(r)}finally{n.f()}this.tables.destroy()}},{key:"tables",set:function(e){this._set("tables",(0,d.Z)(e,this._get("tables")))}},{key:"findTableById",value:function(e){return v(this.tables,"id",e)}},{key:"findTableByUid",value:function(e){return v(this.tables,"uid",e)}}]),n}(e);return(0,u._)([(0,h.Cb)()],t.prototype,"tables",null),t=(0,u._)([(0,f.j)("esri.support.TablesMixin")],t)}},68954:function(e,t,n){n.d(t,{g:function(){return s},s:function(){return u}});var i=n(74165),r=n(15861),a=n(65905),o=n(41201);function s(e){return l.apply(this,arguments)}function l(){return l=(0,r.Z)((0,i.Z)().mark((function e(t){var n,r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return n=t.includes("-vector")?t.slice(0,t.indexOf("-vector")):t,e.next=5,(0,o.ME)("esri/t9n/basemaps");case 5:return r=e.sent,e.abrupt("return",r[t]||r[n]);case 7:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}var u={streets:{id:"streets",classic:!0,deprecated:!0,get thumbnailUrl(){return(0,a.V)("esri/images/basemap/streets.jpg")},baseMapLayers:[{id:"streets-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Street Map",showLegend:!1,visibility:!0,opacity:1}]},satellite:{id:"satellite",classic:!0,get thumbnailUrl(){return(0,a.V)("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",classic:!0,get thumbnailUrl(){return(0,a.V)("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json",layerType:"VectorTileLayer",title:"Hybrid Reference Layer",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",classic:!0,get thumbnailUrl(){return(0,a.V)("esri/images/basemap/terrain.jpg")},baseMapLayers:[{id:"terrain-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Terrain Base",showLegend:!1,visibility:!0,opacity:1},{id:"terrain-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Reference Overlay",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},topo:{id:"topo",classic:!0,deprecated:!0,get thumbnailUrl(){return(0,a.V)("esri/images/basemap/topo.jpg")},baseMapLayers:[{id:"topo-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Topo Map",showLegend:!1,visibility:!0,opacity:1}]},gray:{id:"gray",classic:!0,deprecated:!0,get thumbnailUrl(){return(0,a.V)("esri/images/basemap/gray.jpg")},baseMapLayers:[{id:"gray-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Light Gray Base",showLegend:!1,visibility:!0,opacity:1},{id:"gray-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Light Gray Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},"dark-gray":{id:"dark-gray",classic:!0,deprecated:!0,get thumbnailUrl(){return(0,a.V)("esri/images/basemap/dark-gray.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Dark Gray Base",showLegend:!1,visibility:!0,opacity:1},{id:"dark-gray-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Dark Gray Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},oceans:{id:"oceans",classic:!0,get thumbnailUrl(){return(0,a.V)("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},"national-geographic":{id:"national-geographic",classic:!0,deprecated:!0,get thumbnailUrl(){return(0,a.V)("esri/images/basemap/national-geographic.jpg")},baseMapLayers:[{id:"national-geographic-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer",title:"NatGeo World Map",showLegend:!1,layerType:"ArcGISTiledMapServiceLayer",visibility:!0,opacity:1}]},osm:{id:"osm",classic:!0,get thumbnailUrl(){return(0,a.V)("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",classic:!0,get thumbnailUrl(){return(0,a.V)("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},"gray-vector":{id:"gray-vector",classic:!0,get thumbnailUrl(){return(0,a.V)("esri/images/basemap/gray-vector.jpg")},baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},"streets-vector":{id:"streets-vector",classic:!0,get thumbnailUrl(){return(0,a.V)("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,opacity:1}]},"topo-vector":{id:"topo-vector",classic:!0,get thumbnailUrl(){return(0,a.V)("esri/images/basemap/topo-vector.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},"streets-night-vector":{id:"streets-night-vector",classic:!0,get thumbnailUrl(){return(0,a.V)("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",classic:!0,get thumbnailUrl(){return(0,a.V)("esri/images/basemap/streets-relief.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",classic:!0,get thumbnailUrl(){return(0,a.V)("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},"arcgis-imagery":{get thumbnailUrl(){return(0,a.V)("esri/images/basemap/hybrid.jpg")},title:"Imagery Hybrid",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-imagery-standard":{get thumbnailUrl(){return(0,a.V)("esri/images/basemap/satellite.jpg")},title:"Imagery",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"}]},"arcgis-imagery-labels":{title:"Hybrid [Reference]",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-light-gray":{get thumbnailUrl(){return(0,a.V)("esri/images/basemap/gray-vector.jpg")},title:"Light Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Base",title:"Light Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Labels",title:"Light Gray Canvas Labels",isReference:!0}]},"arcgis-dark-gray":{get thumbnailUrl(){return(0,a.V)("esri/images/basemap/dark-gray.jpg")},title:"Dark Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Base",title:"Dark Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Labels",title:"Dark Gray Canvas Labels",isReference:!0}]},"arcgis-navigation":{get thumbnailUrl(){return(0,a.V)("esri/images/basemap/streets-navigation.jpg")},title:"Navigation",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Navigation",title:"World Navigation Map"}]},"arcgis-navigation-night":{title:"Navigation (Dark Mode)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:NavigationNight",title:"World Navigation Map (Dark Mode)"}]},"arcgis-streets":{get thumbnailUrl(){return(0,a.V)("esri/images/basemap/streets-vector.jpg")},title:"Streets",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Streets",title:"World Street Map"}]},"arcgis-streets-night":{get thumbnailUrl(){return(0,a.V)("esri/images/basemap/streets-night.jpg")},title:"Streets (Night)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsNight",title:"World Street Map (Night)"}]},"arcgis-streets-relief":{get thumbnailUrl(){return(0,a.V)("esri/images/basemap/streets-relief.jpg")},title:"Streets (with Relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsRelief:Base",title:"World Street Map (with Relief)"}]},"arcgis-topographic":{get thumbnailUrl(){return(0,a.V)("esri/images/basemap/topo.jpg")},title:"Topographic",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Topographic:Base",title:"World Topographic Map"}]},"arcgis-oceans":{get thumbnailUrl(){return(0,a.V)("esri/images/basemap/oceans.jpg")},title:"Oceans",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Ocean Base",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Oceans:Labels",title:"World Ocean Reference",isReference:!0}]},"osm-standard":{title:"OpenStreetMap",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Standard",title:"OpenStreetMap"}]},"osm-standard-relief":{title:"OpenStreetMap (with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StandardRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-streets":{title:"OpenStreetMap (Streets)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Streets",title:"OpenStreetMap (Streets)"}]},"osm-streets-relief":{title:"OpenStreetMap (Streets with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StreetsRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-light-gray":{title:"OpenStreetMap (Light Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Base",title:"OSM (Light Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Labels",title:"OSM (Light Gray Reference)",isReference:!0}]},"osm-dark-gray":{title:"OpenStreetMap (Dark Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Base",title:"OSM (Dark Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Labels",title:"OSM (Dark Gray Reference)",isReference:!0}]},"arcgis-terrain":{title:"Terrain with Labels",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Base",title:"World Terrain Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Detail",title:"World Terrain Reference",isReference:!0}]},"arcgis-community":{title:"Community",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Community",title:"Community"}]},"arcgis-charted-territory":{title:"Charted Territory",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ChartedTerritory:Base",title:"Charted Territory"}]},"arcgis-colored-pencil":{title:"Colored Pencil",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ColoredPencil",title:"Colored Pencil"}]},"arcgis-nova":{title:"Nova",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Nova",title:"Nova"}]},"arcgis-modern-antique":{title:"Modern Antique",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ModernAntique:Base",title:"Modern Antique"}]},"arcgis-midcentury":{title:"Mid-Century",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Midcentury",title:"Mid-Century"}]},"arcgis-newspaper":{title:"Newspaper",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Newspaper",title:"Newspaper"}]},"arcgis-hillshade-light":{title:"Hillshade",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"}]},"arcgis-hillshade-dark":{title:"Hillshade (Dark)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade (Dark)",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade_Dark/MapServer"}]},"arcgis-human-geography":{title:"Human Geography",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Base",title:"Human Geography Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Detail",title:"Human Geography Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Label",title:"Human Geography Label",isReference:!0}]},"arcgis-human-geography-dark":{title:"Human Geography (Dark)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Base",title:"Human Geography Dark Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Detail",title:"Human Geography Dark Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Label",title:"Human Geography Dark Label",isReference:!0}]}}},23037:function(e,t,n){n.d(t,{Bf:function(){return h},Df:function(){return p},Us:function(){return g},aL:function(){return y},se:function(){return f},zb:function(){return v}});var i=n(29439),r=n(29479),a=n(42265),o=(n(80987),n(32718)),s=n(92026),l=n(35995),u=n(25243),c=n(68954),d=o.Z.getLogger("esri.support.basemapUtils");function p(){return{}}function h(e){for(var t in e){var n=e[t];!1===(null===n||void 0===n?void 0:n.destroyed)&&n.destroy(),delete e[t]}}function f(e,t){var n,o;if("string"==typeof e){if(!(e in c.s)){var s=Object.entries(c.s).filter((function(e){var t=(0,i.Z)(e,2),n=(t[0],t[1]);return a.Z.apiKey&&!n.classic||!a.Z.apiKey&&n.classic&&!n.deprecated})).map((function(e){var t=(0,i.Z)(e,1)[0];return'"'.concat(t,'"')})).join(", ");return d.warn("Unable to find basemap definition for: ".concat(e,". Try one of these: ").concat(s)),null}t&&(o=t[e]),o||(o=r.default.fromId(e),t&&(t[e]=o))}else o=(0,u.se)(r.default,e);return null!==(n=o)&&void 0!==n&&n.destroyed&&(d.warn("The provided basemap is already destroyed",{basemap:o}),o=null),o}function v(e){return!(null===e||void 0===e||!e.baseLayers.concat(e.referenceLayers).some(y))}function y(e){if(_(e.url))return!0;if("vector-tile"===e.type)for(var t in e.sourceNameToSource){var n;if(_(null===(n=e.sourceNameToSource[t])||void 0===n?void 0:n.sourceUrl))return!0}return!1}function g(e,t){var n,i,r;if((0,s.Wi)(t)||(0,s.Wi)(e))return{spatialReference:null,updating:!1};if("not-loaded"===t.loadStatus)return t.load(),{spatialReference:null,updating:!0};if(t.spatialReference)return{spatialReference:t.spatialReference,updating:!1};if(0===t.baseLayers.length)return{spatialReference:null,updating:!1};var a=t.baseLayers.getItemAt(0);switch(a.loadStatus){case"not-loaded":a.load();case"loading":return{spatialReference:null,updating:!0};case"failed":return{spatialReference:null,updating:!1}}var o=(("supportedSpatialReferences"in a?a.supportedSpatialReferences:null)||["tileInfo"in a?null===(n=a.tileInfo)||void 0===n?void 0:n.spatialReference:a.spatialReference]).filter(Boolean),l=e.spatialReference;return l?{spatialReference:null!==(i=null!==(r=o.find((function(e){return l.equals(e)})))&&void 0!==r?r:o[0])&&void 0!==i?i:null,updating:!1}:{spatialReference:o[0],updating:!1}}var m=/^(basemaps|ibasemaps).*-api\.arcgis\.com$/i;function _(e){if(!e)return!1;var t=new l.R9((0,l.hF)(e));return!!t.authority&&m.test(t.authority)}},30219:function(e,t,n){n.d(t,{a:function(){return r}});var i=n(77178);function r(e){return new i.Z({getCollections:function(){return[e.tables,e.layers]},getChildrenFunction:function(e){var t=[];return"tables"in e&&t.push(e.tables),"layers"in e&&t.push(e.layers),t},itemFilterFunction:function(e){var t=e.parent;return!!t&&"tables"in t&&t.tables.includes(e)}})}},29931:function(e,t,n){n.d(t,{Z:function(){return T}});var i=n(15671),r=n(43144),a=n(60136),o=n(92572),s=n(27366),l=(n(59486),n(36721)),u=n(46784),c=n(49861),d=(n(25243),n(63780),n(69912)),p=n(26277),h=n(22018),f=n(11245),v=n(89494),y=n(22753),g=n(23588),m=n(88396),_=n(15245),b=n(6394);function w(e){return function(e){return e instanceof Float32Array&&e.length>=2}(e)||function(e){return Array.isArray(e)&&e.length>=2}(e)}var k,C=n(86226),M=n(53866),Z=n(585),x=[0,0],I=k=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e))._viewpoint2D={center:(0,b.a)(),rotation:0,scale:0,spatialReference:void 0},r.center=[0,0],r.extent=new M.Z,r.id=0,r.inverseTransform=(0,v.c)(),r.resolution=0,r.rotation=0,r.scale=0,r.transform=(0,v.c)(),r.transformNoRotation=(0,v.c)(),r.displayMat3=(0,g.c)(),r.displayViewMat3=(0,g.c)(),r.viewMat3=(0,g.c)(),r.viewMat2d=(0,f.c)(),r.worldScreenWidth=0,r.size=[0,0],r}return(0,r.Z)(n,[{key:"pixelRatio",set:function(e){this._set("pixelRatio",e),this._update()}},{key:"size",set:function(e){this._set("size",e),this._update()}},{key:"viewpoint",set:function(e){if(e){var t=this._viewpoint2D,n=e.targetGeometry;t.center[0]=n.x,t.center[1]=n.y,t.rotation=e.rotation,t.scale=e.scale,t.spatialReference=n.spatialReference}this._update()}},{key:"copy",value:function(e){var t=this.size,n=this.viewpoint;return n&&t?(this.viewpoint=(0,C.JG)(n,e.viewpoint),this._set("size",(0,m.c)(t,e.size))):(this.viewpoint=e.viewpoint.clone(),this._set("size",[e.size[0],e.size[1]])),this._set("pixelRatio",e.pixelRatio),this}},{key:"clone",value:function(){return new k({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}},{key:"toMap",value:function(e,t,n){return w(t)?(0,m.t)(e,t,this.inverseTransform):(x[0]=t,x[1]=n,(0,m.t)(e,x,this.inverseTransform))}},{key:"toScreen",value:function(e,t,n){return w(t)?(0,m.t)(e,t,this.transform):(x[0]=t,x[1]=n,(0,m.t)(e,x,this.transform))}},{key:"toScreenNoRotation",value:function(e,t,n){return w(t)?(0,m.t)(e,t,this.transformNoRotation):(x[0]=t,x[1]=n,(0,m.t)(e,x,this.transformNoRotation))}},{key:"getScreenTransform",value:function(e,t){var n=this._viewpoint2D.center,i=this._get("pixelRatio")||1,r=this._get("size");return(0,C.Rb)(e,n,r,t,0,i),e}},{key:"_update",value:function(){var e=this._viewpoint2D,t=e.center,n=e.spatialReference,i=e.scale,r=e.rotation,a=this._get("pixelRatio")||1,o=this._get("size"),s=new l.Z({targetGeometry:new Z.Z(t[0],t[1],n),scale:i,rotation:r});if(this._set("viewpoint",s),o&&n&&i){this.resolution=(0,C.uG)(s),this.rotation=r,this.scale=i,this.spatialReference=n,(0,m.c)(this.center,t);var u=0!==o[0]?2/o[0]:0,c=0!==o[1]?-2/o[1]:0;(0,y.s)(this.displayMat3,u,0,0,0,c,0,-1,1,1);var d=(0,y.g)(this.viewMat3),f=(0,_.f)(o[0]/2,o[1]/2),v=(0,_.f)(-o[0]/2,-o[1]/2),g=(0,p.t)(r);(0,y.h)(d,d,f),(0,y.r)(d,d,g),(0,y.h)(d,d,v),(0,y.m)(this.displayViewMat3,this.displayMat3,d);var b=(0,h.a)(this.viewMat2d,f);return(0,h.r)(b,b,g),(0,h.t)(b,b,v),(0,C.bk)(this.extent,s,o),(0,C.Ck)(this.transform,s,o,a),(0,h.c)(this.inverseTransform,this.transform),(0,C.Jp)(this.transformNoRotation,s,o,a),this.worldScreenWidth=(0,C.L2)(this.spatialReference,this.resolution),this._set("id",this.id+1),this}}}]),n}(u.wq);(0,s._)([(0,c.Cb)({readOnly:!0})],I.prototype,"id",void 0),(0,s._)([(0,c.Cb)({value:1,json:{write:!0}})],I.prototype,"pixelRatio",null),(0,s._)([(0,c.Cb)({json:{write:!0}})],I.prototype,"size",null),(0,s._)([(0,c.Cb)()],I.prototype,"spatialReference",void 0),(0,s._)([(0,c.Cb)({type:l.Z,json:{write:!0}})],I.prototype,"viewpoint",null);var T=I=k=(0,s._)([(0,d.j)("esri.views.2d.ViewState")],I)},64634:function(e,t,n){n.d(t,{Z:function(){return h}});var i=n(15671),r=n(43144),a=n(60136),o=n(92572),s=n(27366),l=n(51995),u=n(85015),c=n(49861),d=(n(25243),n(63780),n(69912)),p=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(){var e;return(0,i.Z)(this,n),(e=t.apply(this,arguments)).color=new l.Z([0,255,255]),e.haloOpacity=1,e.fillOpacity=.25,e}return(0,r.Z)(n,[{key:"equals",value:function(e){return this.color.equals(e.color)&&(this.haloColor||this.color).equals(e.haloColor||e.color)&&this.haloOpacity===e.haloOpacity&&this.fillOpacity===e.fillOpacity}}]),n}(u.Z);(0,s._)([(0,c.Cb)({type:l.Z})],p.prototype,"color",void 0),(0,s._)([(0,c.Cb)({type:l.Z})],p.prototype,"haloColor",void 0),(0,s._)([(0,c.Cb)()],p.prototype,"haloOpacity",void 0),(0,s._)([(0,c.Cb)()],p.prototype,"fillOpacity",void 0);var h=p=(0,s._)([(0,d.j)("esri.views.2d.support.HighlightOptions")],p)},84786:function(e,t,n){n.d(t,{T:function(){return a}});var i=n(15671),r=n(43144),a=function(){function e(){(0,i.Z)(this,e),this._names=new Map}return(0,r.Z)(e,[{key:"begin",value:function(e){this._names.has(e)||(this._names.set(e,!1),e.includes("Brush")&&this.record("Esri.FirstDraw"),performance.mark("Esri.".concat(e,".Start")))}},{key:"end",value:function(e){this._names.has(e)&&!this._names.get(e)&&(this._names.set(e,!0),performance.mark("Esri.".concat(e,".End")))}},{key:"record",value:function(e){this._names.has(e)||(this._names.set(e,!0),performance.mark("Esri.".concat(e)))}}]),e}()},5131:function(e,t,n){var i=n(15671),r=n(43144),a=n(60136),o=n(92572),s=n(27366),l=n(85015),u=n(92026),c=n(49861),d=(n(25243),n(63780),n(69912)),p=n(88396),h=n(38164);var f=new Set,v=[],y=new Map,g=[0,0],m=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e))._keyToItem=new Map,r.concurrency=6,r.strategy="scale-first",r.tileInfoView=null,r}return(0,r.Z)(n,[{key:"initialize",value:function(){var e=this,t=this.concurrency,n=this.process;this._queue=new h.e({concurrency:t,process:function(t,i){var r=e._keyToItem.get(t);return n(r,{signal:i})},peeker:function(e){return e.values().next().value}})}},{key:"destroy",value:function(){this.clear(),this._queue=(0,u.SC)(this._queue)}},{key:"length",get:function(){return this._queue?this._queue.length:0}},{key:"onGoingCount",get:function(){return this._keyToItem.size}},{key:"updating",get:function(){return this.length>0||this.onGoingCount>0}},{key:"abort",value:function(e){var t="string"==typeof e?e:e.id;this._queue.abort(t)}},{key:"clear",value:function(){this._queue.clear(),this._keyToItem.clear(),this.notifyChange("updating")}},{key:"has",value:function(e){return"string"==typeof e?this._keyToItem.has(e):this._keyToItem.has(e.id)}},{key:"isOngoing",value:function(e){var t="string"==typeof e?e:e.id;return this.has(t)&&this._queue.isOngoing(t)}},{key:"pause",value:function(){this._queue.pause()}},{key:"push",value:function(e,t){var n=this,i=e.key.id+"-"+t;if(this.has(i))return this.get(i);var r=this._queue.push(i),a=function(){n._keyToItem.delete(i),n.notifyChange("updating")};return this._keyToItem.set(i,e),r.then(a,a),this.notifyChange("updating"),r}},{key:"reset",value:function(){this._queue.reset(),this.notifyChange("updating")}},{key:"resume",value:function(){this._queue.resume()}},{key:"_peekByScaleFirst",value:function(e){var t=this;if(!this.state)return e.values().next().value;var n=this.tileInfoView,i=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY;e.forEach((function(e){var n=t._keyToItem.get(e),a=t.tileInfoView.getTileScale(n.key);y.has(a)||(y.set(a,[]),i=Math.max(a,i),r=Math.min(a,r)),y.get(a).push(n.key),f.add(a)}));var a=this.state.scale;y.has(a)||(function(e,t){e.length=0,t.forEach((function(t){return e.push(t)}))}(v,f),v.sort((function(e,t){return e-t})),a=v.reduce((function(e,t){return Math.abs(t-a)<Math.abs(e-a)?t:e}),v[0])),a=Math.min(a,i),a=Math.max(a,r);var o=y.get(a),s=n.getClosestInfoForScale(a),l=s.getColumnForX(this.state.center[0]),u=s.getRowForY(this.state.center[1]);return o.sort((function(e,t){var n=s.denormalizeCol(e.col,e.world),i=s.denormalizeCol(t.col,t.world);return Math.sqrt((l-n)*(l-n)+(u-e.row)*(u-e.row))-Math.sqrt((l-i)*(l-i)+(u-t.row)*(u-t.row))})),f.clear(),y.clear(),o[0].id}},{key:"_peekByCenterFirst",value:function(e){var t=this;if(!this.state)return e.values().next().value;var n,i=this.tileInfoView,r=this.state.center,a=Number.POSITIVE_INFINITY;return e.forEach((function(e){var o=t._keyToItem.get(e);i.getTileCoords(g,o.key);var s=(0,p.d)(g,r);s<a&&(a=s,n=o.key)})),n.id}}]),n}(l.Z);(0,s._)([(0,c.Cb)({constructOnly:!0})],m.prototype,"concurrency",void 0),(0,s._)([(0,c.Cb)({constructOnly:!0})],m.prototype,"process",void 0),(0,s._)([(0,c.Cb)()],m.prototype,"state",void 0),(0,s._)([(0,c.Cb)({constructOnly:!0})],m.prototype,"strategy",void 0),(0,s._)([(0,c.Cb)({constructOnly:!0})],m.prototype,"tileInfoView",void 0),(0,s._)([(0,c.Cb)({readOnly:!0})],m.prototype,"updating",null),m=(0,s._)([(0,d.j)("esri.views.2d.tiling.PagedTileQueue")],m)},32344:function(e,t,n){n.d(t,{Z:function(){return _}});var i=n(15671),r=n(43144),a=n(60136),o=n(92572),s=n(27366),l=n(85015),u=n(92026),c=n(49861),d=(n(25243),n(63780),n(69912)),p=n(88396),h=n(38164);var f=new Set,v=[],y=new Map,g=[0,0],m=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e))._keyToItem=new Map,r.concurrency=6,r.strategy="scale-first",r.tileInfoView=null,r}return(0,r.Z)(n,[{key:"initialize",value:function(){var e=this,t=this.concurrency,n=this.process,i=this.strategy;this._queue=new h.e({concurrency:t,process:function(t,i){var r=e._keyToItem.get(t);return n(r,{signal:i})},peeker:"scale-first"===i?function(t){return e._peekByScaleFirst(t)}:function(t){return e._peekByCenterFirst(t)}})}},{key:"destroy",value:function(){this.clear(),this._queue=(0,u.SC)(this._queue)}},{key:"length",get:function(){return this._queue?this._queue.length:0}},{key:"onGoingCount",get:function(){return this._keyToItem.size}},{key:"updating",get:function(){return this.length>0||this.onGoingCount>0}},{key:"abort",value:function(e){var t="string"==typeof e?e:e.id;this._queue.abort(t)}},{key:"clear",value:function(){this._queue.clear(),this._keyToItem.clear(),this.notifyChange("updating")}},{key:"has",value:function(e){return"string"==typeof e?this._keyToItem.has(e):this._keyToItem.has(e.id)}},{key:"isOngoing",value:function(e){var t="string"==typeof e?e:e.id;return this.has(t)&&this._queue.isOngoing(t)}},{key:"pause",value:function(){this._queue.pause()}},{key:"push",value:function(e){var t=this,n=e.key.id;if(this._queue.has(n))return this._queue.get(n);var i=this._queue.push(n),r=function(){t._keyToItem.delete(n),t.notifyChange("updating")};return this._keyToItem.set(n,e),i.then(r,r),this.notifyChange("updating"),i}},{key:"reset",value:function(){this._queue.reset()}},{key:"resume",value:function(){this._queue.resume()}},{key:"_peekByScaleFirst",value:function(e){var t=this;if(!this.state)return e.values().next().value;var n=this.tileInfoView,i=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY;e.forEach((function(e){var n=t._keyToItem.get(e),a=t.tileInfoView.getTileScale(n.key);y.has(a)||(y.set(a,[]),i=Math.max(a,i),r=Math.min(a,r)),y.get(a).push(n.key),f.add(a)}));var a=this.state.scale;y.has(a)||(function(e,t){e.length=0,t.forEach((function(t){return e.push(t)}))}(v,f),v.sort((function(e,t){return e-t})),a=v.reduce((function(e,t){return Math.abs(t-a)<Math.abs(e-a)?t:e}),v[0])),a=Math.min(a,i),a=Math.max(a,r);var o=y.get(a),s=n.getClosestInfoForScale(a),l=s.getColumnForX(this.state.center[0]),u=s.getRowForY(this.state.center[1]);return o.sort((function(e,t){var n=s.denormalizeCol(e.col,e.world),i=s.denormalizeCol(t.col,t.world);return Math.sqrt((l-n)*(l-n)+(u-e.row)*(u-e.row))-Math.sqrt((l-i)*(l-i)+(u-t.row)*(u-t.row))})),f.clear(),y.clear(),o[0].id}},{key:"_peekByCenterFirst",value:function(e){var t=this;if(!this.state)return e.values().next().value;var n,i=this.tileInfoView,r=this.state.center,a=Number.POSITIVE_INFINITY;return e.forEach((function(e){var o=t._keyToItem.get(e);i.getTileCoords(g,o.key);var s=(0,p.d)(g,r);s<a&&(a=s,n=o.key)})),n.id}}]),n}(l.Z);(0,s._)([(0,c.Cb)({constructOnly:!0})],m.prototype,"concurrency",void 0),(0,s._)([(0,c.Cb)({constructOnly:!0})],m.prototype,"process",void 0),(0,s._)([(0,c.Cb)()],m.prototype,"state",void 0),(0,s._)([(0,c.Cb)({constructOnly:!0})],m.prototype,"strategy",void 0),(0,s._)([(0,c.Cb)({constructOnly:!0})],m.prototype,"tileInfoView",void 0),(0,s._)([(0,c.Cb)({readOnly:!0})],m.prototype,"updating",null);var _=m=(0,s._)([(0,d.j)("esri.views.2d.tiling.TileQueue")],m)},85269:function(e,t,n){n.d(t,{Z:function(){return v}});var i=n(37762),r=n(15671),a=n(43144),o=n(65156),s=n(88396),l=function(){function e(t,n,i){(0,r.Z)(this,e),this.maxSize=t,this._tileInfoView=n,this._removedFunc=i,this._tilePerId=new Map,this._tileKeysPerLevel=[]}return(0,a.Z)(e,[{key:"has",value:function(e){return this._tilePerId.has(e)}},{key:"get",value:function(e){return this._tilePerId.get(e)}},{key:"pop",value:function(e){var t=this._tilePerId.get(e);if(t){var n=t.key.level,i=this._tileKeysPerLevel[n];u(this._tilePerId,e);for(var r=0;r<i.length;r++)if(i[r].id===e){i.splice(r,1);break}return t.visible=!0,t}}},{key:"add",value:function(e){e.visible=!1;var t=e.key,n=t.id;if(!this._tilePerId.has(n)){this._tilePerId.set(n,e);var i=t.level;this._tileKeysPerLevel[i]||(this._tileKeysPerLevel[i]=[]),this._tileKeysPerLevel[i].push(t)}}},{key:"prune",value:function(e,t,n){var i=this._tilePerId.size;if(!(i<=this.maxSize)){for(var r=this._tileKeysPerLevel.length-1;i>this.maxSize&&r>=0;)r!==e&&(i=this._pruneAroundCenterTile(i,t,n,r)),r--;i>this.maxSize&&(i=this._pruneAroundCenterTile(i,t,n,e))}}},{key:"_pruneAroundCenterTile",value:function(e,t,n,i){var r=this._tileKeysPerLevel[i];if(!r||0===r.length)return e;var a=this._tileInfoView.tileInfo,o=a.size,l=a.origin,u=n*o[0],c=n*o[1],d=[0,0],p=[0,0];for(r.sort((function(e,n){return d[0]=l.x+u*(e.col+.5),d[1]=l.y-c*(e.row+.5),p[0]=l.x+u*(n.col+.5),p[1]=l.y-c*(n.row+.5),(0,s.k)(d,t)-(0,s.k)(p,t)}));r.length>0;){var h=r.pop();if(this._removeTile(h.id),--e===this.maxSize)break}return e}},{key:"_removeTile",value:function(e){var t=this._tilePerId.get(e);this._removedFunc&&t&&this._removedFunc(t),u(this._tilePerId,e)}}]),e}();function u(e,t){e.delete(t)}var c=n(48790),d=new(n(73828).Z)(0,0,0,0),p=new Map,h=[],f=[],v=function(){function e(t){var n=this;(0,r.Z)(this,e),this._previousScale=Number.POSITIVE_INFINITY,this.cachePolicy="keep",this.coveragePolicy="closest",this.resampling=!0,this.tileIndex=new Map,this.tiles=[],this.buffer=192,this.acquireTile=t.acquireTile,this.releaseTile=t.releaseTile,this.tileInfoView=t.tileInfoView,this.resampling=null==t.resampling||!!t.resampling,t.cachePolicy&&(this.cachePolicy=t.cachePolicy),t.coveragePolicy&&(this.coveragePolicy=t.coveragePolicy),null!=t.buffer&&(this.buffer=t.buffer),t.cacheSize&&(this._tileCache=new l(t.cacheSize,this.tileInfoView,(function(e){n.releaseTile(e)})))}return(0,a.Z)(e,[{key:"destroy",value:function(){this.tileIndex.clear()}},{key:"update",value:function(e){var t=this,n=this.resampling,r=this.tileIndex,a=this.tileInfoView.getTileCoverage(e.state,this.buffer,this.coveragePolicy);if(f.length=0,h.length=0,p.clear(),a){var o=this.tileInfoView.tileInfo,s=o.minScale,l=o.maxScale,u=a.spans,v=a.lodInfo,y=v.level,g=e.state,m=g.scale,_=g.center,b=g.resolution,w=!e.stationary&&m>this._previousScale;if(this._previousScale=m,this.tiles.length=0,!n&&(m>s||m<l))return this.tiles.length=0,p.clear(),r.forEach((function(e){t.releaseTile(e)})),r.clear(),f.length=0,h.length=0,p.clear(),c.Z.pool.release(a),!0;r.forEach((function(e){return e.visible=!0}));var k=0,C=0;if(u.length>0){var M,Z=(0,i.Z)(u);try{for(Z.s();!(M=Z.n()).done;)for(var x=M.value,I=x.row,T=x.colFrom,S=x.colTo,A=T;A<=S;A++){k++;var F=d.set(y,I,v.normalizeCol(A),v.getWorldForColumn(A)).id;if(r.has(F)){var P=r.get(F);P.isReady?(p.set(F,P),C++):w||this._addParentTile(F,p)}else{var L=void 0;if(this._tileCache&&this._tileCache.has(F)){if(L=this._tileCache.pop(F),this.tileIndex.set(F,L),L.isReady){p.set(F,L),C++;continue}}else L=this.acquireTile(d),this.tileIndex.set(F,L);w||this._addParentTile(F,p)}}}catch(q){Z.e(q)}finally{Z.f()}}var E=C===k;r.forEach((function(e,n){if(d.set(n),!p.has(n)){var i=t.tileInfoView.intersects(a,d),r="purge"===t.cachePolicy?d.level!==y:d.level>y;!i||!w&&E?!r&&i||h.push(n):e.isReady?r&&"purge"===t.cachePolicy&&t._hasReadyAncestor(d,y)?h.push(n):f.push(n):r&&h.push(n)}}));var R,V=(0,i.Z)(f);try{for(V.s();!(R=V.n()).done;){var O=R.value,D=r.get(O);D&&D.isReady&&p.set(O,D)}}catch(q){V.e(q)}finally{V.f()}var N,z=(0,i.Z)(h);try{for(z.s();!(N=z.n()).done;){var B=N.value,G=r.get(B);this._tileCache?this._tileCache.add(G):this.releaseTile(G),r.delete(B)}}catch(q){z.e(q)}finally{z.f()}return p.forEach((function(e){return t.tiles.push(e)})),r.forEach((function(e){p.has(e.key.id)||(e.visible=!1)})),this._tileCache&&this._tileCache.prune(y,_,b),c.Z.pool.release(a),p.clear(),E}}},{key:"clear",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=this.tileIndex;t&&n.forEach((function(t){e.releaseTile(t)})),n.clear()}},{key:"updateCacheSize",value:function(e){this._tileCache&&(this._tileCache.maxSize=e)}},{key:"_addParentTile",value:function(e,t){for(var n=e,i=null;n=this.tileInfoView.getTileParentId(n);)if(this.tileIndex.has(n)){if((i=this.tileIndex.get(n))&&i.isReady){t.has(i.key.id)||t.set(i.key.id,i);break}}else if(this._tileCache&&this._tileCache.has(n)&&(i=this._tileCache.pop(n),this.tileIndex.set(n,i),i&&i.isReady)){t.has(i.key.id)||t.set(i.key.id,i);break}}},{key:"_hasReadyAncestor",value:function(e,t){var n=(0,o.Ue)();this.tileInfoView.getTileBounds(n,e,!0);var r,a=(0,i.Z)(this.tileIndex.values());try{for(a.s();!(r=a.n()).done;){var s=r.value;if(s.isReady&&s.key.level>=t&&s.key.level<e.level){var l=(0,o.Ue)();if(this.tileInfoView.getTileBounds(l,s.key,!0),(0,o.r3)(l,n))return!0}}}catch(u){a.e(u)}finally{a.f()}return!1}}]),e}()},53942:function(e,t,n){function i(e,t,n,i){var r=3*e,a=3*(n-e)-r,o=1-r-a,s=3*t,l=3*(i-t)-s,u=1-s-l;function c(e){return((o*e+a)*e+r)*e}function d(e){return((u*e+l)*e+s)*e}function p(e){return(3*o*e+2*a)*e+r}function h(e,t){var n,i,r,a,o,s;for(r=e,s=0;s<8;s++){if(a=c(r)-e,Math.abs(a)<t)return r;if(o=p(r),Math.abs(o)<1e-6)break;r-=a/o}if((r=e)<(n=0))return n;if(r>(i=1))return i;for(;n<i;){if(a=c(r),Math.abs(a-e)<t)return r;e>a?n=r:i=r,r=.5*(i-n)+n}return r}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e-6;return d(h(e,t))}}n.d(t,{LI:function(){return a},Qc:function(){return o},n_:function(){return i}});var r=/^cubic-bezier\((.*)\)/,a={};function o(e){var t=a[e]||null;if(!t){var n=r.exec(e);if(n){var o=n[1].split(",").map((function(e){return parseFloat(e.trim())}));4!==o.length||o.some((function(e){return isNaN(e)}))||(t=i.apply(i,o))}}return t}a.ease=i(.25,.1,.25,1),a.linear=i(0,0,1,1),a.easeIn=a["ease-in"]=i(.42,0,1,1),a.easeOut=a["ease-out"]=i(0,0,.58,1),a.easeInOut=a["ease-in-out"]=i(.42,0,.58,1)},86226:function(e,t,n){n.d(t,{$H:function(){return Q},Ck:function(){return G},Dq:function(){return O},EK:function(){return x},H4:function(){return H},Hy:function(){return $},JG:function(){return L},Jp:function(){return q},L2:function(){return W},Rb:function(){return B},Rx:function(){return re},SI:function(){return K},UZ:function(){return ee},Ue:function(){return F},YQ:function(){return J},bk:function(){return R},dI:function(){return j},gG:function(){return te},ni:function(){return E},o2:function(){return Y},qf:function(){return V},uG:function(){return N},ut:function(){return U}});var i=n(74165),r=n(37762),a=n(15861),o=n(36721),s=n(80987),l=n(92026),u=n(68860),c=n(26277),d=n(22018),p=n(89494),h=n(88396),f=n(6394),v=n(53866),y=n(32238),g=n(585),m=n(79803),_=n(78952),b=n(92975),w=39.37,k=180/Math.PI;function C(e){return e.wkid?e:e.spatialReference||_.Z.WGS84}function M(e,t){return t.type?(0,h.s)(e,t.x,t.y):(0,h.c)(e,t)}function Z(e){return(0,u.c9)(e)}function x(e,t){var n=Math.max(1,t[0]),i=Math.max(1,t[1]);return Math.max(e.width/n,e.height/i)*function(e){return(0,b.JY)(e)?Z(e)*w*96:1}(e.spatialReference)}function I(e,t,n,i){return T.apply(this,arguments)}function T(){return(T=(0,a.Z)((0,i.Z)().mark((function e(t,n,a,o){var u,c,d,p,h,f,_,b,w,k,C,M,Z,x,T,S,A,F,P,L,E,R,V,O,D,N,z,B,G;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:if(!Array.isArray(t)||t.length){e.next=4;break}return e.abrupt("return",null);case 4:if(s.Z.isCollection(t)&&(t=t.toArray()),!Array.isArray(t)||!t.length||"object"!=typeof t[0]){e.next=39;break}if(d=t.every((function(e){return"attributes"in e})),p=t.some((function(e){return!e.geometry})),h=t,!(d&&p&&n&&n.allLayerViews)){e.next=20;break}f=new Map,_=(0,r.Z)(t);try{for(_.s();!(b=_.n()).done;)w=b.value,k=w.layer,C=f.get(k)||[],null!=(M=w.attributes[k.objectIdField])&&C.push(M),f.set(k,C)}catch(i){_.e(i)}finally{_.f()}return Z=[],f.forEach((function(e,t){var i=n.allLayerViews.find((function(e){return e.layer.id===t.id}));if(i&&"queryFeatures"in i){var r=t.createQuery();r.objectIds=e,r.returnGeometry=!0,Z.push(i.queryFeatures(r))}})),e.next=15,Promise.all(Z);case 15:x=e.sent,T=[],S=(0,r.Z)(x);try{for(S.s();!(A=S.n()).done;)if((F=A.value)&&F.features&&F.features.length){P=(0,r.Z)(F.features);try{for(P.s();!(L=P.n()).done;)E=L.value,(0,l.pC)(E.geometry)&&T.push(E.geometry)}catch(i){P.e(i)}finally{P.f()}}}catch(i){S.e(i)}finally{S.f()}h=T;case 20:R=(0,r.Z)(h),e.prev=21,R.s();case 23:if((V=R.n()).done){e.next=30;break}return O=V.value,e.next=27,I(O,n,a,o);case 27:o=e.sent;case 28:e.next=23;break;case 30:e.next=35;break;case 32:e.prev=32,e.t0=e.catch(21),R.e(e.t0);case 35:return e.prev=35,R.f(),e.finish(35);case 38:return e.abrupt("return",o);case 39:if(!Array.isArray(t)||2!==t.length||"number"!=typeof t[0]||"number"!=typeof t[1]){e.next=43;break}u=new g.Z(t),e.next=61;break;case 43:if(!(t instanceof y.Z)){e.next=47;break}u=t,e.next=61;break;case 47:if(!("geometry"in t)){e.next=61;break}if(!t.geometry){e.next=52;break}u=t.geometry,e.next=61;break;case 52:if(!t.layer){e.next=61;break}if(D=t.layer,N=n.allLayerViews.find((function(e){return e.layer.id===D.id})),!N||!("queryFeatures"in N)){e.next=61;break}return(z=D.createQuery()).objectIds=[t.attributes[D.objectIdField]],z.returnGeometry=!0,e.next=59,N.queryFeatures(z);case 59:B=e.sent,u=(0,l.U2)(B,"features",0,"geometry");case 61:if(!(0,l.Wi)(u)){e.next=63;break}return e.abrupt("return",null);case 63:if(c="point"===u.type?new v.Z({xmin:u.x,ymin:u.y,xmax:u.x,ymax:u.y,spatialReference:u.spatialReference}):u.extent){e.next=65;break}return e.abrupt("return",null);case 65:if(e.t1=(0,m.kR)()||(0,m.Up)(c.spatialReference,a),e.t1){e.next=69;break}return e.next=69,(0,m.zD)();case 69:return G=(0,m.iV)(c,a),e.abrupt("return",G?o=o?o.union(G):G:null);case 71:case"end":return e.stop()}}),e,null,[[21,32,35,38]])})))).apply(this,arguments)}function S(e){if(e&&(!Array.isArray(e)||"number"!=typeof e[0])&&("object"==typeof e||Array.isArray(e)&&"object"==typeof e[0])){if("layer"in e&&e.layer&&e.layer.minScale&&e.layer.maxScale){var t=e.layer;return{min:t.minScale,max:t.maxScale}}if(Array.isArray(e)&&e.length&&e.every((function(e){return"layer"in e}))){var n,i=0,a=0,o=(0,r.Z)(e);try{for(o.s();!(n=o.n()).done;){var s=n.value.layer;s&&s.minScale&&s.maxScale&&(i=s.minScale<i?s.minScale:i,a=s.maxScale>a?s.maxScale:a)}}catch(l){o.e(l)}finally{o.f()}return i&&a?{min:i,max:a}:null}}}function A(e,t){return(0,b.fS)(C(e),t)?e:(0,m.iV)(e,t)}function F(e,t){return P.apply(this,arguments)}function P(){return(P=(0,a.Z)((0,i.Z)().mark((function e(t,n){var r,a,s,u,c,d,p,h,f,y,_,w,k,M;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&n){e.next=2;break}return e.abrupt("return",new o.Z({targetGeometry:new g.Z,scale:0,rotation:0}));case 2:if(r=n.spatialReference,a=n.constraints,s=n.padding,u=n.viewpoint,c=n.size,d=[s?c[0]-s.left-s.right:c[0],s?c[1]-s.top-s.bottom:c[1]],p=null,t instanceof o.Z?p=t:t.viewpoint?p=t.viewpoint:t.target&&"esri.Viewpoint"===t.target.declaredClass&&(p=t.target),h=null,!p||!p.targetGeometry){e.next=11;break}h=p.targetGeometry,e.next=35;break;case 11:if(!(t instanceof v.Z)){e.next=15;break}h=t,e.next=35;break;case 15:if(e.t0=t||t&&("center"in t||"extent"in t||"target"in t),!e.t0){e.next=35;break}return e.next=19,I(t.center,n,r);case 19:if(e.t3=e.sent,e.t3){e.next=24;break}return e.next=23,I(t.extent,n,r);case 23:e.t3=e.sent;case 24:if(e.t2=e.t3,e.t2){e.next=29;break}return e.next=28,I(t.target,n,r);case 28:e.t2=e.sent;case 29:if(e.t1=e.t2,e.t1){e.next=34;break}return e.next=33,I(t,n,r);case 33:e.t1=e.sent;case 34:h=e.t1;case 35:if(!h&&u&&u.targetGeometry?h=u.targetGeometry:!h&&n.extent&&(h=n.extent),r||(r=C(n.spatialReference||n.extent||h)),e.t4=(0,m.kR)()||(0,b.fS)(h.spatialReference,r)||(0,m.Up)(h,r),e.t4){e.next=41;break}return e.next=41,(0,m.zD)();case 41:return f=A(h.center?h.center:h,r),y=0,p&&(0,l.pC)(p.targetGeometry)&&"point"===p.targetGeometry.type?y=p.scale:"scale"in t&&t.scale?y=t.scale:"zoom"in t&&-1!==t.zoom&&a&&a.effectiveLODs?y=a.zoomToScale(t.zoom):Array.isArray(h)||"point"===h.type||"extent"===h.type&&0===h.width&&0===h.height?(_=A(n.extent,r),y=(0,l.pC)(_)?x(_,d):n.extent?x(n.extent,d):u.scale):y=x(A(h.extent,r),d),(w=S(t))&&(w.min&&w.min>y?y=w.min:w.max&&w.max<y&&(y=w.max)),k=0,p?k=p.rotation:t.hasOwnProperty("rotation")?k=t.rotation:u&&(k=u.rotation),M=new o.Z({targetGeometry:f,scale:y,rotation:k}),e.abrupt("return",(a&&(M=a.fit(M),a.constrainByGeometry(M),a.rotationEnabled||(M.rotation=k)),M));case 50:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(e,t){var n=e.targetGeometry,i=t.targetGeometry;return n.x=i.x,n.y=i.y,n.spatialReference=i.spatialReference,e.scale=t.scale,e.rotation=t.rotation,e}function E(e,t,n){return n?(0,h.s)(e,.5*(t[0]-n.right+n.left),.5*(t[1]-n.bottom+n.top)):(0,h.b)(e,t,.5)}var R=function(){var e=(0,f.a)();return function(t,n,i){var r=n.targetGeometry;M(e,r);var a=.5*N(n);return t.xmin=e[0]-a*i[0],t.ymin=e[1]-a*i[1],t.xmax=e[0]+a*i[0],t.ymax=e[1]+a*i[1],t.spatialReference=r.spatialReference,t}}();function V(e,t,n,i,r){return Y(e,t,n.center),e.scale=x(n,i),r&&r.constraints&&r.constraints.constrain(e),e}var O=function(){var e=(0,f.a)();return function(t,n,i){return(0,h.e)(t,function(e,t){return(0,h.b)(e,t,.5)}(t,n),E(e,n,i))}}(),D=function(){var e=(0,p.c)(),t=(0,f.a)();return function(n,i,r,a){var o=N(i),s=z(i);return(0,h.s)(t,o,o),(0,d.f)(e,t),(0,d.r)(e,e,s),(0,d.t)(e,e,O(t,r,a)),(0,d.t)(e,e,[0,a.top-a.bottom]),(0,h.s)(n,e[4],e[5])}}();function N(e){return e.scale*function(e){return(0,l.pC)(e)&&(0,b.JY)(e.spatialReference)?1/(Z(e.spatialReference)*w*96):1}(e.targetGeometry)}function z(e){return(0,c.t)(e.rotation)||0}var B=function(){var e=(0,f.a)(),t=(0,f.a)(),n=(0,f.a)();return function(i,r,a,o,s,l){return(0,h.n)(e,r),(0,h.b)(t,a,.5*l),(0,h.s)(n,1/o*l,-1/o*l),(0,d.a)(i,t),s&&(0,d.r)(i,i,s),(0,d.s)(i,i,n),(0,d.t)(i,i,e),i}}(),G=function(){var e=(0,f.a)();return function(t,n,i,r){var a=N(n),o=z(n);return M(e,n.targetGeometry),B(t,e,i,a,o,r)}}(),q=function(){var e=(0,f.a)();return function(t,n,i,r){var a=N(n);return M(e,n.targetGeometry),B(t,e,i,a,0,r)}}();function U(e){var t=(0,b.C5)(e);return t?t.valid[1]-t.valid[0]:0}function W(e,t){return Math.round(U(e)/t)}var j=function(){var e=(0,f.a)(),t=(0,f.a)(),n=[0,0,0];return function(i,r,a){(0,h.a)(e,i,r),(0,h.f)(e,e),(0,h.a)(t,i,a),(0,h.f)(t,t),(0,h.g)(n,e,t);var o=Math.acos((0,h.h)(e,t)/((0,h.i)(e)*(0,h.i)(t)))*k;return n[2]<0&&(o=-o),isNaN(o)&&(o=0),o}}(),H=function(){var e=(0,f.a)();return function(t,n,i,r){var a=t.targetGeometry;return L(t,n),D(e,n,i,r),a.x+=e[0],a.y+=e[1],t}}(),Y=function(e,t,n){L(e,t);var i=e.targetGeometry;return i.x=n.x,i.y=n.y,i.spatialReference=n.spatialReference,e},K=function(){var e=(0,f.a)();return function(t,n,i,r,a){a||(a="center"),(0,h.e)(e,i,r),(0,h.b)(e,e,.5);var o=e[0],s=e[1];switch(a){case"center":(0,h.s)(e,0,0);break;case"left":(0,h.s)(e,-o,0);break;case"top":(0,h.s)(e,0,s);break;case"right":(0,h.s)(e,o,0);break;case"bottom":(0,h.s)(e,0,-s);break;case"top-left":(0,h.s)(e,-o,s);break;case"bottom-left":(0,h.s)(e,-o,-s);break;case"top-right":(0,h.s)(e,o,s);break;case"bottom-right":(0,h.s)(e,o,-s)}return re(t,n,e),t}}();function Q(e,t,n){return L(e,t),e.rotation+=n,e}function J(e,t,n){return L(e,t),e.rotation=n,e}var X=function(){var e=(0,f.a)();return function(t,n,i,r,a){return L(t,n),isNaN(i)||0===i||(ne(e,r,n,a),t.scale=n.scale*i,ie(e,e,t,a),re(t,t,(0,h.s)(e,e[0]-r[0],r[1]-e[1]))),t}}();function $(e,t,n){return L(e,t),e.scale=n,e}var ee=function(){var e=(0,f.a)();return function(t,n,i,r,a,o){return L(t,n),isNaN(i)||0===i||(ne(e,a,n,o),t.scale=n.scale*i,t.rotation+=r,ie(e,e,t,o),re(t,t,(0,h.s)(e,e[0]-a[0],a[1]-e[1]))),t}}(),te=function(){var e=(0,f.a)(),t=(0,f.a)();return function(n,i,r,a,o,s,l){return O(t,s,l),(0,h.j)(e,o,t),a?ee(n,i,r,a,e,s):X(n,i,r,e,s)}}(),ne=function(){var e=(0,p.c)();return function(t,n,i,r){return(0,h.t)(t,n,function(e,t,n,i){return G(e,t,n,i),(0,d.c)(e,e)}(e,i,r,1))}}(),ie=function(){var e=(0,p.c)();return function(t,n,i,r){return(0,h.t)(t,n,G(e,i,r,1))}}(),re=function(){var e=(0,f.a)(),t=(0,p.c)();return function(n,i,r){L(n,i);var a=N(i),o=n.targetGeometry;return(0,d.b)(t,z(i)),(0,d.s)(t,t,(0,f.f)(a,a)),(0,h.t)(e,r,t),o.x+=e[0],o.y+=e[1],n}}()},84779:function(e,t,n){n.d(t,{G:function(){return v}});var i=n(15671),r=n(43144),a=n(11752),o=n(61120),s=n(60136),l=n(92572),u=n(27366),c=n(85015),d=n(92026),p=n(49861),h=(n(25243),n(63780),n(69912)),f=n(93463),v=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e,r){var a,o;return(0,i.Z)(this,n),(o=t.call(this,{}))._stage=e,o._textureRequests=new Map,o._frameTask=null!==(a=null===r||void 0===r?void 0:r.registerTask(f.T8.TEXTURE_UNLOAD))&&void 0!==a?a:f.sq,o}return(0,r.Z)(n,[{key:"normalizeCtorArgs",value:function(){return{}}},{key:"destroy",value:function(){var e=this;(0,a.Z)((0,o.Z)(n.prototype),"destroy",this).call(this),this._frameTask.remove(),this._textureRequests.forEach((function(t){return e._releaseTextureRequest(t)})),this._textureRequests.clear()}},{key:"updating",get:function(){return this._frameTask.updating}},{key:"fromData",value:function(e,t,n){var i=this,r=this.makeUid(e),a=this._textureRequests.get(r);if(!a){var o=t();a={referenceCount:0,texture:o,textureAsync:null,abortController:null,onRemove:n},this._stage&&(this._stage.add(o),this._stage.loadImmediate(o)),this._textureRequests.set(r,a)}return a.referenceCount++,{uid:r,texture:a.texture,release:function(){return i._release(r)}}}},{key:"_release",value:function(e){var t=this,n=this._textureRequests.get(e);n?(n.referenceCount<1&&console.warn("TextureCollection: reference count is < 1 for "+e),n.referenceCount--,n.referenceCount<1&&this._frameTask.schedule((function(){return t._releaseNow(e)}))):console.warn("TextureCollection: texture doesn't exist: '".concat(e,"'"))}},{key:"test",get:function(){return{textureRequests:this._textureRequests}}},{key:"_releaseNow",value:function(e){if(this._textureRequests){var t=this._textureRequests.get(e);!t||t.referenceCount>0||(this._releaseTextureRequest(t),this._textureRequests.delete(e))}}},{key:"_releaseTextureRequest",value:function(e){var t;e.onRemove&&e.onRemove(),e.texture?null===(t=this._stage)||void 0===t||t.remove(e.texture):e.abortController&&(e.abortController.abort(),e.abortController=null)}},{key:"makeUid",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(0,d.pC)(t)?"".concat(e,".").concat(t,"px"):e}}]),n}(c.Z);(0,u._)([(0,p.Cb)()],v.prototype,"_frameTask",void 0),(0,u._)([(0,p.Cb)()],v.prototype,"updating",null),v=(0,u._)([(0,h.j)("esri.views.3d.support.TextureCollection")],v)},6003:function(e,t,n){n.d(t,{g:function(){return m}});var i=n(1413),r=n(15671),a=n(43144),o=n(60136),s=n(92572),l=n(27366),u=n(22213),c=n(100),d=n(92026),p=n(94172),h=n(49861),f=(n(25243),n(63780),n(69912)),v={widthBreakpoint:{getValue:function(e){var t=e.viewSize[0],n=e.breakpoints,i=this.values;return t<=n.xsmall?i.xsmall:t<=n.small?i.small:t<=n.medium?i.medium:t<=n.large?i.large:i.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue:function(e){var t=e.viewSize[1],n=e.breakpoints,i=this.values;return t<=n.xsmall?i.xsmall:t<=n.small?i.small:t<=n.medium?i.medium:t<=n.large?i.large:i.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue:function(e){var t=e.viewSize,n=t[0],i=t[1],r=this.values;return i>=n?r.portrait:r.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},y={xsmall:544,small:768,medium:992,large:1200};function g(e,t){return t?v[e].valueToClassName[t].split(" "):[]}var m=function(e){var t=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a)))._breakpointsHandles=new c.Z,e.orientation=null,e.widthBreakpoint=null,e.heightBreakpoint=null,e.breakpoints=y,e}return(0,a.Z)(n,[{key:"initialize",value:function(){var e=this;this._breakpointsHandles.add((0,p.YP)((function(){return[e.breakpoints,e.size]}),(function(){return e._updateClassNames()}),p.nn))}},{key:"destroy",value:function(){this.destroyed||(this._removeActiveClassNames(),this._breakpointsHandles=(0,d.SC)(this._breakpointsHandles))}},{key:"breakpoints",set:function(e){if(e!==this._get("breakpoints")){var t=function(e){var t=e;return t&&t.xsmall<t.small&&t.small<t.medium&&t.medium<t.large}(e);if(!t){var n=JSON.stringify(y,null,2);console.warn("provided breakpoints are not valid, using defaults:"+n)}e=t?e:y,this._set("breakpoints",(0,i.Z)({},e))}}},{key:"_updateClassNames",value:function(){if(this.container){var e,t=u.Z.acquire(),n=u.Z.acquire(),i=!1;for(e in v){var r=this[e],a=v[e].getValue({viewSize:this.size,breakpoints:this.breakpoints});r!==a&&(i=!0,this[e]=a,g(e,r).forEach((function(e){return n.push(e)})),g(e,a).forEach((function(e){return t.push(e)})))}i&&(this._applyClassNameChanges(t,n),u.Z.release(t),u.Z.release(n))}}},{key:"_applyClassNameChanges",value:function(e,t){var n=this.container;n&&(t.forEach((function(e){return n.classList.remove(e)})),e.forEach((function(e){return n.classList.add(e)})))}},{key:"_removeActiveClassNames",value:function(){var e,t=this.container;if(t)for(e in v)g(e,this[e]).forEach((function(e){return t.classList.remove(e)}))}}]),n}(e);return(0,l._)([(0,h.Cb)()],t.prototype,"breakpoints",null),(0,l._)([(0,h.Cb)()],t.prototype,"orientation",void 0),(0,l._)([(0,h.Cb)()],t.prototype,"widthBreakpoint",void 0),(0,l._)([(0,h.Cb)()],t.prototype,"heightBreakpoint",void 0),t=(0,l._)([(0,f.j)("esri.views.BreakpointsOwner")],t)}},78707:function(e,t,n){n.d(t,{f:function(){return Ar}});var i=n(29439),r=n(15671),a=n(43144),o=n(97326),s=n(60136),l=n(92572),u=n(27366),c=n(50093),d=n(32718),p=n(92026),h=n(94172),f=n(99346),v=n(49861),y=(n(25243),n(63780),n(69912)),g=n(74165),m=n(15861),_=n(37762),b=n(85015),w=n(80987),k=n(61826),C=(n(42877),n(88367)),M=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(){var e;return(0,r.Z)(this,n),(e=t.apply(this,arguments)).items=new w.Z,e._watchUpdatingTracking=new k.t,e._callbacks=new Map,e._projector=(0,C.E)(),e._hiddenProjector=(0,C.E)(),e}return(0,a.Z)(n,[{key:"needsRender",get:function(){return this.items.length>0}},{key:"updating",get:function(){var e,t;return null!==(e=null===(t=this._watchUpdatingTracking)||void 0===t?void 0:t.updating)&&void 0!==e&&e}},{key:"initialize",value:function(){var e=this,t=document.createElement("div");t.className="esri-overlay-surface",this._set("surface",t),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),t.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange((function(){return e.items}),(function(t){var n,i=(0,_.Z)(t.added);try{var r=function(){var t=n.value,i=function(){return t.render()};e._callbacks.set(t,i),e._projector.append(e.surface,i)};for(i.s();!(n=i.n()).done;)r()}catch(u){i.e(u)}finally{i.f()}var a,o=(0,_.Z)(t.removed);try{for(o.s();!(a=o.n()).done;){var s=a.value,l=e._projector.detach(e._callbacks.get(s));e.surface.removeChild(l.domNode),e._callbacks.delete(s)}}catch(u){o.e(u)}finally{o.f()}}))}},{key:"addItem",value:function(e){this.items.add(e)}},{key:"removeItem",value:function(e){this.items.remove(e)}},{key:"destroy",value:function(){var e=this;this.items.removeAll(),this._callbacks.forEach((function(t){return e._projector.detach(t)})),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}},{key:"render",value:function(){this._projector.renderNow()}},{key:"computeBoundingRect",value:function(e){var t,n=this._hiddenSurface,i=this._hiddenProjector,r=function(){return t=e.render()};i.append(n,r),i.renderNow();var a={left:0,top:0,right:0,bottom:0};if(t&&t.domNode){var o=t.domNode.getBoundingClientRect();a.left=o.left,a.top=o.top,a.right=o.right,a.bottom=o.bottom}for(i.detach(r);n.firstChild;)n.removeChild(n.firstChild);return a}},{key:"overlaps",value:function(e,t){var n=this.computeBoundingRect(e),i=this.computeBoundingRect(t);return Math.max(n.left,i.left)<=Math.min(n.right,i.right)&&Math.max(n.top,i.top)<=Math.min(n.bottom,i.bottom)}},{key:"hasVisibleItems",get:function(){return this.items.some((function(e){return e.visible}))}},{key:"prepare",value:function(){var e=(0,m.Z)((0,g.Z)().mark((function e(){return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,document.fonts.load(this._fontString()).catch((function(){}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renderCanvas",value:function(e){if(this.items.some((function(e){return e.visible}))){var t=e.getContext("2d");t.save(),t.font=this._fontString(),this.items.forEach((function(e){t.save(),e.renderCanvas(t),t.restore()})),t.restore()}}},{key:"_fontString",value:function(){return"10px ".concat(getComputedStyle(this.surface).fontFamily)}}]),n}(b.Z);(0,u._)([(0,v.Cb)({readOnly:!0})],M.prototype,"surface",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],M.prototype,"items",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],M.prototype,"needsRender",null),(0,u._)([(0,v.Cb)({readOnly:!0})],M.prototype,"_watchUpdatingTracking",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],M.prototype,"updating",null);var Z=M=(0,u._)([(0,y.j)("esri.views.overlay.ViewOverlay")],M),x=n(4942),I=n(1413),T=(n(59166),n(98928)),S=n(100),A=n(14916),F=n(89125),P=n(37056),L=n(10064),E=n(5163),R=n(52639),V=n(11812),O=n(99837),D=n(93433),N=n(643),z=n(76969),B=n(6291),G=n(80031),q=n(37933),U=n(14105),W=n(819),j=d.Z.getLogger("esri.widgets.Feature.support.featureUtils"),H=/href=(""|'')/gi,Y=/(\{([^\{\r\n]+)\})/g,K=/\'/g,Q=/^\s*expression\//i,J=/(\n)/gi,X=/[\u00A0-\u9999<>\&]/gim,$=/href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/gi,ee=/^(?:mailto:|tel:)/,te="relationships/",ne=(0,z.Ze)("short-date-short-time");function ie(e){if(!(0,p.Wi)(e))return e.get("sourceLayer")||e.get("layer")}function re(e,t){return ae.apply(this,arguments)}function ae(){return ae=(0,m.Z)((0,g.Z)().mark((function e(t,n){return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return","function"==typeof t?t.call(null,n):t);case 1:case"end":return e.stop()}}),e)}))),ae.apply(this,arguments)}function oe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(e)return!ee.test(e.trim().toLowerCase())}function se(e){return!!e&&Q.test(e)}function le(e,t){var n=function(e,t){if(!se(t)||!e)return null;var n=t.replace(Q,"").toLowerCase(),i=null;return e.some((function(e){return e.name.toLowerCase()===n&&(i=e,!0)})),i}(t,null===e||void 0===e?void 0:e.fieldName);return n?n.title||null:e?e.label||e.fieldName:null}function ue(e,t){var n=ce(t,e);return n?n.name:e}function ce(e,t){var n;return e&&"function"==typeof e.getField&&t&&null!==(n=e.getField(t))&&void 0!==n?n:null}function de(e){return"".concat(e).trim()}function pe(e){var t=e.attributes,n=e.globalAttributes,i=e.layer,r=e.text,a=e.expressionAttributes,o=e.fieldInfoMap;return r?he({formattedAttributes:n,template:ge(r,(0,I.Z)((0,I.Z)((0,I.Z)({},n),a),t),i),fieldInfoMap:o}):""}function he(e){var t=e.formattedAttributes,n=e.template,i=e.fieldInfoMap;return de(function(e){return e.replace(H,"")}((0,N.gx)((0,N.gx)(n,(function(e){return function(e,t){var n=t.get(e.toLowerCase());return"{".concat(n&&n.fieldName||e,"}")}(e,i)})),t)))}function fe(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=t[e];if("string"==typeof i){var r="%27",a=(n?encodeURIComponent(i):i).replace(K,r);t[e]=a}}function ve(e,t,n){var i=(t=de(t))&&"{"!==t[0];return(0,N.gx)(e,function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=(0,I.Z)({},e);return Object.keys(n).forEach((function(e){return fe(e,n,t)})),n}(n,i||!1))}function ye(e,t){return e.replace(Y,(function(e,n,i){var r=ce(t,i);return r?"{".concat(r.name,"}"):n}))}function ge(e,t,n){var i=ye(e,n);return i?i.replace($,(function(e,n,i){return ve(e,n||i,t)})):i}function me(e){return!(null===e||void 0===e||!e.layer)}function _e(e,t){var n,i=t.fieldInfos,r=t.fieldName,a=null===(n=be(i,r))||void 0===n?void 0:n.clone(),o=t.preventPlacesFormatting,s=t.layer,l=ce(s,r);if(a&&"date"===(null===l||void 0===l?void 0:l.type)){var u=a.format||new U.Z;u.dateFormat=u.dateFormat||"short-date-short-time",u.dateTimeFormatOptions=!me(s)&&function(e){return"feature"===(null===e||void 0===e?void 0:e.type)}(s)&&s.datesInUnknownTimezone||me(s)&&function(e){return"map-image"===(null===e||void 0===e?void 0:e.type)}(s.layer)&&s.layer.datesInUnknownTimezone?{timeZone:"UTC"}:null,a.format=u}var c=a&&a.format;return"string"==typeof e&&(0,G.Ec)(r)&&c?c.formatRasterPixelValue(e):"string"==typeof(e=function(e,t){if("string"==typeof e&&t&&null==t.dateFormat&&(null!=t.places||null!=t.digitSeparator)){var n=Number(e);if(!isNaN(n))return n}return e}(e,c))||null==e||null==c?Ce(e):o?(0,B.uf)(e,(0,I.Z)((0,I.Z)({},(0,B.sh)(c)),{},{minimumFractionDigits:0,maximumFractionDigits:20})):c.format(e)}function be(e,t){if(e&&e.length&&t){var n,i=t.toLowerCase();return e.some((function(e){return!(!e.fieldName||e.fieldName.toLowerCase()!==i)&&(n=e,!0)})),n}}function we(e){var t=[];if(!e)return t;var n=e.fieldInfos,i=e.content;return n&&t.push.apply(t,(0,D.Z)(n)),i&&Array.isArray(i)?(i.forEach((function(e){if("fields"===e.type){var n=e&&e.fieldInfos;n&&t.push.apply(t,(0,D.Z)(n))}})),t):t}function ke(e){return e.replace(X,(function(e){return"&#".concat(e.charCodeAt(0),";")}))}function Ce(e){return"string"==typeof e?e.replace(J,'<br class="esri-text-new-line" />'):e}function Me(e){var t=e.value,n=e.fieldName,i=e.fieldInfos,r=e.fieldInfoMap,a=e.layer,o=e.graphic;if(null==t)return"";var s=function(e){var t=e.fieldName,n=e.value,i=e.graphic,r=e.layer;if(Pe(t))return null;if(!r||"function"!=typeof r.getFieldDomain)return null;var a=i&&r.getFieldDomain(t,{feature:i});return a&&"coded-value"===a.type?a.getName(n):null}({fieldName:n,value:t,graphic:o,layer:a});if(s)return s;var l=function(e){var t=e.fieldName,n=e.graphic,i=e.layer;if(Pe(t))return null;if(!i||"function"!=typeof i.getFeatureType)return null;var r=i.typeIdField;if(!r||t!==r)return null;var a=i.getFeatureType(n);return a?a.name:null}({fieldName:n,graphic:o,layer:a});if(l)return l;if(r.get(n.toLowerCase()))return _e(t,{fieldInfos:i||Array.from(r.values()),fieldName:n,layer:a});var u=a&&a.fieldsIndex;return u&&u.isDateField(n)?(0,z.p6)(t,ne):Ce(t)}function Ze(e){var t=e.fieldInfos,n=e.attributes,i=e.layer,r=e.graphic,a=e.fieldInfoMap,o=e.relatedInfos,s={};return null!==o&&void 0!==o&&o.forEach((function(e){return function(e){var t=e.attributes,n=e.relatedInfo,i=e.fieldInfoMap,r=e.fieldInfos,a=e.layer;t&&n&&(n.relatedFeatures&&n.relatedFeatures&&n.relatedFeatures.forEach((function(e){return Le({attributes:t,graphic:e,relatedInfo:n,fieldInfoMap:i,fieldInfos:r,layer:a})})),n.relatedStatsFeatures&&n.relatedStatsFeatures&&n.relatedStatsFeatures.forEach((function(e){return Le({attributes:t,graphic:e,relatedInfo:n,fieldInfoMap:i,fieldInfos:r,layer:a})})))}({attributes:s,relatedInfo:e,fieldInfoMap:a,fieldInfos:t,layer:i})})),n&&Object.keys(n).forEach((function(e){var o=n[e];s[e]=Me({fieldName:e,fieldInfos:t,fieldInfoMap:a,layer:i,value:o,graphic:r})})),s}function xe(e,t){return Ie.apply(this,arguments)}function Ie(){return Ie=(0,m.Z)((0,g.Z)().mark((function e(t,n){var i,r,a,o,s,l,u,c,d,p,h,f;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.layer,o=t.graphic,s=t.outFields,l=t.objectIds,u=t.returnGeometry,c=t.spatialReference,"number"==typeof(d=l[0])||"string"==typeof d){e.next=4;break}return"Could not query required fields for the specified feature. The feature's ID is invalid.",p={layer:a,graphic:o,objectId:d,requiredFields:s},e.abrupt("return",(j.warn("Could not query required fields for the specified feature. The feature's ID is invalid.",p),null));case 4:if(null!==(i=(0,q.S1)(a))&&void 0!==i&&null!==(r=i.operations)&&void 0!==r&&r.supportsQuery){e.next=7;break}return"The specified layer cannot be queried. The following fields will not be available.",h={layer:a,graphic:o,requiredFields:s,returnGeometry:u},e.abrupt("return",(j.warn("The specified layer cannot be queried. The following fields will not be available.",h),null));case 7:return(f=a.createQuery()).objectIds=l,f.outFields=null!==s&&void 0!==s&&s.length?s:[a.objectIdField],f.returnGeometry=!!u,f.returnZ=!!u,f.returnM=!!u,f.outSpatialReference=c,e.next=11,a.queryFeatures(f,n);case 11:return e.abrupt("return",e.sent.features[0]);case 12:case"end":return e.stop()}}),e)}))),Ie.apply(this,arguments)}function Te(e){return Se.apply(this,arguments)}function Se(){return Se=(0,m.Z)((0,g.Z)().mark((function e(t){var n,i,r;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(n=t.expressionInfos)&&void 0!==n&&n.length){e.next=2;break}return e.abrupt("return",!1);case 2:return e.next=4,(0,W.LC)();case 4:return i=e.sent,r=i.arcadeUtils.hasGeometryFunctions,e.abrupt("return",r(t));case 7:case"end":return e.stop()}}),e)}))),Se.apply(this,arguments)}function Ae(e,t){return Fe.apply(this,arguments)}function Fe(){return Fe=(0,m.Z)((0,g.Z)().mark((function e(t,n){var i,r,a,o,s,l,u,c,d,p,h;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.graphic,r=t.popupTemplate,a=t.layer,o=t.spatialReference,a&&r){e.next=3;break}return e.abrupt("return");case 3:if(e.t0="function"==typeof a.load,!e.t0){e.next=7;break}return e.next=7,a.load(n);case 7:if(i.attributes){e.next=9;break}return e.abrupt("return");case 9:if(null!=(s=i.attributes[a.objectIdField])){e.next=12;break}return e.abrupt("return");case 12:return l=[s],e.next=15,r.getRequiredFields(a.fieldsIndex);case 15:if(u=e.sent,c=(0,G.R9)(u,i),d=c?[]:u,e.t1=r.returnGeometry,e.t1){e.next=23;break}return e.next=22,Te(r);case 22:e.t1=e.sent;case 23:if(p=e.t1,!c||p){e.next=26;break}return e.abrupt("return");case 26:return e.next=28,xe({layer:a,graphic:i,outFields:d,objectIds:l,returnGeometry:p,spatialReference:o},n);case 28:(h=e.sent)&&(h.geometry&&(i.geometry=h.geometry),h.attributes&&(i.attributes=(0,I.Z)((0,I.Z)({},i.attributes),h.attributes)));case 30:case"end":return e.stop()}}),e)}))),Fe.apply(this,arguments)}function Pe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return!!e&&e.includes(te)}function Le(e){var t=e.attributes,n=e.graphic,i=e.relatedInfo,r=e.fieldInfos,a=e.fieldInfoMap,o=e.layer;t&&n&&i&&Object.keys(n.attributes).forEach((function(e){var s=function(e){return e?"".concat(te).concat(e.layerId,"/").concat(e.fieldName):""}({layerId:i.relation.id.toString(),fieldName:e}),l=n.attributes[e];t[s]=Me({fieldName:s,fieldInfos:r,fieldInfoMap:a,layer:o,value:l,graphic:n})}))}var Ee=function(e){if(!e)return!1;var t=e.toUpperCase();return t.includes("CURRENT_TIMESTAMP")||t.includes("CURRENT_DATE")||t.includes("CURRENT_TIME")},Re=function(e){var t,n,i=e.layer,r=e.method,a=e.query,o=e.definitionExpression;if(null!==(t=i.capabilities)&&void 0!==t&&null!==(n=t.query)&&void 0!==n&&n.supportsCacheHint&&"attachments"!==r){var s=(0,p.pC)(a.where)?a.where:null,l=(0,p.pC)(a.geometry)?a.geometry:null;Ee(o)||Ee(s)||"extent"===(null===l||void 0===l?void 0:l.type)||"tile"===a.resultType||(a.cacheHint=!0)}};function Ve(e,t,n){return e.find((function(e){return e!==t&&"feature"===e.type&&e.url===t.url&&e.layerId===n.relatedTableId}))}var Oe={editing:!1,operations:{add:!0,update:!0,delete:!0}},De=w.Z.ofType(V.Z),Ne=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e){var i;return(0,r.Z)(this,n),(i=t.call(this,e))._getAttachmentsPromise=null,i._attachmentLayer=null,i.abilities=(0,I.Z)({},Oe),i.activeAttachmentInfo=null,i.activeFileInfo=null,i.attachmentInfos=new De,i.fileInfos=new w.Z,i.graphic=null,i.mode="view",i.filesEnabled=!1,i.addHandles((0,h.YP)((function(){return i.graphic}),(function(){return i._graphicChanged()}),h.nn)),i}return(0,a.Z)(n,[{key:"destroy",value:function(){this._attachmentLayer=null,this.graphic=null}},{key:"castAbilities",value:function(e){return(0,I.Z)((0,I.Z)({},Oe),e)}},{key:"state",get:function(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}},{key:"supportsResizeAttachments",get:function(){var e=this.graphic;if(!e)return!1;var t=e.layer||e.sourceLayer;return(null===t||void 0===t?void 0:t.loaded)&&"capabilities"in t&&t.capabilities&&"operations"in t.capabilities&&"supportsResizeAttachments"in t.capabilities.operations&&t.capabilities.operations.supportsResizeAttachments||!1}},{key:"getAttachments",value:function(){var e=(0,m.Z)((0,g.Z)().mark((function e(){var t,n,i,r,a,o,s;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._attachmentLayer,n=this.attachmentInfos,t&&"function"==typeof t.queryAttachments){e.next=3;break}throw new L.Z("invalid-layer","getAttachments(): A valid layer is required.");case 3:return i=this._getObjectId(),r=new O.Z({objectIds:[i],returnMetadata:!0}),a=[],o=t.queryAttachments(r).then((function(e){return e[i]||a})).catch((function(){return a})),this._getAttachmentsPromise=o,this.notifyChange("state"),e.next=7,o;case 7:return s=e.sent,e.abrupt("return",(n.removeAll(),s.length&&n.addMany(s),this._getAttachmentsPromise=null,this.notifyChange("state"),s));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addAttachment",value:function(){var e=(0,m.Z)((0,g.Z)().mark((function e(t){var n,i,r,a,o,s,l,u=this,c=arguments;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=c.length>1&&void 0!==c[1]?c[1]:this.graphic,r=this._attachmentLayer,a=this.attachmentInfos,o=this.abilities,i){e.next=4;break}throw new L.Z("invalid-graphic","addAttachment(): A valid graphic is required.",{graphic:i});case 4:if(t){e.next=6;break}throw new L.Z("invalid-attachment","addAttachment(): An attachment is required.",{attachment:t});case 6:if(null!==(n=o.operations)&&void 0!==n&&n.add){e.next=8;break}throw new L.Z("invalid-abilities","addAttachment(): add abilities are required.");case 8:if(r&&"function"==typeof r.addAttachment){e.next=10;break}throw new L.Z("invalid-layer","addAttachment(): A valid layer is required.");case 10:return s=r.addAttachment(i,t).then((function(e){return u._queryAttachment(e.objectId,i)})),e.next=13,s;case 13:return l=e.sent,e.abrupt("return",(a.add(l),l));case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteAttachment",value:function(){var e=(0,m.Z)((0,g.Z)().mark((function e(t){var n,i,r,a,o,s,l;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this._attachmentLayer,r=this.attachmentInfos,a=this.graphic,o=this.abilities,t){e.next=3;break}throw new L.Z("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:t});case 3:if(null!==(n=o.operations)&&void 0!==n&&n.delete){e.next=5;break}throw new L.Z("invalid-abilities","deleteAttachment(): delete abilities are required.");case 5:if(i&&"function"==typeof i.deleteAttachments){e.next=7;break}throw new L.Z("invalid-layer","deleteAttachment(): A valid layer is required.");case 7:if(a){e.next=9;break}throw new L.Z("invalid-graphic","deleteAttachment(): A graphic is required.");case 9:return s=i.deleteAttachments(a,[t.id]).then((function(){return t})),e.next=12,s;case 12:return l=e.sent,e.abrupt("return",(r.remove(l),l));case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateAttachment",value:function(){var e=(0,m.Z)((0,g.Z)().mark((function e(t){var n,i,r,a,o,s,l,u,c,d=this,p=arguments;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=p.length>1&&void 0!==p[1]?p[1]:this.activeAttachmentInfo,r=this._attachmentLayer,a=this.attachmentInfos,o=this.graphic,s=this.abilities,t){e.next=4;break}throw new L.Z("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:t});case 4:if(i){e.next=6;break}throw new L.Z("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:i});case 6:if(null!==(n=s.operations)&&void 0!==n&&n.update){e.next=8;break}throw new L.Z("invalid-abilities","updateAttachment(): Update abilities are required.");case 8:if(l=a.findIndex((function(e){return e===i})),r&&"function"==typeof r.updateAttachment){e.next=11;break}throw new L.Z("invalid-layer","updateAttachment(): A valid layer is required.");case 11:if(o){e.next=13;break}throw new L.Z("invalid-graphic","updateAttachment(): A graphic is required.");case 13:return u=r.updateAttachment(o,i.id,t).then((function(e){return d._queryAttachment(e.objectId)})),e.next=16,u;case 16:return c=e.sent,e.abrupt("return",(a.splice(l,1,c),c));case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"commitFiles",value:function(){var e=(0,m.Z)((0,g.Z)().mark((function e(){var t=this;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.fileInfos.items.map((function(e){return t.addAttachment(e.form)})));case 2:return this.fileInfos.removeAll(),e.abrupt("return",this.getAttachments());case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addFile",value:function(e,t){if(!e||!t)return null;var n={file:e,form:t};return this.fileInfos.add(n),n}},{key:"updateFile",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.activeFileInfo;if(!e||!t||!n)return null;var i=this.fileInfos.findIndex((function(e){return n===e}));return i>-1&&this.fileInfos.splice(i,1,{file:e,form:t}),this.fileInfos.items[i]}},{key:"deleteFile",value:function(e){var t=this.fileInfos.find((function(t){return t.file===e}));return t?(this.fileInfos.remove(t),t):null}},{key:"_queryAttachment",value:function(){var e=(0,m.Z)((0,g.Z)().mark((function e(t,n){var i,r,a;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this._attachmentLayer,t&&null!==i&&void 0!==i&&i.queryAttachments){e.next=3;break}throw new L.Z("invalid-attachment-id","Could not query attachment.");case 3:return r=this._getObjectId(n),a=new O.Z({objectIds:[r],attachmentsWhere:"AttachmentId=".concat(t),returnMetadata:!0}),e.abrupt("return",i.queryAttachments(a).then((function(e){return e[r][0]})));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_getObjectId",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.graphic;return null!==(e=null===t||void 0===t?void 0:t.getObjectId())&&void 0!==e?e:null}},{key:"_graphicChanged",value:function(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch((function(){})))}},{key:"_setAttachmentLayer",value:function(){var e=ie(this.graphic);this._attachmentLayer=e?"scene"===e.type&&(0,p.pC)(e.associatedLayer)?e.associatedLayer:e:null}}]),n}(b.Z);(0,u._)([(0,v.Cb)()],Ne.prototype,"abilities",void 0),(0,u._)([(0,F.p)("abilities")],Ne.prototype,"castAbilities",null),(0,u._)([(0,v.Cb)()],Ne.prototype,"activeAttachmentInfo",void 0),(0,u._)([(0,v.Cb)()],Ne.prototype,"activeFileInfo",void 0),(0,u._)([(0,v.Cb)({readOnly:!0,type:De})],Ne.prototype,"attachmentInfos",void 0),(0,u._)([(0,v.Cb)()],Ne.prototype,"fileInfos",void 0),(0,u._)([(0,v.Cb)({type:R.Z})],Ne.prototype,"graphic",void 0),(0,u._)([(0,v.Cb)()],Ne.prototype,"mode",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],Ne.prototype,"state",null),(0,u._)([(0,v.Cb)()],Ne.prototype,"filesEnabled",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],Ne.prototype,"supportsResizeAttachments",null);var ze=Ne=(0,u._)([(0,y.j)("esri.widgets.Attachments.AttachmentsViewModel")],Ne),Be=n(65905);function Ge(e){var t=e.toLowerCase();return"image/bmp"===t||"image/emf"===t||"image/exif"===t||"image/gif"===t||"image/x-icon"===t||"image/jpeg"===t||"image/png"===t||"image/tiff"===t||"image/x-wmf"===t}var qe=n(37680),Ue=n(80532),We=n(67005),je={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},He="esri-attachments",Ye="esri-button",Ke={base:He,loaderContainer:"".concat(He,"__loader-container"),loader:"".concat(He,"__loader"),fadeIn:"".concat(He,"--fade-in"),container:"".concat(He,"__container"),containerList:"".concat(He,"__container--list"),containerPreview:"".concat(He,"__container--preview"),actions:"".concat(He,"__actions"),deleteButton:"".concat(He,"__delete-button"),addAttachmentButton:"".concat(He,"__add-attachment-button"),errorMessage:"".concat(He,"__error-message"),items:"".concat(He,"__items"),item:"".concat(He,"__item"),itemButton:"".concat(He,"__item-button"),itemMask:"".concat(He,"__item-mask"),itemMaskIcon:"".concat(He,"__item-mask--icon"),itemImage:"".concat(He,"__image"),itemImageResizable:"".concat(He,"__image--resizable"),itemLabel:"".concat(He,"__label"),itemFilename:"".concat(He,"__filename"),itemChevronIcon:"".concat(He,"__item-chevron-icon"),itemLink:"".concat(He,"__item-link"),itemLinkOverlay:"".concat(He,"__item-link-overlay"),itemLinkOverlayIcon:"".concat(He,"__item-link-overlay-icon"),itemEditIcon:"".concat(He,"__item-edit-icon"),itemAddIcon:"".concat(He,"__item-add-icon"),itemAddButton:"".concat(He,"__item-add-button"),formNode:"".concat(He,"__form-node"),fileFieldset:"".concat(He,"__file-fieldset"),fileLabel:"".concat(He,"__file-label"),fileName:"".concat(He,"__file-name"),fileInput:"".concat(He,"__file-input"),metadata:"".concat(He,"__metadata"),metadataFieldset:"".concat(He,"__metadata-fieldset"),progressBar:"".concat(He,"__progress-bar"),esriWidget:"esri-widget",esriButton:Ye,buttonDisabled:"".concat(Ye,"--disabled"),esriButtonSecondary:"".concat(Ye,"--secondary"),esriButtonTertiary:"".concat(Ye,"--tertiary"),esriButtonThird:"".concat(Ye,"--third"),esriButtonSmall:"".concat(Ye,"--small"),esriButtonHalf:"".concat(Ye,"--half"),empty:"esri-widget__content--empty",iconExternalLink:"esri-icon-link-external",iconEdit:"esri-icon-edit",iconRight:"esri-icon-right",iconLeft:"esri-icon-left",iconPlus:"esri-icon-plus"},Qe=window.CSS,Je=function(e){(0,s.Z)(i,e);var t=(0,l.Z)(i);function i(e,n){var a;return(0,r.Z)(this,i),(a=t.call(this,e,n)).displayType="auto",a.messages=null,a.messagesUnits=null,a.selectedFile=null,a.submitting=!1,a.viewModel=null,a.visibleElements=(0,I.Z)({},je),a._supportsImageOrientation=Qe&&Qe.supports&&Qe.supports("image-orientation","from-image"),a._addAttachmentForm=null,a._updateAttachmentForm=null,a}return(0,a.Z)(i,[{key:"initialize",value:function(){var e=this;this.viewModel||(this.viewModel=new ze),this.addHandles([(0,h.on)((function(){var t;return null===(t=e.viewModel)||void 0===t?void 0:t.attachmentInfos}),"change",(function(){return e.scheduleRender()})),(0,h.on)((function(){var t;return null===(t=e.viewModel)||void 0===t?void 0:t.fileInfos}),"change",(function(){return e.scheduleRender()})),(0,h.YP)((function(){var t;return null===(t=e.viewModel)||void 0===t?void 0:t.mode}),(function(){return e._modeChanged()}),h.nn)])}},{key:"loadDependencies",value:function(){return Promise.all([n.e(64756).then(n.bind(n,64756))])}},{key:"abilities",get:function(){return this.viewModel.abilities},set:function(e){this.viewModel.abilities=e}},{key:"effectiveDisplayType",get:function(){var e=this.displayType;return e&&"auto"!==e?e:this.viewModel.supportsResizeAttachments?"preview":"list"}},{key:"graphic",get:function(){return this.viewModel.graphic},set:function(e){this.viewModel.graphic=e}},{key:"label",get:function(){var e,t;return null!==(e=null===(t=this.messages)||void 0===t?void 0:t.widgetLabel)&&void 0!==e?e:""},set:function(e){this._overrideIfSome("label",e)}},{key:"castVisibleElements",value:function(e){return(0,I.Z)((0,I.Z)({},je),e)}},{key:"addAttachment",value:function(){var e=this,t=this._addAttachmentForm,n=this.viewModel;return this._set("submitting",!0),this._set("error",null),n.addAttachment(t).then((function(t){return e._set("submitting",!1),e._set("error",null),n.mode="view",t})).catch((function(t){throw e._set("submitting",!1),e._set("error",new L.Z("attachments:add-attachment",e.messages.addErrorMessage,t)),t}))}},{key:"deleteAttachment",value:function(e){var t=this,n=this.viewModel;return this._set("submitting",!0),this._set("error",null),n.deleteAttachment(e).then((function(e){return t._set("submitting",!1),t._set("error",null),n.mode="view",e})).catch((function(e){throw t._set("submitting",!1),t._set("error",new L.Z("attachments:delete-attachment",t.messages.deleteErrorMessage,e)),e}))}},{key:"updateAttachment",value:function(){var e=this,t=this.viewModel,n=this._updateAttachmentForm;return this._set("submitting",!0),this._set("error",null),t.updateAttachment(n).then((function(n){return e._set("submitting",!1),e._set("error",null),t.mode="view",n})).catch((function(t){throw e._set("submitting",!1),e._set("error",new L.Z("attachments:update-attachment",e.messages.updateErrorMessage,t)),t}))}},{key:"addFile",value:function(){var e=this.viewModel.addFile(this.selectedFile,this._addAttachmentForm);return this.viewModel.mode="view",e}},{key:"updateFile",value:function(){var e=this.viewModel,t=e.updateFile(this.selectedFile,this._updateAttachmentForm,e.activeFileInfo);return e.mode="view",t}},{key:"deleteFile",value:function(e){var t,n=this.viewModel.deleteFile(e||(null===(t=this.viewModel.activeFileInfo)||void 0===t?void 0:t.file));return this.viewModel.mode="view",n}},{key:"render",value:function(){var e=this.submitting,t=this.viewModel.state;return(0,We.u)("div",{class:this.classes(Ke.base,Ke.esriWidget)},e?this.renderProgressBar():null,"loading"===t?this.renderLoading():this.renderAttachments(),this.renderErrorMessage())}},{key:"renderErrorMessage",value:function(){var e=this.error,t=this.visibleElements;return e&&t.errorMessage?(0,We.u)("div",{key:"error-message",class:Ke.errorMessage},e.message):null}},{key:"renderAttachments",value:function(){var e=this.viewModel,t=e.activeFileInfo,n=e.mode,i=e.activeAttachmentInfo;return"add"===n?this.renderAddForm():"edit"===n?this.renderDetailsForm(i||t):this.renderAttachmentContainer()}},{key:"renderLoading",value:function(){return(0,We.u)("div",{class:Ke.loaderContainer,key:"loader"},(0,We.u)("div",{class:Ke.loader}))}},{key:"renderProgressBar",value:function(){return this.visibleElements.progressBar?(0,We.u)("div",{class:Ke.progressBar,key:"progress-bar"}):null}},{key:"renderAddForm",value:function(){var e=this.submitting,t=this.selectedFile,n=e||!t,i=this.visibleElements.cancelAddButton?(0,We.u)("button",{type:"button",bind:this,disabled:e,onclick:this._cancelForm,class:this.classes(Ke.esriButton,Ke.esriButtonTertiary,Ke.esriButtonSmall,Ke.esriButtonHalf,e&&Ke.buttonDisabled)},this.messages.cancel):null,r=this.visibleElements.addSubmitButton?(0,We.u)("button",{type:"submit",disabled:n,class:this.classes(Ke.esriButton,Ke.esriButtonSecondary,Ke.esriButtonSmall,Ke.esriButtonHalf,(0,x.Z)({},Ke.buttonDisabled,n))},this.messages.add):null,a=t?(0,We.u)("span",{key:"file-name",class:Ke.fileName},t.name):null,o=(0,We.u)("form",{bind:this,afterCreate:qe.Yo,afterRemoved:qe.pV,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},(0,We.u)("fieldset",{class:Ke.fileFieldset},a,(0,We.u)("label",{class:this.classes(Ke.fileLabel,Ke.esriButton,Ke.esriButtonSecondary)},t?this.messages.changeFile:this.messages.selectFile,(0,We.u)("input",{class:Ke.fileInput,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))),r,i);return(0,We.u)("div",{key:"add-form-container",class:Ke.formNode},o)}},{key:"renderDetailsForm",value:function(e){var t,n,i,r,a,o,s,l,u=this,c=this.visibleElements,d=this.viewModel,h=this.selectedFile,f=this.submitting,v=d.abilities,y=f||!h;h?(a=h.type,o=h.name,s=h.size):e&&"file"in e?(a=e.file.type,o=e.file.name,s=e.file.size):e&&"contentType"in e&&(a=e.contentType,o=e.name,s=e.size,l=e.url);var g=v.editing&&null!==(t=v.operations)&&void 0!==t&&t.delete&&c.deleteButton?(0,We.u)("button",{key:"delete-button",type:"button",disabled:f,bind:this,onclick:function(t){return u._submitDeleteAttachment(t,e)},class:this.classes(Ke.esriButton,Ke.esriButtonSmall,Ke.esriButtonTertiary,Ke.deleteButton,(0,x.Z)({},Ke.buttonDisabled,f))},this.messages.delete):void 0,m=v.editing&&null!==(n=v.operations)&&void 0!==n&&n.update&&c.updateButton?(0,We.u)("button",{disabled:y,key:"update-button",type:"submit",class:this.classes(Ke.esriButton,Ke.esriButtonSmall,Ke.esriButtonThird,(0,x.Z)({},Ke.buttonDisabled,y))},this.messages.update):void 0,_=this.visibleElements.cancelUpdateButton?(0,We.u)("button",{disabled:f,key:"cancel-button",type:"button",bind:this,onclick:this._cancelForm,class:this.classes(Ke.esriButton,Ke.esriButtonSmall,Ke.esriButtonTertiary,Ke.esriButtonThird,(0,x.Z)({},Ke.buttonDisabled,f))},this.messages.cancel):void 0,b=v.editing&&null!==(i=v.operations)&&void 0!==i&&i.update?(0,We.u)("fieldset",{key:"file",class:Ke.fileFieldset},(0,We.u)("span",{key:"file-name",class:Ke.fileName},o),(0,We.u)("label",{class:this.classes(Ke.fileLabel,Ke.esriButton,Ke.esriButtonSecondary)},this.messages.changeFile,(0,We.u)("input",{class:Ke.fileInput,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))):void 0,w=(0,We.u)("fieldset",{key:"size",class:Ke.metadataFieldset},(0,We.u)("label",null,(0,E.sS)(this.messagesUnits,null!==(r=s)&&void 0!==r?r:0))),k=(0,We.u)("fieldset",{key:"content-type",class:Ke.metadataFieldset},(0,We.u)("label",null,a)),C=(0,p.pC)(l)?(0,We.u)("a",{class:Ke.itemLink,href:l,rel:"noreferrer",target:"_blank"},this.renderImageMask(e,400),(0,We.u)("div",{class:Ke.itemLinkOverlay},(0,We.u)("span",{class:Ke.itemLinkOverlayIcon},(0,We.u)("calcite-icon",{icon:"launch"})))):this.renderImageMask(e,400),M=(0,We.u)("form",{bind:this,afterCreate:qe.Yo,afterRemoved:qe.pV,"data-node-ref":"_updateAttachmentForm",onsubmit:function(t){return u._submitUpdateAttachment(t,e)}},(0,We.u)("div",{class:Ke.metadata},w,k),b,(0,We.u)("div",{class:Ke.actions},g,_,m));return(0,We.u)("div",{key:"edit-form-container",class:Ke.formNode},C,M)}},{key:"renderImageMask",value:function(e,t){return e?"file"in e?this.renderGenericImageMask(e.file.name,e.file.type):this.renderImageMaskForAttachment(e,t):null}},{key:"renderGenericImageMask",value:function(e,t){var n=this.viewModel.supportsResizeAttachments,i=function(e){var t=(0,Be.V)("esri/themes/base/images/files/");return e?"text/plain"===e?"".concat(t,"text-32.svg"):"application/pdf"===e?"".concat(t,"pdf-32.svg"):"text/csv"===e?"".concat(t,"csv-32.svg"):"application/gpx+xml"===e?"".concat(t,"gpx-32.svg"):"application/x-dwf"===e?"".concat(t,"cad-32.svg"):"application/postscript"===e||"application/json"===e||"text/xml"===e||"model/vrml"===e?"".concat(t,"code-32.svg"):"application/x-zip-compressed"===e||"application/x-7z-compressed"===e||"application/x-gzip"===e||"application/x-tar"===e||"application/x-gtar"===e||"application/x-bzip2"===e||"application/gzip"===e||"application/x-compress"===e||"application/x-apple-diskimage"===e||"application/x-rar-compressed"===e||"application/zip"===e?"".concat(t,"zip-32.svg"):e.includes("image/")?"".concat(t,"image-32.svg"):e.includes("audio/")?"".concat(t,"sound-32.svg"):e.includes("video/")?"".concat(t,"video-32.svg"):e.includes("msexcel")||e.includes("ms-excel")||e.includes("spreadsheetml")?"".concat(t,"excel-32.svg"):e.includes("msword")||e.includes("ms-word")||e.includes("wordprocessingml")?"".concat(t,"word-32.svg"):e.includes("powerpoint")||e.includes("presentationml")?"".concat(t,"report-32.svg"):"".concat(t,"generic-32.svg"):"".concat(t,"generic-32.svg")}(t),r=(0,x.Z)({},Ke.itemImageResizable,n);return(0,We.u)("div",{class:this.classes(Ke.itemMaskIcon,Ke.itemMask)},(0,We.u)("img",{title:e,alt:e,src:i,class:this.classes(r,Ke.itemImage)}))}},{key:"renderImageMaskForAttachment",value:function(e,t){var n=this.viewModel.supportsResizeAttachments;if(!e)return null;var i=e.contentType,r=e.name,a=e.url;if(!n||!Ge(i))return this.renderGenericImageMask(r,i);var o=this._getCSSTransform(e),s=o?{transform:o,"image-orientation":"none"}:{},l="".concat(a).concat(null!==a&&void 0!==a&&a.includes("?")?"&":"?","w=").concat(t),u=(0,x.Z)({},Ke.itemImageResizable,n);return(0,We.u)("div",{class:this.classes(Ke.itemMask)},(0,We.u)("img",{styles:s,alt:r,title:r,src:l,class:this.classes(u,Ke.itemImage)}))}},{key:"renderFile",value:function(e){var t=this,n=e.file;return(0,We.u)("li",{class:Ke.item,key:n},(0,We.u)("button",{key:"details-button",bind:this,class:Ke.itemButton,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,onclick:function(){return t._startEditFile(e)},type:"button"},this.renderImageMask(e),(0,We.u)("label",{class:Ke.itemLabel},(0,We.u)("span",{class:Ke.itemFilename},n.name||this.messages.noTitle),(0,We.u)("span",{"aria-hidden":"true",class:this.classes(Ke.itemChevronIcon,(0,qe.dZ)(this.container)?Ke.iconLeft:Ke.iconRight)}))))}},{key:"renderAttachmentInfo",value:function(e){var t=this,n=e.attachmentInfo,i=e.displayType,r=this.viewModel,a=this.effectiveDisplayType,o=r.abilities,s=r.supportsResizeAttachments,l=n.contentType,u=n.name,c=n.url,d=this.renderImageMask(n,"list"===i?48:400),p=o.editing?(0,We.u)("span",{"aria-hidden":"true",class:this.classes(Ke.itemChevronIcon,(0,qe.dZ)(this.container)?Ke.iconLeft:Ke.iconRight)}):null,h=[d,"preview"===a&&s&&Ge(l)?null:(0,We.u)("label",{class:Ke.itemLabel},(0,We.u)("span",{class:Ke.itemFilename},u||this.messages.noTitle),p)],f=o.editing?(0,We.u)("button",{key:"details-button",bind:this,class:Ke.itemButton,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,"data-attachment-info-id":n.id,onclick:function(){return t._startEditAttachment(n)},type:"button"},h):(0,We.u)("a",{key:"details-link",class:Ke.itemButton,href:null!==c&&void 0!==c?c:void 0,target:"_blank"},h);return(0,We.u)("li",{class:Ke.item,key:n},f)}},{key:"renderAttachmentContainer",value:function(){var e,t,n=this,i=this.effectiveDisplayType,r=this.viewModel,a=this.visibleElements,o=r.attachmentInfos,s=r.abilities,l=r.fileInfos,u=!(null===o||void 0===o||!o.length),c=!(null===l||void 0===l||!l.length),d=(e={},(0,x.Z)(e,Ke.containerList,"preview"!==i),(0,x.Z)(e,Ke.containerPreview,"preview"===i),e),p=s.editing&&null!==(t=s.operations)&&void 0!==t&&t.add&&a.addButton?(0,We.u)("button",{bind:this,onclick:function(){return n._startAddAttachment()},class:this.classes(Ke.esriButton,Ke.esriButtonTertiary,Ke.addAttachmentButton),type:"button"},(0,We.u)("span",{"aria-hidden":"true",class:this.classes(Ke.itemAddIcon,Ke.iconPlus)}),this.messages.add):void 0,h=u?(0,We.u)("ul",{key:"attachments-list",class:Ke.items},o.toArray().map((function(e){return n.renderAttachmentInfo({attachmentInfo:e,displayType:i})}))):void 0,f=c?(0,We.u)("ul",{key:"file-list",class:Ke.items},l.toArray().map((function(e){return n.renderFile(e)}))):void 0,v=c||u?void 0:(0,We.u)("div",{class:Ke.empty},this.messages.noAttachments);return(0,We.u)("div",{key:"attachments-container",class:this.classes(Ke.container,d)},h,f,v,p)}},{key:"_modeChanged",value:function(){this._set("error",null),this._set("selectedFile",null)}},{key:"_handleFileInputChange",value:function(e){var t=e.target,n=t&&t.files&&t.files.item(0);this._set("selectedFile",n)}},{key:"_submitDeleteAttachment",value:function(e,t){e.preventDefault(),t&&("file"in t?this.deleteFile(t.file):t&&this.deleteAttachment(t))}},{key:"_submitAddAttachment",value:function(e){e.preventDefault(),this.viewModel.filesEnabled?this.addFile():this.addAttachment()}},{key:"_submitUpdateAttachment",value:function(e,t){e.preventDefault(),t&&"file"in t?this.updateFile():this.updateAttachment()}},{key:"_startEditAttachment",value:function(e){var t=this.viewModel;t.activeFileInfo=null,t.activeAttachmentInfo=e,t.mode="edit"}},{key:"_startEditFile",value:function(e){var t=this.viewModel;t.activeAttachmentInfo=null,t.activeFileInfo=e,t.mode="edit"}},{key:"_startAddAttachment",value:function(){this.viewModel.mode="add"}},{key:"_cancelForm",value:function(e){e.preventDefault(),this.viewModel.mode="view"}},{key:"_getCSSTransform",value:function(e){var t=e.orientationInfo;return!this._supportsImageOrientation&&t?[t.rotation?"rotate(".concat(t.rotation,"deg)"):"",t.mirrored?"scaleX(-1)":""].join(" "):""}}]),i}(P.Z);(0,u._)([(0,v.Cb)()],Je.prototype,"abilities",null),(0,u._)([(0,v.Cb)()],Je.prototype,"displayType",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],Je.prototype,"effectiveDisplayType",null),(0,u._)([(0,v.Cb)()],Je.prototype,"graphic",null),(0,u._)([(0,v.Cb)()],Je.prototype,"label",null),(0,u._)([(0,v.Cb)(),(0,Ue.H)("esri/widgets/Attachments/t9n/Attachments")],Je.prototype,"messages",void 0),(0,u._)([(0,v.Cb)(),(0,Ue.H)("esri/core/t9n/Units")],Je.prototype,"messagesUnits",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],Je.prototype,"selectedFile",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],Je.prototype,"submitting",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],Je.prototype,"error",void 0),(0,u._)([(0,v.Cb)({type:ze})],Je.prototype,"viewModel",void 0),(0,u._)([(0,v.Cb)()],Je.prototype,"visibleElements",void 0),(0,u._)([(0,F.p)("visibleElements")],Je.prototype,"castVisibleElements",null);var Xe=Je=(0,u._)([(0,y.j)("esri.widgets.Attachments")],Je),$e=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e){var i;return(0,r.Z)(this,n),(i=t.call(this,e)).description=null,i.title=null,i}return(0,a.Z)(n)}(ze);(0,u._)([(0,v.Cb)()],$e.prototype,"description",void 0),(0,u._)([(0,v.Cb)()],$e.prototype,"title",void 0);var et=$e=(0,u._)([(0,y.j)("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")],$e),tt=n(96919),nt="esri-feature-element-info",it={base:nt,title:"".concat(nt,"__title"),description:"".concat(nt,"__description")},rt=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e,i){var a;return(0,r.Z)(this,n),(a=t.call(this,e,i)).description=null,a.headingLevel=2,a.title=null,a}return(0,a.Z)(n,[{key:"render",value:function(){return(0,We.u)("div",{class:it.base},this.renderTitle(),this.renderDescription())}},{key:"renderTitle",value:function(){var e=this.title;return e?(0,We.u)(tt.X6,{level:this.headingLevel,class:it.title},e):null}},{key:"renderDescription",value:function(){var e=this.description;return e?(0,We.u)("div",{key:"description",class:it.description},e):null}}]),n}(P.Z);(0,u._)([(0,v.Cb)()],rt.prototype,"description",void 0),(0,u._)([(0,v.Cb)()],rt.prototype,"headingLevel",void 0),(0,u._)([(0,v.Cb)()],rt.prototype,"title",void 0);var at=rt=(0,u._)([(0,y.j)("esri.widgets.Feature.support.FeatureElementInfo")],rt),ot="esri-feature-attachments",st=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e,i){var a;return(0,r.Z)(this,n),(a=t.call(this,e,i))._featureElementInfo=null,a.attachmentsWidget=new Xe,a.headingLevel=2,a.viewModel=new et,a}return(0,a.Z)(n,[{key:"initialize",value:function(){var e=this;this._featureElementInfo=new at,this.addHandles([(0,h.YP)((function(){var t,n;return[null===(t=e.viewModel)||void 0===t?void 0:t.description,null===(n=e.viewModel)||void 0===n?void 0:n.title,e.headingLevel]}),(function(){return e._setupFeatureElementInfo()}),h.nn),(0,h.YP)((function(){return e.viewModel}),(function(t){return e.attachmentsWidget.viewModel=t}),h.nn)])}},{key:"destroy",value:function(){var e;this.attachmentsWidget.destroy(),null===(e=this._featureElementInfo)||void 0===e||e.destroy()}},{key:"description",get:function(){return this.viewModel.description},set:function(e){this.viewModel.description=e}},{key:"displayType",get:function(){return this.attachmentsWidget.displayType},set:function(e){this.attachmentsWidget.displayType=e}},{key:"graphic",get:function(){return this.viewModel.graphic},set:function(e){this.viewModel.graphic=e}},{key:"title",get:function(){return this.viewModel.title},set:function(e){this.viewModel.title=e}},{key:"render",value:function(){var e,t=this.attachmentsWidget;return(0,We.u)("div",{class:ot},null===(e=this._featureElementInfo)||void 0===e?void 0:e.render(),null===t||void 0===t?void 0:t.render())}},{key:"_setupFeatureElementInfo",value:function(){var e,t=this.description,n=this.title,i=this.headingLevel;null===(e=this._featureElementInfo)||void 0===e||e.set({description:t,title:n,headingLevel:i})}}]),n}(P.Z);(0,u._)([(0,v.Cb)({readOnly:!0})],st.prototype,"attachmentsWidget",void 0),(0,u._)([(0,v.Cb)()],st.prototype,"description",null),(0,u._)([(0,v.Cb)()],st.prototype,"displayType",null),(0,u._)([(0,v.Cb)()],st.prototype,"graphic",null),(0,u._)([(0,v.Cb)()],st.prototype,"headingLevel",void 0),(0,u._)([(0,v.Cb)()],st.prototype,"title",null),(0,u._)([(0,v.Cb)({type:et})],st.prototype,"viewModel",void 0);var lt=st=(0,u._)([(0,y.j)("esri.widgets.Feature.FeatureAttachments")],st),ut=n(41691),ct=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e){var i;return(0,r.Z)(this,n),(i=t.call(this,e))._loadingPromise=null,i.created=null,i.creator=null,i.destroyer=null,i.graphic=null,i.handles.add((0,h.YP)((function(){return i.creator}),(function(e){i._destroyContent(),i._createContent(e)}),h.nn)),i}return(0,a.Z)(n,[{key:"destroy",value:function(){this._destroyContent()}},{key:"state",get:function(){return this._loadingPromise?"loading":"ready"}},{key:"_destroyContent",value:function(){var e=this.created,t=this.graphic,n=this.destroyer;e&&t&&(re(n,{graphic:t}).catch((function(){return null})),this._set("created",null))}},{key:"_createContent",value:function(){var e=(0,m.Z)((0,g.Z)().mark((function e(t){var n,i,r;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=this.graphic)&&t){e.next=3;break}return e.abrupt("return");case 3:return i=re(t,{graphic:n}).catch((function(){return null})),this._loadingPromise=i,this.notifyChange("state"),e.next=7,i;case 7:r=e.sent,i===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",r));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}((0,ut.p)(b.Z));(0,u._)([(0,v.Cb)({readOnly:!0})],ct.prototype,"created",void 0),(0,u._)([(0,v.Cb)()],ct.prototype,"creator",void 0),(0,u._)([(0,v.Cb)()],ct.prototype,"destroyer",void 0),(0,u._)([(0,v.Cb)({type:R.Z})],ct.prototype,"graphic",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],ct.prototype,"state",null);var dt=ct=(0,u._)([(0,y.j)("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],ct),pt=n(53963),ht="esri-feature-content",ft={base:ht,loaderContainer:"".concat(ht,"__loader-container"),loader:"".concat(ht,"__loader")},vt=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e,i){var a;return(0,r.Z)(this,n),(a=t.call(this,e,i)).viewModel=null,a._addTargetToAnchors=function(e){Array.from(e.querySelectorAll("a")).forEach((function(e){oe(e.href)&&!e.hasAttribute("target")&&e.setAttribute("target","_blank")}))},a}return(0,a.Z)(n,[{key:"creator",get:function(){var e;return null===(e=this.viewModel)||void 0===e?void 0:e.creator},set:function(e){this.viewModel&&(this.viewModel.creator=e)}},{key:"graphic",get:function(){var e;return null===(e=this.viewModel)||void 0===e?void 0:e.graphic},set:function(e){this.viewModel&&(this.viewModel.graphic=e)}},{key:"renderLoading",value:function(){return(0,We.u)("div",{class:ft.loaderContainer,key:"loader"},(0,We.u)("div",{class:ft.loader}))}},{key:"renderCreated",value:function(){var e,t=null===(e=this.viewModel)||void 0===e?void 0:e.created;return t?t instanceof HTMLElement?(0,We.u)("div",{key:t,bind:t,afterCreate:this._attachToNode}):(0,pt.Qd)(t)?(0,We.u)("div",{key:t},!t.destroyed&&t.render()):(0,We.u)("div",{key:t,innerHTML:t,afterCreate:this._addTargetToAnchors}):null}},{key:"render",value:function(){var e,t=null===(e=this.viewModel)||void 0===e?void 0:e.state;return(0,We.u)("div",{class:ft.base},"loading"===t?this.renderLoading():this.renderCreated())}},{key:"_attachToNode",value:function(e){e.appendChild(this)}}]),n}(P.Z);(0,u._)([(0,v.Cb)()],vt.prototype,"creator",null),(0,u._)([(0,v.Cb)()],vt.prototype,"graphic",null),(0,u._)([(0,v.Cb)({type:dt})],vt.prototype,"viewModel",void 0);var yt=vt=(0,u._)([(0,y.j)("esri.widgets.Feature.FeatureContent")],vt),gt=n(89860),mt=n(16698),_t=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e){var i;return(0,r.Z)(this,n),(i=t.call(this,e)).attributes=null,i.expressionInfos=null,i.description=null,i.fieldInfos=null,i.title=null,i}return(0,a.Z)(n,[{key:"formattedFieldInfos",get:function(){var e=this.expressionInfos,t=this.fieldInfos,n=[];return null!==t&&void 0!==t&&t.forEach((function(t){if(!t.hasOwnProperty("visible")||t.visible){var i=t.clone();i.label=le(i,e),n.push(i)}})),n}}]),n}(b.Z);(0,u._)([(0,v.Cb)()],_t.prototype,"attributes",void 0),(0,u._)([(0,v.Cb)({type:[gt.Z]})],_t.prototype,"expressionInfos",void 0),(0,u._)([(0,v.Cb)()],_t.prototype,"description",void 0),(0,u._)([(0,v.Cb)({type:[mt.Z]})],_t.prototype,"fieldInfos",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],_t.prototype,"formattedFieldInfos",null),(0,u._)([(0,v.Cb)()],_t.prototype,"title",void 0);var bt=_t=(0,u._)([(0,y.j)("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],_t),wt=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];function kt(e){var t=null;return wt.some((function(n){return n.pattern.test(e)&&(t=n),!!t})),t}var Ct="esri-feature-fields",Mt={base:Ct,fieldHeader:"".concat(Ct,"__field-header"),fieldData:"".concat(Ct,"__field-data"),fieldDataDate:"".concat(Ct,"__field-data--date"),esriTable:"esri-widget__table"},Zt=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e,i){var a;return(0,r.Z)(this,n),(a=t.call(this,e,i))._featureElementInfo=null,a.viewModel=new bt,a.messages=null,a.messagesURIUtils=null,a}return(0,a.Z)(n,[{key:"initialize",value:function(){var e=this;this._featureElementInfo=new at,this.addHandles((0,h.YP)((function(){var t,n;return[null===(t=e.viewModel)||void 0===t?void 0:t.description,null===(n=e.viewModel)||void 0===n?void 0:n.title]}),(function(){return e._setupFeatureElementInfo()}),h.nn))}},{key:"destroy",value:function(){var e;null===(e=this._featureElementInfo)||void 0===e||e.destroy()}},{key:"attributes",get:function(){return this.viewModel.attributes},set:function(e){this.viewModel.attributes=e}},{key:"description",get:function(){return this.viewModel.description},set:function(e){this.viewModel.description=e}},{key:"expressionInfos",get:function(){return this.viewModel.expressionInfos},set:function(e){this.viewModel.expressionInfos=e}},{key:"fieldInfos",get:function(){return this.viewModel.fieldInfos},set:function(e){this.viewModel.fieldInfos=e}},{key:"title",get:function(){return this.viewModel.title},set:function(e){this.viewModel.title=e}},{key:"renderFieldInfo",value:function(e,t){var n=this.viewModel.attributes,i=e.fieldName,r=e.label||i,a=n?null==n[i]?"":n[i]:"",o=!(!e.format||!e.format.dateFormat),s="number"!=typeof a||o?function(e,t){if("string"!=typeof t||!t)return t;var n=kt(t);if(!n)return t;var i=t.match(n.pattern),r=i&&i[2],a=(0,N.gx)((0,N.gx)(n.label,{messages:e,hierPart:r}),{appName:n.appName}),o=n.target?' target="'.concat(n.target,'"'):"",s="_blank"===n.target?' rel="noreferrer"':"";return t.replace(n.pattern,"<a".concat(o,' href="$1"').concat(s,">").concat(a,"</a>"))}(this.messagesURIUtils,a):this._forceLTR(a),l=(0,x.Z)({},Mt.fieldDataDate,o);return(0,We.u)("tr",{key:"fields-element-info-row-".concat(i,"-").concat(t)},(0,We.u)("th",{key:"fields-element-info-row-header-".concat(i,"-").concat(t),class:Mt.fieldHeader,innerHTML:r}),(0,We.u)("td",{key:"fields-element-info-row-data-".concat(i,"-").concat(t),class:this.classes(Mt.fieldData,l),innerHTML:s}))}},{key:"renderFields",value:function(){var e=this,t=this.viewModel.formattedFieldInfos;return null!==t&&void 0!==t&&t.length?(0,We.u)("table",{class:Mt.esriTable,summary:this.messages.fieldsSummary},(0,We.u)("tbody",null,t.map((function(t,n){return e.renderFieldInfo(t,n)})))):null}},{key:"render",value:function(){var e;return(0,We.u)("div",{class:Mt.base},null===(e=this._featureElementInfo)||void 0===e?void 0:e.render(),this.renderFields())}},{key:"_setupFeatureElementInfo",value:function(){var e,t=this.description,n=this.title;null===(e=this._featureElementInfo)||void 0===e||e.set({description:t,title:n})}},{key:"_forceLTR",value:function(e){return"&lrm;".concat(e)}}]),n}(P.Z);(0,u._)([(0,v.Cb)()],Zt.prototype,"attributes",null),(0,u._)([(0,v.Cb)()],Zt.prototype,"description",null),(0,u._)([(0,v.Cb)()],Zt.prototype,"expressionInfos",null),(0,u._)([(0,v.Cb)()],Zt.prototype,"fieldInfos",null),(0,u._)([(0,v.Cb)()],Zt.prototype,"title",null),(0,u._)([(0,v.Cb)({type:bt,nonNullable:!0})],Zt.prototype,"viewModel",void 0),(0,u._)([(0,v.Cb)(),(0,Ue.H)("esri/widgets/Feature/t9n/Feature")],Zt.prototype,"messages",void 0),(0,u._)([(0,v.Cb)(),(0,Ue.H)("esri/widgets/support/t9n/uriUtils")],Zt.prototype,"messagesURIUtils",void 0);var xt=Zt=(0,u._)([(0,y.j)("esri.widgets.Feature.FeatureFields")],Zt),It=n(99388),Tt=n(60260),St=n(76200),At=n(66978),Ft=(n(93169),n(64020),n(77946)),Pt=(n(42265),n(19545),n(35995),n(68860),n(92975),n(83406),n(53866),n(32238),n(77577),n(585)),Lt=(n(80885),n(29909),n(91340),n(78084),n(49818),n(21149)),Et=(n(59486),n(99086)),Rt=(n(54307),n(33997)),Vt=d.Z.getLogger("esri.widgets.Feature.support.relatedFeatureUtils"),Ot=new Map;function Dt(e){if(!Pe(e))return null;var t=e.split("/").slice(1),n=(0,i.Z)(t,2);return{layerId:n[0],fieldName:n[1]}}function Nt(e){var t=e.originRelationship,n=e.relationships,i=e.layerId,r=null;return n&&n.some((function(e){return"".concat(e.relatedTableId)===i&&e.id===(null===t||void 0===t?void 0:t.id)&&(r=e),!!r})),r}function zt(e,t){var n=t.toLowerCase();for(var i in e)if(i.toLowerCase()===n)return e[i];return null}function Bt(e,t){var n=function(e,t){if(!t.relationships)return null;var n=null;return t.relationships.some((function(t){return t.id===parseInt(e,10)&&(n=t,!0)})),n}(e,t);if(n)return{url:"".concat(t.url,"/").concat(n.relatedTableId),sourceSpatialReference:t.spatialReference,relation:n,relatedFields:[],outStatistics:[]}}function Gt(e,t){if(t&&e){var n=e.features,i=e.statsFeatures,r=n&&n.value;t.relatedFeatures=r?r.features:[];var a=i&&i.value;t.relatedStatsFeatures=a?a.features:[]}}function qt(e,t,n,i){var r,a,o=new Et.default;return o.outFields=["*"],o.relationshipId="number"==typeof t.id?t.id:parseInt(t.id,10),o.objectIds=[e.attributes[n.objectIdField]],null!==(r=null===(a=n.queryRelatedFeatures)||void 0===a?void 0:a.call(n,o,i))&&void 0!==r?r:Promise.resolve({})}function Ut(e,t,n){for(var i=0,r=[];i<t.length;)r.push("".concat(e," IN (").concat(t.slice(i,n+i),")")),i+=n;return r.join(" OR ")}function Wt(){return Wt=(0,m.Z)((0,g.Z)().mark((function e(t,n,i,r){var a,o,s,l,u,c,d,p,h,f,v,y,m,_,b,w,k,C,M;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=i.layerId.toString(),o=n.layerInfo,s=n.relation,l=n.relatedFields,u=n.outStatistics,c=n.url,d=n.sourceSpatialReference,o&&s){e.next=3;break}return e.abrupt("return",null);case 3:if(null===(p=Nt({originRelationship:s,relationships:o.relationships,layerId:a}))||void 0===p||!p.relationshipTableId||!p.keyFieldInRelationshipTable){e.next=17;break}return e.next=7,qt(t,p,i,r);case 7:if(e.t0=t.attributes[i.objectIdField],h=e.sent[e.t0]){e.next=11;break}return e.abrupt("return",null);case 11:if(f=h.features.map((function(e){return e.attributes[o.objectIdField]})),null===u||void 0===u||!u.length||!o.supportsStatistics){e.next=17;break}return(v=new Lt.Z).where=Ut(o.objectIdField,f,1e3),v.outFields=l,v.outStatistics=u,v.sourceSpatialReference=d,y={features:Promise.resolve(h),statsFeatures:(0,Ft.e)(c,v)},e.abrupt("return",(0,At.as)(y));case 17:if(!(m=null===p||void 0===p?void 0:p.keyField)){e.next=21;break}return _=(0,G.H7)(Yt(o.fields,m)),b=zt(t.attributes,s.keyField),w=_?"".concat(m,"=").concat(b):"".concat(m,"='").concat(b,"'"),k=(0,Ft.e)(c,new Lt.Z({where:w,outFields:n.relatedFields,sourceSpatialReference:d}),r),C=n.outStatistics&&n.outStatistics.length>0&&o.supportsStatistics?(0,Ft.e)(c,new Lt.Z({where:w,outFields:n.relatedFields,outStatistics:n.outStatistics,sourceSpatialReference:d}),r):null,M={features:k},e.abrupt("return",(C&&(M.statsFeatures=C),(0,At.as)(M)));case 21:return e.abrupt("return",null);case 22:case"end":return e.stop()}}),e)}))),Wt.apply(this,arguments)}function jt(e,t){var n=e.relatedInfos,i=e.layer,r={};return n.forEach((function(e,t){var n=e.relation;if(!n){var a=new L.Z("relation-required","A relation is required on a layer to retrieve related records.");throw Vt.error(a),a}var o=n.relatedTableId;if("number"!=typeof o){var s=new L.Z("A related table ID is required on a layer to retrieve related records.");throw Vt.error(s),s}var l="".concat(i.url,"/").concat(o),u=Ot.get(l),c=u||function(e,t){return(0,St.default)(e,{query:{f:"json"},signal:t&&t.signal})}(l);u||Ot.set(l,c),r[t]=c})),(0,At.Hl)((0,At.as)(r),t)}function Ht(e,t){var n=e.graphic,i=e.relatedInfos,r=e.layer,a={};return i.forEach((function(e,i){e.layerInfo&&(a[i]=function(e,t,n,i){return Wt.apply(this,arguments)}(n,e,r,t))})),(0,At.as)(a)}function Yt(e,t){if(null!=e){t=t.toLowerCase();var n,i=(0,_.Z)(e);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(r&&r.name.toLowerCase()===t)return r}}catch(a){i.e(a)}finally{i.f()}}return null}var Kt={chartAnimation:!0},Qt=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e){var i;return(0,r.Z)(this,n),(i=t.call(this,e)).abilities=(0,I.Z)({},Kt),i.activeMediaInfoIndex=0,i.attributes=null,i.description=null,i.fieldInfoMap=null,i.formattedAttributes=null,i.expressionAttributes=null,i.isAggregate=!1,i.layer=null,i.mediaInfos=null,i.popupTemplate=null,i.relatedInfos=null,i.title=null,i}return(0,a.Z)(n,[{key:"castAbilities",value:function(e){return(0,I.Z)((0,I.Z)({},Kt),e)}},{key:"activeMediaInfo",get:function(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}},{key:"formattedMediaInfos",get:function(){return this._formatMediaInfos()||[]}},{key:"formattedMediaInfoCount",get:function(){return this.formattedMediaInfos.length}},{key:"setActiveMedia",value:function(e){this._setContentElementMedia(e)}},{key:"next",value:function(){this._pageContentElementMedia(1)}},{key:"previous",value:function(){this._pageContentElementMedia(-1)}},{key:"_setContentElementMedia",value:function(e){var t=this.formattedMediaInfoCount,n=(e+t)%t;this.activeMediaInfoIndex=n}},{key:"_pageContentElementMedia",value:function(e){var t=this.activeMediaInfoIndex+e;this._setContentElementMedia(t)}},{key:"_formatMediaInfos",value:function(){var e,t,n,i,r,a=this,o=this.mediaInfos,s=this.layer,l=null!==(e=this.attributes)&&void 0!==e?e:{},u=null!==(t=this.formattedAttributes)&&void 0!==t?t:{},c=null!==(n=this.expressionAttributes)&&void 0!==n?n:{},d=null!==(i=this.fieldInfoMap)&&void 0!==i?i:new Map;return null!==(r=null===o||void 0===o?void 0:o.map((function(e){var t=null===e||void 0===e?void 0:e.clone();if(!t)return null;if(t.title=pe({attributes:l,fieldInfoMap:d,globalAttributes:u,expressionAttributes:c,layer:s,text:t.title}),t.caption=pe({attributes:l,fieldInfoMap:d,globalAttributes:u,expressionAttributes:c,layer:s,text:t.caption}),t.altText=pe({attributes:l,fieldInfoMap:d,globalAttributes:u,expressionAttributes:c,layer:s,text:t.altText}),"image"===t.type){var n=t.value;return a._setImageValue({value:n,formattedAttributes:u,layer:s}),t.value.sourceURL?t:void 0}if("pie-chart"===t.type||"line-chart"===t.type||"column-chart"===t.type||"bar-chart"===t.type){var i=t.value;return a._setChartValue({value:i,chartType:t.type,attributes:l,formattedAttributes:u,layer:s,expressionAttributes:c}),t}return null})).filter(p.pC))&&void 0!==r?r:[]}},{key:"_setImageValue",value:function(e){var t,n=null!==(t=this.fieldInfoMap)&&void 0!==t?t:new Map,i=e.value,r=e.formattedAttributes,a=e.layer,o=i.linkURL,s=i.sourceURL;if(s){var l=ye(s,a);i.sourceURL=he({formattedAttributes:r,template:l,fieldInfoMap:n})}if(o){var u=ye(o,a);i.linkURL=he({formattedAttributes:r,template:u,fieldInfoMap:n})}}},{key:"_setChartValue",value:function(e){var t,n=this,i=e.value,r=e.attributes,a=e.formattedAttributes,o=e.chartType,s=e.layer,l=e.expressionAttributes,u=this.popupTemplate,c=this.relatedInfos,d=i.fields,p=i.normalizeField,h=s;if(i.fields=function(e,t){return e&&e.map((function(e){return ue(e,t)}))}(d,h),p&&(i.normalizeField=ue(p,h)),d.some((function(e){return!!(null!=a[e]||Pe(e)&&null!==c&&void 0!==c&&c.size)}))){var f=null!==(t=null===u||void 0===u?void 0:u.fieldInfos)&&void 0!==t?t:[];d.forEach((function(e){if(Pe(e))i.series=[].concat((0,D.Z)(i.series),(0,D.Z)(n._getRelatedChartInfos({fieldInfos:f,fieldName:e,formattedAttributes:a,chartType:o,value:i})));else{var t=n._getChartOption({value:i,attributes:r,chartType:o,formattedAttributes:a,expressionAttributes:l,fieldName:e,fieldInfos:f});i.series.push(t)}}))}}},{key:"_getRelatedChartInfos",value:function(e){var t,n=this,i=e.fieldInfos,r=e.fieldName,a=e.formattedAttributes,o=e.chartType,s=e.value,l=[],u=Dt(r),c=u&&(null===(t=this.relatedInfos)||void 0===t?void 0:t.get(u.layerId.toString()));if(!c)return l;var d=c.relatedFeatures,p=c.relation;if(!p||!d)return l;var h=p.cardinality;return d.forEach((function(e){var t=e.attributes;t&&Object.keys(t).forEach((function(e){e===u.fieldName&&l.push(n._getChartOption({value:s,attributes:t,formattedAttributes:a,fieldName:r,chartType:o,relatedFieldName:e,hasMultipleRelatedFeatures:(null===d||void 0===d?void 0:d.length)>1,fieldInfos:i}))}))})),"one-to-many"===h||"many-to-many"===h?l:[l[0]]}},{key:"_getTooltip",value:function(e){var t=e.label,n=e.value;return"pie-chart"===e.chartType?"".concat(t):"".concat(t,": ").concat(n)}},{key:"_getChartOption",value:function(e){var t,n,i=e.value,r=e.attributes,a=e.formattedAttributes,o=e.expressionAttributes,s=e.fieldName,l=e.relatedFieldName,u=e.fieldInfos,c=e.chartType,d=e.hasMultipleRelatedFeatures,p=this.layer,h=null!==(t=this.fieldInfoMap)&&void 0!==t?t:new Map,f=i.normalizeField,v=i.tooltipField,y=f?Pe(f)?r[Dt(f).fieldName]:r[f]:null,g=se(s)&&o&&void 0!==o[s]?o[s]:l&&void 0!==r[l]?r[l]:void 0!==r[s]?r[s]:a[s],m=new Tt.Z({fieldName:s,value:void 0===g?null:g&&y?g/y:g});if(Pe(s)){var _,b,w,k,C,M=h.get(s.toLowerCase()),Z=v&&h.get(v.toLowerCase()),x=null!==(_=null===M||void 0===M?void 0:M.fieldName)&&void 0!==_?_:s,I=d&&v?Dt(v).fieldName:null!==(b=null===Z||void 0===Z?void 0:Z.fieldName)&&void 0!==b?b:v,T=d&&I?r[I]:null!==(w=null!==(k=null!==(C=a[I])&&void 0!==C?C:null===M||void 0===M?void 0:M.label)&&void 0!==k?k:null===M||void 0===M?void 0:M.fieldName)&&void 0!==w?w:l,S=d&&l?r[l]:a[x];return m.tooltip=this._getTooltip({label:T,value:S,chartType:c}),m}var A=be(u,s),F=ue(s,p),P=v&&void 0!==a[v]?a[v]:le(A||new mt.Z({fieldName:F}),null===(n=this.popupTemplate)||void 0===n?void 0:n.expressionInfos),L=a[F];return m.tooltip=this._getTooltip({label:P,value:L,chartType:c}),m}}]),n}(b.Z);(0,u._)([(0,v.Cb)()],Qt.prototype,"abilities",void 0),(0,u._)([(0,F.p)("abilities")],Qt.prototype,"castAbilities",null),(0,u._)([(0,v.Cb)()],Qt.prototype,"activeMediaInfoIndex",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],Qt.prototype,"activeMediaInfo",null),(0,u._)([(0,v.Cb)()],Qt.prototype,"attributes",void 0),(0,u._)([(0,v.Cb)()],Qt.prototype,"description",void 0),(0,u._)([(0,v.Cb)()],Qt.prototype,"fieldInfoMap",void 0),(0,u._)([(0,v.Cb)()],Qt.prototype,"formattedAttributes",void 0),(0,u._)([(0,v.Cb)()],Qt.prototype,"expressionAttributes",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],Qt.prototype,"formattedMediaInfos",null),(0,u._)([(0,v.Cb)()],Qt.prototype,"isAggregate",void 0),(0,u._)([(0,v.Cb)()],Qt.prototype,"layer",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],Qt.prototype,"formattedMediaInfoCount",null),(0,u._)([(0,v.Cb)()],Qt.prototype,"mediaInfos",void 0),(0,u._)([(0,v.Cb)()],Qt.prototype,"popupTemplate",void 0),(0,u._)([(0,v.Cb)()],Qt.prototype,"relatedInfos",void 0),(0,u._)([(0,v.Cb)()],Qt.prototype,"title",void 0);var Jt=Qt=(0,u._)([(0,y.j)("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],Qt),Xt=["#ffffff","#858585","#ffbebe","#ffebbe","#ffebaf","#ffffbe","#e9ffbe","#d3ffbe","#beffe8","#bee8ff","#bed2ff","#e8beff","#ffbee8","#ebebeb","#707070","#ff7f7f","#ffa77f","#ffd37f","#ffff73","#d1ff73","#a3ff73","#73ffdf","#73dfff","#73b2ff","#df73ff","#ff73df","#d6d6d6","#5c5c5c","#ff0000","#ff5500","#ffaa00","#ffff00","#aaff00","#55ff00","#00ffc5","#00c5ff","#0070ff","#c500ff","#ff00c5","#c2c2c2","#474747","#e60000","#e64c00","#e69800","#e6e600","#98e600","#4ce600","#00e6a9","#00a9e6","#005ce6","#a900e6","#e600a9","#adadad","#242424","#a80000","#a83800","#a87000","#a8a800","#70a800","#38a800","#00a884","#0084a8","#004da8","#8400a8","#a80084","#999999","#1a1a1a","#730000","#732600","#734c00","#737300","#4c7300","#267300","#00734c","#004c73","#002673","#4c0073","#73004"],$t=[].concat(Xt.slice(30,39),Xt.slice(28,30).reverse()),en=[{name:"default",colors:$t},{name:"cat-dark",colors:["#ed5151","#149ece","#a7c636","#9e559c","#fc921f","#ffde3e","#f789d8","#b7814a","#3caf99","#6b6bd6","#b54779","#7f7f7f"]},{name:"tropical-bliss",colors:["#fce138","#ff9399","#fcd27e","#f1983c","#a553b7","#b1a9d0","#6ecffc","#4c81cd","#fc6f84","#fc3e5a","#6af689","#48885c"]},{name:"desert-blooms",colors:["#102432","#144d59","#ffc730","#ed9310","#a64f1b","#661510","#d9351a","#b31515","#4a0932","#8c213f","#18382e","#2c6954"]},{name:"under-the-sea",colors:["#bf9727","#607100","#00734c","#704489","#01acca","#024e76","#f09100","#ea311f","#c6004b","#7570b3","#666666","#333333"]},{name:"vibrant-rainbow",colors:["#fffb00","#f5cb11","#9fd40c","#46e39c","#32b8a6","#7ff2fa","#ac08cc","#dd33ff","#eb7200","#e8a784","#bf2e2e","#6c7000"]},{name:"ocean-bay",colors:["#191921","#11495c","#78b1c2","#454f4b","#8f8f82","#9be0c0","#87b051","#f7ec88","#ebdcc1","#dbb658","#c43541","#75351e"]},{name:"prairie-summer",colors:["#332424","#751555","#d47013","#d68989","#211173","#82aad6","#7bfaeb","#6ec9a8","#6b6408","#eada40","#ccc54a","#1fc235"]},{name:"pastel-chalk",colors:["#fffd99","#f5e6a4","#c1d48c","#b8e3d0","#a0b8b5","#cbf7fa","#d791f2","#dfc1eb","#f2b983","#e8c4b2","#bf8e8e","#94995c"]},{name:"seq-yellow-orange-red-bright",colors:["#910000","#b1260b","#c0370f","#e05919","#ef6a1d","#ff7b22","#ffa143","#ffb454","#ffda74","#ffed85"]},{name:"seq-reds-bright",colors:["#57453b","#7b4238","#9f4036","#c23d33","#d7483c","#ec5244","#f3696c","#f9816c","#ffc4ae","#fff0dc"]},{name:"seq-purples-bright",colors:["#4e465c","#5a4a78","#695291","#775baa","#8663c3","#946bdc","#aa89e8","#c1a6f3","#d7c4ff","#e6e1ff"]},{name:"seq-blues-bright",colors:["#404d54","#435c6c","#48799d","#4b88b6","#4d96ce","#50a5e7","#74bbed","#98d0f3","#bce6f9","#e6faff"]},{name:"seq-greens-bright",colors:["#39544c","#386757","#368165","#359b73","#33b581","#4bc392","#64d2a2","#7ce0b3","#cbf6d9","#f4ffea"]},{name:"seq-browns-bright",colors:["#524834","#715b38","#8f6e3c","#ae8140","#cc9444","#eba748","#eeb664","#f0c47f","#f9e0b7","#fff8eb"]}],tn=n(36257),nn="en-us",rn=new Map([["ar",function(){return n.e(39440).then(n.bind(n,39440)).then((function(e){return e.a}))}],["bg-bg",function(){return n.e(46647).then(n.bind(n,46647)).then((function(e){return e.b}))}],["bs-ba",function(){return n.e(45546).then(n.bind(n,45546)).then((function(e){return e.b}))}],["ca-es",function(){return n.e(27143).then(n.bind(n,27143)).then((function(e){return e.c}))}],["cs-cz",function(){return n.e(23863).then(n.bind(n,23863)).then((function(e){return e.c}))}],["da-dk",function(){return n.e(62668).then(n.bind(n,62668)).then((function(e){return e.d}))}],["de-de",function(){return n.e(60591).then(n.bind(n,60591)).then((function(e){return e.d}))}],["de-ch",function(){return n.e(77393).then(n.bind(n,77393)).then((function(e){return e.d}))}],["el-gr",function(){return n.e(54052).then(n.bind(n,54052)).then((function(e){return e.e}))}],["en-us",function(){return n.e(1304).then(n.bind(n,1304)).then((function(e){return e.e}))}],["en-ca",function(){return n.e(92922).then(n.bind(n,92922)).then((function(e){return e.e}))}],["es-es",function(){return n.e(64720).then(n.bind(n,64720)).then((function(e){return e.e}))}],["et-ee",function(){return n.e(35773).then(n.bind(n,35773)).then((function(e){return e.e}))}],["fi-fi",function(){return n.e(90098).then(n.bind(n,90098)).then((function(e){return e.f}))}],["fr-fr",function(){return n.e(46682).then(n.bind(n,46682)).then((function(e){return e.f}))}],["he-il",function(){return n.e(48257).then(n.bind(n,48257)).then((function(e){return e.h}))}],["hr-hr",function(){return n.e(32627).then(n.bind(n,32627)).then((function(e){return e.h}))}],["hu-hu",function(){return n.e(84888).then(n.bind(n,84888)).then((function(e){return e.h}))}],["id-id",function(){return n.e(48578).then(n.bind(n,48578)).then((function(e){return e.i}))}],["it-it",function(){return n.e(53907).then(n.bind(n,53907)).then((function(e){return e.i}))}],["ja-jp",function(){return n.e(5649).then(n.bind(n,5649)).then((function(e){return e.j}))}],["ko-kr",function(){return n.e(13625).then(n.bind(n,13625)).then((function(e){return e.k}))}],["lt-lt",function(){return n.e(33318).then(n.bind(n,33318)).then((function(e){return e.l}))}],["lv-lv",function(){return n.e(45429).then(n.bind(n,45429)).then((function(e){return e.l}))}],["nb-no",function(){return n.e(54422).then(n.bind(n,54422)).then((function(e){return e.n}))}],["nl-nl",function(){return n.e(93834).then(n.bind(n,93834)).then((function(e){return e.n}))}],["pl-pl",function(){return n.e(92141).then(n.bind(n,92141)).then((function(e){return e.p}))}],["pt-br",function(){return n.e(98915).then(n.bind(n,98915)).then((function(e){return e.p}))}],["pt-pt",function(){return n.e(77643).then(n.bind(n,77643)).then((function(e){return e.p}))}],["ro-ro",function(){return n.e(620).then(n.bind(n,620)).then((function(e){return e.r}))}],["ru-ru",function(){return n.e(50428).then(n.bind(n,50428)).then((function(e){return e.r}))}],["sk-sk",function(){return n.e(64699).then(n.bind(n,64699)).then((function(e){return e.s}))}],["sl-sl",function(){return n.e(91416).then(n.bind(n,91416)).then((function(e){return e.s}))}],["sr-rs",function(){return n.e(24078).then(n.bind(n,24078)).then((function(e){return e.s}))}],["sv-se",function(){return n.e(97930).then(n.bind(n,97930)).then((function(e){return e.s}))}],["th-th",function(){return n.e(90213).then(n.bind(n,90213)).then((function(e){return e.t}))}],["tr-tr",function(){return n.e(26979).then(n.bind(n,26979)).then((function(e){return e.t}))}],["uk-ua",function(){return n.e(88872).then(n.bind(n,66602)).then((function(e){return e.u}))}],["vi-vn",function(){return n.e(41870).then(n.bind(n,41870)).then((function(e){return e.v}))}],["zh-cn",function(){return n.e(50323).then(n.bind(n,50323)).then((function(e){return e.z}))}],["zh-hk",function(){return n.e(9105).then(n.bind(n,9105)).then((function(e){return e.z}))}],["zh-tw",function(){return n.e(9105).then(n.bind(n,9105)).then((function(e){return e.z}))}]]);function an(e){return e?rn.has(e.toLowerCase())?e.toLowerCase():function(e){var t,n=e.split("-")[0].toLowerCase(),i=null,r=(0,_.Z)(rn.keys());try{for(r.s();!(t=r.n()).done;){var a=t.value;if(a.startsWith(n)){i=a;break}}}catch(o){r.e(o)}finally{r.f()}return i}(e)||nn:nn}var on=null,sn=null;function ln(){return un.apply(this,arguments)}function un(){return un=(0,m.Z)((0,g.Z)().mark((function e(){var t,r,a,o,s,l=arguments;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=an(t=l.length>0&&void 0!==l[0]?l[0]:(0,tn.Kd)()),!on||t!==sn){e.next=3;break}return e.abrupt("return",on);case 3:return on=n.e(43457).then(n.bind(n,43457)).then((function(e){return e.i})),sn=t,e.prev=4,e.next=7,Promise.all([on,rn.get(sn)()]);case 7:r=e.sent,a=(0,i.Z)(r,2),o=a[0],s=a[1],sn===t&&(o.am4core.options.defaultLocale=s.default),o.am4core.options.suppressWarnings=!0,o.am4core.options.autoDispose=!0,e.next=17;break;case 14:return e.prev=14,e.t0=e.catch(4),e.abrupt("return",(on=null,sn=null,null));case 17:return e.abrupt("return",on);case 18:case"end":return e.stop()}}),e,null,[[4,14]])}))),un.apply(this,arguments)}function cn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",n=en.find((function(e){return e.name===t}));return n?n.colors.map((function(t){return e.color(t)})):null}var dn=n(37384),pn="esri-feature-media",hn={base:pn,mediaContainer:"".concat(pn,"__container"),mediaItemContainer:"".concat(pn,"__item-container"),mediaItem:"".concat(pn,"__item"),mediaItemTitle:"".concat(pn,"__item-title"),mediaItemCaption:"".concat(pn,"__item-caption"),mediaPrevious:"".concat(pn,"__previous"),mediaPreviousIconLTR:"".concat(pn,"__previous-icon"),mediaPreviousIconRTL:"".concat(pn,"__previous-icon--rtl"),mediaNext:"".concat(pn,"__next"),mediaNextIconLTR:"".concat(pn,"__next-icon"),mediaNextIconRTL:"".concat(pn,"__next-icon--rtl"),mediaChart:"".concat(pn,"__chart"),mediaButton:"".concat(pn,"__button"),mediaIcon:"".concat(pn,"__icon"),iconLeftTriangleArrow:"esri-icon-left-triangle-arrow",iconRightTriangleArrow:"esri-icon-right-triangle-arrow"},fn=.05,vn=.95,yn="color",gn="tooltip",mn="value",_n="default-line-value",bn=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e,i){var a;return(0,r.Z)(this,n),(a=t.call(this,e,i))._refreshTimer=null,a._refreshIntervalInfo=null,a._featureElementInfo=null,a.viewModel=new Jt,a.messages=null,a._getChartDependencies=function(){var e=(0,m.Z)((0,g.Z)().mark((function e(t){var n,i,r,s,l,u;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ln();case 2:if(n=e.sent,i=(0,o.Z)(a),r=i.destroyed,s=i.viewModel,!r&&s&&t){e.next=8;break}return e.abrupt("return");case 8:return l=s.activeMediaInfo,e.next=11,a._getRendererColors(n);case 11:u=e.sent,a._renderChart({chartDiv:t,mediaInfo:l,chartsModule:n,colorMap:u});case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a}return(0,a.Z)(n,[{key:"initialize",value:function(){var e=this;this._featureElementInfo=new at,this.addHandles([(0,h.YP)((function(){var t,n;return[null===(t=e.viewModel)||void 0===t?void 0:t.activeMediaInfo,null===(n=e.viewModel)||void 0===n?void 0:n.activeMediaInfoIndex]}),(function(){return e._setupMediaRefreshTimer()}),h.nn),(0,h.YP)((function(){var t,n;return[null===(t=e.viewModel)||void 0===t?void 0:t.description,null===(n=e.viewModel)||void 0===n?void 0:n.title]}),(function(){return e._setupFeatureElementInfo()}),h.nn)])}},{key:"destroy",value:function(){var e;this._clearMediaRefreshTimer(),null===(e=this._featureElementInfo)||void 0===e||e.destroy()}},{key:"attributes",get:function(){return this.viewModel.attributes},set:function(e){this.viewModel.attributes=e}},{key:"activeMediaInfoIndex",get:function(){return this.viewModel.activeMediaInfoIndex},set:function(e){this.viewModel.activeMediaInfoIndex=e}},{key:"description",get:function(){return this.viewModel.description},set:function(e){this.viewModel.description=e}},{key:"fieldInfoMap",get:function(){return this.viewModel.fieldInfoMap},set:function(e){this.viewModel.fieldInfoMap=e}},{key:"layer",get:function(){return this.viewModel.layer},set:function(e){this.viewModel.layer=e}},{key:"mediaInfos",get:function(){return this.viewModel.mediaInfos},set:function(e){this.viewModel.mediaInfos=e}},{key:"popupTemplate",get:function(){return this.viewModel.popupTemplate},set:function(e){this.viewModel.popupTemplate=e}},{key:"relatedInfos",get:function(){return this.viewModel.relatedInfos},set:function(e){this.viewModel.relatedInfos=e}},{key:"title",get:function(){return this.viewModel.title},set:function(e){this.viewModel.title=e}},{key:"render",value:function(){var e;return(0,We.u)("div",{bind:this,class:hn.base,onkeyup:this._handleMediaKeyup},null===(e=this._featureElementInfo)||void 0===e?void 0:e.render(),this.renderMedia())}},{key:"renderMedia",value:function(){return this.viewModel.formattedMediaInfoCount?(0,We.u)("div",{key:"media-element-container",class:hn.mediaContainer},this.renderMediaPageButton("previous"),this.renderMediaInfo(),this.renderMediaPageButton("next")):null}},{key:"renderImageMediaInfo",value:function(e){var t=this._refreshIntervalInfo,n=this.viewModel,i=n.activeMediaInfoIndex,r=n.formattedMediaInfoCount,a=e.value,o=e.refreshInterval,s=e.altText,l=e.title,u=e.type,c=a.sourceURL,d=a.linkURL,p=oe(null!==d&&void 0!==d?d:void 0)?"_blank":"_self",h="_blank"===p?"noreferrer":"",f=o?t:null,v=f?f.timestamp:0,y=f?f.sourceURL:c,g=(0,We.u)("img",{alt:s||l,key:"media-".concat(u,"-").concat(i,"-").concat(r,"-").concat(v),src:null!==y&&void 0!==y?y:void 0});return(d?(0,We.u)("a",{title:l,href:d,rel:h,target:p},g):null)||g}},{key:"renderChartMediaInfo",value:function(e){var t=this.viewModel,n=t.activeMediaInfoIndex,i=t.formattedMediaInfoCount;return(0,We.u)("div",{key:"media-".concat(e.type,"-").concat(n,"-").concat(i),bind:this,class:hn.mediaChart,afterCreate:this._getChartDependencies})}},{key:"renderMediaInfoType",value:function(){var e=this.viewModel.activeMediaInfo;return e?"image"===e.type?this.renderImageMediaInfo(e):e.type.includes("chart")?this.renderChartMediaInfo(e):null:null}},{key:"renderMediaInfo",value:function(){var e=this.viewModel.activeMediaInfo;if(!e)return null;var t=e.title?(0,We.u)("div",{key:"media-title",class:hn.mediaItemTitle,innerHTML:e.title}):null,n=e.caption?(0,We.u)("div",{key:"media-caption",class:hn.mediaItemCaption,innerHTML:e.caption}):null;return(0,We.u)("div",{key:"media-container",class:hn.mediaItemContainer},(0,We.u)("div",{key:"media-item-container",class:hn.mediaItem},this.renderMediaInfoType()),t,n)}},{key:"renderMediaPageButton",value:function(e){if(this.viewModel.formattedMediaInfoCount<2)return null;var t="previous"===e,n=t?this.messages.previous:this.messages.next,i=t?this.classes(hn.mediaButton,hn.mediaPrevious):this.classes(hn.mediaButton,hn.mediaNext),r=t?this.classes(hn.mediaIcon,hn.mediaPreviousIconLTR,hn.iconLeftTriangleArrow):this.classes(hn.mediaIcon,hn.mediaNextIconLTR,hn.iconRightTriangleArrow),a=t?this.classes(hn.mediaIcon,hn.mediaPreviousIconRTL,hn.iconRightTriangleArrow):this.classes(hn.mediaIcon,hn.mediaNextIconRTL,hn.iconLeftTriangleArrow),o=t?"media-previous":"media-next",s=t?this._previous:this._next;return(0,We.u)("button",{type:"button",key:o,title:n,"aria-label":n,tabIndex:0,class:i,bind:this,onclick:s},(0,We.u)("span",{"aria-hidden":"true",class:r}),(0,We.u)("span",{"aria-hidden":"true",class:a}))}},{key:"_setupFeatureElementInfo",value:function(){var e,t=this.description,n=this.title;null===(e=this._featureElementInfo)||void 0===e||e.set({description:t,title:n})}},{key:"_next",value:function(){this.viewModel.next()}},{key:"_previous",value:function(){this.viewModel.previous()}},{key:"_getRenderer",value:function(){var e=this.viewModel,t=e.isAggregate,n=e.layer;return t&&null!==n&&void 0!==n&&n.featureReduction&&"renderer"in n.featureReduction?n.featureReduction.renderer:null===n||void 0===n?void 0:n.renderer}},{key:"_getRendererColors",value:function(){var e=(0,m.Z)((0,g.Z)().mark((function e(t){var n,i,r,a,o;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.am4core,i=new Map,r=this._getRenderer(),a="default",r){e.next=3;break}return e.abrupt("return",i);case 3:return e.next=5,(0,It.zB)(r);case 5:return(o=e.sent).delete(a),e.abrupt("return",Array.from(o.values()).every((function(e){return 1===(null===e||void 0===e?void 0:e.length)}))?(i.set(_n,n.color({r:50,g:50,b:50,a:1})),Array.from(o.keys()).forEach((function(e){var t;e&&i.set(e,n.color(null===(t=o.get(e))||void 0===t?void 0:t[0].toCss(!0)))})),i):i);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_handleMediaKeyup",value:function(e){var t=(0,T.kK)(e);"ArrowLeft"===t&&(e.stopPropagation(),this.viewModel.previous()),"ArrowRight"===t&&(e.stopPropagation(),this.viewModel.next())}},{key:"_renderChart",value:function(e){var t=this.viewModel.abilities,n=e.chartsModule,i=e.chartDiv,r=e.mediaInfo,a=e.colorMap,o=r.value,s=r.type,l=n.am4core,u=cn(l);(0,dn.$o)()&&l.useTheme(n.am4themes_dark);var c=window.matchMedia("(prefers-reduced-motion: reduce)");t.chartAnimation&&!c.matches?l.useTheme(n.am4themes_animated):l.unuseTheme(n.am4themes_animated),l.useTheme((function(e){e instanceof l.ColorSet&&u&&(e.list=u)}));var d="pie-chart"===s?this._createPieChart(e):this._createXYChart(e);i.setAttribute("aria-label",r.altText||r.title),d.data=o.series.map((function(e){var t;return t={},(0,x.Z)(t,gn,e.tooltip),(0,x.Z)(t,mn,e.value),(0,x.Z)(t,yn,a.get(e.fieldName)),t})).filter((function(e){return"pie-chart"!==s||null!=e.value&&e.value>0}))}},{key:"_customizeChartTooltip",value:function(e,t){e&&(e.label.wrap=!0,e.label.maxWidth=200,e.autoTextColor=!1,e.getFillFromObject=!1,e.label.fill=t.color("#ffffff"),e.background.fill=t.color({r:0,g:0,b:0,a:.7}))}},{key:"_createPieChart",value:function(e){var t=e.chartDiv,n=e.chartsModule,i=n.am4core,r=n.am4charts,a=i.create(t,r.PieChart);a.rtl=(0,qe.dZ)(this.container);var o=a.series.push(new r.PieSeries);return o.labels.template.disabled=!0,o.ticks.template.disabled=!0,o.dataFields.value=mn,o.dataFields.category=gn,this._customizeChartTooltip(o.tooltip,i),o.slices.template.propertyFields.fill=yn,o.slices.template.propertyFields.stroke=yn,a}},{key:"_getMinSeriesValue",value:function(e){var t=0;return e.forEach((function(e){return t=Math.min(e.value,t)})),t}},{key:"_createColumnChart",value:function(e,t){var n=t.chartsModule,i=t.mediaInfo.value,r=n.am4core,a=n.am4charts,o=e.xAxes.push(new a.CategoryAxis);o.dataFields.category=gn,o.renderer.labels.template.disabled=!0;var s=o.tooltip;this._customizeChartTooltip(s,r),s.events.on("sizechanged",(function(){s.dy=-s.contentHeight}));var l=e.yAxes.push(new a.ValueAxis),u=l.renderer.labels.template;l.renderer.minLabelPosition=fn,l.renderer.maxLabelPosition=vn,l.min=this._getMinSeriesValue(i.series),this._customizeChartTooltip(l.tooltip,r),u.wrap=!0;var c=e.series.push(new a.ColumnSeries);c.dataFields.valueY=mn,c.dataFields.categoryX=gn,c.columns.template.propertyFields.fill=yn,c.columns.template.propertyFields.stroke=yn,e.cursor=new a.XYCursor,i.series.length>15&&(e.scrollbarX=new r.Scrollbar)}},{key:"_createBarChart",value:function(e,t){var n=t.chartsModule,i=t.mediaInfo.value,r=n.am4core,a=n.am4charts,o=e.yAxes.push(new a.CategoryAxis);o.dataFields.category=gn,o.renderer.inversed=!0,o.renderer.labels.template.disabled=!0;var s=o.tooltip;this._customizeChartTooltip(s,r),s.events.on("sizechanged",(function(){s.dx=s.contentWidth}));var l=e.xAxes.push(new a.ValueAxis),u=l.renderer.labels.template;l.renderer.minLabelPosition=fn,l.renderer.maxLabelPosition=vn,l.min=this._getMinSeriesValue(i.series),this._customizeChartTooltip(l.tooltip,r),u.wrap=!0;var c=e.series.push(new a.ColumnSeries);c.dataFields.valueX=mn,c.dataFields.categoryY=gn,c.columns.template.propertyFields.fill=yn,c.columns.template.propertyFields.stroke=yn,e.cursor=new a.XYCursor,i.series.length>15&&(e.scrollbarY=new r.Scrollbar)}},{key:"_createLineChart",value:function(e,t){var n=t.chartsModule,i=t.mediaInfo,r=t.colorMap,a=i.value,o=n.am4core,s=n.am4charts,l=e.xAxes.push(new s.CategoryAxis);l.dataFields.category=gn,l.renderer.labels.template.disabled=!0;var u=l.tooltip;this._customizeChartTooltip(u,o),u.events.on("sizechanged",(function(){u.dy=-u.contentHeight}));var c=e.yAxes.push(new s.ValueAxis),d=c.renderer.labels.template;c.renderer.minLabelPosition=fn,c.renderer.maxLabelPosition=vn,c.min=this._getMinSeriesValue(a.series),this._customizeChartTooltip(c.tooltip,o),d.wrap=!0;var p=e.series.push(new s.LineSeries);p.dataFields.categoryX=gn,p.dataFields.valueY=mn,p.strokeWidth=1;var h=r.get(_n);h&&(p.stroke=h);var f=p.bullets.push(new s.CircleBullet);f.propertyFields.fill=yn,f.propertyFields.stroke=yn,e.cursor=new s.XYCursor,a.series.length>15&&(e.scrollbarX=new o.Scrollbar)}},{key:"_createXYChart",value:function(e){var t=e.chartDiv,n=e.chartsModule,i=e.mediaInfo.type,r=n.am4core,a=n.am4charts,o=r.create(t,a.XYChart);return o.rtl=(0,qe.dZ)(this.container),"column-chart"===i&&this._createColumnChart(o,e),"bar-chart"===i&&this._createBarChart(o,e),"line-chart"===i&&this._createLineChart(o,e),o}},{key:"_clearMediaRefreshTimer",value:function(){var e=this._refreshTimer;e&&(clearTimeout(e),this._refreshTimer=null)}},{key:"_updateMediaInfoTimestamp",value:function(e){var t=Date.now();this._refreshIntervalInfo={timestamp:t,sourceURL:e&&this._getImageSource(e,t)},this.scheduleRender()}},{key:"_setupMediaRefreshTimer",value:function(){this._clearMediaRefreshTimer();var e=this.viewModel.activeMediaInfo;e&&"image"===e.type&&e.refreshInterval&&this._setRefreshTimeout(e)}},{key:"_setRefreshTimeout",value:function(e){var t=this,n=e.refreshInterval,i=e.value;if(n){var r=6e4*n;this._updateMediaInfoTimestamp(i.sourceURL);var a=setInterval((function(){t._updateMediaInfoTimestamp(i.sourceURL)}),r);this._refreshTimer=a}}},{key:"_getImageSource",value:function(e,t){var n=e.includes("?")?"&":"?",r=e.split("#"),a=(0,i.Z)(r,2),o=a[0],s=a[1],l=void 0===s?"":s;return"".concat(o).concat(n,"timestamp=").concat(t).concat(l?"#":"").concat(l)}}]),n}(P.Z);(0,u._)([(0,v.Cb)()],bn.prototype,"attributes",null),(0,u._)([(0,v.Cb)()],bn.prototype,"activeMediaInfoIndex",null),(0,u._)([(0,v.Cb)()],bn.prototype,"description",null),(0,u._)([(0,v.Cb)()],bn.prototype,"fieldInfoMap",null),(0,u._)([(0,v.Cb)()],bn.prototype,"layer",null),(0,u._)([(0,v.Cb)()],bn.prototype,"mediaInfos",null),(0,u._)([(0,v.Cb)()],bn.prototype,"popupTemplate",null),(0,u._)([(0,v.Cb)()],bn.prototype,"relatedInfos",null),(0,u._)([(0,v.Cb)()],bn.prototype,"title",null),(0,u._)([(0,v.Cb)({type:Jt})],bn.prototype,"viewModel",void 0),(0,u._)([(0,v.Cb)(),(0,Ue.H)("esri/widgets/Feature/t9n/Feature")],bn.prototype,"messages",void 0);var wn=bn=(0,u._)([(0,y.j)("esri.widgets.Feature.FeatureMedia")],bn),kn=(n(26418),n(23046),n(1374),n(39384),n(29230)),Cn=n(29514),Mn=(n(44051),n(98752)),Zn=n(26538),xn=n(64326),In=["$datastore","$map","$layer","$aggregatedfeatures"],Tn=d.Z.getLogger("esri.widgets.Feature.support.arcadeFeatureUtils");function Sn(e){return"string"==typeof e?Ce(ke(e)):Array.isArray(e)?function(e){return'<ul class="esri-widget__list">'.concat(e.map((function(e){return"<li>".concat("string"==typeof e?Ce(ke(e)):e,"</li>")})).join(""),"</ul>")}(e):"esri.arcade.Dictionary"===(null===e||void 0===e?void 0:e.declaredClass)?function(e){return'<table class="esri-widget__table">'.concat(e.keys().map((function(t){var n=e.field(t);return"<tr><th>".concat(t,"</th><td>").concat("string"==typeof n?Ce(ke(n)):n,"</td></tr>")})).join(""),"</table>")}(e):e}function An(e){var t=e.aggregatedFeatures,n=e.arcadeUtils,i=e.featureSetVars,r=e.context,a=e.viewInfo,o=e.map,s=e.graphic,l=e.interceptor;i.forEach((function(e){var i=e.toLowerCase(),u=a.sr,c={map:o,spatialReference:u,interceptor:l};if("$map"===i&&(r.vars[i]=n.convertMapToFeatureSetCollection(c)),"$layer"===i&&(r.vars[i]=n.convertFeatureLayerToFeatureSet({layer:s.sourceLayer,spatialReference:u,interceptor:l})),"$datastore"===i&&(r.vars[i]=n.convertServiceUrlToWorkspace({url:s.sourceLayer.url,spatialReference:u,interceptor:l})),"$aggregatedfeatures"===i){var d=s.layer,p=d.fields,h=d.objectIdField,f=d.geometryType,v=d.spatialReference,y=d.displayField,g=new xn.default((0,I.Z)((0,I.Z)({fields:p,objectIdField:h,geometryType:f,spatialReference:v,displayField:y},"feature"===d.type?{templates:d.templates,typeIdField:d.typeIdField,types:d.types}:null),{},{source:t}));r.vars[i]=n.convertFeatureLayerToFeatureSet({layer:g,spatialReference:v,interceptor:l})}}))}function Fn(){return Promise.all([n.e(18016),n.e(70718)]).then(n.bind(n,70718))}function Pn(e){return"createQuery"in e&&"queryFeatures"in e}function Ln(e){return En.apply(this,arguments)}function En(){return En=(0,m.Z)((0,g.Z)().mark((function e(t){var n,i,r,a,o,s,l,u,c;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.graphic,i=t.view,r=n.isAggregate,a=n.layer,r&&a&&"2d"===(null===i||void 0===i?void 0:i.type)){e.next=4;break}return e.abrupt("return",[]);case 4:return e.next=6,i.whenLayerView(a);case 6:if(Pn(o=e.sent)){e.next=9;break}return e.abrupt("return",[]);case 9:return s=o.createQuery(),l=n.getObjectId(),s.aggregateIds=null!=l?[l]:[],e.next=13,o.queryFeatures(s);case 13:return u=e.sent,c=u.features,e.abrupt("return",c);case 16:case"end":return e.stop()}}),e)}))),En.apply(this,arguments)}function Rn(e){return Vn.apply(this,arguments)}function Vn(){return Vn=(0,m.Z)((0,g.Z)().mark((function e(t){var n,r,a,o,s,l,u,c,d,p,h,f,v,y,m;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.expressionInfo,r=t.arcadeUtils,a=t.interceptor,o=t.spatialReference,s=t.map,l=t.graphic,u=t.view,n&&n.expression){e.next=3;break}return e.abrupt("return",null);case 3:return c=r.createSyntaxTree(n.expression),d=In.filter((function(e){return r.hasVariable(c,e)})),e.next=7,Promise.all([Ln({graphic:l,view:u}),r.loadScriptDependencies(c,!0,d)]);case 7:return p=e.sent,h=(0,i.Z)(p,1),f=h[0],v=r.getViewInfo({spatialReference:o}),(y=r.createExecContext(l,v)).interceptor=a,y.useAsync=!0,An({aggregatedFeatures:f,arcadeUtils:r,featureSetVars:d,context:y,viewInfo:v,map:s,graphic:l,interceptor:a}),m=r.createFunction(c,y),e.abrupt("return",r.executeAsyncFunction(m,y).catch((function(e){return Tn.error("arcade-execution-error",{error:e,graphic:l,expressionInfo:n})})));case 15:case"end":return e.stop()}}),e)}))),Vn.apply(this,arguments)}function On(e){return Dn.apply(this,arguments)}function Dn(){return Dn=(0,m.Z)((0,g.Z)().mark((function e(t){var n,i,r,a,o,s,l,u,c,d,p,h,f,v;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.expressionInfos,i=t.spatialReference,r=t.graphic,a=t.interceptor,o=t.map,s=t.view,n&&n.length){e.next=3;break}return e.abrupt("return",{});case 3:return e.next=5,Fn();case 5:l=e.sent,u={},c=(0,_.Z)(n);try{for(c.s();!(d=c.n()).done;)p=d.value,u["expression/".concat(p.name)]=Rn({expressionInfo:p,arcadeUtils:l,interceptor:a,spatialReference:i,map:o,graphic:r,view:s})}catch(y){c.e(y)}finally{c.f()}return e.next=11,(0,At.as)(u);case 11:for(v in h=e.sent,f={},h)f[v]=Sn(h[v].value);return e.abrupt("return",f);case 15:case"end":return e.stop()}}),e)}))),Dn.apply(this,arguments)}var Nn=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e){var i;return(0,r.Z)(this,n),(i=t.call(this,e))._abortController=null,i.expressionInfo=null,i.graphic=null,i.contentElement=null,i.contentElementViewModel=null,i.interceptor=null,i.view=null,i._cancelQuery=function(){var e=(0,o.Z)(i)._abortController;e&&e.abort(),i._abortController=null},i._createVM=function(){var e,t,n=null===(e=i.contentElement)||void 0===e?void 0:e.type;null===(t=i.contentElementViewModel)||void 0===t||t.destroy();var r="fields"===n?new bt:"media"===n?new Jt:"text"===n?new dt:null;i._set("contentElementViewModel",r)},i._compile=(0,m.Z)((0,g.Z)().mark((function e(){var t;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i._cancelQuery(),t=new AbortController,i._abortController=t,e.next=5,i._compileExpression();case 5:i._abortController===t&&(i._abortController=null);case 6:case"end":return e.stop()}}),e)}))),i._compileThrottled=(0,A.P)(i._compile,1,(0,o.Z)(i)),i._compileExpression=(0,m.Z)((0,g.Z)().mark((function e(){var t,n,r,a,s,l,u,c,d,p,h,f,v;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(0,o.Z)(i),n=t.expressionInfo,r=t.graphic,a=t.interceptor,s=t.spatialReference,l=t.map,u=t.view,c=t._abortController,n&&r&&s&&l){e.next=3;break}return e.abrupt("return",void i._set("contentElement",null));case 3:return e.next=5,Fn();case 5:if(d=e.sent,c===i._abortController){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,Rn({arcadeUtils:d,expressionInfo:n,graphic:r,interceptor:a,map:l,spatialReference:s,view:u});case 10:if((p=e.sent)&&"esri.arcade.Dictionary"===p.declaredClass){e.next=13;break}return e.abrupt("return",void i._set("contentElement",null));case 13:return e.next=15,p.castAsJsonAsync(null===c||void 0===c?void 0:c.signal);case 15:h=e.sent,f=null===h||void 0===h?void 0:h.type,v="media"===f?Cn.Z.fromJSON(h):"text"===f?Mn.Z.fromJSON(h):"fields"===f?kn.Z.fromJSON(h):null,i._set("contentElement",v);case 19:case"end":return e.stop()}}),e)}))),i.handles.add([(0,h.YP)((function(){return[i.expressionInfo,i.graphic,i.map,i.spatialReference,i.view]}),(function(){return i._compileThrottled()}),h.nn),(0,h.YP)((function(){return[i.contentElement]}),(function(){return i._createVM()}),h.nn)]),i}return(0,a.Z)(n,[{key:"destroy",value:function(){var e;this._cancelQuery(),null!==(e=this.contentElementViewModel)&&void 0!==e&&e.destroy(),this._set("contentElementViewModel",null),this._set("contentElement",null)}},{key:"spatialReference",get:function(){var e,t;return null!==(e=null===(t=this.view)||void 0===t?void 0:t.spatialReference)&&void 0!==e?e:null},set:function(e){this._override("spatialReference",e)}},{key:"state",get:function(){var e=this._abortController,t=this.contentElement,n=this.contentElementViewModel;return e?"loading":t||n?"ready":"disabled"}},{key:"map",get:function(){var e,t;return null!==(e=null===(t=this.view)||void 0===t?void 0:t.map)&&void 0!==e?e:null},set:function(e){this._override("map",e)}}]),n}((0,ut.p)(b.Z));(0,u._)([(0,v.Cb)()],Nn.prototype,"_abortController",void 0),(0,u._)([(0,v.Cb)({type:Zn.Z})],Nn.prototype,"expressionInfo",void 0),(0,u._)([(0,v.Cb)({type:R.Z})],Nn.prototype,"graphic",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],Nn.prototype,"contentElement",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],Nn.prototype,"contentElementViewModel",void 0),(0,u._)([(0,v.Cb)()],Nn.prototype,"interceptor",void 0),(0,u._)([(0,v.Cb)()],Nn.prototype,"spatialReference",null),(0,u._)([(0,v.Cb)({readOnly:!0})],Nn.prototype,"state",null),(0,u._)([(0,v.Cb)()],Nn.prototype,"map",null),(0,u._)([(0,v.Cb)()],Nn.prototype,"view",void 0);var zn=Nn=(0,u._)([(0,y.j)("esri.widgets.Feature.FeatureExpression.FeatureExpressionViewModel")],Nn),Bn="esri-icon-loading-indicator esri-rotating",Gn="esri-feature-expression",qn="esri-feature__loading-container",Un="esri-feature__loading-spinner",Wn=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e,i){var a;return(0,r.Z)(this,n),(a=t.call(this,e,i))._contentWidget=null,a.viewModel=new zn,a}return(0,a.Z)(n,[{key:"initialize",value:function(){var e=this;this.addHandles((0,h.YP)((function(){var t;return null===(t=e.viewModel)||void 0===t?void 0:t.contentElementViewModel}),(function(){return e._setupExpressionWidget()}),h.nn))}},{key:"destroy",value:function(){this._destroyContentWidget()}},{key:"renderLoading",value:function(){return(0,We.u)("div",{key:"loading-container",class:qn},(0,We.u)("span",{class:this.classes(Bn,Un)}))}},{key:"render",value:function(){var e,t=this.viewModel.state;return(0,We.u)("div",{class:Gn},"loading"===t?this.renderLoading():"disabled"===t?null:null===(e=this._contentWidget)||void 0===e?void 0:e.render())}},{key:"_destroyContentWidget",value:function(){var e=this._contentWidget;e&&(e.viewModel=null,e.destroy()),this._contentWidget=null}},{key:"_setupExpressionWidget",value:function(){var e=this.viewModel,t=e.contentElementViewModel,n=e.contentElement,i=null===n||void 0===n?void 0:n.type;this._destroyContentWidget();var r=t?"fields"===i?new xt({viewModel:t}):"media"===i?new wn({viewModel:t}):"text"===i?new yt({viewModel:t}):null:null;this._contentWidget=r,this.scheduleRender()}}]),n}(P.Z);(0,u._)([(0,v.Cb)({type:zn})],Wn.prototype,"viewModel",void 0);var jn=Wn=(0,u._)([(0,y.j)("esri.widgets.Feature.FeatureExpression")],Wn),Hn=n(11582),Yn=n(79056),Kn=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e){var i;return(0,r.Z)(this,n),(i=t.call(this,e))._queryAbortController=null,i._queryPageAbortController=null,i._queryFeatureCountAbortController=null,i.featuresPerPage=10,i.description=null,i.graphic=null,i.layer=null,i.map=null,i.orderByFields=null,i.featureCount=0,i.relationshipId=null,i.showAllEnabled=!1,i.title=null,i._cancelQuery=function(){var e=(0,o.Z)(i)._queryAbortController;e&&e.abort(),i._queryAbortController=null},i._cancelQueryFeatureCount=function(){var e=(0,o.Z)(i)._queryFeatureCountAbortController;e&&e.abort(),i._queryFeatureCountAbortController=null},i._cancelQueryPage=function(){var e=(0,o.Z)(i)._queryPageAbortController;e&&e.abort(),i._queryPageAbortController=null},i._queryController=(0,m.Z)((0,g.Z)().mark((function e(){var t;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i._cancelQuery(),t=new AbortController,i._queryAbortController=t,e.next=5,(0,At.R8)(i._query());case 5:i._queryAbortController===t&&(i._queryAbortController=null);case 6:case"end":return e.stop()}}),e)}))),i._queryFeatureCountController=(0,m.Z)((0,g.Z)().mark((function e(){var t;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i._cancelQueryFeatureCount(),t=new AbortController,i._queryFeatureCountAbortController=t,e.next=5,(0,At.R8)(i._queryFeatureCount());case 5:i._queryFeatureCountAbortController===t&&(i._queryFeatureCountAbortController=null);case 6:case"end":return e.stop()}}),e)}))),i._queryPageController=(0,m.Z)((0,g.Z)().mark((function e(){var t;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new AbortController,i._queryPageAbortController=t,e.next=4,(0,At.R8)(i._queryPage());case 4:i._queryPageAbortController===t&&(i._queryPageAbortController=null);case 5:case"end":return e.stop()}}),e)}))),i._queryThrottled=(0,A.P)(i._queryController,100,(0,o.Z)(i)),i._queryFeatureCountThrottled=(0,A.P)(i._queryFeatureCountController,100,(0,o.Z)(i)),i._queryPageThrottled=(0,A.P)(i._queryPageController,100,(0,o.Z)(i)),i._query=(0,m.Z)((0,g.Z)().mark((function e(){var t,n,r;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,o.Z)(i),n=t._queryAbortController,r=t.relatedFeatures,i._destroyRelatedFeatureViewModels(),i.featurePage=1,r.removeAll(),e.t0=r,e.t1=i,e.next=8,i._queryRelatedFeatures({signal:null===n||void 0===n?void 0:n.signal});case 8:e.t2=e.sent,e.t3=e.t1._sliceFeatures.call(e.t1,e.t2),e.t0.addMany.call(e.t0,e.t3);case 11:case"end":return e.stop()}}),e)}))),i.handles.add([(0,h.YP)((function(){return[i.displayCount,i.graphic,i.layer,i.map,i.orderByFieldsFixedCasing,i.relationshipId,i.featuresPerPage,i.showAllEnabled,i.canQuery,i.featureCount]}),(function(){return i._queryThrottled()}),h.nn),(0,h.YP)((function(){return[i.featurePage,i.showAllEnabled]}),(function(){return i._queryPageThrottled()})),(0,h.YP)((function(){return[i.layer,i.relationshipId,i.objectId,i.canQuery]}),(function(){return i._queryFeatureCountThrottled()}))]),i}return(0,a.Z)(n,[{key:"destroy",value:function(){this._destroyRelatedFeatureViewModels(),this.relatedFeatures.removeAll(),this._cancelQuery(),this._cancelQueryFeatureCount(),this._cancelQueryPage()}},{key:"featurePage",get:function(){return this._get("featurePage")},set:function(e){var t=this.featuresPerPage,n=this.featureCount,i=Math.ceil(n/t)||1;this._set("featurePage",Math.min(Math.max(e,1),i))}},{key:"orderByFieldsFixedCasing",get:function(){var e=this.orderByFields,t=this.relatedLayer;return e&&null!==t&&void 0!==t&&t.loaded?e.map((function(e){var n=e.clone(),i=ue(e.field,t);return n.field=i,n})):null!==e&&void 0!==e?e:[]}},{key:"supportsCacheHint",get:function(){var e,t,n;return!(null===(e=this.layer)||void 0===e||null===(t=e.capabilities)||void 0===t||null===(n=t.queryRelated)||void 0===n||!n.supportsCacheHint)}},{key:"canQuery",get:function(){var e,t,n=null===(e=this.layer)||void 0===e||null===(t=e.capabilities)||void 0===t?void 0:t.queryRelated;return!!(this.relatedLayer&&this.relationship&&"number"==typeof this.relationshipId&&"number"==typeof this.objectId&&null!==n&&void 0!==n&&n.supportsCount&&null!==n&&void 0!==n&&n.supportsPagination)}},{key:"itemDescriptionFieldName",get:function(){var e,t;return(null===(e=this.orderByFieldsFixedCasing)||void 0===e||null===(t=e[0])||void 0===t?void 0:t.field)||null}},{key:"displayCount",get:function(){return this._get("displayCount")},set:function(e){this._set("displayCount",Math.min(Math.max(e,0),10))}},{key:"objectId",get:function(){var e,t,n;return null!==(e=this.objectIdField&&(null===(t=this.graphic)||void 0===t||null===(n=t.attributes)||void 0===n?void 0:n[this.objectIdField]))&&void 0!==e?e:null}},{key:"objectIdField",get:function(){var e;return(null===(e=this.layer)||void 0===e?void 0:e.objectIdField)||null}},{key:"relatedFeatures",get:function(){return this._get("relatedFeatures")||new w.Z}},{key:"relatedLayer",get:function(){var e,t=this.layer,n=this.map,i=this.relationship;return null!==t&&void 0!==t&&t.loaded&&n&&i&&null!==(e=function(e,t,n){return e&&t&&n?Ve(e.allLayers,t,n)||Ve(e.allTables,t,n):null}(n,t,i))&&void 0!==e?e:null}},{key:"relationship",get:function(){var e,t,n=this.relationshipId,i=this.layer;return"number"==typeof n&&null!==(e=null===i||void 0===i||null===(t=i.relationships)||void 0===t?void 0:t.find((function(e){return e.id===n})))&&void 0!==e?e:null}},{key:"relatedFeatureViewModels",get:function(){return this._get("relatedFeatureViewModels")||new w.Z}},{key:"state",get:function(){var e=this._queryAbortController,t=this._queryFeatureCountAbortController,n=this._queryPageAbortController,i=this.canQuery;return t?"loading":e||n?"querying":i?"ready":"disabled"}},{key:"_destroyRelatedFeatureViewModels",value:function(){var e;null!==(e=this.relatedFeatureViewModels)&&void 0!==e&&e.forEach((function(e){return!e.destroyed&&e.destroy()})),this.relatedFeatureViewModels.removeAll()}},{key:"_queryFeatureCount",value:function(){var e=(0,m.Z)((0,g.Z)().mark((function e(){var t,n,i,r,a,o,s,l,u,c;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.layer,n=this.relatedLayer,i=this.relationshipId,r=this.objectId,a=this._queryFeatureCountAbortController,o=this.canQuery,s=this.supportsCacheHint,e.next=3,null===t||void 0===t?void 0:t.load();case 3:return e.next=5,null===n||void 0===n?void 0:n.load();case 5:if(o&&t&&n){e.next=7;break}return e.abrupt("return",void this._set("featureCount",0));case 7:return l=n.createQuery(),u=new Et.default({cacheHint:s,relationshipId:i,returnGeometry:!1,objectIds:[r],where:(0,p.yl)(l.where,void 0)}),e.next=11,t.queryRelatedFeaturesCount(u,{signal:null===a||void 0===a?void 0:a.signal});case 11:c=e.sent,this._set("featureCount",c[r]||0);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_sliceFeatures",value:function(e){var t=this.showAllEnabled,n=this.displayCount;return t?e:n?e.slice(0,n):[]}},{key:"_queryPage",value:function(){var e=(0,m.Z)((0,g.Z)().mark((function e(){var t,n,i,r;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.relatedFeatures,n=this.featurePage,i=this.showAllEnabled,r=this._queryPageAbortController,e.t0=!i||n<2,e.t0){e.next=8;break}return e.t1=t,e.next=6,this._queryRelatedFeatures({signal:null===r||void 0===r?void 0:r.signal});case 6:e.t2=e.sent,e.t1.addMany.call(e.t1,e.t2);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_queryRelatedFeatures",value:function(){var e=(0,m.Z)((0,g.Z)().mark((function e(t){var n,i,r,a,o,s,l,u,c,d,h,f,v,y,m,_,b,w,k,C,M;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.orderByFieldsFixedCasing,r=this.showAllEnabled,a=this.featuresPerPage,o=this.displayCount,s=this.layer,l=this.relationshipId,u=this.featurePage,c=this.featureCount,d=this.relatedLayer,h=this.supportsCacheHint,f=this.canQuery,v=this.objectId,f&&s&&d){e.next=3;break}return e.abrupt("return",[]);case 3:return y=r?((u-1)*a+c)%c:0,m=r?a:o,_=d.objectIdField,b=[].concat((0,D.Z)(null===i||void 0===i?void 0:i.map((function(e){return e.field}))),[_]).filter(p.pC),w=null===i||void 0===i?void 0:i.map((function(e){return"".concat(e.field," ").concat(e.order)})),k=d.createQuery(),C=new Et.default({orderByFields:w,start:y,num:m,outFields:b,cacheHint:h,relationshipId:l,returnGeometry:!1,objectIds:[v],where:(0,p.yl)(k.where,void 0)}),e.next=12,s.queryRelatedFeatures(C,{signal:null===t||void 0===t?void 0:t.signal});case 12:if(e.t2=v,e.t3=n=e.sent[e.t2],e.t1=null===e.t3,e.t1){e.next=17;break}e.t1=void 0===n;case 17:if(!e.t1){e.next=21;break}e.t4=void 0,e.next=22;break;case 21:e.t4=n.features;case 22:if(e.t0=e.t4,e.t0){e.next=25;break}e.t0=[];case 25:return M=e.t0,e.abrupt("return",(M.forEach((function(e){e.sourceLayer=d,e.layer=d})),M));case 27:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}((0,Hn.J)((0,Yn.IG)((0,ut.p)(b.Z))));(0,u._)([(0,v.Cb)()],Kn.prototype,"_queryAbortController",void 0),(0,u._)([(0,v.Cb)()],Kn.prototype,"_queryPageAbortController",void 0),(0,u._)([(0,v.Cb)()],Kn.prototype,"_queryFeatureCountAbortController",void 0),(0,u._)([(0,v.Cb)({value:1})],Kn.prototype,"featurePage",null),(0,u._)([(0,v.Cb)()],Kn.prototype,"featuresPerPage",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],Kn.prototype,"orderByFieldsFixedCasing",null),(0,u._)([(0,v.Cb)({readOnly:!0})],Kn.prototype,"supportsCacheHint",null),(0,u._)([(0,v.Cb)({readOnly:!0})],Kn.prototype,"canQuery",null),(0,u._)([(0,v.Cb)()],Kn.prototype,"description",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],Kn.prototype,"itemDescriptionFieldName",null),(0,u._)([(0,v.Cb)({value:3})],Kn.prototype,"displayCount",null),(0,u._)([(0,v.Cb)({type:R.Z})],Kn.prototype,"graphic",void 0),(0,u._)([(0,v.Cb)()],Kn.prototype,"layer",void 0),(0,u._)([(0,v.Cb)()],Kn.prototype,"map",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],Kn.prototype,"objectId",null),(0,u._)([(0,v.Cb)({readOnly:!0})],Kn.prototype,"objectIdField",null),(0,u._)([(0,v.Cb)()],Kn.prototype,"orderByFields",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],Kn.prototype,"relatedFeatures",null),(0,u._)([(0,v.Cb)({readOnly:!0})],Kn.prototype,"relatedLayer",null),(0,u._)([(0,v.Cb)({readOnly:!0})],Kn.prototype,"relationship",null),(0,u._)([(0,v.Cb)()],Kn.prototype,"featureCount",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],Kn.prototype,"relatedFeatureViewModels",null),(0,u._)([(0,v.Cb)()],Kn.prototype,"relationshipId",void 0),(0,u._)([(0,v.Cb)()],Kn.prototype,"showAllEnabled",void 0),(0,u._)([(0,v.Cb)()],Kn.prototype,"state",null),(0,u._)([(0,v.Cb)()],Kn.prototype,"title",void 0);var Qn=Kn=(0,u._)([(0,y.j)("esri.widgets.Feature.FeatureRelationship.FeatureRelationshipViewModel")],Kn),Jn=n(8704),Xn="esri-feature",$n="".concat(Xn,"-relationship"),ei={base:$n,esriWidget:"esri-widget",listContainer:"".concat($n,"__list"),listContainerQuerying:"".concat($n,"__list--querying"),featureObserver:"".concat(Xn,"__feature-observer"),stickySpinnerContainer:"".concat(Xn,"__sticky-loading-container"),loadingSpinnerContainer:"".concat(Xn,"__loading-container"),spinner:"".concat(Xn,"__loading-spinner"),iconLoading:"esri-icon-loading-indicator esri-rotating"},ti={title:!0,description:!0},ni=function(e){(0,s.Z)(o,e);var t=(0,l.Z)(o);function o(e,n){var a;return(0,r.Z)(this,o),(a=t.call(this,e,n))._featureElementInfo=null,a._relatedFeatureIntersectionObserverNode=null,a._relatedFeatureIntersectionObserver=new IntersectionObserver((function(e){var t=(0,i.Z)(e,1)[0];(null===t||void 0===t?void 0:t.isIntersecting)&&a._increaseFeaturePage()}),{root:window.document}),a.headingLevel=2,a.viewModel=new Qn,a.messages=null,a.messagesCommon=null,a.visibleElements=(0,I.Z)({},ti),a._increaseFeaturePage=function(){var e=a.viewModel,t=e.state,n=e.showAllEnabled,i=e.relatedFeatures,r=e.featuresPerPage,o=e.featurePage;"ready"===t&&n&&i.length>=r*o&&a.viewModel.featurePage++},a}return(0,a.Z)(o,[{key:"initialize",value:function(){var e=this;this._featureElementInfo=new at,this.addHandles([(0,h.YP)((function(){return[e.viewModel.description,e.viewModel.title,e.headingLevel]}),(function(){return e._setupFeatureElementInfo()}),h.nn),(0,h.YP)((function(){return[e.viewModel.state,e.viewModel.showAllEnabled,e._relatedFeatureIntersectionObserverNode]}),(function(){return e._handleRelatedFeatureObserverChange()})),(0,h.on)((function(){return e.viewModel.relatedFeatureViewModels}),"change",(function(){return e._setupRelatedFeatureViewModels()}))])}},{key:"loadDependencies",value:function(){return Promise.all([Promise.all([n.e(11307),n.e(93714)]).then(n.bind(n,93714)),n.e(41425).then(n.bind(n,41425)),n.e(64756).then(n.bind(n,64756)),Promise.all([n.e(11307),n.e(86726)]).then(n.bind(n,86726))])}},{key:"destroy",value:function(){this._unobserveRelatedFeatureObserver(),this._featureElementInfo=(0,p.SC)(this._featureElementInfo)}},{key:"displayShowAllButton",get:function(){var e=this.viewModel,t=e.showAllEnabled,n=e.featureCount,i=e.displayCount;return!t&&!!n&&(n>i||0===i)}},{key:"displayListItems",get:function(){return this.displayShowAllButton||this.viewModel.relatedFeatureViewModels.length>0}},{key:"description",get:function(){return this.viewModel.description},set:function(e){this.viewModel.description=e}},{key:"featureCountDescription",get:function(){var e=this.messages,t=this.viewModel.featureCount;return(0,Jn.n)(1===t?null===e||void 0===e?void 0:e.numberRecord:null===e||void 0===e?void 0:e.numberRecords,{number:t})}},{key:"title",get:function(){return this.viewModel.title},set:function(e){this.viewModel.title=e}},{key:"castVisibleElements",value:function(e){return(0,I.Z)((0,I.Z)({},ti),e)}},{key:"renderStickyLoading",value:function(){return"querying"===this.viewModel.state?(0,We.u)("div",{key:"sticky-loader",class:ei.stickySpinnerContainer},this.renderLoadingIcon()):null}},{key:"renderLoadingIcon",value:function(){return(0,We.u)("span",{class:this.classes(ei.iconLoading,ei.spinner)})}},{key:"renderLoading",value:function(){return(0,We.u)("div",{key:"loading-container",class:ei.loadingSpinnerContainer},this.renderLoadingIcon())}},{key:"renderShowAllIconNode",value:function(){return(0,We.u)("calcite-icon",{scale:"s",icon:"list",slot:"content-end"})}},{key:"renderChevronIconNode",value:function(){var e=(0,qe.dZ)(this.container)?"chevron-left":"chevron-right";return(0,We.u)("calcite-icon",{scale:"s",icon:e,slot:"content-end"})}},{key:"renderRelatedFeature",value:function(e){var t,n,i,r=this,a=this.viewModel.itemDescriptionFieldName,o=e.title;e.description=a&&(null===(t=e.formattedAttributes)||void 0===t?void 0:t.global[a]);var s="loading"===e.state;return(0,We.u)("calcite-list-item",{key:e.uid,label:s?"".concat(null===(n=this.messagesCommon)||void 0===n?void 0:n.loading,"\u2026"):o,description:s?"\u2026":null!==(i=e.description)&&void 0!==i?i:"",onCalciteListItemSelect:function(){return r.emit("select-record",{featureViewModel:e})}},this.renderChevronIconNode())}},{key:"renderShowAllListItem",value:function(){var e,t=this;return this.displayShowAllButton?(0,We.u)("calcite-list-item",{key:"show-all-item",label:null===(e=this.messages)||void 0===e?void 0:e.showAll,description:this.featureCountDescription,onCalciteListItemSelect:function(){return t.emit("show-all-records")}},this.renderShowAllIconNode()):null}},{key:"renderNoRelatedFeaturesMessage",value:function(){var e;return(0,We.u)("calcite-notice",{key:"no-related-features-message",icon:"information",open:!0,kind:"brand",scale:"s",width:"full"},(0,We.u)("div",{slot:"message"},null===(e=this.messages)||void 0===e?void 0:e.noRelatedFeatures))}},{key:"renderFeatureObserver",value:function(){return(0,We.u)("div",{key:"feature-observer",class:ei.featureObserver,bind:this,afterCreate:this._relatedFeatureIntersectionObserverCreated})}},{key:"renderList",value:function(){var e=this,t=this.viewModel.relatedFeatureViewModels;return(0,We.u)("calcite-list",null,t.toArray().map((function(t){return e.renderRelatedFeature(t)})),this.renderShowAllListItem())}},{key:"renderRelatedFeatures",value:function(){var e=this.displayListItems,t=this.viewModel.state;return(0,We.u)("div",{key:"list-container",class:this.classes(ei.listContainer,(0,x.Z)({},ei.listContainerQuerying,"querying"===t))},e?this.renderList():"ready"===t?this.renderNoRelatedFeaturesMessage():null,this.renderStickyLoading(),this.renderFeatureObserver())}},{key:"renderRelationshipNotFound",value:function(){var e;return(0,We.u)("calcite-notice",{key:"relationship-not-found",icon:"exclamation-mark-triangle",open:!0,kind:"danger",scale:"s",width:"full"},(0,We.u)("div",{slot:"message"},null===(e=this.messages)||void 0===e?void 0:e.relationshipNotFound))}},{key:"render",value:function(){var e,t=this.viewModel.state;return(0,We.u)("div",{class:this.classes(ei.base,ei.esriWidget)},null===(e=this._featureElementInfo)||void 0===e?void 0:e.render(),"loading"===t?this.renderLoading():"disabled"===t?this.renderRelationshipNotFound():this.renderRelatedFeatures())}},{key:"_setupRelatedFeatureViewModels",value:function(){var e=this,t=this.viewModel.relatedFeatureViewModels,n="related-feature-viewmodels";this.removeHandles(n),null!==t&&void 0!==t&&t.forEach((function(t){e.addHandles((0,h.YP)((function(){return[t.title,t.state]}),(function(){return e.scheduleRender()}),h.nn),n)})),this.scheduleRender()}},{key:"_setupFeatureElementInfo",value:function(){var e,t=this.headingLevel,n=this.visibleElements,i=n.description&&this.description,r=n.title&&this.title;null===(e=this._featureElementInfo)||void 0===e||e.set({description:i,title:r,headingLevel:t})}},{key:"_handleRelatedFeatureObserverChange",value:function(){var e=(0,m.Z)((0,g.Z)().mark((function e(){var t,n,i;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._unobserveRelatedFeatureObserver(),t=this.viewModel,n=t.state,i=t.showAllEnabled,e.next=4,(0,At.e4)(0);case 4:this._relatedFeatureIntersectionObserverNode&&"ready"===n&&i&&this._relatedFeatureIntersectionObserver.observe(this._relatedFeatureIntersectionObserverNode);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_relatedFeatureIntersectionObserverCreated",value:function(e){this._relatedFeatureIntersectionObserverNode=e}},{key:"_unobserveRelatedFeatureObserver",value:function(){this._relatedFeatureIntersectionObserverNode&&this._relatedFeatureIntersectionObserver.unobserve(this._relatedFeatureIntersectionObserverNode)}}]),o}(P.Z);(0,u._)([(0,v.Cb)()],ni.prototype,"_relatedFeatureIntersectionObserverNode",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],ni.prototype,"displayShowAllButton",null),(0,u._)([(0,v.Cb)({readOnly:!0})],ni.prototype,"displayListItems",null),(0,u._)([(0,v.Cb)()],ni.prototype,"description",null),(0,u._)([(0,v.Cb)({readOnly:!0})],ni.prototype,"featureCountDescription",null),(0,u._)([(0,v.Cb)()],ni.prototype,"headingLevel",void 0),(0,u._)([(0,v.Cb)()],ni.prototype,"title",null),(0,u._)([(0,v.Cb)({type:Qn})],ni.prototype,"viewModel",void 0),(0,u._)([(0,v.Cb)(),(0,Ue.H)("esri/widgets/Feature/t9n/Feature")],ni.prototype,"messages",void 0),(0,u._)([(0,v.Cb)(),(0,Ue.H)("esri/t9n/common")],ni.prototype,"messagesCommon",void 0),(0,u._)([(0,v.Cb)()],ni.prototype,"visibleElements",void 0),(0,u._)([(0,F.p)("visibleElements")],ni.prototype,"castVisibleElements",null);var ii,ri=ni=(0,u._)([(0,y.j)("esri.widgets.Feature.FeatureRelationship")],ni),ai=(0,a.Z)((function e(t,n){(0,r.Z)(this,e),this.preLayerQueryCallback=t,this.preRequestCallback=n,this.preLayerQueryCallback||(this.preLayerQueryCallback=function(e){}),this.preRequestCallback||(this.preLayerQueryCallback=function(e){})})),oi="content-view-models",si="relationship-view-models",li={attachmentsContent:!0,chartAnimation:!0,customContent:!0,expressionContent:!0,fieldsContent:!0,mediaContent:!0,textContent:!0,relationshipContent:!0},ui=ii=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e){var i;return(0,r.Z)(this,n),(i=t.call(this,e))._handles=new S.Z,i._error=null,i._featureAbortController=null,i._graphicChangedThrottled=(0,A.P)(i._graphicChanged,1,(0,o.Z)(i)),i._expressionAttributes=null,i._graphicExpressionAttributes=null,i.abilities=(0,I.Z)({},li),i.content=null,i.contentViewModels=[],i.description=null,i.defaultPopupTemplateEnabled=!1,i.formattedAttributes=null,i.lastEditInfo=null,i.relatedInfos=new Map,i.title="",i.view=null,i._isAllowedContentType=function(e){var t=(0,o.Z)(i).abilities;return"attachments"===e.type&&!!t.attachmentsContent||"custom"===e.type&&!!t.customContent||"fields"===e.type&&!!t.fieldsContent||"media"===e.type&&!!t.mediaContent||"text"===e.type&&!!t.textContent||"expression"===e.type&&!!t.expressionContent||"relationship"===e.type&&!!t.relationshipContent},i._handles.add((0,h.YP)((function(){return[i.graphic,i._effectivePopupTemplate,i.abilities]}),(function(){return i._graphicChangedThrottled()}),h.nn)),i}return(0,a.Z)(n,[{key:"destroy",value:function(){this._clear(),this._cancelFeatureQuery(),this._error=null,this._handles.destroy(),this.graphic=null,this._destroyContentViewModels(),this.relatedInfos.clear()}},{key:"_effectivePopupTemplate",get:function(){return(0,p.pC)(this.graphic)?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}},{key:"_fieldInfoMap",get:function(){return function(e,t){var n=new Map;return e?(e.forEach((function(e){var i=ue(e.fieldName,t);e.fieldName=i,n.set(i.toLowerCase(),e)})),n):n}(we(this._effectivePopupTemplate),this._sourceLayer)}},{key:"_sourceLayer",get:function(){return ie(this.graphic)}},{key:"castAbilities",value:function(e){return(0,I.Z)((0,I.Z)({},li),e)}},{key:"isTable",get:function(){var e;return(null===(e=this._sourceLayer)||void 0===e?void 0:e.isTable)||!1}},{key:"state",get:function(){return this.graphic?this._error?"error":this.waitingForContent?"loading":"ready":"disabled"}},{key:"graphic",set:function(e){this._set("graphic",e?e.clone():null)}},{key:"spatialReference",get:function(){var e,t;return null!==(e=null===(t=this.view)||void 0===t?void 0:t.spatialReference)&&void 0!==e?e:null},set:function(e){this._override("spatialReference",e)}},{key:"map",get:function(){var e;return(null===(e=this.view)||void 0===e?void 0:e.map)||null},set:function(e){this._override("map",e)}},{key:"waitingForContent",get:function(){return!!this._featureAbortController}},{key:"setActiveMedia",value:function(e,t){var n=this.contentViewModels[e];n instanceof Jt&&n.setActiveMedia(t)}},{key:"nextMedia",value:function(e){var t=this.contentViewModels[e];t instanceof Jt&&t.next()}},{key:"previousMedia",value:function(e){var t=this.contentViewModels[e];t instanceof Jt&&t.previous()}},{key:"updateGeometry",value:function(){var e=(0,m.Z)((0,g.Z)().mark((function e(){var t,n,i,r,a,o,s,l,u;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.graphic,i=this.spatialReference,r=this._sourceLayer,e.next=3,null===r||void 0===r?void 0:r.load();case 3:if((a=null===r||void 0===r?void 0:r.objectIdField)&&n&&r){e.next=6;break}return e.abrupt("return");case 6:if(null!=(o=null===n||void 0===n||null===(t=n.attributes)||void 0===t?void 0:t[a])){e.next=9;break}return e.abrupt("return");case 9:if(s=[o],n.geometry){e.next=24;break}return e.next=13,xe({layer:r,graphic:n,outFields:[],objectIds:s,returnGeometry:!0,spatialReference:i});case 13:if(e.t1=l=e.sent,e.t0=null===e.t1,e.t0){e.next=17;break}e.t0=void 0===l;case 17:if(!e.t0){e.next=21;break}e.t2=void 0,e.next=22;break;case 21:e.t2=l.geometry;case 22:(u=e.t2)&&(n.geometry=u);case 24:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_clear",value:function(){this._set("title",""),this._set("content",null),this._set("formattedAttributes",null)}},{key:"_graphicChanged",value:function(){var e=(0,m.Z)((0,g.Z)().mark((function e(){var t,n;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._cancelFeatureQuery(),this._error=null,this._clear(),t=this.graphic){e.next=4;break}return e.abrupt("return");case 4:return n=new AbortController,this._featureAbortController=n,e.prev=6,e.next=9,this._queryFeature({signal:n.signal});case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(6),(0,At.D_)(e.t0)||(this._error=e.t0,d.Z.getLogger(this.declaredClass).error("error","The popupTemplate could not be displayed for this feature.",{error:e.t0,graphic:t,popupTemplate:this._effectivePopupTemplate}));case 14:this._featureAbortController===n&&(this._featureAbortController=null);case 15:case"end":return e.stop()}}),e,this,[[6,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"_cancelFeatureQuery",value:function(){var e=this._featureAbortController;e&&e.abort(),this._featureAbortController=null}},{key:"_compileContentElement",value:function(e,t){return"attachments"===e.type?this._compileAttachments(e,t):"custom"===e.type?this._compileCustom(e,t):"fields"===e.type?this._compileFields(e,t):"media"===e.type?this._compileMedia(e,t):"text"===e.type?this._compileText(e,t):"expression"===e.type?this._compileExpression(e,t):"relationship"===e.type?this._compileRelationship(e,t):void 0}},{key:"_compileContent",value:function(e){var t=this;if(this._destroyContentViewModels(),this.graphic)return Array.isArray(e)?e.filter(this._isAllowedContentType).map((function(e,n){return t._compileContentElement(e,n)})).filter(p.pC):"string"==typeof e?this._compileText(new Mn.Z({text:e}),0).text:e}},{key:"_destroyContentViewModels",value:function(){var e,t;null!==(e=this._handles)&&void 0!==e&&e.remove(si),null!==(t=this._handles)&&void 0!==t&&t.remove(oi),this.contentViewModels.forEach((function(e){return e&&!e.destroyed&&e.destroy()})),this._set("contentViewModels",[])}},{key:"_matchesFeature",value:function(e,t){var n,i=null===e||void 0===e||null===(n=e.graphic)||void 0===n?void 0:n.getObjectId(),r=null===t||void 0===t?void 0:t.getObjectId();return(0,p.pC)(i)&&(0,p.pC)(r)&&i===r}},{key:"_setRelatedFeaturesViewModels",value:function(e){var t=this,n=e.relatedFeatureViewModels,i=e.relatedFeatures,r=e.map,a=this.view,o=this.spatialReference;null!==i&&void 0!==i&&i.filter(Boolean).forEach((function(e){n.find((function(n){return t._matchesFeature(n,e)}))||n.add(new ii({abilities:{relationshipContent:!1},map:r,view:a,spatialReference:o,graphic:e}))})),n.forEach((function(e){var r=null===i||void 0===i?void 0:i.find((function(n){return t._matchesFeature(e,n)}));r||n.remove(e)}))}},{key:"_setExpressionContentVM",value:function(e,t){var n=this.formattedAttributes,i=e.contentElement,r=e.contentElementViewModel,a=null===i||void 0===i?void 0:i.type;r&&a&&("fields"===a&&(this._createFieldsFormattedAttributes({contentElement:i,contentElementIndex:t,formattedAttributes:n}),r.set(this._createFieldsVMParams(i,t))),"media"===a&&(this._createMediaFormattedAttributes({contentElement:i,contentElementIndex:t,formattedAttributes:n}),r.set(this._createMediaVMParams(i,t))),"text"===a&&r.set(this._createTextVMParams(i)))}},{key:"_compileRelationship",value:function(e,t){var n=this,i=e.displayCount,r=e.orderByFields,a=e.relationshipId,o=e.title,s=e.description,l=this._sourceLayer,u=this.graphic,c=this.map,d=new Qn((0,I.Z)({displayCount:i,graphic:u,orderByFields:r,relationshipId:a,layer:l,map:c},this._compileTitleAndDesc({title:o,description:s})));return this.contentViewModels[t]=d,this._handles.add((0,h.on)((function(){return d.relatedFeatures}),"change",(function(){return n._setRelatedFeaturesViewModels(d)})),si),e}},{key:"_compileExpression",value:function(e,t){var n=this,i=e.expressionInfo,r=this.graphic,a=this.map,o=this.spatialReference,s=this.view,l=new zn({expressionInfo:i,graphic:r,interceptor:ii.interceptor,map:a,spatialReference:o,view:s});return this.contentViewModels[t]=l,this._handles.add((0,h.YP)((function(){return l.contentElementViewModel}),(function(){return n._setExpressionContentVM(l,t)}),h.nn),oi),e}},{key:"_compileAttachments",value:function(e,t){var n=this.graphic,i=e.description,r=e.title;return this.contentViewModels[t]=new et((0,I.Z)({graphic:n},this._compileTitleAndDesc({title:r,description:i}))),e}},{key:"_compileCustom",value:function(e,t){var n=this.graphic,i=e.creator,r=e.destroyer;return this.contentViewModels[t]=new dt({graphic:n,creator:i,destroyer:r}),e}},{key:"_compileTitleAndDesc",value:function(e){var t=e.title,n=e.description,i=this._fieldInfoMap,r=this._sourceLayer,a=this.graphic,o=this.formattedAttributes,s=null===a||void 0===a?void 0:a.attributes,l=this._expressionAttributes,u=o.global;return{title:pe({attributes:s,fieldInfoMap:i,globalAttributes:u,expressionAttributes:l,layer:r,text:t}),description:pe({attributes:s,fieldInfoMap:i,globalAttributes:u,expressionAttributes:l,layer:r,text:n})}}},{key:"_createFieldsVMParams",value:function(e,t){var n,i=this._effectivePopupTemplate,r=this.formattedAttributes,a=(0,I.Z)((0,I.Z)({},null===r||void 0===r?void 0:r.global),null===r||void 0===r?void 0:r.content[t]),o=null===(n=(null===e||void 0===e?void 0:e.fieldInfos)||(null===i||void 0===i?void 0:i.fieldInfos))||void 0===n?void 0:n.filter((function(e){var t=e.fieldName;return se(t)||Pe(t)||a.hasOwnProperty(t)})),s=null===i||void 0===i?void 0:i.expressionInfos,l=e.description,u=e.title;return(0,I.Z)({attributes:a,expressionInfos:s,fieldInfos:o},this._compileTitleAndDesc({title:u,description:l}))}},{key:"_compileFields",value:function(e,t){var n=e.clone(),i=new bt(this._createFieldsVMParams(e,t));return this.contentViewModels[t]=i,n.fieldInfos=i.formattedFieldInfos.slice(0),n}},{key:"_createMediaVMParams",value:function(e,t){var n,i=this.abilities,r=this.graphic,a=this._fieldInfoMap,o=this._effectivePopupTemplate,s=this.relatedInfos,l=this._sourceLayer,u=this._expressionAttributes,c=this.formattedAttributes,d=null!==(n=null===r||void 0===r?void 0:r.attributes)&&void 0!==n?n:{},p=e.description,h=e.mediaInfos,f=e.title;return(0,I.Z)({abilities:{chartAnimation:i.chartAnimation},activeMediaInfoIndex:e.activeMediaInfoIndex||0,attributes:d,isAggregate:null===r||void 0===r?void 0:r.isAggregate,layer:l,fieldInfoMap:a,formattedAttributes:(0,I.Z)((0,I.Z)({},null===c||void 0===c?void 0:c.global),null===c||void 0===c?void 0:c.content[t]),expressionAttributes:u,mediaInfos:h,popupTemplate:o,relatedInfos:s},this._compileTitleAndDesc({title:f,description:p}))}},{key:"_compileMedia",value:function(e,t){var n=e.clone(),i=new Jt(this._createMediaVMParams(e,t));return n.mediaInfos=i.formattedMediaInfos.slice(0),this.contentViewModels[t]=i,n}},{key:"_createTextVMParams",value:function(e){var t=this.graphic,n=this._fieldInfoMap,i=this._sourceLayer,r=this._expressionAttributes;if(e&&e.text){var a,o,s,l=null!==(a=null===t||void 0===t?void 0:t.attributes)&&void 0!==a?a:{},u=null!==(o=null===(s=this.formattedAttributes)||void 0===s?void 0:s.global)&&void 0!==o?o:{};e.text=pe({attributes:l,fieldInfoMap:n,globalAttributes:u,expressionAttributes:r,layer:i,text:e.text})}return{graphic:t,creator:e.text}}},{key:"_compileText",value:function(e,t){var n=e.clone();return this.contentViewModels[t]=new dt(this._createTextVMParams(n)),n}},{key:"_compileLastEditInfo",value:function(){var e=this._effectivePopupTemplate,t=this._sourceLayer,n=this.graphic;if(e){var i=e.lastEditInfoEnabled,r=null===t||void 0===t?void 0:t.editFieldsInfo;return i&&r?function(e,t){var n=e.creatorField,i=e.creationDateField,r=e.editorField,a=e.editDateField;if(t){var o=t[a];if("number"==typeof o){var s=t[r];return{type:"edit",date:(0,z.p6)(o,ne),user:s}}var l=t[i];if("number"==typeof l){var u=t[n];return{type:"create",date:(0,z.p6)(l,ne),user:u}}return null}}(r,null===n||void 0===n?void 0:n.attributes):void 0}}},{key:"_compileTitle",value:function(e){var t,n,i,r=this._fieldInfoMap,a=this._sourceLayer,o=this.graphic,s=this._expressionAttributes;return pe({attributes:null!==(t=null===o||void 0===o?void 0:o.attributes)&&void 0!==t?t:{},fieldInfoMap:r,globalAttributes:null!==(n=null===(i=this.formattedAttributes)||void 0===i?void 0:i.global)&&void 0!==n?n:{},expressionAttributes:s,layer:a,text:e})}},{key:"_getTitle",value:function(){var e=(0,m.Z)((0,g.Z)().mark((function e(){var t,n,i;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._effectivePopupTemplate,n=this.graphic){e.next=3;break}return e.abrupt("return",null);case 3:return i=null===t||void 0===t?void 0:t.title,e.abrupt("return",re(i,{graphic:n}));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getContent",value:function(){var e=(0,m.Z)((0,g.Z)().mark((function e(){var t,n,i;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._effectivePopupTemplate,n=this.graphic){e.next=3;break}return e.abrupt("return",null);case 3:return i=null===t||void 0===t?void 0:t.content,e.abrupt("return",re(i,{graphic:n}));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_queryFeature",value:function(){var e=(0,m.Z)((0,g.Z)().mark((function e(t){var n,i,r,a,o,s,l,u,c,d,p,h;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._featureAbortController,i=this._sourceLayer,r=this.graphic,a=this._effectivePopupTemplate,o=this.map,s=this.view,l=this.spatialReference,n===this._featureAbortController&&r){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,Ae({graphic:r,popupTemplate:a,layer:i,spatialReference:l},t);case 5:return e.next=7,(0,At.as)({content:this._getContent(),title:this._getTitle()});case 7:return u=e.sent,c=u.content.value,d=u.title.value,e.next=12,(0,At.as)({checkForRelatedFeatures:this._checkForRelatedFeatures(t),expressionAttributes:On({expressionInfos:null===a||void 0===a?void 0:a.expressionInfos,spatialReference:l,graphic:r,map:o,interceptor:ii.interceptor,view:s})});case 12:p=e.sent,h=p.expressionAttributes.value,n===this._featureAbortController&&r&&(this._expressionAttributes=h,this._graphicExpressionAttributes=(0,I.Z)((0,I.Z)({},r.attributes),h),this._set("formattedAttributes",this._createFormattedAttributes(c)),this._set("title",this._compileTitle(d)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(c)||null));case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createMediaFormattedAttributes",value:function(e){var t=e.contentElement,n=e.contentElementIndex,i=e.formattedAttributes,r=this._effectivePopupTemplate,a=this.graphic,o=this.relatedInfos,s=this._sourceLayer,l=this._fieldInfoMap,u=this._graphicExpressionAttributes;i.content[n]=Ze({fieldInfos:null===r||void 0===r?void 0:r.fieldInfos,graphic:a,attributes:(0,I.Z)((0,I.Z)({},u),t.attributes),layer:s,fieldInfoMap:l,relatedInfos:o})}},{key:"_createFieldsFormattedAttributes",value:function(e){var t=e.contentElement,n=e.contentElementIndex,i=e.formattedAttributes;if(t.fieldInfos){var r=this.graphic,a=this.relatedInfos,o=this._sourceLayer,s=this._fieldInfoMap,l=this._graphicExpressionAttributes;i.content[n]=Ze({fieldInfos:t.fieldInfos,graphic:r,attributes:(0,I.Z)((0,I.Z)({},l),t.attributes),layer:o,fieldInfoMap:s,relatedInfos:a})}}},{key:"_createFormattedAttributes",value:function(e){var t=this,n=this._effectivePopupTemplate,i=this.graphic,r=this.relatedInfos,a=this._sourceLayer,o=this._fieldInfoMap,s=this._graphicExpressionAttributes,l={global:Ze({fieldInfos:null===n||void 0===n?void 0:n.fieldInfos,graphic:i,attributes:s,layer:a,fieldInfoMap:o,relatedInfos:r}),content:[]};return Array.isArray(e)&&e.forEach((function(e,n){"fields"===e.type&&t._createFieldsFormattedAttributes({contentElement:e,contentElementIndex:n,formattedAttributes:l}),"media"===e.type&&t._createMediaFormattedAttributes({contentElement:e,contentElementIndex:n,formattedAttributes:l})})),l}},{key:"_checkForRelatedFeatures",value:function(e){var t=this.graphic,n=this._effectivePopupTemplate;return this._queryRelatedInfos(t,we(n),e)}},{key:"_queryRelatedInfos",value:function(){var e=(0,m.Z)((0,g.Z)().mark((function e(t,n,i){var r,a,o,s,l,u,c=this;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.relatedInfos,a=this._sourceLayer,r.clear(),!(0,p.pC)(null===a||void 0===a?void 0:a.associatedLayer)){e.next=8;break}return e.next=5,null===a||void 0===a?void 0:a.associatedLayer.load(i);case 5:e.t0=e.sent,e.next=9;break;case 8:e.t0=a;case 9:if((o=e.t0)&&t){e.next=12;break}return e.abrupt("return");case 12:if(s=n.filter((function(e){return e&&Pe(e.fieldName)})),s&&s.length){e.next=15;break}return e.abrupt("return");case 15:return n.forEach((function(e){return c._configureRelatedInfo(e,o)})),e.next=18,jt({relatedInfos:r,layer:o},i);case 18:return l=e.sent,Object.keys(l).forEach((function(e){var t,n=r.get(e.toString()),i=null===(t=l[e])||void 0===t?void 0:t.value;n&&i&&(n.layerInfo=i.data)})),e.next=22,Ht({graphic:t,relatedInfos:r,layer:o},i);case 22:u=e.sent,Object.keys(u).forEach((function(e){var t;Gt(null===(t=u[e])||void 0===t?void 0:t.value,r.get(e.toString()))}));case 24:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}()},{key:"_configureRelatedInfo",value:function(e,t){var n=this.relatedInfos,i=Dt(e.fieldName);if(i){var r=i.layerId,a=i.fieldName;if(r){var o=n.get(r.toString())||Bt(r,t);o&&(function(e){var t,n=e.relatedInfo,i=e.fieldName,r=e.fieldInfo;if(null!==(t=n.relatedFields)&&void 0!==t&&t.push(i),r.statisticType){var a,o=new Rt.Z({statisticType:r.statisticType,onStatisticField:i,outStatisticFieldName:i});null===(a=n.outStatistics)||void 0===a||a.push(o)}}({relatedInfo:o,fieldName:a,fieldInfo:e}),this.relatedInfos.set(r,o))}}}}]),n}((0,Yn.IG)(b.Z));ui.interceptor=new ai((function(e){var t=e.query,n=e.layer,i=e.method;Re({layer:n,method:i,query:t,definitionExpression:"".concat(n.definitionExpression," ").concat(n.serviceDefinitionExpression)})}),(function(e){var t=e.queryPayload,n=e.layer,i=e.method;Re({layer:n,method:i,query:t,definitionExpression:"".concat(n.definitionExpression," ").concat(n.serviceDefinitionExpression)})})),(0,u._)([(0,v.Cb)()],ui.prototype,"_error",void 0),(0,u._)([(0,v.Cb)()],ui.prototype,"_featureAbortController",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],ui.prototype,"_effectivePopupTemplate",null),(0,u._)([(0,v.Cb)({readOnly:!0})],ui.prototype,"_fieldInfoMap",null),(0,u._)([(0,v.Cb)({readOnly:!0})],ui.prototype,"_sourceLayer",null),(0,u._)([(0,v.Cb)()],ui.prototype,"abilities",void 0),(0,u._)([(0,F.p)("abilities")],ui.prototype,"castAbilities",null),(0,u._)([(0,v.Cb)({readOnly:!0})],ui.prototype,"content",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],ui.prototype,"contentViewModels",void 0),(0,u._)([(0,v.Cb)()],ui.prototype,"description",void 0),(0,u._)([(0,v.Cb)({type:Boolean})],ui.prototype,"defaultPopupTemplateEnabled",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],ui.prototype,"isTable",null),(0,u._)([(0,v.Cb)({readOnly:!0})],ui.prototype,"state",null),(0,u._)([(0,v.Cb)({readOnly:!0})],ui.prototype,"formattedAttributes",void 0),(0,u._)([(0,v.Cb)({type:R.Z,value:null})],ui.prototype,"graphic",null),(0,u._)([(0,v.Cb)({readOnly:!0})],ui.prototype,"lastEditInfo",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],ui.prototype,"relatedInfos",void 0),(0,u._)([(0,v.Cb)()],ui.prototype,"spatialReference",null),(0,u._)([(0,v.Cb)({readOnly:!0})],ui.prototype,"title",void 0),(0,u._)([(0,v.Cb)()],ui.prototype,"map",null),(0,u._)([(0,v.Cb)({readOnly:!0})],ui.prototype,"waitingForContent",null),(0,u._)([(0,v.Cb)()],ui.prototype,"view",void 0);var ci,di=ui=ii=(0,u._)([(0,y.j)("esri.widgets.FeatureViewModel")],ui),pi="esri-feature",hi={iconText:"esri-icon-font-fallback-text",iconLoading:"esri-icon-loading-indicator esri-rotating",esriTable:"esri-widget__table",esriWidget:"esri-widget",base:pi,container:"".concat(pi,"__size-container"),title:"".concat(pi,"__title"),main:"".concat(pi,"__main-container"),btn:"".concat(pi,"__button"),icon:"".concat(pi,"__icon"),content:"".concat(pi,"__content"),contentNode:"".concat(pi,"__content-node"),contentElement:"".concat(pi,"__content-element"),text:"".concat(pi,"__text"),lastEditedInfo:"".concat(pi,"__last-edited-info"),fields:"".concat(pi,"__fields"),fieldHeader:"".concat(pi,"__field-header"),fieldData:"".concat(pi,"__field-data"),fieldDataDate:"".concat(pi,"__field-data--date"),loadingSpinnerContainer:"".concat(pi,"__loading-container"),spinner:"".concat(pi,"__loading-spinner")},fi=function(e){var t=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(){var e;return(0,r.Z)(this,n),(e=t.apply(this,arguments)).renderNodeContent=function(t){return(0,pt.Qd)(t)&&!t.destroyed?(0,We.u)("div",{class:hi.contentNode,key:t},t.render()):t instanceof HTMLElement?(0,We.u)("div",{class:hi.contentNode,key:t,bind:t,afterCreate:e._attachToNode}):(0,pt.o)(t)?(0,We.u)("div",{class:hi.contentNode,key:t,bind:t.domNode,afterCreate:e._attachToNode}):null},e}return(0,a.Z)(n,[{key:"_attachToNode",value:function(e){e.appendChild(this)}}]),n}(e);return t=(0,u._)([(0,y.j)("esri.widgets.Feature.ContentMixin")],t)},vi={title:!0,content:!0,lastEditedInfo:!0},yi="relationship-handles",gi=ci=function(e){(0,s.Z)(i,e);var t=(0,l.Z)(i);function i(e,n){var a;return(0,r.Z)(this,i),(a=t.call(this,e,n))._contentWidgets=[],a.flowItems=null,a.headingLevel=2,a.messages=null,a.messagesCommon=null,a.messagesURIUtils=null,a.visibleElements=(0,I.Z)({},vi),a.viewModel=new di,a}return(0,a.Z)(i,[{key:"initialize",value:function(){var e=this;this.addHandles((0,h.YP)((function(){var t;return null===(t=e.viewModel)||void 0===t?void 0:t.contentViewModels}),(function(){return e._setupContentWidgets()}),h.nn))}},{key:"loadDependencies",value:function(){return Promise.all([n.e(11307),n.e(86726)]).then(n.bind(n,86726))}},{key:"destroy",value:function(){this._destroyContentWidgets()}},{key:"graphic",get:function(){return this.viewModel.graphic},set:function(e){this.viewModel.graphic=e}},{key:"defaultPopupTemplateEnabled",get:function(){return this.viewModel.defaultPopupTemplateEnabled},set:function(e){this.viewModel.defaultPopupTemplateEnabled=e}},{key:"isTable",get:function(){return this.viewModel.isTable}},{key:"label",get:function(){var e,t;return null!==(e=null===(t=this.messages)||void 0===t?void 0:t.widgetLabel)&&void 0!==e?e:""},set:function(e){this._overrideIfSome("label",e)}},{key:"spatialReference",get:function(){return this.viewModel.spatialReference},set:function(e){this.viewModel.spatialReference=e}},{key:"title",get:function(){return this.viewModel.title}},{key:"castVisibleElements",value:function(e){return(0,I.Z)((0,I.Z)({},vi),e)}},{key:"map",get:function(){return this.viewModel.map},set:function(e){this.viewModel.map=e}},{key:"view",get:function(){return this.viewModel.view},set:function(e){this.viewModel.view=e}},{key:"render",value:function(){var e=this.viewModel.state,t=(0,We.u)("div",{class:hi.container,key:"container"},this.renderTitle(),"error"===e?this.renderError():"loading"===e?this.renderLoading():this.renderContentContainer());return(0,We.u)("div",{class:this.classes(hi.base,hi.esriWidget)},t)}},{key:"setActiveMedia",value:function(e,t){return this.viewModel.setActiveMedia(e,t)}},{key:"nextMedia",value:function(e){return this.viewModel.nextMedia(e)}},{key:"previousMedia",value:function(e){return this.viewModel.previousMedia(e)}},{key:"renderError",value:function(){var e=this.messagesCommon,t=this.messages,n=this.visibleElements;return(0,We.u)("calcite-notice",{open:!0,kind:"danger",icon:"exclamation-mark-circle",scale:"s"},n.title?(0,We.u)("div",{key:"error-title",slot:"title"},e.errorMessage):null,(0,We.u)("div",{key:"error-message",slot:"message"},t.loadingError))}},{key:"renderLoading",value:function(){return(0,We.u)("div",{key:"loading-container",class:hi.loadingSpinnerContainer},(0,We.u)("span",{class:this.classes(hi.iconLoading,hi.spinner)}))}},{key:"renderContentContainer",value:function(){return this.visibleElements.content?(0,We.u)("div",{class:hi.main},[this.renderContent(),this.renderLastEditInfo()]):null}},{key:"renderTitle",value:function(){var e=this.visibleElements,t=this.title;return e.title?(0,We.u)(tt.X6,{level:this.headingLevel,class:hi.title,innerHTML:t}):null}},{key:"renderContent",value:function(){var e=this.viewModel.content,t="content";if(!e)return null;if(Array.isArray(e))return e.length?(0,We.u)("div",{class:hi.contentNode,key:"".concat(t,"-content-elements")},e.map(this.renderContentElement,this)):null;if("string"==typeof e){var n=this._contentWidgets[0];return!n||n.destroyed?null:(0,We.u)("div",{class:hi.contentNode,key:"".concat(t,"-content")},n.render())}return this.renderNodeContent(e)}},{key:"renderContentElement",value:function(e,t){var n,i=this.visibleElements;if("boolean"!=typeof i.content&&(null===(n=i.content)||void 0===n||!n[e.type]))return null;switch(e.type){case"attachments":return this.renderAttachments(t);case"custom":return this.renderCustom(e,t);case"fields":return this.renderFields(t);case"media":return this.renderMedia(t);case"text":return this.renderText(e,t);case"expression":return this.renderExpression(t);case"relationship":return this.renderRelationship(t);default:return null}}},{key:"renderAttachments",value:function(e){var t=this._contentWidgets[e];if(!t||t.destroyed)return null;var n=t.viewModel,i=n.state,r=n.attachmentInfos;return"loading"===i||r.length>0?(0,We.u)("div",{key:this._buildKey("attachments-element",e),class:this.classes(hi.contentElement)},t.render()):null}},{key:"renderRelationship",value:function(e){var t=this._contentWidgets[e];return t&&!t.destroyed&&this.flowItems?(0,We.u)("div",{key:this._buildKey("relationship-element",e),class:hi.contentElement},t.render()):null}},{key:"renderExpression",value:function(e){var t=this._contentWidgets[e];return!t||t.destroyed?null:(0,We.u)("div",{key:this._buildKey("expression-element",e),class:hi.contentElement},t.render())}},{key:"renderCustom",value:function(e,t){var n=e.creator,i=this._contentWidgets[t];return!i||i.destroyed?null:n?(0,We.u)("div",{key:this._buildKey("custom-element",t),class:hi.contentElement},i.render()):null}},{key:"renderFields",value:function(e){var t=this._contentWidgets[e];return!t||t.destroyed?null:(0,We.u)("div",{key:this._buildKey("fields-element",e),class:hi.contentElement},t.render())}},{key:"renderMedia",value:function(e){var t=this._contentWidgets[e];return!t||t.destroyed?null:(0,We.u)("div",{key:this._buildKey("media-element",e),class:hi.contentElement},t.render())}},{key:"renderLastEditInfo",value:function(){var e=this.visibleElements,t=this.messages,n=this.viewModel.lastEditInfo;if(!n||!e.lastEditedInfo)return null;var i=n.date,r=n.user,a="edit"===n.type?r?t.lastEditedByUser:t.lastEdited:r?t.lastCreatedByUser:t.lastCreated,o=(0,Jn.n)(a,{date:i,user:r});return(0,We.u)("div",{key:"edit-info-element",class:this.classes(hi.lastEditedInfo,hi.contentElement)},o)}},{key:"renderText",value:function(e,t){var n=e.text,i=this._contentWidgets[t];return!i||i.destroyed?null:n?(0,We.u)("div",{key:this._buildKey("text-element",t),class:this.classes(hi.contentElement,hi.text)},i.render()):null}},{key:"_buildKey",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return"".concat(e,"__").concat(this.get("viewModel.graphic.uid")||"0","-").concat(n.join("-"))}},{key:"_destroyContentWidget",value:function(e){e&&(e.viewModel=null,!e.destroyed&&e.destroy())}},{key:"_destroyContentWidgets",value:function(){var e=this;this.removeHandles(yi),this._contentWidgets.forEach((function(t){return e._destroyContentWidget(t)})),this._contentWidgets=[]}},{key:"_addFeatureRelationshipHandles",value:function(e){var t=this,n=this.flowItems,i=this.visibleElements;this.addHandles([(0,h.on)((function(){return e}),"select-record",(function(e){var t=e.featureViewModel;n&&(t.abilities={relationshipContent:!0},n.push(new ci({flowItems:n,viewModel:t,visibleElements:i})))})),(0,h.on)((function(){return e}),"show-all-records",(function(){if(n){var i=e.viewModel;i.showAllEnabled=!0;var r=new ri({visibleElements:{title:!1,description:!1},viewModel:i});t._addFeatureRelationshipHandles(r),n.push(r)}}))],yi)}},{key:"_setupContentWidgets",value:function(){var e=this;this._destroyContentWidgets();var t=this.headingLevel,n=this.visibleElements,i=this.get("viewModel.content"),r=this.viewModel.contentViewModels;if(Array.isArray(i))i.forEach((function(i,a){if("attachments"===i.type&&(e._contentWidgets[a]=new lt({displayType:i.displayType,headingLevel:n.title?t+1:t,viewModel:r[a]})),"fields"===i.type&&(e._contentWidgets[a]=new xt({viewModel:r[a]})),"media"===i.type&&(e._contentWidgets[a]=new wn({viewModel:r[a]})),"text"===i.type&&(e._contentWidgets[a]=new yt({viewModel:r[a]})),"custom"===i.type&&(e._contentWidgets[a]=new yt({viewModel:r[a]})),"expression"===i.type&&(e._contentWidgets[a]=new jn({viewModel:r[a]})),"relationship"===i.type){var o=new ri({viewModel:r[a]});e._addFeatureRelationshipHandles(o),e._contentWidgets[a]=o}}),this);else{var a=r[0];a&&!a.destroyed&&(this._contentWidgets[0]=new yt({viewModel:a}))}this.scheduleRender()}}]),i}(fi(P.Z));(0,u._)([(0,v.Cb)()],gi.prototype,"graphic",null),(0,u._)([(0,v.Cb)()],gi.prototype,"defaultPopupTemplateEnabled",null),(0,u._)([(0,v.Cb)()],gi.prototype,"flowItems",void 0),(0,u._)([(0,v.Cb)()],gi.prototype,"headingLevel",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],gi.prototype,"isTable",null),(0,u._)([(0,v.Cb)()],gi.prototype,"label",null),(0,u._)([(0,v.Cb)(),(0,Ue.H)("esri/widgets/Feature/t9n/Feature")],gi.prototype,"messages",void 0),(0,u._)([(0,v.Cb)(),(0,Ue.H)("esri/t9n/common")],gi.prototype,"messagesCommon",void 0),(0,u._)([(0,v.Cb)(),(0,Ue.H)("esri/widgets/support/t9n/uriUtils")],gi.prototype,"messagesURIUtils",void 0),(0,u._)([(0,v.Cb)()],gi.prototype,"spatialReference",null),(0,u._)([(0,v.Cb)({readOnly:!0})],gi.prototype,"title",null),(0,u._)([(0,v.Cb)()],gi.prototype,"visibleElements",void 0),(0,u._)([(0,F.p)("visibleElements")],gi.prototype,"castVisibleElements",null),(0,u._)([(0,v.Cb)()],gi.prototype,"map",null),(0,u._)([(0,v.Cb)()],gi.prototype,"view",null),(0,u._)([(0,v.Cb)({type:di})],gi.prototype,"viewModel",void 0);var mi,_i=gi=ci=(0,u._)([(0,y.j)("esri.widgets.Feature")],gi),bi=n(91505),wi=Symbol("anchorHandles"),ki=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e){var i;return(0,r.Z)(this,n),(i=t.call(this,e))[mi]=new S.Z,i.location=null,i.screenLocationEnabled=!1,i.view=null,i[wi].add([(0,h.gx)((function(){return(0,p.yw)(i.screenLocationEnabled?i.view:null,(function(e){return[e.size,"3d"===e.type?e.camera:e.viewpoint]}))}),(function(){return i.notifyChange("screenLocation")})),(0,h.YP)((function(){return i.screenLocation}),(function(e,t){(0,p.pC)(e)&&(0,p.pC)(t)&&i.emit("view-change")}))]),i}return(0,a.Z)(n,[{key:"destroy",value:function(){this.view=null,this[wi]=(0,p.SC)(this[wi])}},{key:"screenLocation",get:function(){var e,t=this.location,n=this.view;return this.screenLocationEnabled&&(0,p.pC)(t)&&(0,p.pC)(n)&&n.ready?null===(e=n.toScreen)||void 0===e?void 0:e.call(n,t):null}}]),n}(bi.Z.EventedAccessor);mi=wi,(0,u._)([(0,v.Cb)()],ki.prototype,"location",void 0),(0,u._)([(0,v.Cb)()],ki.prototype,"screenLocation",null),(0,u._)([(0,v.Cb)()],ki.prototype,"screenLocationEnabled",void 0),(0,u._)([(0,v.Cb)()],ki.prototype,"view",void 0);var Ci=ki=(0,u._)([(0,y.j)("esri.widgets.support.AnchorElementViewModel")],ki),Mi=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e){var i;return(0,r.Z)(this,n),(i=t.call(this,e)).visible=!1,i}return(0,a.Z)(n)}(Ci);(0,u._)([(0,v.Cb)()],Mi.prototype,"visible",void 0);var Zi=Mi=(0,u._)([(0,y.j)("esri.widgets.CompassViewModel")],Mi),xi="esri-spinner",Ii={base:xi,spinnerStart:"".concat(xi,"--start"),spinnerFinish:"".concat(xi,"--finish")},Ti=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e,i){var a;return(0,r.Z)(this,n),(a=t.call(this,e,i))._animationDelay=500,a._animationPromise=null,a.viewModel=new Zi,a}return(0,a.Z)(n,[{key:"initialize",value:function(){var e=this;this.addHandles((0,h.YP)((function(){return e.visible}),(function(t){return e._visibleChange(t)})))}},{key:"destroy",value:function(){this._animationPromise=null}},{key:"location",get:function(){return this.viewModel.location},set:function(e){this.viewModel.location=e}},{key:"view",get:function(){return this.viewModel.view},set:function(e){this.viewModel.view=e}},{key:"visible",get:function(){return this.viewModel.visible},set:function(e){this.viewModel.visible=e}},{key:"show",value:function(e){var t=this,n=null!==e&&void 0!==e?e:{},i=n.location,r=n.promise;i&&(this.viewModel.location=i),this.visible=!0;r&&r.catch((function(){})).then((function(){return t.hide()}))}},{key:"hide",value:function(){this.visible=!1}},{key:"render",value:function(){var e,t=this.visible,n=!!this.viewModel.screenLocation,i=t&&n,r=!t&&n,a=(e={},(0,x.Z)(e,Ii.spinnerStart,i),(0,x.Z)(e,Ii.spinnerFinish,r),e),o=this._getPositionStyles();return(0,We.u)("div",{class:this.classes(Ii.base,a),styles:o})}},{key:"_visibleChange",value:function(e){var t=this;if(e)this.viewModel.screenLocationEnabled=!0;else{var n=(0,At.e4)(this._animationDelay);this._animationPromise=n,n.catch((function(){})).then((function(){t._animationPromise===n&&(t.viewModel.screenLocationEnabled=!1,t._animationPromise=null)}))}}},{key:"_getPositionStyles",value:function(){var e=this.viewModel,t=e.screenLocation,n=e.view;if((0,p.Wi)(n)||(0,p.Wi)(t))return{};var i=n.padding;return{left:t.x-i.left+"px",top:t.y-i.top+"px"}}}]),n}(P.Z);(0,u._)([(0,v.Cb)()],Ti.prototype,"location",null),(0,u._)([(0,v.Cb)()],Ti.prototype,"view",null),(0,u._)([(0,v.Cb)({type:Zi})],Ti.prototype,"viewModel",void 0),(0,u._)([(0,v.Cb)()],Ti.prototype,"visible",null);var Si=Ti=(0,u._)([(0,y.j)("esri.widgets.Spinner")],Ti),Ai=n(6945),Fi="esri-icon-zoom-in-magnifying-glass",Pi="esri-icon-trash",Li="esri-icon-table",Ei=new Ai.Z({id:"zoom-to-feature",title:"{messages.zoom}",className:Fi}),Ri=new Ai.Z({id:"remove-selected-feature",title:"{messages.remove}",className:Pi}),Vi=new Ai.Z({id:"zoom-to-clustered-features",title:"{messages.zoom}",className:Fi}),Oi=new Ai.Z({id:"browse-clustered-features",title:"{messages.browseClusteredFeatures}",className:Li}),Di=d.Z.getLogger("esri.widgets.Popup.PopupViewModel"),Ni=function(e){var t=e.event,n=e.view,i=t.action,r=n&&n.popup;if(!i)return Promise.reject(new L.Z("trigger-action:missing-arguments","Event has no action"));if(!r)return Promise.reject(new L.Z("trigger-action:missing-arguments","view.popup is missing"));var a=i.disabled,o=i.id;if(!o)return Promise.reject(new L.Z("trigger-action:invalid-action","action.id is missing"));if(a)return Promise.reject(new L.Z("trigger-action:invalid-action","Action is disabled"));if(o===Ei.id)return function(e){return Ui.apply(this,arguments)}(r.viewModel).catch(At.H9);if(o===Vi.id)return function(e){return Wi.apply(this,arguments)}(r.viewModel);if(o===Oi.id)return r.featureMenuOpen=!r.featureMenuOpen,r.viewModel.browseClusterEnabled=!r.viewModel.browseClusterEnabled,Promise.resolve();if(r.viewModel.browseClusterEnabled=!1,o===Ri.id){r.close();var s=r.selectedFeature;if(!s)return Promise.reject(new L.Z("trigger-action:".concat(Ri.id),"selectedFeature is required",{selectedFeature:s}));var l=s.sourceLayer;return l?l.remove(s):n.graphics.remove(s),Promise.resolve()}return Promise.resolve()};function zi(e){var t,n=e.selectedFeature,i=e.location,r=e.view;return r?"3d"===r.type?null!==(t=null!==n&&void 0!==n?n:i)&&void 0!==t?t:null:e.get("selectedFeature.geometry")||i:null}function Bi(e){var t,n;return!!e&&e.isAggregate&&"cluster"===(null===(t=e.sourceLayer)||void 0===t||null===(n=t.featureReduction)||void 0===n?void 0:n.type)}function Gi(e,t){return qi.apply(this,arguments)}function qi(){return qi=(0,m.Z)((0,g.Z)().mark((function e(t,n){var i,r;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("3d"===(null===n||void 0===n?void 0:n.type)&&t&&"esri.Graphic"===t.declaredClass){e.next=2;break}return e.abrupt("return",!0);case 2:if(!(i=n.getViewForGraphic(t))||!("whenGraphicBounds"in i)){e.next=13;break}return e.prev=4,e.next=7,i.whenGraphicBounds(t,{useViewElevation:!0});case 7:r=e.sent,e.next=12;break;case 10:e.prev=10,e.t0=e.catch(4);case 12:return e.abrupt("return",!r||!r.boundingBox||r.boundingBox[0]===r.boundingBox[3]&&r.boundingBox[1]===r.boundingBox[4]&&r.boundingBox[2]===r.boundingBox[5]);case 13:return e.abrupt("return",!0);case 14:case"end":return e.stop()}}),e,null,[[4,10]])}))),qi.apply(this,arguments)}function Ui(){return Ui=(0,m.Z)((0,g.Z)().mark((function e(t){var n,i,r,a,o,s,l,u,c,d,h,f;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.location,r=t.selectedFeature,a=t.view,o=t.zoomFactor,s=zi(t),a&&s){e.next=4;break}throw l=new L.Z("zoom-to:invalid-target-or-view","Cannot zoom to location without a target and view.",{target:s,view:a}),Di.error(l),l;case 4:if(u=a.scale/o,c=null===(n=t.selectedFeature)||void 0===n?void 0:n.geometry,d=null!==c&&void 0!==c?c:i,e.t0=(0,p.pC)(d)&&"point"===d.type,!e.t0){e.next=12;break}return e.next=11,Gi(r,a);case 11:e.t0=e.sent;case 12:return h=e.t0,Ei.active=!0,Ei.disabled=!0,e.prev=14,e.next=17,t.zoomTo({target:{target:s,scale:h?u:void 0}});case 17:e.next=23;break;case 19:e.prev=19,e.t1=e.catch(14),f=new L.Z("zoom-to:invalid-graphic","Could not zoom to the location of the graphic.",{graphic:r}),Di.error(f);case 23:return e.prev=23,Ei.active=!1,Ei.disabled=!1,t.zoomToLocation=null,h&&(t.location=d),e.finish(23);case 26:case"end":return e.stop()}}),e,null,[[14,19,23,26]])}))),Ui.apply(this,arguments)}function Wi(){return Wi=(0,m.Z)((0,g.Z)().mark((function e(t){var n,r,a,o,s,l,u,c,d,p;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.selectedFeature,"2d"===(null===(r=t.view)||void 0===r?void 0:r.type)){e.next=4;break}throw a=new L.Z("zoomToCluster:invalid-view","View must be 2d MapView.",{view:r}),Di.error(a),a;case 4:if(n&&Bi(n)){e.next=7;break}throw o=new L.Z("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:n}),Di.error(o),o;case 7:return e.next=9,Qi(r,n);case 9:return s=e.sent,l=(0,i.Z)(s,2),u=l[0],c=l[1],Vi.active=!0,Vi.disabled=!0,e.next=16,u.queryExtent(c);case 16:return d=e.sent,p=d.extent,e.next=20,t.zoomTo({target:p});case 20:Vi.active=!1,Vi.disabled=!1;case 22:case"end":return e.stop()}}),e)}))),Wi.apply(this,arguments)}function ji(e){return Hi.apply(this,arguments)}function Hi(){return Hi=(0,m.Z)((0,g.Z)().mark((function e(t){var n,r,a,o,s,l,u,c;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.view,r=t.selectedFeature,n&&r){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,Qi(n,r);case 5:return a=e.sent,o=(0,i.Z)(a,2),s=o[0],l=o[1],e.next=11,s.queryExtent(l);case 11:u=e.sent,c=u.extent,t.selectedClusterBoundaryFeature.geometry=c,n.graphics.add(t.selectedClusterBoundaryFeature);case 14:case"end":return e.stop()}}),e)}))),Hi.apply(this,arguments)}function Yi(e){return Ki.apply(this,arguments)}function Ki(){return Ki=(0,m.Z)((0,g.Z)().mark((function e(t){var n,r,a,o,s,l,u,c,d;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.selectedFeature,(a=t.view)&&r){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,Qi(a,r);case 5:return o=e.sent,s=(0,i.Z)(o,2),l=s[0],u=s[1],Oi.active=!0,Oi.disabled=!0,e.next=12,l.queryFeatures(u);case 12:c=e.sent,d=c.features,Oi.active=!1,Oi.disabled=!1,null===(n=a.popup)||void 0===n||n.open({features:[r].concat(d),featureMenuOpen:!0});case 15:case"end":return e.stop()}}),e)}))),Ki.apply(this,arguments)}function Qi(e,t){return Ji.apply(this,arguments)}function Ji(){return Ji=(0,m.Z)((0,g.Z)().mark((function e(t,n){var i,r,a;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.whenLayerView(n.sourceLayer);case 2:return i=e.sent,r=i.createQuery(),a=n.getObjectId(),e.abrupt("return",(r.aggregateIds=null!=a?[a]:[],[i,r]));case 6:case"end":return e.stop()}}),e)}))),Ji.apply(this,arguments)}function Xi(e){var t;if((0,p.Wi)(e))return null;switch(e.type){case"point":return e;case"extent":return e.center;case"polygon":return e.centroid;case"multipoint":case"polyline":return null===(t=e.extent)||void 0===t?void 0:t.center;default:return null}}var $i="esri-popup",er="".concat($i,"__header"),tr="".concat($i,"--is-docked"),nr={calciteThemeLight:"calcite-mode-light",calciteThemeDark:"calcite-mode-dark",iconLeftTriangleArrow:"esri-icon-left-triangle-arrow",iconRightTriangleArrow:"esri-icon-right-triangle-arrow",iconDockToTop:"esri-icon-maximize",iconDockToBottom:"esri-icon-dock-bottom",iconDockToLeft:"esri-icon-dock-left",iconDockToRight:"esri-icon-dock-right",iconClose:"esri-icon-close",iconUndock:"esri-icon-minimize",iconCheckMark:"esri-icon-check-mark",iconLoading:"esri-icon-loading-indicator",iconDefaultAction:"esri-icon-default-action",iconActionsMenu:"esri-icon-handle-horizontal",rotating:"esri-rotating",base:$i,widget:"esri-widget",main:"".concat($i,"__main-container"),loadingContainer:"".concat($i,"__loading-container"),isCollapsible:"".concat($i,"--is-collapsible"),isCollapsed:"".concat($i,"--is-collapsed"),shadow:"".concat($i,"--shadow"),isDocked:tr,isDockedTopLeft:"".concat(tr,"-top-left"),isDockedTopCenter:"".concat(tr,"-top-center"),isDockedTopRight:"".concat(tr,"-top-right"),isDockedBottomLeft:"".concat(tr,"-bottom-left"),isDockedBottomCenter:"".concat(tr,"-bottom-center"),isDockedBottomRight:"".concat(tr,"-bottom-right"),alignTopCenter:"".concat($i,"--aligned-top-center"),alignBottomCenter:"".concat($i,"--aligned-bottom-center"),alignTopLeft:"".concat($i,"--aligned-top-left"),alignBottomLeft:"".concat($i,"--aligned-bottom-left"),alignTopRight:"".concat($i,"--aligned-top-right"),alignBottomRight:"".concat($i,"--aligned-bottom-right"),isFeatureMenuOpen:"".concat($i,"--feature-menu-open"),isActionsMenuOpen:"".concat($i,"--actions-menu-open"),hasFeatureUpdated:"".concat($i,"--feature-updated"),header:er,headerButtons:"".concat(er,"-buttons"),headerContainer:"".concat(er,"-container"),headerContainerButton:"".concat(er,"-container--button"),headerTitle:"".concat(er,"-title"),content:"".concat($i,"__content"),contentHasFlows:"esri-content--has-flows",contentFlowItem:"esri-content__flow-item",footer:"".concat($i,"__footer"),footerHasPagination:"".concat($i,"__footer--has-pagination"),footerHasActions:"".concat($i,"__footer--has-actions"),footerHasActionsMenu:"".concat($i,"__footer--has-actions-menu"),button:"".concat($i,"__button"),buttonDisabled:"".concat($i,"__button--disabled"),buttonDock:"".concat($i,"__button--dock"),icon:"".concat($i,"__icon"),iconDock:"".concat($i,"__icon--dock-icon"),inlineActionsContainer:"".concat($i,"__inline-actions-container"),actionsMenuButton:"".concat($i,"__actions-menu-button"),actions:"".concat($i,"__actions"),action:"".concat($i,"__action"),actionImage:"".concat($i,"__action-image"),actionText:"".concat($i,"__action-text"),actionToggle:"".concat($i,"__action-toggle"),actionToggleOn:"".concat($i,"__action-toggle--on"),actionExit:"".concat($i,"__action--exit"),actionSelectFeature:"".concat($i,"__action--select-feature"),pointer:"".concat($i,"__pointer"),pointerDirection:"".concat($i,"__pointer-direction"),navigation:"".concat($i,"__navigation"),paginationPrevious:"".concat($i,"__pagination-previous"),paginationNext:"".concat($i,"__pagination-next"),paginationPreviousIconLTR:"".concat($i,"__pagination-previous-icon"),paginationPreviousIconRTL:"".concat($i,"__pagination-previous-icon--rtl"),paginationNextIconLTR:"".concat($i,"__pagination-next-icon"),paginationNextIconRTL:"".concat($i,"__pagination-next-icon--rtl"),featureMenu:"".concat($i,"__feature-menu"),featureMenuList:"".concat($i,"__feature-menu-list"),featureMenuItem:"".concat($i,"__feature-menu-item"),featureMenuViewport:"".concat($i,"__feature-menu-viewport"),featureMenuHeader:"".concat($i,"__feature-menu-header"),featureMenuNote:"".concat($i,"__feature-menu-note"),featureMenuSelected:"".concat($i,"__feature-menu-item--selected"),featureMenuButton:"".concat($i,"__feature-menu-button"),featureMenuTitle:"".concat($i,"__feature-menu-title"),featureMenuObserver:"".concat($i,"__feature-menu-observer"),featureMenuLoader:"".concat($i,"__feature-menu-loader"),collapseButton:"".concat($i,"__collapse-button"),collapseIcon:"".concat($i,"__collapse-icon")},ir=(n(51508),n(81753)),rr=n(30651),ar=n(28970),or=n(57976),sr=n(9676),lr=n(86828),ur=n(1614),cr=n(69787),dr=n(99505),pr=n(61459),hr=w.Z.ofType({key:"type",defaultKeyValue:"button",base:or.Z,typeMap:{button:Ai.Z,toggle:sr.Z}}),fr=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e){var i;return(0,r.Z)(this,n),(i=t.call(this,e))._handles=new S.Z,i._pendingPromises=new Set,i._fetchFeaturesController=null,i._highlightSelectedFeaturePromise=null,i._highlightActiveFeaturePromise=null,i._selectedClusterFeature=null,i.featurePage=null,i.actions=new hr,i.activeFeature=null,i.defaultPopupTemplateEnabled=!1,i.autoCloseEnabled=!1,i.autoOpenEnabled=!0,i.browseClusterEnabled=!1,i.content=null,i.featuresPerPage=20,i.featureViewModelAbilities=null,i.featureViewModels=[],i.highlightEnabled=!0,i.includeDefaultActions=!0,i.selectedClusterBoundaryFeature=new R.Z({symbol:new pr.Z({outline:{width:1.5,color:"cyan"},style:"none"})}),i.title=null,i.updateLocationEnabled=!1,i.view=null,i.visible=!1,i.zoomFactor=4,i.zoomToLocation=null,i}return(0,a.Z)(n,[{key:"isLoadingFeature",get:function(){return this.featureViewModels.some((function(e){return e.waitingForContent}))}},{key:"initialize",value:function(){var e=this;this._handles.add([(0,h.YP)((function(){return[e.autoOpenEnabled,e.view]}),(function(){return e._autoOpenEnabledChange()})),this.on("view-change",(function(){return e._autoClose()})),(0,h.YP)((function(){return[e.highlightEnabled,e.selectedFeature,e.visible,e.view]}),(function(){return e._highlightSelectedFeature()})),(0,h.YP)((function(){return[e.highlightEnabled,e.activeFeature,e.visible,e.view]}),(function(){return e._highlightActiveFeature()})),(0,h.YP)((function(){var t,n;return null===(t=e.view)||void 0===t||null===(n=t.animation)||void 0===n?void 0:n.state}),(function(t){return e._animationStateChange(t)})),(0,h.YP)((function(){return e.location}),(function(t){return e._locationChange(t)})),(0,h.YP)((function(){return e.selectedFeature}),(function(t){return e._selectedFeatureChange(t)})),(0,h.YP)((function(){return[e.selectedFeatureIndex,e.featureCount,e.featuresPerPage]}),(function(){return e._selectedFeatureIndexChange()})),(0,h.YP)((function(){return[e.featurePage,e.selectedFeatureIndex,e.featureCount,e.featuresPerPage,e.featureViewModels]}),(function(){return e._setGraphicOnFeatureViewModels()})),(0,h.YP)((function(){return e.featureViewModels}),(function(){return e._featureViewModelsChange()})),this.on("trigger-action",(function(t){return Ni({event:t,view:e.view})})),(0,h.gx)((function(){return!e.waitingForResult}),(function(){return e._waitingForResultChange()}),h.Z_),(0,h.YP)((function(){var t,n;return[e.features,null===(t=e.view)||void 0===t?void 0:t.map,null===(n=e.view)||void 0===n?void 0:n.spatialReference]}),(function(){return e._updateFeatureVMs()})),(0,h.YP)((function(){var t;return null===(t=e.view)||void 0===t?void 0:t.scale}),(function(){return e._viewScaleChange()})),(0,h.gx)((function(){return!e.visible}),(function(){return e.browseClusterEnabled=!1})),(0,h.YP)((function(){return e.browseClusterEnabled}),(function(t){return t?e.enableClusterBrowsing():e.disableClusterBrowsing()}))])}},{key:"destroy",value:function(){this._cancelFetchingFeatures(),this._handles.destroy(),this._pendingPromises.clear(),this.browseClusterEnabled=!1,this.view=null}},{key:"active",get:function(){return!(!this.visible||this.waitingForResult)}},{key:"allActions",get:function(){var e=this._get("allActions")||new hr;e.removeAll();var t=this.actions,n=this.defaultActions,i=this.defaultPopupTemplateEnabled,r=this.includeDefaultActions,a=this.selectedFeature,o=r?n.concat(t):t,s=a&&("function"==typeof a.getEffectivePopupTemplate&&a.getEffectivePopupTemplate(i)||a.popupTemplate),l=s&&s.actions,u=s&&s.overwriteActions?l:l?l.concat(o):o;return u&&u.filter(Boolean).forEach((function(t){return e.add(t)})),e}},{key:"defaultActions",get:function(){var e=this._get("defaultActions")||new hr;return e.removeAll(),e.addMany(Bi(this.selectedFeature)?[Vi.clone(),Oi.clone()]:[Ei.clone()]),e}},{key:"featureCount",get:function(){return this.features.length}},{key:"features",get:function(){return this._get("features")||[]},set:function(e){var t=e||[];this._set("features",t);var n=this.pendingPromisesCount,i=this.promiseCount,r=this.selectedFeatureIndex,a=i&&t.length;a&&n&&-1===r?this.selectedFeatureIndex=0:a&&-1!==r||(this.selectedFeatureIndex=t.length?0:-1)}},{key:"location",get:function(){return this._get("location")||null},set:function(e){var t,n,i,r=e,a=null===(t=this.view)||void 0===t||null===(n=t.spatialReference)||void 0===n?void 0:n.isWebMercator;e&&null!==e&&void 0!==e&&null!==(i=e.spatialReference)&&void 0!==i&&i.isWGS84&&a&&(r=(0,ir.$)(e)),this._set("location",r)}},{key:"pendingPromisesCount",get:function(){return this._pendingPromises.size}},{key:"waitingForResult",get:function(){return!(!(this._fetchFeaturesController||this.pendingPromisesCount>0)||0!==this.featureCount)}},{key:"promiseCount",get:function(){return this.promises.length}},{key:"promises",get:function(){return this._get("promises")||[]},set:function(e){var t=this;if(this._pendingPromises.clear(),this.features=[],!Array.isArray(e)||!e.length)return this._set("promises",[]),void this.notifyChange("pendingPromisesCount");this._set("promises",e),(e=e.slice(0)).forEach((function(e){t._pendingPromises.add(e);e.then((function(n){t._pendingPromises.has(e)&&t._updateFeatures(n),t._updatePendingPromises(e)}),(function(){return t._updatePendingPromises(e)}))})),this.notifyChange("pendingPromisesCount")}},{key:"selectedFeature",get:function(){var e=this.features,t=this.selectedFeatureIndex;return-1===t?null:e[t]||null}},{key:"selectedFeatureIndex",get:function(){var e=this._get("selectedFeatureIndex");return"number"==typeof e?e:-1},set:function(e){var t=this.featureCount;e=isNaN(e)||e<-1||!t?-1:(e+t)%t,this.activeFeature=null,this._set("selectedFeatureIndex",e)}},{key:"selectedFeatureViewModel",get:function(){return this.featureViewModels[this.selectedFeatureIndex]||null}},{key:"state",get:function(){return this.get("view.ready")?"ready":"disabled"}},{key:"centerAtLocation",value:function(){var e=this.view,t=zi(this);return t&&e?this.callGoTo({target:{target:t,scale:e.scale}}):Promise.reject(new L.Z("center-at-location:invalid-target-or-view","Cannot center at a location without a target and view.",{target:t,view:e}))}},{key:"zoomTo",value:function(e){return this.callGoTo(e)}},{key:"clear",value:function(){this.set({promises:[],features:[],content:null,title:null,location:null,activeFeature:null})}},{key:"fetchFeatures",value:function(e,t){var n=this.view;if(!n||!e)throw new L.Z("fetch-features:invalid-screenpoint-or-view","Cannot fetch features without a screenPoint and view.",{screenPoint:e,view:n});return n.fetchPopupFeatures(e,{event:t&&t.event,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,signal:t&&t.signal})}},{key:"open",value:function(e){var t=(0,I.Z)((0,I.Z)({updateLocationEnabled:!1,promises:[],fetchFeatures:!1},e),{},{visible:!0}),n=t.fetchFeatures;delete t.fetchFeatures,n&&this._setFetchFeaturesPromises(t.location);for(var i=0,r=["actionsMenuOpen","collapsed","featureMenuOpen"];i<r.length;i++){delete t[r[i]]}this.set(t)}},{key:"triggerAction",value:function(e){var t=this.allActions.getItemAt(e);t&&!t.disabled&&this.emit("trigger-action",{action:t})}},{key:"next",value:function(){return this.selectedFeatureIndex=this.selectedFeatureIndex+1,this}},{key:"previous",value:function(){return this.selectedFeatureIndex=this.selectedFeatureIndex-1,this}},{key:"disableClusterBrowsing",value:function(){(function(e){var t=e.features.filter((function(e){return Bi(e)}));t.length&&(e.features=t)})(this),this._clearBrowsedClusterGraphics()}},{key:"enableClusterBrowsing",value:function(){var e=(0,m.Z)((0,g.Z)().mark((function e(){var t,n;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.view,n=this.selectedFeature,"2d"!==(null===t||void 0===t?void 0:t.type)){e.next=12;break}if(!Bi(n)){e.next=9;break}return e.next=5,ji(this);case 5:return e.next=7,Yi(this);case 7:e.next=10;break;case 9:d.Z.getLogger(this.declaredClass).warn("enableClusterBrowsing:invalid-selectedFeature: Selected feature must represent an aggregate/cluster graphic.",n);case 10:e.next=13;break;case 12:d.Z.getLogger(this.declaredClass).warn("enableClusterBrowsing:invalid-view: View must be 2d MapView.",n);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_animationStateChange",value:function(e){this.zoomToLocation||(Ei.disabled="waiting-for-target"===e)}},{key:"_clearBrowsedClusterGraphics",value:function(){var e,t=null===(e=this.view)||void 0===e?void 0:e.graphics;t&&(t.remove(this.selectedClusterBoundaryFeature),this._selectedClusterFeature&&t.remove(this._selectedClusterFeature)),this._selectedClusterFeature=null,this.selectedClusterBoundaryFeature.geometry=null}},{key:"_viewScaleChange",value:function(){if(Bi(this.selectedFeature))return this.browseClusterEnabled=!1,this.visible=!1,void this.clear();this.browseClusterEnabled&&(this.features=this.selectedFeature?[this.selectedFeature]:[])}},{key:"_locationChange",value:function(e){var t=this.selectedFeature;this.updateLocationEnabled&&e&&(!t||t.geometry)&&this.centerAtLocation()}},{key:"_selectedFeatureIndexChange",value:function(){this.featurePage=this.featureCount>1?Math.floor(this.selectedFeatureIndex/this.featuresPerPage)+1:null}},{key:"_featureViewModelsChange",value:function(){this.featurePage=this.featureCount>1?1:null}},{key:"_setGraphicOnFeatureViewModels",value:function(){var e=this.features,t=this.featureCount,n=this.featurePage,i=this.featuresPerPage,r=this.featureViewModels;if(null!==n){var a=((n-1)*i+t)%t,o=a+i;r.slice(a,o).forEach((function(t,n){t&&!t.graphic&&(t.graphic=e[a+n])}))}}},{key:"_selectedFeatureChange",value:function(){var e=(0,m.Z)((0,g.Z)().mark((function e(t){var n,i,r,a=this;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.location,i=this.updateLocationEnabled,r=this.view,!t||!r){e.next=11;break}if(!this.browseClusterEnabled){e.next=10;break}if(this._selectedClusterFeature&&(r.graphics.remove(this._selectedClusterFeature),this._selectedClusterFeature=null),!Bi(t)){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,(0,lr.zd)(t);case 7:return t.symbol=e.sent,this._selectedClusterFeature=t,e.abrupt("return",void r.graphics.add(this._selectedClusterFeature));case 10:!i&&n||!t.geometry?i&&!t.geometry&&this.centerAtLocation().then((function(){var e,t=null===(e=r.center)||void 0===e?void 0:e.clone();t&&(a.location=t)})):this.location=(0,p.Wg)(Xi(t.geometry));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_waitingForResultChange",value:function(){!this.featureCount&&this.promises&&(this.visible=!1)}},{key:"_setFetchFeaturesPromises",value:function(e){var t=this;return this._fetchFeaturesWithController(this._getScreenPoint(e||this.location)).then((function(e){var n=e.clientOnlyGraphics,i=e.promisesPerLayerView,r=Promise.resolve(n),a=i.map((function(e){return e.promise}));t.promises=[r].concat((0,D.Z)(a))}))}},{key:"_destroyFeatureVMs",value:function(){this.featureViewModels.forEach((function(e){return e&&!e.destroyed&&e.destroy()})),this._set("featureViewModels",[])}},{key:"_updateFeatureVMs",value:function(){var e=this,t=this.selectedFeature,n=this.features,i=this.featureViewModels;if(Bi(t)||(this.browseClusterEnabled=!1),this._destroyFeatureVMs(),n&&n.length){var r=i.slice(0),a=[];n.forEach((function(n,i){if(n){var o=null;if(r.some((function(e,t){return e&&e.graphic===n&&(o=e,r.splice(t,1)),!!o})),o)a[i]=o;else{var s,l,u=new di({abilities:e.featureViewModelAbilities,defaultPopupTemplateEnabled:e.defaultPopupTemplateEnabled,spatialReference:null===(s=e.view)||void 0===s?void 0:s.spatialReference,graphic:n===t?n:null,map:null===(l=e.view)||void 0===l?void 0:l.map,view:e.view});a[i]=u}}})),r.forEach((function(e){return e&&!e.destroyed&&e.destroy()})),this._set("featureViewModels",a)}}},{key:"_getScreenPoint",value:function(e){var t=this.view;return t&&e&&"function"==typeof t.toScreen?t.toScreen(e):null}},{key:"_autoOpenEnabledChange",value:function(){var e=this,t="auto-fetch-features",n=this._handles,i=this.autoOpenEnabled;if(n.remove(t),i&&this.view){var r=this.view.on("click",(function(t){"mouse"===t.pointerType&&0!==t.button||e._fetchFeaturesAndOpen(t)}),ur.f.WIDGET);n.add(r,t)}}},{key:"_cancelFetchingFeatures",value:function(){var e=this._fetchFeaturesController;e&&e.abort(),this._fetchFeaturesController=null,this.notifyChange("waitingForResult")}},{key:"_fetchFeaturesWithController",value:function(e,t){var n=this;this._cancelFetchingFeatures();var i=new AbortController,r=i.signal;this._fetchFeaturesController=i,this.notifyChange("waitingForResult");var a=this.fetchFeatures(e,{signal:r,event:t});return a.catch((function(){})).then((function(){n._fetchFeaturesController=null,n.notifyChange("waitingForResult")})),a}},{key:"_fetchFeaturesAndOpen",value:function(e){var t=e.screenPoint,n=e.mapPoint,i=this.view;this._fetchFeaturesWithController(t,e).then((function(e){var t,r=e.clientOnlyGraphics,a=e.promisesPerLayerView,o=e.location,s=[Promise.resolve(r)].concat((0,D.Z)(a.map((function(e){return e.promise}))));return null!==i&&void 0!==i&&null!==(t=i.popup)&&void 0!==t&&t.open({location:o||n,promises:s}),e}))}},{key:"_updatePendingPromises",value:function(e){e&&this._pendingPromises.has(e)&&(this._pendingPromises.delete(e),this.notifyChange("pendingPromisesCount"))}},{key:"_autoClose",value:function(){this.autoCloseEnabled&&(this.visible=!1)}},{key:"_getLayerView",value:function(){var e=(0,m.Z)((0,g.Z)().mark((function e(t,n){return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.when();case 2:return e.abrupt("return",t.whenLayerView(n));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_getHighlightLayer",value:function(e){var t=e.layer,n=e.sourceLayer;return n&&"layer"in n&&n.layer?n.layer:"map-notes"===(null===n||void 0===n?void 0:n.type)||"subtype-group"===(null===n||void 0===n?void 0:n.type)?n:t}},{key:"_getHighlightTarget",value:function(e,t){var n="imagery"===t.type?void 0:"objectIdField"in t?t.objectIdField||ar.d:null,i=e.attributes;return i&&n&&i[n]||e}},{key:"_highlightActiveFeature",value:function(){var e=(0,m.Z)((0,g.Z)().mark((function e(){var t,n,i,r,a,o,s,l,u;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t="highlight-active-feature",this._handles.remove(t),n=this.highlightEnabled,i=this.view,r=this.activeFeature,a=this.visible,r&&i&&n&&a){e.next=5;break}return e.abrupt("return");case 5:if((o=this._getHighlightLayer(r))&&o instanceof rr.Z){e.next=8;break}return e.abrupt("return");case 8:return s=this._getLayerView(i,o),this._highlightActiveFeaturePromise=s,e.next=12,s;case 12:if((l=e.sent)&&(0,cr.tl)(l)&&this._highlightActiveFeaturePromise===s&&this.activeFeature&&this.highlightEnabled){e.next=15;break}return e.abrupt("return");case 15:u=l.highlight(this._getHighlightTarget(r,o)),this._handles.add(u,t);case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_highlightSelectedFeature",value:function(){var e=(0,m.Z)((0,g.Z)().mark((function e(){var t,n,i,r,a,o,s,l,u;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t="highlight-selected-feature",this._handles.remove(t),n=this.selectedFeature,i=this.highlightEnabled,r=this.view,a=this.visible,n&&r&&i&&a){e.next=5;break}return e.abrupt("return");case 5:if((o=this._getHighlightLayer(n))&&o instanceof rr.Z){e.next=8;break}return e.abrupt("return");case 8:return s=this._getLayerView(r,o),this._highlightSelectedFeaturePromise=s,e.next=12,s;case 12:if((l=e.sent)&&(0,cr.tl)(l)&&this._highlightSelectedFeaturePromise===s&&this.selectedFeature&&this.highlightEnabled&&this.visible){e.next=15;break}return e.abrupt("return");case 15:u=l.highlight(this._getHighlightTarget(n,o)),this._handles.add(u,t);case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_updateFeatures",value:function(e){var t=this.features;if(e&&e.length)if(t.length){var n=e.filter((function(e){return!t.includes(e)}));this.features=t.concat(n)}else this.features=e}}]),n}((0,dr._)(Ci));(0,u._)([(0,v.Cb)()],fr.prototype,"featurePage",void 0),(0,u._)([(0,v.Cb)()],fr.prototype,"isLoadingFeature",null),(0,u._)([(0,v.Cb)({type:hr})],fr.prototype,"actions",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],fr.prototype,"active",null),(0,u._)([(0,v.Cb)()],fr.prototype,"activeFeature",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],fr.prototype,"allActions",null),(0,u._)([(0,v.Cb)({type:Boolean})],fr.prototype,"defaultPopupTemplateEnabled",void 0),(0,u._)([(0,v.Cb)()],fr.prototype,"autoCloseEnabled",void 0),(0,u._)([(0,v.Cb)()],fr.prototype,"autoOpenEnabled",void 0),(0,u._)([(0,v.Cb)()],fr.prototype,"browseClusterEnabled",void 0),(0,u._)([(0,v.Cb)()],fr.prototype,"content",void 0),(0,u._)([(0,v.Cb)({type:hr,readOnly:!0})],fr.prototype,"defaultActions",null),(0,u._)([(0,v.Cb)({readOnly:!0})],fr.prototype,"featureCount",null),(0,u._)([(0,v.Cb)()],fr.prototype,"features",null),(0,u._)([(0,v.Cb)()],fr.prototype,"featuresPerPage",void 0),(0,u._)([(0,v.Cb)()],fr.prototype,"featureViewModelAbilities",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],fr.prototype,"featureViewModels",void 0),(0,u._)([(0,v.Cb)()],fr.prototype,"highlightEnabled",void 0),(0,u._)([(0,v.Cb)()],fr.prototype,"includeDefaultActions",void 0),(0,u._)([(0,v.Cb)({type:Pt.Z})],fr.prototype,"location",null),(0,u._)([(0,v.Cb)({readOnly:!0})],fr.prototype,"pendingPromisesCount",null),(0,u._)([(0,v.Cb)({readOnly:!0})],fr.prototype,"selectedClusterBoundaryFeature",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],fr.prototype,"waitingForResult",null),(0,u._)([(0,v.Cb)({readOnly:!0})],fr.prototype,"promiseCount",null),(0,u._)([(0,v.Cb)()],fr.prototype,"promises",null),(0,u._)([(0,v.Cb)({value:null,readOnly:!0})],fr.prototype,"selectedFeature",null),(0,u._)([(0,v.Cb)({value:-1})],fr.prototype,"selectedFeatureIndex",null),(0,u._)([(0,v.Cb)({readOnly:!0})],fr.prototype,"selectedFeatureViewModel",null),(0,u._)([(0,v.Cb)({readOnly:!0})],fr.prototype,"state",null),(0,u._)([(0,v.Cb)()],fr.prototype,"title",void 0),(0,u._)([(0,v.Cb)()],fr.prototype,"updateLocationEnabled",void 0),(0,u._)([(0,v.Cb)()],fr.prototype,"view",void 0),(0,u._)([(0,v.Cb)()],fr.prototype,"visible",void 0),(0,u._)([(0,v.Cb)()],fr.prototype,"zoomFactor",void 0),(0,u._)([(0,v.Cb)()],fr.prototype,"zoomToLocation",void 0),(0,u._)([(0,v.Cb)()],fr.prototype,"centerAtLocation",null);var vr=fr=(0,u._)([(0,y.j)("esri.widgets.Popup.PopupViewModel")],fr),yr=n(78088),gr=n(28907),mr="selected-index",_r="popup-spinner",br={buttonEnabled:!0,position:"auto",breakpoint:{width:544}},wr="esri-popup";function kr(e,t){return void 0===t?"".concat(wr,"__").concat(e):"".concat(wr,"__").concat(e,"-").concat(t)}var Cr={closeButton:!0,featureNavigation:!0},Mr=function(e){(0,s.Z)(o,e);var t=(0,l.Z)(o);function o(e,n){var a;return(0,r.Z)(this,o),(a=t.call(this,e,n))._blurClose=!1,a._blurContainer=!1,a._containerNode=null,a._mainContainerNode=null,a._featureMenuNode=null,a._actionsMenuNode=null,a._focusClose=!1,a._focusContainer=!1,a._focusDockButton=!1,a._focusFeatureMenuButton=!1,a._focusActionsMenuButton=!1,a._focusFirstFeature=!1,a._focusFirstAction=!1,a._handles=new S.Z,a._pointerOffsetInPx=16,a._spinner=null,a._feature=null,a._featureMenuIntersectionObserverNode=null,a._featureMenuViewportNode=null,a._rootFlowItemNode=null,a._featureMenuIntersectionObserverCallback=function(e){var t=(0,i.Z)(e,1)[0];(null===t||void 0===t?void 0:t.isIntersecting)&&null!=a.viewModel.featurePage&&a.viewModel.featurePage++},a._featureMenuIntersectionObserver=new IntersectionObserver(a._featureMenuIntersectionObserverCallback,{root:window.document}),a._displaySpinnerThrottled=(0,A.P)((function(){return a._displaySpinner()}),0),a._exitRelatedRecordsActions=new WeakMap,a._featureSelectionActions=new WeakMap,a._flowItems=new w.Z,a.alignment="auto",a.collapsed=!1,a.collapseEnabled=!0,a.dockEnabled=!1,a.featureMenuOpen=!1,a.headingLevel=2,a.maxInlineActions=3,a.messages=null,a.messagesCommon=null,a.spinnerEnabled=!0,a.viewModel=new vr,a.visibleElements=(0,I.Z)({},Cr),a._handleOpenRelatedFeature=function(e){a._openRelatedFeature(e)},a._addSelectedFeatureIndexHandle(),a.addHandles([(0,h.YP)((function(){var e;return null===(e=a.viewModel)||void 0===e?void 0:e.screenLocation}),(function(){return a._positionContainer()})),(0,h.YP)((function(){var e;return[null===(e=a.viewModel)||void 0===e?void 0:e.active,a.dockEnabled]}),(function(){return a._toggleScreenLocationEnabled()})),(0,h.YP)((function(){var e;return null===(e=a.viewModel)||void 0===e?void 0:e.screenLocation}),(function(e,t){!!e!=!!t&&a.reposition()})),(0,h.YP)((function(){var e,t,n,i,r,o;return[null===(e=a.viewModel)||void 0===e||null===(t=e.view)||void 0===t?void 0:t.padding,null===(n=a.viewModel)||void 0===n||null===(i=n.view)||void 0===i?void 0:i.size,null===(r=a.viewModel)||void 0===r?void 0:r.active,null===(o=a.viewModel)||void 0===o?void 0:o.location,a.alignment]}),(function(){return a.reposition()})),(0,h.YP)((function(){return a.spinnerEnabled}),(function(e){return a._spinnerEnabledChange(e)})),(0,h.YP)((function(){var e,t;return null===(e=a.viewModel)||void 0===e||null===(t=e.view)||void 0===t?void 0:t.size}),(function(e,t){return a._updateDockEnabledForViewSize(e,t)})),(0,h.YP)((function(){var e;return null===(e=a.viewModel)||void 0===e?void 0:e.view}),(function(e,t){return a._viewChange(e,t)})),(0,h.YP)((function(){var e,t;return null===(e=a.viewModel)||void 0===e||null===(t=e.view)||void 0===t?void 0:t.ready}),(function(e,t){return a._viewReadyChange(null!==e&&void 0!==e&&e,null!==t&&void 0!==t&&t)})),(0,h.YP)((function(){var e,t;return[null===(e=a.viewModel)||void 0===e?void 0:e.waitingForResult,null===(t=a.viewModel)||void 0===t?void 0:t.location]}),(function(){a._hideSpinner(),a._displaySpinnerThrottled()})),(0,h.YP)((function(){return a.selectedFeatureWidget}),(function(){return a._destroyFlowItemWidgets()})),(0,h.YP)((function(){var e,t,n,i;return[null===(e=a.selectedFeatureWidget)||void 0===e||null===(t=e.viewModel)||void 0===t?void 0:t.title,null===(n=a.selectedFeatureWidget)||void 0===n||null===(i=n.viewModel)||void 0===i?void 0:i.state]}),(function(){return a._setTitleFromFeatureWidget()})),(0,h.YP)((function(){var e,t,n,i;return[null===(e=a.selectedFeatureWidget)||void 0===e||null===(t=e.viewModel)||void 0===t?void 0:t.content,null===(n=a.selectedFeatureWidget)||void 0===n||null===(i=n.viewModel)||void 0===i?void 0:i.state]}),(function(){return a._setContentFromFeatureWidget()})),(0,h.gx)((function(){return!a.collapsed}),(function(){var e,t;"xsmall"===(null===(e=a.viewModel)||void 0===e||null===(t=e.view)||void 0===t?void 0:t.widthBreakpoint)&&a.viewModel.active&&a.collapseEnabled&&a.viewModel.centerAtLocation()})),(0,h.on)((function(){var e;return null===(e=a.viewModel)||void 0===e?void 0:e.allActions}),"change",(function(){return a._watchActions()})),(0,h.YP)((function(){var e;return null===(e=a.viewModel)||void 0===e?void 0:e.allActions}),(function(){return a._watchActions()}),h.nn),(0,h.YP)((function(){var e;return null===(e=a.viewModel)||void 0===e?void 0:e.featureViewModels}),(function(){return a._featureMenuViewportScrollTop()})),(0,h.on)((function(){return a._flowItems}),"change",(function(){a.notifyChange("_activeFlowItemWidget"),a.scheduleRender()})),(0,h.YP)((function(){var e,t,n,i;return[null===(e=a._activeFlowItemWidget)||void 0===e||null===(t=e.viewModel)||void 0===t?void 0:t.state,null===(n=a._activeFlowItemWidget)||void 0===n||null===(i=n.viewModel)||void 0===i?void 0:i.title]}),(function(){return a.scheduleRender()}))]),a}return(0,a.Z)(o,[{key:"loadDependencies",value:function(){return Promise.all([n.e(61766).then(n.bind(n,61766)),Promise.all([n.e(11307),n.e(89998),n.e(2607),n.e(76648),n.e(97213),n.e(74446)]).then(n.bind(n,74446)),Promise.all([n.e(11307),n.e(2607),n.e(49501)]).then(n.bind(n,5855)),Promise.all([n.e(89998),n.e(97213),n.e(51124)]).then(n.bind(n,51124)),n.e(64756).then(n.bind(n,64756))])}},{key:"destroy",value:function(){var e,t;this._destroyFlowItemWidgets(),this._destroySelectedFeatureWidget(),this._destroySpinner(),null!==(e=this._handles)&&void 0!==e&&e.destroy(),this._unobserveFeatureMenuObserver(),null===(t=this._featureMenuIntersectionObserver)||void 0===t||t.disconnect()}},{key:"actionsMenuId",get:function(){return"".concat(this.id,"-actions-menu")}},{key:"actionsMenuButtonId",get:function(){return"".concat(this.id,"-actions-menu-button")}},{key:"featureMenuId",get:function(){return"".concat(this.id,"-feature-menu")}},{key:"titleId",get:function(){return"".concat(this.id,"-popup-title")}},{key:"contentId",get:function(){return"".concat(this.id,"-popup-content")}},{key:"hasContent",get:function(){var e=this.selectedFeatureWidget,t=this.viewModel;if(!e)return!(null===t||void 0===t||!t.content);var n=e.viewModel;if(null!==n&&void 0!==n&&n.waitingForContent||"error"===(null===n||void 0===n?void 0:n.state))return!0;var i=null===n||void 0===n?void 0:n.content;return Array.isArray(i)?!!i.length:!!i}},{key:"featureNavigationVisible",get:function(){return this.viewModel.active&&this.viewModel.featureCount>1&&null!=this.visibleElements.featureNavigation}},{key:"collapsible",get:function(){return!!(this.collapseEnabled&&this.viewModel.title&&this.hasContent)}},{key:"featureMenuVisible",get:function(){return this.featureNavigationVisible&&this.featureMenuOpen}},{key:"contentCollapsed",get:function(){return this.collapsible&&!this.featureMenuVisible&&this.collapsed}},{key:"dividedActions",get:function(){return this._divideActions()}},{key:"_activeFlowItemWidget",get:function(){var e=this._flowItems;return e.getItemAt(e.length-1)||null}},{key:"actions",get:function(){return this.viewModel.actions},set:function(e){this.viewModel.actions=e}},{key:"actionsMenuOpen",get:function(){return!!this.viewModel.active&&this._get("actionsMenuOpen")},set:function(e){this._set("actionsMenuOpen",!!e)}},{key:"autoCloseEnabled",get:function(){return this.viewModel.autoCloseEnabled},set:function(e){this.viewModel.autoCloseEnabled=e}},{key:"autoOpenEnabled",get:function(){return this.viewModel.autoOpenEnabled},set:function(e){this.viewModel.autoOpenEnabled=e}},{key:"defaultPopupTemplateEnabled",get:function(){return this.viewModel.defaultPopupTemplateEnabled},set:function(e){this.viewModel.defaultPopupTemplateEnabled=e}},{key:"content",get:function(){return this.viewModel.content},set:function(e){this.viewModel.content=e}},{key:"currentAlignment",get:function(){return this._getCurrentAlignment()}},{key:"currentDockPosition",get:function(){return this._getCurrentDockPosition()}},{key:"dockOptions",get:function(){return this._get("dockOptions")||br},set:function(e){var t,n,i=(0,I.Z)({},br),r=null===(t=this.viewModel)||void 0===t||null===(n=t.view)||void 0===n?void 0:n.breakpoints,a={};r&&(a.width=r.xsmall,a.height=r.xsmall);var o=(0,I.Z)((0,I.Z)({},i),e),s=(0,I.Z)((0,I.Z)({},i.breakpoint),a),l=o.breakpoint;"object"==typeof l?o.breakpoint=(0,I.Z)((0,I.Z)({},s),l):l&&(o.breakpoint=s),this._set("dockOptions",o),this._setCurrentDockPosition(),this.reposition()}},{key:"featureCount",get:function(){return this.viewModel.featureCount}},{key:"features",get:function(){return this.viewModel.features},set:function(e){this.viewModel.features=e}},{key:"goToOverride",get:function(){return this.viewModel.goToOverride},set:function(e){this.viewModel.goToOverride=e}},{key:"highlightEnabled",get:function(){return this.viewModel.highlightEnabled},set:function(e){this.viewModel.highlightEnabled=e}},{key:"location",get:function(){return this.viewModel.location},set:function(e){this.viewModel.location=e}},{key:"label",get:function(){var e,t;return null!==(e=null===(t=this.messages)||void 0===t?void 0:t.widgetLabel)&&void 0!==e?e:""},set:function(e){this._overrideIfSome("label",e)}},{key:"promises",get:function(){return this.viewModel.promises},set:function(e){this.viewModel.promises=e}},{key:"selectedFeature",get:function(){return this.viewModel.selectedFeature}},{key:"selectedFeatureIndex",get:function(){return this.viewModel.selectedFeatureIndex},set:function(e){this.viewModel.selectedFeatureIndex=e}},{key:"selectedFeatureWidget",get:function(){var e=this._feature,t=this.visibleElements,n=this.headingLevel,i=this._flowItems,r=this.viewModel.selectedFeatureViewModel,a=(0,I.Z)((0,I.Z)({},t),{},{title:!1});return r?(e?(e.viewModel=r,e.visibleElements=a):this._feature=new _i({flowItems:i,headingLevel:n+1,viewModel:r,visibleElements:a}),this._feature):null}},{key:"title",get:function(){return this.viewModel.title},set:function(e){this.viewModel.title=e}},{key:"updateLocationEnabled",get:function(){return this.viewModel.updateLocationEnabled},set:function(e){this.viewModel.updateLocationEnabled=e}},{key:"view",get:function(){return this.viewModel.view},set:function(e){this.viewModel.view=e}},{key:"visible",get:function(){return this.viewModel.visible},set:function(e){this.viewModel.visible=e}},{key:"castVisibleElements",value:function(e){return(0,I.Z)((0,I.Z)({},Cr),e)}},{key:"blur",value:function(){this.viewModel.active||d.Z.getLogger(this.declaredClass).warn("Popup can only be blurred when currently active."),this.visibleElements.closeButton?this._blurClose=!0:this._blurContainer=!0,this.scheduleRender()}},{key:"clear",value:function(){return this.viewModel.clear()}},{key:"close",value:function(){this.visible=!1}},{key:"fetchFeatures",value:function(e,t){return this.viewModel.fetchFeatures(e,t)}},{key:"focus",value:function(){this.viewModel.active||d.Z.getLogger(this.declaredClass).warn("Popup can only be focused when currently active."),this.visibleElements.closeButton?this._focusClose=!0:this._focusContainer=!0,this.scheduleRender()}},{key:"next",value:function(){return this.viewModel.next()}},{key:"open",value:function(e){var t,n;this._handles.remove(mr);var i=!!e&&!!e.featureMenuOpen,r=!!e&&!!e.actionsMenuOpen,a={collapsed:!!e&&!!e.collapsed,actionsMenuOpen:r,featureMenuOpen:i};"xsmall"===(null===(t=this.viewModel)||void 0===t||null===(n=t.view)||void 0===n?void 0:n.widthBreakpoint)&&(a.collapsed=!0),this.set(a),this.viewModel.open(e),this._shouldFocus(e),this._addSelectedFeatureIndexHandle()}},{key:"previous",value:function(){return this.viewModel.previous()}},{key:"reposition",value:function(){this.renderNow(),this._positionContainer(),this._setCurrentAlignment()}},{key:"triggerAction",value:function(e){return this.viewModel.triggerAction(e)}},{key:"render",value:function(){var e,t,n,i,r,a=this.actionsMenuOpen,o=this.dockEnabled,s=this.featureMenuVisible,l=this.dividedActions,u=this.currentAlignment,c=this.currentDockPosition,d=this.viewModel.active,p=l.menuActions,h=d&&p.length>1&&a,f=d&&o,v=d&&!o,y=null===(e=this.selectedFeature)||void 0===e||null===(t=e.layer)||void 0===t?void 0:t.title,g=null===(n=this.selectedFeature)||void 0===n||null===(i=n.layer)||void 0===i?void 0:i.id,m=(r={},(0,x.Z)(r,nr.alignTopCenter,"top-center"===u),(0,x.Z)(r,nr.alignBottomCenter,"bottom-center"===u),(0,x.Z)(r,nr.alignTopLeft,"top-left"===u),(0,x.Z)(r,nr.alignBottomLeft,"bottom-left"===u),(0,x.Z)(r,nr.alignTopRight,"top-right"===u),(0,x.Z)(r,nr.alignBottomRight,"bottom-right"===u),(0,x.Z)(r,nr.isDocked,f),(0,x.Z)(r,nr.shadow,v),(0,x.Z)(r,nr.isDockedTopLeft,"top-left"===c),(0,x.Z)(r,nr.isDockedTopCenter,"top-center"===c),(0,x.Z)(r,nr.isDockedTopRight,"top-right"===c),(0,x.Z)(r,nr.isDockedBottomLeft,"bottom-left"===c),(0,x.Z)(r,nr.isDockedBottomCenter,"bottom-center"===c),(0,x.Z)(r,nr.isDockedBottomRight,"bottom-right"===c),(0,x.Z)(r,nr.isFeatureMenuOpen,s),(0,x.Z)(r,nr.isActionsMenuOpen,h),r);return(0,We.u)("div",{class:this.classes(nr.base,m),role:"presentation","data-layer-title":y,"data-layer-id":g,bind:this,afterCreate:this._positionContainer,afterUpdate:this._positionContainer},d?[this.renderMainContainer(),this.renderPointer()]:null)}},{key:"renderLoadingIcon",value:function(){return(0,We.u)("span",{"aria-hidden":"true",class:this.classes(nr.icon,nr.iconLoading,nr.rotating)})}},{key:"renderNavigationLoading",value:function(){var e=this.messagesCommon;return this.viewModel.pendingPromisesCount?(0,We.u)("div",{key:kr("loading-container"),role:"presentation",class:nr.loadingContainer,"aria-label":e.loading,title:e.loading},this.renderLoadingIcon()):null}},{key:"renderPreviousIcon",value:function(){var e,t=(0,qe.dZ)(this.container),n=(e={},(0,x.Z)(e,nr.iconRightTriangleArrow,t),(0,x.Z)(e,nr.paginationPreviousIconRTL,t),(0,x.Z)(e,nr.iconLeftTriangleArrow,!t),(0,x.Z)(e,nr.paginationPreviousIconLTR,!t),e);return(0,We.u)("span",{"aria-hidden":"true",class:this.classes(nr.icon,n)})}},{key:"renderPreviousButton",value:function(){var e=this.messages;return(0,We.u)("div",{role:"button",tabIndex:0,bind:this,onclick:this._previous,onkeydown:this._previous,class:this.classes(nr.button,nr.paginationPrevious),"aria-label":e.previous,title:e.previous},this.renderPreviousIcon())}},{key:"renderNextIcon",value:function(){var e,t=(0,qe.dZ)(this.container),n=(e={},(0,x.Z)(e,nr.iconLeftTriangleArrow,t),(0,x.Z)(e,nr.paginationNextIconRTL,t),(0,x.Z)(e,nr.iconRightTriangleArrow,!t),(0,x.Z)(e,nr.paginationNextIconLTR,!t),e);return(0,We.u)("span",{"aria-hidden":"true",class:this.classes(nr.icon,n)})}},{key:"renderNextButton",value:function(){var e=this.messages;return(0,We.u)("div",{role:"button",tabIndex:0,bind:this,onclick:this._next,onkeydown:this._next,class:this.classes(nr.button,nr.paginationNext),"aria-label":e.next,title:e.next},this.renderNextIcon())}},{key:"renderFeatureMenuButton",value:function(){var e=this.featureMenuOpen,t=this.featureMenuId,n=this.messagesCommon,i=this.viewModel,r=i.featureCount,a=i.selectedFeatureIndex;return(0,We.u)("div",{role:"button",tabIndex:0,bind:this,onclick:this._toggleFeatureMenu,onkeydown:this._toggleFeatureMenu,afterCreate:this._focusFeatureMenuButtonNode,afterUpdate:this._focusFeatureMenuButtonNode,class:this.classes(nr.button,nr.featureMenuButton),"aria-haspopup":"true","aria-controls":t,"aria-expanded":e.toString(),"aria-label":n.menu,title:n.menu},this._getPageText(r,a))}},{key:"renderNavigationButtons",value:function(){return this.featureNavigationVisible?[this.renderPreviousButton(),this.renderNavigationLoading()||this.renderFeatureMenuButton(),this.renderNextButton()]:[]}},{key:"renderDockIcon",value:function(){var e,t=this.dockEnabled,n=this._wouldDockTo(),i=(e={},(0,x.Z)(e,nr.iconUndock,t),(0,x.Z)(e,nr.iconDock,!t),(0,x.Z)(e,nr.iconDockToRight,!t&&("top-right"===n||"bottom-right"===n)),(0,x.Z)(e,nr.iconDockToLeft,!t&&("top-left"===n||"bottom-left"===n)),(0,x.Z)(e,nr.iconDockToTop,!t&&"top-center"===n),(0,x.Z)(e,nr.iconDockToBottom,!t&&"bottom-center"===n),e);return(0,We.u)("span",{"aria-hidden":"true",class:this.classes(i,nr.icon)})}},{key:"renderDockButton",value:function(){var e,t,n,i=this.dockEnabled,r=this.messages,a=null===(e=this.viewModel)||void 0===e||null===(t=e.view)||void 0===t?void 0:t.widthBreakpoint,o=i?r.undock:r.dock;return"xsmall"!==a&&null!==(n=this.dockOptions)&&void 0!==n&&n.buttonEnabled?(0,We.u)("div",{role:"button","aria-label":o,title:o,tabIndex:0,bind:this,onclick:this._toggleDockEnabled,onkeydown:this._toggleDockEnabled,afterCreate:this._focusDockButtonNode,afterUpdate:this._focusDockButtonNode,class:this.classes(nr.button,nr.buttonDock)},this.renderDockIcon()):null}},{key:"renderTitle",value:function(){var e=this.viewModel.title,t=this.titleId,n=this.collapsible,i=this.contentCollapsed,r=this.messagesCommon,a=(0,x.Z)({},nr.headerContainerButton,n),o=(0,We.u)(tt.X6,{level:this.headingLevel,class:nr.headerTitle,innerHTML:null!==e&&void 0!==e?e:""}),s=n?(0,We.u)("button",{key:"".concat(e,"--collapsible"),id:t,title:i?r.expand:r.collapse,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(nr.headerContainer,a),"aria-expanded":i?"false":"true",onclick:this._toggleCollapsed,type:"button"},o,(0,We.u)("calcite-icon",{class:nr.collapseIcon,key:"collapse-icon",icon:i?"chevron-down":"chevron-up",scale:"m"})):(0,We.u)("div",{key:null!==e&&void 0!==e?e:"title",id:t,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(nr.headerContainer,a)},o);return e?s:null}},{key:"renderCloseIcon",value:function(){return(0,We.u)("span",{"aria-hidden":"true",class:this.classes(nr.icon,nr.iconClose)})}},{key:"renderCloseButton",value:function(){var e=this.visibleElements,t=this.messagesCommon;return e.closeButton?(0,We.u)("div",{role:"button",tabIndex:0,bind:this,onclick:this._close,onkeydown:this._close,class:nr.button,"aria-label":t.close,title:t.close,afterCreate:this._closeButtonNodeUpdated,afterUpdate:this._closeButtonNodeUpdated},this.renderCloseIcon()):null}},{key:"renderHeader",value:function(){return(0,We.u)("header",{class:nr.header},this.renderTitle(),(0,We.u)("div",{class:nr.headerButtons},this.renderDockButton(),this.renderCloseButton()))}},{key:"renderContentContainer",value:function(){var e=this,t=this.contentId,n=this.hasContent,i=this.contentCollapsed,r=this._flowItems,a=this.viewModel.content,o=r.toArray(),s=(0,x.Z)({},nr.contentHasFlows,!!o.length);return n&&!i?(0,We.u)("div",{key:null!==a&&void 0!==a?a:"content",enterAnimation:this._createFeatureUpdatedAnimation(),id:t,class:this.classes(nr.content,s)},(0,We.u)("calcite-flow",{bind:this},(0,We.u)("calcite-flow-item",{bind:this,"data-node-ref":"_rootFlowItemNode",afterCreate:qe.Yo,key:"root-flow-item",onCalciteFlowItemBack:this._handleBackClick},this.renderContent()),o.map((function(t){return e.renderFlowItem(t)}))),o.map((function(t){return e.renderFlowItemTooltips(t)}))):null}},{key:"renderFlowItem",value:function(e){var t,n,i,r=this,a=this.messages,o=(0,dn.$o)(),s="graphic"in e&&!e.isTable;return(0,We.u)("calcite-flow-item",{bind:this,class:this.classes((t={},(0,x.Z)(t,nr.calciteThemeDark,!o),(0,x.Z)(t,nr.calciteThemeLight,o),t)),heading:null!==(n=e.title)&&void 0!==n?n:"",description:this._getFlowItemDescription(e),onCalciteFlowItemBack:this._handleBackClick,key:"flow-item-".concat(e.viewModel.uid)},(0,We.u)("calcite-action",{class:nr.actionExit,icon:"move-up",label:null===a||void 0===a?void 0:a.exitRelatedRecords,text:null===a||void 0===a?void 0:a.exitRelatedRecords,slot:"header-actions-start",bind:this,afterCreate:function(t){return r._storeExitRelatedRecordsAction(e,t)},onclick:this._destroyFlowItemWidgets}),s?(0,We.u)("calcite-action",{class:nr.actionSelectFeature,icon:"zoom-to-object",label:null===a||void 0===a?void 0:a.selectFeature,text:null===a||void 0===a?void 0:a.selectFeature,slot:"header-actions-end",bind:this,afterCreate:function(t){return r._storeFeatureSelectionAction(e,t)},onclick:function(){return r._handleOpenRelatedFeature(e)}}):null,(0,We.u)("div",{class:this.classes(nr.contentFlowItem,(i={},(0,x.Z)(i,nr.calciteThemeDark,o),(0,x.Z)(i,nr.calciteThemeLight,!o),i))},e.render()))}},{key:"renderFlowItemTooltips",value:function(e){var t,n,i=this.messages,r=this._exitRelatedRecordsActions,a=this._featureSelectionActions,o=(0,dn.$o)(),s=a.get(e);return[(0,We.u)("calcite-tooltip",{class:this.classes((t={},(0,x.Z)(t,nr.calciteThemeDark,!o),(0,x.Z)(t,nr.calciteThemeLight,o),t)),key:"exit-related-records-tooltip-".concat(e.viewModel.uid),label:null===i||void 0===i?void 0:i.exitRelatedRecords,overlayPositioning:"fixed",referenceElement:r.get(e),placement:"top"},null===i||void 0===i?void 0:i.exitRelatedRecords),s?(0,We.u)("calcite-tooltip",{class:this.classes((n={},(0,x.Z)(n,nr.calciteThemeDark,!o),(0,x.Z)(n,nr.calciteThemeLight,o),n)),key:"select-related-record-tooltip-".concat(e.viewModel.uid),label:null===i||void 0===i?void 0:i.selectFeature,overlayPositioning:"fixed",referenceElement:s,placement:"top"},null===i||void 0===i?void 0:i.selectFeature):null]}},{key:"renderActionsMenuButton",value:function(){var e=this.actionsMenuId,t=this.actionsMenuButtonId,n=this.actionsMenuOpen,i=this.dividedActions,r=this.messagesCommon,a=n?r.close:r.open;return i.menuActions.length?(0,We.u)("div",{key:kr("actions-menu-button"),class:this.classes(nr.button,nr.actionsMenuButton),role:"button",id:t,"aria-haspopup":"true","aria-controls":n?e:null,tabIndex:0,bind:this,onclick:this._toggleActionsMenu,onkeydown:this._toggleActionsMenu,afterCreate:this._focusActionsMenuButtonNode,afterUpdate:this._focusActionsMenuButtonNode,"aria-label":a,title:a},(0,We.u)("span",{"aria-hidden":"true",class:nr.iconActionsMenu})):null}},{key:"renderMenuActions",value:function(){var e=this,t=this.actionsMenuId,n=this.actionsMenuButtonId,i=this.actionsMenuOpen,r=this.dividedActions.menuActions;return r.length&&i?(0,We.u)("ul",{id:t,role:"menu","aria-labelledby":n,key:kr("actions"),class:nr.actions,bind:this,onkeyup:this._handleActionMenuKeyup,afterCreate:this._actionsMenuNodeUpdated,afterUpdate:this._actionsMenuNodeUpdated},r.toArray().map((function(t){return e.renderAction({action:t,type:"menu-item"})}))):null}},{key:"renderInlineActions",value:function(){var e=this,t=this.dividedActions.inlineActions;return t.length?t.toArray().map((function(t){return e.renderAction({action:t,type:"inline"})})):[]}},{key:"renderInlineActionsContainer",value:function(){var e=this.dividedActions,t=e.inlineActions,n=e.menuActions,i=!!t.length,r=!!n.length;return i||r?(0,We.u)("div",{key:"inline-actions-container","data-inline-actions":i.toString(),"data-menu-actions":r.toString(),class:nr.inlineActionsContainer},this.renderInlineActions(),this.renderActionsMenuButton(),this.renderMenuActions()):null}},{key:"renderNavigation",value:function(){return this.featureNavigationVisible?(0,We.u)("section",{key:kr("navigation"),class:this.classes(nr.navigation)},this.renderNavigationButtons()):null}},{key:"renderFooter",value:function(){var e,t=this.featureNavigationVisible,n=this.dividedActions,i=n.inlineActions,r=n.menuActions,a=!!i.length,o=!!r.length,s=(e={},(0,x.Z)(e,nr.footerHasPagination,t),(0,x.Z)(e,nr.footerHasActions,a),(0,x.Z)(e,nr.footerHasActionsMenu,o),e);return t||a?(0,We.u)("div",{key:kr("feature-buttons"),class:this.classes(nr.footer,s)},this.renderInlineActionsContainer(),this.renderNavigation()):null}},{key:"renderFeatureMenuContainer",value:function(){var e=this.messages,t=this.viewModel,n=t.featureViewModels,i=t.isLoadingFeature,r=(0,Jn.n)(e.selectedFeatures,{total:n.length});return(0,We.u)("section",{key:kr("menu"),class:nr.featureMenu},(0,We.u)("strong",{class:nr.featureMenuHeader},r),(0,We.u)("nav",{bind:this,class:nr.featureMenuViewport,"data-node-ref":"_featureMenuViewportNode",afterCreate:qe.Yo},this.renderFeatureMenu(),(0,We.u)("div",{class:nr.featureMenuObserver,bind:this,afterCreate:this._featureMenuIntersectionObserverCreated}),i?(0,We.u)("div",{class:nr.featureMenuLoader},this.renderLoadingIcon()):null))}},{key:"renderPointer",value:function(){return this.dockEnabled?null:(0,We.u)("div",{key:kr("pointer"),class:nr.pointer,role:"presentation"},(0,We.u)("div",{class:this.classes(nr.pointerDirection,nr.shadow)}))}},{key:"renderMainContainer",value:function(){var e,t=this.dockEnabled,n=this.currentAlignment,i=this.currentDockPosition,r=this.titleId,a=this.contentId,o=this.collapsible,s=this.hasContent,l=this.contentCollapsed,u=this.visibleElements,c=this.viewModel.title,d="bottom-left"===n||"bottom-center"===n||"bottom-right"===n||"top-left"===i||"top-center"===i||"top-right"===i,p="top-left"===n||"top-center"===n||"top-right"===n||"bottom-left"===i||"bottom-center"===i||"bottom-right"===i,h=(e={},(0,x.Z)(e,nr.shadow,t),(0,x.Z)(e,nr.isCollapsible,o),(0,x.Z)(e,nr.isCollapsed,l),e);return(0,We.u)("div",{class:this.classes(nr.main,nr.widget,h),tabIndex:u.closeButton?void 0:-1,role:"dialog","aria-labelledby":c?r:"","aria-describedby":s&&!l?a:"",bind:this,onkeyup:this._handleMainKeyup,afterCreate:this._mainContainerNodeUpdated,afterUpdate:this._mainContainerNodeUpdated},d?this.renderFooter():null,d?this.renderFeatureMenuContainer():null,this.renderHeader(),this.renderContentContainer(),p?this.renderFooter():null,p?this.renderFeatureMenuContainer():null)}},{key:"renderContent",value:function(){var e,t=null===(e=this.viewModel)||void 0===e?void 0:e.content;return t?"string"==typeof t?(0,We.u)("div",{class:hi.contentNode,key:t,innerHTML:t}):this.renderNodeContent(t):null}},{key:"renderActionText",value:function(e){return(0,We.u)("span",{key:"text",class:nr.actionText},e)}},{key:"renderActionIcon",value:function(e){var t,n=this._getActionClass(e),i=this._getActionImage(e),r=(t={},(0,x.Z)(t,nr.iconLoading,e.active),(0,x.Z)(t,nr.rotating,e.active),(0,x.Z)(t,nr.icon,!!n),(0,x.Z)(t,nr.actionImage,!e.active&&!!i),t);return n&&(r[n]=!e.active),(0,We.u)("span",{key:"icon","aria-hidden":"true",class:this.classes(nr.icon,r),styles:this._getIconStyles(i)})}},{key:"renderAction",value:function(e){var t,n=e.action,i=e.type,r=this._getActionTitle(n),a=(t={},(0,x.Z)(t,nr.action,"toggle"!==n.type),(0,x.Z)(t,nr.actionToggle,"toggle"===n.type),(0,x.Z)(t,nr.actionToggleOn,"toggle"===n.type&&n.value),(0,x.Z)(t,nr.buttonDisabled,n.disabled),t),o=[this.renderActionIcon(n),this.renderActionText(r)],s="menu-item"===i?(0,We.u)("li",{key:n.uid,role:"menuitem",tabIndex:0,title:r,"aria-label":r,class:this.classes(nr.button,a),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-uid":n.uid,onclick:this._triggerAction,onkeydown:this._triggerAction},o):(0,We.u)("div",{key:n.uid,role:"button",tabIndex:0,title:r,"aria-label":r,class:this.classes(nr.button,a),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-uid":n.uid,onclick:this._triggerAction,onkeydown:this._triggerAction},o);return n.visible?s:null}},{key:"renderFeatureMenuItem",value:function(e,t){var n=this.messages,i=this.messagesCommon,r=this.viewModel,a=r.selectedFeatureIndex,o=e===r.selectedFeatureViewModel,s=(0,x.Z)({},nr.featureMenuSelected,o),l=o?(0,We.u)("span",{key:kr("feature-menu-selected-feature-".concat(a)),title:n.selectedFeature,"aria-label":n.selectedFeature,class:nr.iconCheckMark}):null,u=(0,We.u)("span",{innerHTML:e.title||i.untitled});return(0,We.u)("li",{role:"menuitem",tabIndex:-1,key:kr("feature-menu-feature-".concat(a)),class:this.classes(s,nr.featureMenuItem),bind:this,"data-feature-index":t,onblur:this._removeActiveFeature,onfocus:this._setActiveFeature,onkeyup:this._handleFeatureMenuItemKeyup,onclick:this._selectFeature,onkeydown:this._selectFeature,onmouseover:this._setActiveFeature,onmouseleave:this._removeActiveFeature},(0,We.u)("span",{class:nr.featureMenuTitle},u,l))}},{key:"renderFeatureMenu",value:function(){var e=this,t=this.featureMenuId,n=this.viewModel.featureViewModels;return n.length>1?(0,We.u)("ol",{class:nr.featureMenuList,id:t,bind:this,afterCreate:this._featureMenuNodeUpdated,afterUpdate:this._featureMenuNodeUpdated,onkeyup:this._handleFeatureMenuKeyup,role:"menu"},n.filter((function(e){return!!e.graphic})).map((function(t,n){return e.renderFeatureMenuItem(t,n)}))):null}},{key:"_storeFeatureSelectionAction",value:function(e,t){this._featureSelectionActions.set(e,t),this.scheduleRender()}},{key:"_storeExitRelatedRecordsAction",value:function(e,t){this._exitRelatedRecordsActions.set(e,t),this.scheduleRender()}},{key:"_getFlowItemDescription",value:function(e){var t;return"featureCountDescription"in e?e.featureCountDescription:null!==(t=e.viewModel.description)&&void 0!==t?t:""}},{key:"_openRelatedFeature",value:function(){var e=(0,m.Z)((0,g.Z)().mark((function e(t){var n,i,r;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.viewModel.updateGeometry();case 2:if(n=t.graphic,i=null===n||void 0===n?void 0:n.geometry,!(0,p.Wi)(i)&&!(0,p.Wi)(n)){e.next=5;break}return e.abrupt("return");case 5:return this._destroyFlowItemWidgets(),e.next=8,this.viewModel.zoomTo({target:i});case 8:r=Xi(i),this.open({features:[n],location:(0,p.pC)(r)?r:void 0});case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_destroyFlowItemWidgets",value:function(){this._flowItems.removeAll().forEach((function(e){"showAllEnabled"in e.viewModel&&(e.viewModel.showAllEnabled=!1),e.viewModel=null,e.destroy()}))}},{key:"_handleBackClick",value:function(){var e=this._flowItems.pop();e&&(this._exitRelatedRecordsActions.delete(e),this._featureSelectionActions.delete(e),"showAllEnabled"in e.viewModel&&(e.viewModel.showAllEnabled=!1),e&&(e.viewModel=null,e.destroy()))}},{key:"_getActionTitle",value:function(e){var t,n=this.messages,i=this.selectedFeature,r=this.messagesCommon,a=e.id,o=null===i||void 0===i?void 0:i.attributes,s=null!==(t=e.title)&&void 0!==t?t:"",l="zoom-to-feature"===a?(0,Jn.n)(s,{messages:n}):"remove-selected-feature"===a?(0,Jn.n)(s,{messages:r}):"zoom-to-clustered-features"===a||"browse-clustered-features"===a?(0,Jn.n)(s,{messages:n}):e.title;return l&&o?(0,Jn.n)(l,o):null!==l&&void 0!==l?l:""}},{key:"_getActionClass",value:function(e){var t=this.selectedFeature,n=null===t||void 0===t?void 0:t.attributes,i=e.className,r=e.image||i?i:nr.iconDefaultAction;return r&&n?(0,Jn.n)(r,n):null!==r&&void 0!==r?r:""}},{key:"_getActionImage",value:function(e){var t=this.selectedFeature,n=null===t||void 0===t?void 0:t.attributes,i=e.image;return i&&n?(0,Jn.n)(i,n):null!==i&&void 0!==i?i:""}},{key:"_createFeatureUpdatedAnimation",value:function(){return(0,qe.vU)("enter",nr.hasFeatureUpdated)}},{key:"_getInlineActionCount",value:function(){var e=this.maxInlineActions,t=this.featureNavigationVisible;if("number"!=typeof e)return null;var n=Math.round(e);return Math.max(t?n-1:n,0)}},{key:"_watchActions",value:function(){var e=this,t=this.viewModel.allActions;this.notifyChange("dividedActions");var n="actions";this._handles.remove(n),t&&t.forEach((function(t){e._handles.add((0,h.YP)((function(){return[t.uid,t.active,t.className,t.disabled,t.id,t.title,t.image,t.visible]}),(function(){return e.scheduleRender()})),n)}))}},{key:"_divideActions",value:function(){var e=this.viewModel.allActions.filter((function(e){return e.visible})),t=this._getInlineActionCount(),n=null===t,i=0===t;return{inlineActions:n?e.slice(0):i?new w.Z:e.slice(0,t),menuActions:n?new w.Z:i?e.slice(0):e.slice(t)}}},{key:"_featureMenuOpenChanged",value:function(e){e?this._focusFirstFeature=!0:this._focusFeatureMenuButton=!0}},{key:"_actionsMenuOpenChanged",value:function(e){e?this._focusFirstAction=!0:this._focusActionsMenuButton=!0}},{key:"_setTitleFromFeatureWidget",value:function(){var e,t,n=this.selectedFeatureWidget,i=this.messagesCommon;n&&(this.viewModel.title="error"===(null===(e=n.viewModel)||void 0===e?void 0:e.state)?i.errorMessage:(null===(t=n.viewModel)||void 0===t?void 0:t.title)||"")}},{key:"_setContentFromFeatureWidget",value:function(){var e=this.selectedFeatureWidget;e&&(this.viewModel.content=e)}},{key:"_unobserveFeatureMenuObserver",value:function(){this._featureMenuIntersectionObserverNode&&this._featureMenuIntersectionObserver.unobserve(this._featureMenuIntersectionObserverNode)}},{key:"_featureMenuIntersectionObserverCreated",value:function(e){this._unobserveFeatureMenuObserver(),this._featureMenuIntersectionObserver.observe(e),this._featureMenuIntersectionObserverNode=e}},{key:"_handleFeatureMenuKeyup",value:function(e){"Escape"===(0,T.kK)(e)&&(e.stopPropagation(),this._focusFeatureMenuButton=!0,this.featureMenuOpen=!1,this.scheduleRender())}},{key:"_handleActionMenuKeyup",value:function(e){"Escape"===(0,T.kK)(e)&&(e.stopPropagation(),this._focusActionsMenuButton=!0,this.actionsMenuOpen=!1,this.scheduleRender())}},{key:"_setActiveFeature",value:function(e){var t=this.viewModel,n=e.currentTarget["data-feature-index"];t.activeFeature=t.features[n]||null}},{key:"_removeActiveFeature",value:function(){this.viewModel.activeFeature=null}},{key:"_handleFeatureMenuItemKeyup",value:function(e){var t=(0,T.kK)(e),n=this._featureMenuNode,i=e.currentTarget["data-feature-index"];if(n){var r=n.querySelectorAll("li"),a=r.length;"ArrowUp"!==t?"ArrowDown"!==t?"Home"!==t?"End"!==t||(e.stopPropagation(),r[r.length-1].focus()):(e.stopPropagation(),r[0].focus()):(e.stopPropagation(),r[(i+1+a)%a].focus()):(e.stopPropagation(),r[(i-1+a)%a].focus())}}},{key:"_handleActionMenuItemKeyup",value:function(e){var t=(0,T.kK)(e),n=this._actionsMenuNode,i=e.currentTarget.dataset.actionUid,r=this.dividedActions.menuActions.findIndex((function(e){return e.uid===i}));if(n){var a=n.querySelectorAll("li"),o=a.length;"ArrowUp"!==t?"ArrowDown"!==t?"Home"!==t?"End"!==t||(e.stopPropagation(),a[a.length-1].focus()):(e.stopPropagation(),a[0].focus()):(e.stopPropagation(),a[(r+1+o)%o].focus()):(e.stopPropagation(),a[(r-1+o)%o].focus())}}},{key:"_handleMainKeyup",value:function(e){var t=(0,T.kK)(e);"ArrowLeft"===t&&(e.stopPropagation(),this.previous()),"ArrowRight"===t&&(e.stopPropagation(),this.next())}},{key:"_spinnerEnabledChange",value:function(e){if(this._destroySpinner(),e){var t=this.get("viewModel.view");this._createSpinner(t)}}},{key:"_hideSpinner",value:function(){var e=this._spinner;e&&(e.location=null,e.hide())}},{key:"_displaySpinner",value:function(){var e=this._spinner;if(e){var t=this.viewModel,n=t.location;t.waitingForResult&&n?e.show({location:n}):e.hide()}}},{key:"_getIconStyles",value:function(e){return{"background-image":e?"url(".concat(e,")"):""}}},{key:"_shouldFocus",value:function(){var e=(0,m.Z)((0,g.Z)().mark((function e(t){var n=this;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=null===t||void 0===t?void 0:t.shouldFocus,!e.t0){e.next=5;break}return e.next=4,(0,h.N1)((function(){var e;return!0===(null===(e=n.viewModel)||void 0===e?void 0:e.active)}));case 4:this.focus();case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_addSelectedFeatureIndexHandle",value:function(){var e=this,t=(0,h.YP)((function(){var t;return null===(t=e.viewModel)||void 0===t?void 0:t.selectedFeatureIndex}),(function(t,n){return e._selectedFeatureIndexUpdated(t,n)}));this._handles.add(t,mr)}},{key:"_selectedFeatureIndexUpdated",value:function(e,t){this.featureCount&&e!==t&&-1!==e&&(this._destroyFlowItemWidgets(),this.actionsMenuOpen=!1,this.featureMenuOpen=!1,this._mainContainerNode&&(this._mainContainerNode.scrollTop=0),this._rootFlowItemNode&&this._rootFlowItemNode.scrollContentTo({top:0}))}},{key:"_destroySelectedFeatureWidget",value:function(){var e=this._feature;e&&(e.viewModel=null,e&&!e.destroyed&&e.destroy()),this._feature=null}},{key:"_isScreenLocationWithinView",value:function(e,t){return e.x>-1&&e.y>-1&&e.x<=t.width&&e.y<=t.height}},{key:"_isOutsideView",value:function(e){var t=e.popupHeight,n=e.popupWidth,i=e.screenLocation,r=e.side,a=e.view;if(isNaN(n)||isNaN(t)||!a||!i)return!1;var o=a.padding;return"right"===r&&i.x+n/2>a.width-o.right||"left"===r&&i.x-n/2<o.left||"top"===r&&i.y-t<o.top||"bottom"===r&&i.y+t>a.height-o.bottom}},{key:"_calculateAutoAlignment",value:function(e){if("auto"!==e)return e;var t=this._pointerOffsetInPx,n=this._containerNode,i=this._mainContainerNode,r=this.viewModel,a=r.screenLocation,o=r.view;if((0,p.Wi)(a)||!o||!n)return"top-center";if(!this._isScreenLocationWithinView(a,o))return this._get("currentAlignment")||"top-center";function s(e){return parseInt(e.replace(/[^-\d\.]/g,""),10)}var l=i?window.getComputedStyle(i,null):null,u=l?s(l.getPropertyValue("max-height")):0,c=l?s(l.getPropertyValue("height")):0,d=n.getBoundingClientRect(),h=d.height,f=d.width+t,v=Math.max(h,u,c)+t,y=this._isOutsideView({popupHeight:v,popupWidth:f,screenLocation:a,side:"right",view:o}),g=this._isOutsideView({popupHeight:v,popupWidth:f,screenLocation:a,side:"left",view:o}),m=this._isOutsideView({popupHeight:v,popupWidth:f,screenLocation:a,side:"top",view:o}),_=this._isOutsideView({popupHeight:v,popupWidth:f,screenLocation:a,side:"bottom",view:o});return g?m?"bottom-right":"top-right":y?m?"bottom-left":"top-left":m?_?"top-center":"bottom-center":"top-center"}},{key:"_callCurrentAlignment",value:function(e){return"function"==typeof e?e.call(this):e}},{key:"_getCurrentAlignment",value:function(){var e=this.alignment;return this.dockEnabled||!this.viewModel.active?null:this._calculatePositionResult(this._calculateAutoAlignment(this._callCurrentAlignment(e)))}},{key:"_setCurrentAlignment",value:function(){this._set("currentAlignment",this._getCurrentAlignment())}},{key:"_setCurrentDockPosition",value:function(){this._set("currentDockPosition",this._getCurrentDockPosition())}},{key:"_calculatePositionResult",value:function(e){var t=["left","right"];return(0,qe.dZ)(this.container)&&t.reverse(),e.replace(/leading/gi,t[0]).replace(/trailing/gi,t[1])}},{key:"_callDockPosition",value:function(e){return"function"==typeof e?e.call(this):e}},{key:"_getDockPosition",value:function(){var e;return this._calculatePositionResult(this._calculateAutoDockPosition(this._callDockPosition(null===(e=this.dockOptions)||void 0===e?void 0:e.position)))}},{key:"_getCurrentDockPosition",value:function(){return this.dockEnabled&&this.viewModel.active?this._getDockPosition():null}},{key:"_wouldDockTo",value:function(){return this.dockEnabled?null:this._getDockPosition()}},{key:"_calculateAutoDockPosition",value:function(e){var t;if("auto"!==e)return e;var n=null===(t=this.viewModel)||void 0===t?void 0:t.view,i=(0,qe.dZ)(this.container)?"top-left":"top-right";if(!n)return i;var r=n.padding||{left:0,right:0,top:0,bottom:0},a=n.width-r.left-r.right,o=n.breakpoints;return o&&a<=o.xsmall?"bottom-center":i}},{key:"_positionContainer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._containerNode;if(e&&(this._containerNode=e),this._containerNode){var t=this.viewModel.screenLocation,n=this._containerNode.getBoundingClientRect(),i=n.width,r=this._calculatePositionStyle(t,i);r&&Object.assign(this._containerNode.style,r)}}},{key:"_calculateFullWidth",value:function(e){var t=this.currentAlignment,n=this._pointerOffsetInPx;return"top-left"===t||"bottom-left"===t||"top-right"===t||"bottom-right"===t?e+n:e}},{key:"_calculateAlignmentPosition",value:function(e,t,n,i){var r=this.currentAlignment,a=this._pointerOffsetInPx;if(n){var o=n.padding,s=i/2,l=n.height-t,u=n.width-e;return"bottom-center"===r?{top:t+a-o.top,left:e-s-o.left}:"top-left"===r?{bottom:l+a-o.bottom,right:u+a-o.right}:"bottom-left"===r?{top:t+a-o.top,right:u+a-o.right}:"top-right"===r?{bottom:l+a-o.bottom,left:e+a-o.left}:"bottom-right"===r?{top:t+a-o.top,left:e+a-o.left}:"top-center"===r?{bottom:l+a-o.bottom,left:e-s-o.left}:void 0}}},{key:"_calculatePositionStyle",value:function(e,t){var n=this.dockEnabled,i=this.view;if(i){if(n)return{left:"",top:"",right:"",bottom:""};if(!(0,p.Wi)(e)&&t){var r=this._calculateFullWidth(t),a=this._calculateAlignmentPosition(e.x,e.y,i,r);return a?{top:void 0!==a.top?"".concat(a.top,"px"):"auto",left:void 0!==a.left?"".concat(a.left,"px"):"auto",bottom:void 0!==a.bottom?"".concat(a.bottom,"px"):"auto",right:void 0!==a.right?"".concat(a.right,"px"):"auto"}:void 0}}}},{key:"_viewChange",value:function(e,t){e&&t&&(this.close(),this.clear())}},{key:"_viewReadyChange",value:function(e,t){if(e){var n=this.get("viewModel.view");this._wireUpView(n)}else t&&(this.close(),this.clear())}},{key:"_wireUpView",value:function(e){(this._destroySpinner(),e)&&(this.spinnerEnabled&&this._createSpinner(e),this._setDockEnabledForViewSize(this.dockOptions))}},{key:"_dockingThresholdCrossed",value:function(e,t,n){var r=(0,i.Z)(e,2),a=r[0],o=r[1],s=(0,i.Z)(t,2),l=s[0],u=s[1],c=null!==n&&void 0!==n?n:{},d=c.width,p=void 0===d?0:d,h=c.height,f=void 0===h?0:h;return a<=p&&l>p||a>p&&l<=p||o<=f&&u>f||o>f&&u<=f}},{key:"_updateDockEnabledForViewSize",value:function(e,t){if(e&&t){var n=this.get("viewModel.view.padding")||{left:0,right:0,top:0,bottom:0},i=n.left+n.right,r=n.top+n.bottom,a=[],o=[];a[0]=e[0]-i,a[1]=e[1]-r,o[0]=t[0]-i,o[1]=t[1]-r;var s=this.dockOptions,l=s.breakpoint;this._dockingThresholdCrossed(a,o,l)&&this._setDockEnabledForViewSize(s),this._setCurrentDockPosition()}}},{key:"_focusDockButtonNode",value:function(e){this._focusDockButton&&(this._focusDockButton=!1,e.focus())}},{key:"_closeButtonNodeUpdated",value:function(e){return this._focusClose?(this._focusClose=!1,void e.focus()):this._blurClose?(this._blurClose=!1,void e.blur()):void 0}},{key:"_mainContainerNodeUpdated",value:function(e){return this._mainContainerNode=e,this._focusContainer?(this._focusContainer=!1,void e.focus()):this._blurContainer?(this._blurContainer=!1,void e.blur()):void 0}},{key:"_featureMenuNodeUpdated",value:function(e){if(this._featureMenuNode=e,e&&this._focusFirstFeature){this._focusFirstFeature=!1;var t=e.querySelectorAll("li");t.length&&t[0].focus()}}},{key:"_actionsMenuNodeUpdated",value:function(e){if(this._actionsMenuNode=e,e&&this._focusFirstAction){this._focusFirstAction=!1;var t=e.querySelectorAll("li");t.length&&t[0].focus()}}},{key:"_focusFeatureMenuButtonNode",value:function(e){this._focusFeatureMenuButton&&(this._focusFeatureMenuButton=!1,e.focus())}},{key:"_focusActionsMenuButtonNode",value:function(e){this._focusActionsMenuButton&&(this._focusActionsMenuButton=!1,e.focus())}},{key:"_featureMenuViewportScrollTop",value:function(){this._featureMenuViewportNode&&(this._featureMenuViewportNode.scrollTop=0)}},{key:"_toggleScreenLocationEnabled",value:function(){var e=this.dockEnabled,t=this.viewModel;if(t){var n=t.active&&!e;t.screenLocationEnabled=n}}},{key:"_shouldDockAtCurrentViewSize",value:function(e){var t,n,i,r,a=e.breakpoint,o=null===(t=this.viewModel)||void 0===t||null===(n=t.view)||void 0===n?void 0:n.ui;if(!o)return!1;var s=o.width,l=o.height;if(isNaN(s)||isNaN(l))return!1;if(!a)return!1;var u=a.hasOwnProperty("width")&&s<=(null!==(i=a.width)&&void 0!==i?i:0),c=a.hasOwnProperty("height")&&l<=(null!==(r=a.height)&&void 0!==r?r:0);return u||c}},{key:"_setDockEnabledForViewSize",value:function(e){e.breakpoint&&(this.dockEnabled=this._shouldDockAtCurrentViewSize(e))}},{key:"_getPageText",value:function(e,t){return this.featureNavigationVisible?(0,Jn.n)(this.messages.pageText,{index:t+1,total:e}):null}},{key:"_destroySpinner",value:function(){var e=this._spinner,t=this.view;e&&(t&&t.ui&&t.ui.remove(e,_r),e.destroy(),this._spinner=null)}},{key:"_createSpinner",value:function(e){e&&(this._spinner=new Si({view:e}),e.ui.add(this._spinner,{key:_r,position:"manual"}))}},{key:"_toggleCollapsed",value:function(){this.collapsed=!this.collapsed}},{key:"_close",value:function(){this.close(),this.view&&this.view.focus()}},{key:"_toggleDockEnabled",value:function(){this.dockEnabled=!this.dockEnabled,this._focusDockButton=!0,this.scheduleRender()}},{key:"_toggleFeatureMenu",value:function(){var e=!this.featureMenuOpen;this._featureMenuOpenChanged(e),this.actionsMenuOpen=!1,this.featureMenuOpen=e}},{key:"_toggleActionsMenu",value:function(){var e=!this.actionsMenuOpen;this._actionsMenuOpenChanged(e),this.featureMenuOpen=!1,this.actionsMenuOpen=e}},{key:"_triggerAction",value:function(e){var t=e.currentTarget.dataset.actionUid,n=this.viewModel.allActions,i=n.findIndex((function(e){return e.uid===t})),r=n.getItemAt(i);r&&"toggle"===r.type&&(r.value=!r.value),this.actionsMenuOpen=!1,this.viewModel.triggerAction(i)}},{key:"_selectFeature",value:function(e){var t=e.currentTarget["data-feature-index"];isNaN(t)||(this.viewModel.selectedFeatureIndex=t),this.featureMenuOpen=!1,this._focusFeatureMenuButton=!0,this.scheduleRender()}},{key:"_next",value:function(){this.next()}},{key:"_previous",value:function(){this.previous()}}]),o}(fi(P.Z));(0,u._)([(0,v.Cb)({readOnly:!0})],Mr.prototype,"actionsMenuId",null),(0,u._)([(0,v.Cb)({readOnly:!0})],Mr.prototype,"actionsMenuButtonId",null),(0,u._)([(0,v.Cb)({readOnly:!0})],Mr.prototype,"featureMenuId",null),(0,u._)([(0,v.Cb)({readOnly:!0})],Mr.prototype,"titleId",null),(0,u._)([(0,v.Cb)({readOnly:!0})],Mr.prototype,"contentId",null),(0,u._)([(0,v.Cb)({readOnly:!0})],Mr.prototype,"hasContent",null),(0,u._)([(0,v.Cb)({readOnly:!0})],Mr.prototype,"featureNavigationVisible",null),(0,u._)([(0,v.Cb)({readOnly:!0})],Mr.prototype,"collapsible",null),(0,u._)([(0,v.Cb)({readOnly:!0})],Mr.prototype,"featureMenuVisible",null),(0,u._)([(0,v.Cb)({readOnly:!0})],Mr.prototype,"contentCollapsed",null),(0,u._)([(0,v.Cb)({readOnly:!0})],Mr.prototype,"dividedActions",null),(0,u._)([(0,v.Cb)({readOnly:!0,dependsOn:["_flowItems.length"]})],Mr.prototype,"_activeFlowItemWidget",null),(0,u._)([(0,v.Cb)()],Mr.prototype,"actions",null),(0,u._)([(0,v.Cb)()],Mr.prototype,"actionsMenuOpen",null),(0,u._)([(0,v.Cb)()],Mr.prototype,"alignment",void 0),(0,u._)([(0,v.Cb)()],Mr.prototype,"autoCloseEnabled",null),(0,u._)([(0,v.Cb)()],Mr.prototype,"autoOpenEnabled",null),(0,u._)([(0,v.Cb)()],Mr.prototype,"defaultPopupTemplateEnabled",null),(0,u._)([(0,v.Cb)()],Mr.prototype,"content",null),(0,u._)([(0,v.Cb)()],Mr.prototype,"collapsed",void 0),(0,u._)([(0,v.Cb)()],Mr.prototype,"collapseEnabled",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],Mr.prototype,"currentAlignment",null),(0,u._)([(0,v.Cb)({readOnly:!0})],Mr.prototype,"currentDockPosition",null),(0,u._)([(0,v.Cb)()],Mr.prototype,"dockOptions",null),(0,u._)([(0,v.Cb)()],Mr.prototype,"dockEnabled",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],Mr.prototype,"featureCount",null),(0,u._)([(0,v.Cb)()],Mr.prototype,"featureMenuOpen",void 0),(0,u._)([(0,v.Cb)()],Mr.prototype,"features",null),(0,u._)([(0,v.Cb)()],Mr.prototype,"goToOverride",null),(0,u._)([(0,v.Cb)()],Mr.prototype,"headingLevel",void 0),(0,u._)([(0,v.Cb)()],Mr.prototype,"highlightEnabled",null),(0,u._)([(0,v.Cb)()],Mr.prototype,"location",null),(0,u._)([(0,v.Cb)()],Mr.prototype,"label",null),(0,u._)([(0,v.Cb)()],Mr.prototype,"maxInlineActions",void 0),(0,u._)([(0,v.Cb)(),(0,Ue.H)("esri/widgets/Popup/t9n/Popup")],Mr.prototype,"messages",void 0),(0,u._)([(0,v.Cb)(),(0,Ue.H)("esri/t9n/common")],Mr.prototype,"messagesCommon",void 0),(0,u._)([(0,v.Cb)()],Mr.prototype,"promises",null),(0,u._)([(0,v.Cb)({readOnly:!0})],Mr.prototype,"selectedFeature",null),(0,u._)([(0,v.Cb)()],Mr.prototype,"selectedFeatureIndex",null),(0,u._)([(0,v.Cb)({readOnly:!0})],Mr.prototype,"selectedFeatureWidget",null),(0,u._)([(0,v.Cb)()],Mr.prototype,"spinnerEnabled",void 0),(0,u._)([(0,v.Cb)()],Mr.prototype,"title",null),(0,u._)([(0,v.Cb)()],Mr.prototype,"updateLocationEnabled",null),(0,u._)([(0,v.Cb)()],Mr.prototype,"view",null),(0,u._)([(0,v.Cb)({type:vr}),(0,gr.s)(["triggerAction","trigger-action"])],Mr.prototype,"viewModel",void 0),(0,u._)([(0,v.Cb)()],Mr.prototype,"visible",null),(0,u._)([(0,v.Cb)()],Mr.prototype,"visibleElements",void 0),(0,u._)([(0,F.p)("visibleElements")],Mr.prototype,"castVisibleElements",null),(0,u._)([(0,yr.h)()],Mr.prototype,"_close",null),(0,u._)([(0,yr.h)()],Mr.prototype,"_toggleDockEnabled",null),(0,u._)([(0,yr.h)()],Mr.prototype,"_toggleFeatureMenu",null),(0,u._)([(0,yr.h)()],Mr.prototype,"_toggleActionsMenu",null),(0,u._)([(0,yr.h)()],Mr.prototype,"_triggerAction",null),(0,u._)([(0,yr.h)()],Mr.prototype,"_selectFeature",null),(0,u._)([(0,yr.h)()],Mr.prototype,"_next",null),(0,u._)([(0,yr.h)()],Mr.prototype,"_previous",null);var Zr=Mr=(0,u._)([(0,y.j)("esri.widgets.Popup")],Mr),xr=[0,0];function Ir(e){e&&((0,c.cS)(e),e.parentNode&&e.parentNode.removeChild(e))}var Tr=16,Sr=750,Ar=function(e){var t=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(){var e,i;(0,r.Z)(this,n);for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return(i=t.call.apply(t,[this].concat(s)))._freqInfo={freq:Tr,time:Sr},i._overlayRenderTaskHandle=null,i.height=0,i.overlay=null,i.position=null,i.resizing=!1,i.root=null,i.surface=null,i.suspended=!0,i.ui=null,i.userContent=null,i.width=0,i.widthBreakpoint=null,0!==s.length&&void 0!==(null===(e=s[0])||void 0===e?void 0:e.popup)||(i.popup=new Zr({view:(0,o.Z)(i)})),i.handles.add([(0,h.YP)((function(){return i.cursor}),(function(e){var t=(0,o.Z)(i).surface;t&&t.setAttribute("data-cursor",e)})),(0,h.YP)((function(){return i.interacting}),(function(e){var t=(0,o.Z)(i).surface;t&&t.setAttribute("data-interacting",e.toString())}))]),i}return(0,a.Z)(n,[{key:"initialize",value:function(){var e=this;this.handles.add((0,h.YP)((function(){return e.ui}),(function(t,n){return e._handleUIChange(t,n)}))),this._wireUI(this.ui),this.handles.add([this.on("focus",(function(){return e.notifyChange("focused")})),this.on("blur",(function(){return e.notifyChange("focused")}))])}},{key:"destroy",value:function(){this.destroyed||(this.ui=(0,p.SC)(this.ui),this.popup&&!this.popup.destroyed&&this.popup.destroy(),this.container=null)}},{key:"container",get:function(){var e;return null!==(e=this._get("container"))&&void 0!==e?e:null},set:function(e){var t=this,n=this._get("container"),r=(0,c.L7)(e);if(r||"string"!=typeof e||d.Z.getLogger(this.declaredClass).error("#container","element with id '".concat(e,"' not found")),n!==r){var a="dom-size";if(this.handles.remove(a),this._stopMeasuring(),n&&(n.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(Ir(this.root),this._set("root",null)),this.userContent&&((0,c.YD)(this.userContent,n),Ir(this.userContent),this._set("userContent",null))),!r)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);r.classList.add("esri-view");var o=document.createElement("div");o.className="esri-view-user-storage",(0,c.YD)(r,o),r.appendChild(o),this._set("userContent",o);var s=document.createElement("div");s.className="esri-view-root",r.insertBefore(s,r.firstChild),this._set("root",s);var l=document.createElement("div");l.className="esri-view-surface",l.setAttribute("role","application"),l.tabIndex=0,s.appendChild(l),this._set("surface",l);var u=new Z;s.appendChild(u.surface),this._set("overlay",u),(0,h.YP)((function(){return u.needsRender}),(function(e){e&&!t._overlayRenderTaskHandle?t._overlayRenderTaskHandle=(0,f.A)({render:function(){var e;return null===(e=t.overlay)||void 0===e?void 0:e.render()}}):t._overlayRenderTaskHandle=(0,p.hw)(t._overlayRenderTaskHandle)})),this.forceDOMReadyCycle(),this.handles.add((0,h.YP)((function(){return t.size}),(function(e){var t=(0,i.Z)(e,2),n=t[0],r=t[1],a="esri-view-surface--inset-outline";n>=document.body.clientWidth||r>=document.body.clientHeight?l.classList.add(a):l.classList.remove(a)}),h.nn),a),this._set("container",r),this._startMeasuring()}}},{key:"focused",get:function(){var e=document.activeElement===this.surface;return document.hasFocus()&&e}},{key:"popup",set:function(e){var t=this._get("popup");t&&t!==e&&t.destroy(),this._set("popup",e)}},{key:"size",get:function(){return[this.width,this.height]}},{key:"blur",value:function(){this.surface&&this.surface.blur()}},{key:"focus",value:function(){this.surface&&this.surface.focus()}},{key:"pageToContainer",value:function(e,t,n){var i=this.position;return e-=i?i[0]:0,t-=i?i[1]:0,n?(n[0]=e,n[1]=t):n=[e,t],n}},{key:"containerToPage",value:function(e,t,n){var i=this.position;return e+=i?i[0]:0,t+=i?i[1]:0,n?(n[0]=e,n[1]=t):n=[e,t],n}},{key:"_handleUIChange",value:function(e,t){t&&(this.handles.remove("ui"),t.destroy()),e&&this._wireUI(e),this._set("ui",e)}},{key:"_wireUI",value:function(e){var t=this;this.handles.remove("ui"),e&&(e.view=this,this.handles.add([(0,h.YP)((function(){return t.root}),(function(t){e.container=t?function(e){var t=document.createElement("div");return e.appendChild(t),t}(t):null}),h.nn),(0,h.YP)((function(){return t.popup}),(function(t,n){var i="popup";n&&e.remove(n,i),t&&(t.view=e.view,e.add(t,{key:i,position:"manual"}))}),h.nn)],"ui"))}},{key:"_stopMeasuring",value:function(){this.handles.remove("measuring"),this._get("resizing")&&this._set("resizing",!1)}},{key:"_startMeasuring",value:function(){var e=this,t=this._freqInfo;t.freq=Tr,t.time=Sr,this.handles.add([function(){var e=function(){t.freq=Tr,t.time=Sr};return window.addEventListener("resize",e),{remove:function(){window.removeEventListener("resize",e)}}}(),(0,f.A)({prepare:function(t){var n=e._measure(),i=e._freqInfo;if(i.time+=t.deltaTime,n&&(i.freq=Tr,e._get("resizing")||e._set("resizing",!0)),!(i.time<i.freq)){i.time=0;var r=e._position();i.freq=r||n?Tr:Math.min(Sr,2*i.freq),!n&&i.freq>=512&&e._get("resizing")&&e._set("resizing",!1)}}})],"measuring"),this._measure(),this._position()}},{key:"_measure",value:function(){var e=this.container,t=e?e.clientWidth:0,n=e?e.clientHeight:0;if(0===t||0===n)return this.suspended||this._set("suspended",!0),!1;var i=this.width,r=this.height;return t===i&&n===r?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",t),this._set("height",n),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:i,oldHeight:r,width:t,height:n}),!0)}},{key:"_position",value:function(){var e=this.container,t=this.position,n=e&&function(e){var t,n,i=(e.ownerDocument||window.document).defaultView,r=e.getBoundingClientRect();return xr[0]=r.left+(null!==(t=null===i||void 0===i?void 0:i.pageXOffset)&&void 0!==t?t:0),xr[1]=r.top+(null!==(n=null===i||void 0===i?void 0:i.pageYOffset)&&void 0!==n?n:0),xr}(e);return!!n&&(!t||n[0]!==t[0]||n[1]!==t[1])&&(this._set("position",[n[0],n[1]]),!0)}},{key:"forceDOMReadyCycle",value:function(){}}]),n}(e);return(0,u._)([(0,v.Cb)()],t.prototype,"container",null),(0,u._)([(0,v.Cb)({readOnly:!0})],t.prototype,"focused",null),(0,u._)([(0,v.Cb)({readOnly:!0})],t.prototype,"height",void 0),(0,u._)([(0,v.Cb)({type:Zr})],t.prototype,"popup",null),(0,u._)([(0,v.Cb)({type:Z})],t.prototype,"overlay",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],t.prototype,"position",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],t.prototype,"resizing",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],t.prototype,"root",void 0),(0,u._)([(0,v.Cb)({value:null,readOnly:!0})],t.prototype,"size",null),(0,u._)([(0,v.Cb)({readOnly:!0})],t.prototype,"surface",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],t.prototype,"suspended",void 0),(0,u._)([(0,v.Cb)()],t.prototype,"ui",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],t.prototype,"userContent",void 0),(0,u._)([(0,v.Cb)({readOnly:!0})],t.prototype,"width",void 0),(0,u._)([(0,v.Cb)()],t.prototype,"widthBreakpoint",void 0),t=(0,u._)([(0,y.j)("esri.views.DOMContainer")],t)}},600:function(e,t,n){n.d(t,{Z:function(){return Tt}});var i=n(37762),r=n(29439),a=n(74165),o=n(93433),s=n(4942),l=n(1413),u=n(15671),c=n(43144),d=n(97326),p=n(11752),h=n(61120),f=n(60136),v=n(92572),y=n(15861),g=n(27366),m=n(52639),_=n(36721),b=n(80987),w=n(77178),k=n(10064),C=n(93169),M=n(83704),Z=n(32718),x=n(92026),I=n(66978),T=n(94172),S=n(17842),A=n(51370),F=n(31009),P=n(49861),L=(n(25243),n(63780),n(69912)),E=n(53866),R=n(585),V=n(79803),O=n(92975),D=n(22824),N=n(6003),z=n(78707),B=n(28435),G=n(98921),q=n(9918),U=(n(59486),n(85015)),W=n(99346),j=n(53942),H=n(86226),Y=function(){function e(t,n,i,r){(0,u.Z)(this,e);var a=t.targetGeometry,o=n.targetGeometry;r?"string"==typeof r&&(r=(0,j.Qc)(r)||j.LI.ease):r=j.LI.ease,this.easing=r,this.duration=i,this.sCenterX=a.x,this.sCenterY=a.y,this.sScale=t.scale,this.sRotation=t.rotation,this.tCenterX=o.x,this.tCenterY=o.y,this.tScale=n.scale,this.tRotation=n.rotation,this.dCenterX=this.tCenterX-this.sCenterX,this.dCenterY=this.tCenterY-this.sCenterY,this.dScale=this.tScale-this.sScale,this.dRotation=this.tRotation-this.sRotation,this.dRotation>180?this.dRotation-=360:this.dRotation<-180&&(this.dRotation+=360)}return(0,c.Z)(e,[{key:"applyRatio",value:function(e,t){var n,i,r,a,o=this.easing(t);t>=1?(n=this.tCenterX,i=this.tCenterY,r=this.tRotation,a=this.tScale):(n=this.sCenterX+o*this.dCenterX,i=this.sCenterY+o*this.dCenterY,r=this.sRotation+o*this.dRotation,a=this.sScale+o*this.dScale),e.targetGeometry.x=n,e.targetGeometry.y=i,e.scale=a,e.rotation=r}}]),e}(),K=function(e){(0,f.Z)(n,e);var t=(0,v.Z)(n);function n(e){var i;return(0,u.Z)(this,n),(i=t.call(this,e)).updateFunction=null,i.animation=null,i.duration=200,i.transition=null,i.easing=j.LI.ease,i.view=null,i.viewpoint=new _.Z({targetGeometry:new R.Z,scale:0,rotation:0}),i._updateTask=(0,W.A)({postRender:i._postRender.bind((0,d.Z)(i))}),i._updateTask.pause(),i}return(0,c.Z)(n,[{key:"destroy",value:function(){this._updateTask=(0,x.hw)(this._updateTask)}},{key:"animate",value:function(e,t,n){var i=this;this.stop();var r=this.viewpoint;(0,H.JG)(r,t),this.transition=new Y(this.viewpoint,e.target,n&&n.duration||this.duration,n&&n.easing||this.easing);var a=function(){var t,n;i.animation===e&&i._updateTask&&("finished"===e.state&&(null!==(t=i.transition)&&void 0!==t&&t.applyRatio(i.viewpoint,1),null!==(n=i.view)&&void 0!==n&&n.state&&(i.view.state.viewpoint=i.viewpoint.clone())),i.animation=null,i.updateFunction=null)};return e.when(a,a),this._startTime=performance.now(),this._updateTask.resume(),this.animation=e,e}},{key:"animateContinous",value:function(e,t){var n=this;this.stop(),this.updateFunction=t,this.viewpoint=e;var i=new q.Z({target:e.clone()}),r=function(){n.animation===i&&n._updateTask&&(n.animation=null,n.updateFunction=null)};return i.when(r,r),this._startTime=performance.now(),this._updateTask.resume(),this.animation=i,i}},{key:"stop",value:function(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}},{key:"_postRender",value:function(e){var t=this.animation;if(t&&t.state!==q.Z.State.STOPPED){var n;if(this.updateFunction)this.updateFunction(this.viewpoint,e.deltaTime);else{var i,r=this.transition,a=(performance.now()-this._startTime)/r.duration,o=a>=1;r.applyRatio(this.viewpoint,a),o&&(null===(i=this.animation)||void 0===i||i.finish())}(null===(n=this.view)||void 0===n?void 0:n.state)&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}}]),n}(U.Z);(0,g._)([(0,P.Cb)()],K.prototype,"animation",void 0),(0,g._)([(0,P.Cb)()],K.prototype,"duration",void 0),(0,g._)([(0,P.Cb)()],K.prototype,"transition",void 0),(0,g._)([(0,P.Cb)()],K.prototype,"easing",void 0),(0,g._)([(0,P.Cb)()],K.prototype,"view",void 0),(0,g._)([(0,P.Cb)()],K.prototype,"viewpoint",void 0);var Q=K=(0,g._)([(0,L.j)("esri.views.2d.AnimationManager")],K),J=function(){function e(t){var n=this;(0,u.Z)(this,e),this.view=t,this._stationaryHandle=null,this._frameTaskHandle=null,this._updateParameters=null,this._updateRequested=!1,this.stationary=!0,this.animationInProgress=!1,this.prepare=function(){n._updateParameters&&(n._updateParameters.state=n.view.state,n._updateParameters.stationary=n.view.stationary,n._updateParameters.pixelRatio=window.devicePixelRatio,n._updateParameters.renderingOptions=n.view.renderingOptions)},this.update=function(){var e;n._updateRequested=!1;var t=n.view,i=t.basemapView,r=t.graphicsView,a=t.labelManager,o=t.layerViews,s=t.state.id;null!==i&&void 0!==i&&i.baseLayerViews.forEach(n._updateLayerView,n),o.forEach(n._updateLayerView,n),null!==i&&void 0!==i&&i.referenceLayerViews.forEach(n._updateLayerView,n),(0,x.pC)(a)&&(a.lastUpdateId!==s&&(a.viewChange(),a.lastUpdateId=s),a.updateRequested&&a.processUpdate(n._updateParameters)),(0,x.pC)(r)&&(r.lastUpdateId!==s&&(r.viewChange(),r.lastUpdateId=s),r.updateRequested&&r.processUpdate(n._updateParameters)),n.view.graphicsTileStore.setViewState(n._updateParameters.state),n.animationInProgress||n._updateRequested||null===(e=n._frameTaskHandle)||void 0===e||e.pause()}}return(0,c.Z)(e,[{key:"destroy",value:function(){this.stop()}},{key:"start",value:function(){var e=this;if(!this._frameTaskHandle){var t=this.view;this.stationary=t.stationary,this._updateParameters={state:t.state,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:t.renderingOptions},this._stationaryHandle=(0,T.YP)((function(){return t.stationary}),(function(t){e.stationary=t,e.requestFrame()})),this._frameTaskHandle=(0,W.A)(this),this.requestUpdate()}}},{key:"stop",value:function(){var e;this._frameTaskHandle&&(this._updateRequested=!1,null!==(e=this._stationaryHandle)&&void 0!==e&&e.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0,this.animationInProgress=!1)}},{key:"requestUpdate",value:function(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}},{key:"requestFrame",value:function(){this._frameTaskHandle&&this._frameTaskHandle.resume()}},{key:"_updateLayerView",value:function(e){if(e.attached){var t=this.view.state,n=e.lastUpdateId;null!=n&&(this.stationary||e.moving)||(e.moving=!0,e.moveStart()),n!==t.id&&e.viewChange(),this.stationary&&e.moving&&(e.moving=!1,e.moveEnd()),e.lastUpdateId=t.id,e.updateRequested&&e.processUpdate(this._updateParameters),"layerViews"in e&&e.layerViews.forEach(this._updateLayerView,this)}else this.requestUpdate()}}]),e}();function X(){return Promise.all([Promise.all([n.e(51378),n.e(62029),n.e(47428),n.e(60345)]).then(n.bind(n,60345)),Promise.all([n.e(51378),n.e(62029),n.e(33624),n.e(64542),n.e(98029),n.e(47428),n.e(9892),n.e(72878),n.e(9795),n.e(98991),n.e(7671),n.e(18016),n.e(99484),n.e(8131),n.e(483),n.e(46642),n.e(82022),n.e(64893),n.e(73789),n.e(49104),n.e(86401),n.e(59685)]).then(n.bind(n,61341))])}var $=function(){return X().then((function(){return Promise.all([n.e(51378),n.e(62029),n.e(33624),n.e(64542),n.e(98029),n.e(47428),n.e(82195),n.e(9892),n.e(72878),n.e(9795),n.e(98991),n.e(7671),n.e(18016),n.e(99484),n.e(8131),n.e(483),n.e(46642),n.e(82022),n.e(64893),n.e(58985),n.e(73789),n.e(49104),n.e(85258),n.e(80844)]).then(n.bind(n,70056))}))},ee=function(){return X().then((function(){return Promise.all([n.e(51378),n.e(33624),n.e(64542),n.e(98029),n.e(82195),n.e(9795),n.e(98991),n.e(7671),n.e(18495),n.e(19110)]).then(n.bind(n,19110))}))},te={"base-dynamic":function(){return X().then((function(){return Promise.all([n.e(51378),n.e(62029),n.e(33624),n.e(64542),n.e(98029),n.e(47428),n.e(82195),n.e(9892),n.e(72878),n.e(18048),n.e(52662)]).then(n.bind(n,52662))}))},"base-tile":$,"bing-maps":$,csv:ee,"geo-rss":function(){return X().then((function(){return Promise.all([n.e(51378),n.e(62029),n.e(33624),n.e(64542),n.e(98029),n.e(47428),n.e(82195),n.e(9892),n.e(72878),n.e(9795),n.e(98991),n.e(7671),n.e(18016),n.e(99484),n.e(8131),n.e(483),n.e(46642),n.e(82022),n.e(53684)]).then(n.bind(n,53684))}))},feature:ee,geojson:ee,graphics:function(){return X().then((function(){return Promise.all([n.e(51378),n.e(62029),n.e(33624),n.e(64542),n.e(98029),n.e(47428),n.e(82195),n.e(9892),n.e(72878),n.e(9795),n.e(98991),n.e(7671),n.e(18016),n.e(99484),n.e(8131),n.e(483),n.e(46642),n.e(82022),n.e(73558)]).then(n.bind(n,73558))}))},group:function(){return X().then((function(){return Promise.all([n.e(51378),n.e(62029),n.e(33624),n.e(64542),n.e(98029),n.e(47428),n.e(82195),n.e(9892),n.e(72878),n.e(74105)]).then(n.bind(n,74105))}))},imagery:function(){return X().then((function(){return Promise.all([n.e(51378),n.e(62029),n.e(33624),n.e(64542),n.e(98029),n.e(47428),n.e(82195),n.e(9892),n.e(72878),n.e(9795),n.e(98991),n.e(7671),n.e(18016),n.e(99484),n.e(8131),n.e(483),n.e(46642),n.e(82022),n.e(80394),n.e(35345),n.e(18048),n.e(38843),n.e(62358)]).then(n.bind(n,62358))}))},"imagery-tile":function(){return X().then((function(){return Promise.all([n.e(51378),n.e(62029),n.e(33624),n.e(64542),n.e(98029),n.e(47428),n.e(82195),n.e(9892),n.e(72878),n.e(80394),n.e(35345),n.e(38843),n.e(83095)]).then(n.bind(n,83095))}))},kml:function(){return X().then((function(){return Promise.all([n.e(51378),n.e(62029),n.e(33624),n.e(64542),n.e(98029),n.e(47428),n.e(82195),n.e(9892),n.e(72878),n.e(9795),n.e(98991),n.e(7671),n.e(18016),n.e(99484),n.e(8131),n.e(483),n.e(46642),n.e(82022),n.e(80394),n.e(73789),n.e(86401),n.e(82821)]).then(n.bind(n,6326))}))},"knowledge-graph":function(){return X().then((function(){return Promise.all([n.e(51378),n.e(33624),n.e(82195),n.e(83808)]).then(n.bind(n,83808))}))},"link-chart":function(){return X().then((function(){return Promise.all([n.e(51378),n.e(33624),n.e(82195),n.e(83808)]).then(n.bind(n,83808))}))},"knowledge-graph-sublayer":ee,"map-image":function(){return X().then((function(){return Promise.all([n.e(51378),n.e(62029),n.e(33624),n.e(64542),n.e(98029),n.e(47428),n.e(82195),n.e(9892),n.e(72878),n.e(9795),n.e(98991),n.e(7671),n.e(18016),n.e(99484),n.e(8131),n.e(483),n.e(46642),n.e(82022),n.e(58985),n.e(18048),n.e(38013)]).then(n.bind(n,57682))}))},"map-notes":function(){return X().then((function(){return Promise.all([n.e(51378),n.e(62029),n.e(33624),n.e(64542),n.e(98029),n.e(47428),n.e(82195),n.e(9892),n.e(72878),n.e(9795),n.e(98991),n.e(7671),n.e(18016),n.e(99484),n.e(8131),n.e(483),n.e(46642),n.e(82022),n.e(82186)]).then(n.bind(n,82186))}))},media:function(){return X().then((function(){return Promise.all([n.e(51378),n.e(62029),n.e(33624),n.e(64542),n.e(98029),n.e(47428),n.e(82195),n.e(9892),n.e(72878),n.e(9795),n.e(98991),n.e(7671),n.e(18016),n.e(99484),n.e(8131),n.e(483),n.e(46642),n.e(64893),n.e(73789),n.e(49104),n.e(45139)]).then(n.bind(n,45139))}))},"ogc-feature":function(){return X().then((function(){return Promise.all([n.e(51378),n.e(33624),n.e(64542),n.e(98029),n.e(82195),n.e(9795),n.e(98991),n.e(7671),n.e(18495),n.e(19110),n.e(58926)]).then(n.bind(n,58926))}))},"open-street-map":$,"oriented-imagery":ee,route:function(){return X().then((function(){return Promise.all([n.e(51378),n.e(62029),n.e(33624),n.e(64542),n.e(98029),n.e(47428),n.e(82195),n.e(9892),n.e(72878),n.e(9795),n.e(98991),n.e(7671),n.e(18016),n.e(99484),n.e(8131),n.e(483),n.e(46642),n.e(82022),n.e(729),n.e(58405)]).then(n.bind(n,58405))}))},stream:function(){return X().then((function(){return Promise.all([n.e(51378),n.e(33624),n.e(64542),n.e(98029),n.e(82195),n.e(9795),n.e(98991),n.e(7671),n.e(18495),n.e(19110),n.e(50397)]).then(n.bind(n,50397))}))},"subtype-group":function(){return X().then((function(){return Promise.all([n.e(51378),n.e(33624),n.e(64542),n.e(98029),n.e(82195),n.e(9795),n.e(98991),n.e(7671),n.e(18495),n.e(19110),n.e(13177)]).then(n.bind(n,13177))}))},tile:$,"vector-tile":function(){return X().then((function(){return Promise.all([n.e(51378),n.e(62029),n.e(33624),n.e(64542),n.e(98029),n.e(47428),n.e(82195),n.e(9892),n.e(72878),n.e(30969),n.e(77416),n.e(19774)]).then(n.bind(n,10196))}))},wcs:function(){return X().then((function(){return Promise.all([n.e(51378),n.e(62029),n.e(33624),n.e(64542),n.e(98029),n.e(47428),n.e(82195),n.e(9892),n.e(72878),n.e(80394),n.e(35345),n.e(38843),n.e(83095)]).then(n.bind(n,83095))}))},"web-tile":$,wfs:ee,wms:function(){return X().then((function(){return Promise.all([n.e(51378),n.e(62029),n.e(33624),n.e(64542),n.e(98029),n.e(47428),n.e(82195),n.e(9892),n.e(72878),n.e(18048),n.e(39332)]).then(n.bind(n,39332))}))},wmts:function(){return X().then((function(){return Promise.all([n.e(51378),n.e(62029),n.e(33624),n.e(64542),n.e(98029),n.e(47428),n.e(82195),n.e(9892),n.e(72878),n.e(85258),n.e(24882)]).then(n.bind(n,5738))}))},"line-of-sight":null,"base-elevation":null,"building-scene":null,dimension:null,elevation:null,"integrated-mesh":null,"point-cloud":null,voxel:null,scene:null,unknown:null,unsupported:null};var ne,ie=function(e){return(0,x.pC)(te[e.type])},re=function(e){var t=te[e.type];if((0,x.Wi)(t))throw function(e){var t=e.declaredClass?e.declaredClass.slice(e.declaredClass.lastIndexOf(".")+1):"Unknown",n=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new k.Z("".concat(n,":view-not-supported"),"".concat(t," is not supported in 2D"))}(e);return t(e)},ae=n(59068),oe=n(79056),se=n(34066),le=n(88396),ue=n(69662);var ce,de=ne=function(e){(0,f.Z)(n,e);var t=(0,v.Z)(n);function n(e){var i;return(0,u.Z)(this,n),(i=t.call(this,e)).geometry=null,i.spatialReference=null,i}return(0,c.Z)(n,[{key:"normalizedGeometry",get:function(){if((0,x.Wi)(this.geometry)||!this.spatialReference)return null;if(!this.spatialReference.equals(this.geometry.spatialReference))try{return(0,V.iV)(this.geometry,this.spatialReference)}catch(gt){return Z.Z.getLogger(this.declaredClass).error("#constraints.geometry","could not project the geometry to the view's spatial reference",{geometry:this.geometry,spatialReference:this.spatialReference,error:gt}),null}return this.geometry}},{key:"constrain",value:function(e,t){if((0,x.Wi)(this.normalizedGeometry))return e;var n=e.targetGeometry;if("extent"===this.normalizedGeometry.type?(0,se.aV)(this.normalizedGeometry,n):(0,se.CI)(this.normalizedGeometry,n))return e;var r=function(e,t){var n,r=t.spatialReference,a=[t.x,t.y],o=Number.POSITIVE_INFINITY,s=0,l=0,u=[0,0],c="extent"===e.type?[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]:e.rings,d=(0,i.Z)(c);try{for(d.s();!(n=d.n()).done;)for(var p=n.value,h=0;h<p.length-1;h++){(0,ue.Tx)(u,a,p,h);var f=(0,le.d)(a,u);f<o&&(o=f,s=u[0],l=u[1])}}catch(v){d.e(v)}finally{d.f()}return{coordinate:new R.Z({x:s,y:l,spatialReference:r}),distance:o}}(this.normalizedGeometry,n),a=r.coordinate;return a?(e.targetGeometry=a,e):e}},{key:"clone",value:function(){var e,t;return new ne({geometry:null===(e=this.geometry)||void 0===e?void 0:e.clone(),spatialReference:null===(t=this.spatialReference)||void 0===t?void 0:t.clone()})}}]),n}((0,oe.iv)(U.Z));(0,g._)([(0,P.Cb)({constructOnly:!0})],de.prototype,"geometry",void 0),(0,g._)([(0,P.Cb)({readOnly:!0})],de.prototype,"normalizedGeometry",null),(0,g._)([(0,P.Cb)({constructOnly:!0})],de.prototype,"spatialReference",void 0),de=ne=(0,g._)([(0,L.j)("esri.views.2d.constraints.GeometryConstraint")],de);var pe=ce=function(e){(0,f.Z)(n,e);var t=(0,v.Z)(n);function n(){var e;return(0,u.Z)(this,n),(e=t.apply(this,arguments)).enabled=!0,e.rotationEnabled=!0,e}return(0,c.Z)(n,[{key:"constrain",value:function(e,t){return this.enabled&&t?(this.rotationEnabled||(e.rotation=t.rotation),e):e}},{key:"clone",value:function(){return new ce({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}}]),n}((0,oe.iv)(U.Z));(0,g._)([(0,P.Cb)()],pe.prototype,"enabled",void 0),(0,g._)([(0,P.Cb)()],pe.prototype,"rotationEnabled",void 0);var he,fe=pe=ce=(0,g._)([(0,L.j)("esri.views.2d.constraints.RotationConstraint")],pe),ve=he=function(e){(0,f.Z)(n,e);var t=(0,v.Z)(n);function n(e){var i;return(0,u.Z)(this,n),(i=t.call(this,e))._lodByScale={},i._scales=[],i.effectiveLODs=null,i.effectiveMinZoom=-1,i.effectiveMaxZoom=-1,i.effectiveMinScale=0,i.effectiveMaxScale=0,i.lods=null,i.minZoom=-1,i.maxZoom=-1,i.minScale=0,i.maxScale=0,i.snapToZoom=!0,i}return(0,c.Z)(n,[{key:"initialize",value:function(){var e,t,n,r=this,a=this.lods,o=this.minScale,s=this.maxScale,l=this.minZoom,u=this.maxZoom,c=-1,d=-1,p=!1,h=!1;if(0!==o&&0!==s&&o<s&&(o=(e=[s,o])[0],s=e[1]),!a||!a.length)return this._set("effectiveMinScale",o),void this._set("effectiveMaxScale",s);a=a.map((function(e){return e.clone()})),a.sort((function(e,t){return t.scale-e.scale})),a.forEach((function(e,t){return e.level=t}));var f,v=(0,i.Z)(a);try{for(v.s();!(f=v.n()).done;){var y=f.value;!p&&o>0&&o>=y.scale&&(c=y.level,p=!0),!h&&s>0&&s>=y.scale&&(d=n?n.level:-1,h=!0),n=y}}catch(g){v.e(g)}finally{v.f()}-1===l&&(l=0===o?0:c),-1===u&&(u=0===s?a.length-1:d),l=Math.max(l,0),l=Math.min(l,a.length-1),u=Math.max(u,0),l>(u=Math.min(u,a.length-1))&&(l=(t=[u,l])[0],u=t[1]),o=a[l].scale,s=a[u].scale,a.splice(0,l),a.splice(u-l+1,a.length),a.forEach((function(e,t){r._lodByScale[e.scale]=e,r._scales[t]=e.scale})),this._set("effectiveLODs",a),this._set("effectiveMinZoom",l),this._set("effectiveMaxZoom",u),this._set("effectiveMinScale",o),this._set("effectiveMaxScale",s)}},{key:"constrain",value:function(e,t){if(t&&e.scale===t.scale)return e;var n=this.effectiveMinScale,i=this.effectiveMaxScale,r=e.targetGeometry,a=t&&t.targetGeometry,o=0!==i&&e.scale<i,s=0!==n&&e.scale>n;if(o||s){var l=s?n:i;if(t&&a){var u=(l-t.scale)/(e.scale-t.scale);r.x=a.x+(r.x-a.x)*u,r.y=a.y+(r.y-a.y)*u}e.scale=l}return this.snapToZoom&&this.effectiveLODs&&(e.scale=this._getClosestScale(e.scale)),e}},{key:"fit",value:function(e){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(e,null);var t=this.scaleToZoom(e.scale),n=Math.abs(t-Math.floor(t));return e.scale=this.zoomToScale(n>.99?Math.round(t):Math.floor(t)),e}},{key:"zoomToScale",value:function(e){if(!this.effectiveLODs)return 0;e-=this.effectiveMinZoom,e=Math.max(0,e);var t=this._scales;if(e<=0)return t[0];if(e>=t.length)return t[t.length-1];var n=Math.round(e-.5),i=Math.round(e);return t[i]+(i-e)*(t[n]-t[i])}},{key:"scaleToZoom",value:function(e){if(!this.effectiveLODs)return-1;var t,n,i=this._scales;if(e>=i[0])return this.effectiveMinZoom;if(e<=i[i.length-1])return this.effectiveMaxZoom;for(var r=0;r<i.length-1;r++){if(t=i[r],(n=i[r+1])===e)return r+this.effectiveMinZoom+1;if(t>e&&n<e)return r+this.effectiveMinZoom+1-(e-n)/(t-n)}return-1}},{key:"snapToClosestScale",value:function(e){if(!this.effectiveLODs)return e;var t=this.scaleToZoom(e);return this.zoomToScale(Math.round(t))}},{key:"snapToNextScale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;if(!this.effectiveLODs)return e*t;var n=Math.round(this.scaleToZoom(e));return this.zoomToScale(n+1)}},{key:"snapToPreviousScale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(!this.effectiveLODs)return e*t;var n=Math.round(this.scaleToZoom(e));return this.zoomToScale(n-1)}},{key:"clone",value:function(){return new he({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}},{key:"_getClosestScale",value:function(e){return this._lodByScale[e]||(e=this._scales.reduce((function(t,n){return Math.abs(n-e)<=Math.abs(t-e)?n:t}),this._scales[0])),this._lodByScale[e].scale}}]),n}((0,oe.iv)(U.Z));(0,g._)([(0,P.Cb)({readOnly:!0})],ve.prototype,"effectiveLODs",void 0),(0,g._)([(0,P.Cb)({readOnly:!0})],ve.prototype,"effectiveMinZoom",void 0),(0,g._)([(0,P.Cb)({readOnly:!0})],ve.prototype,"effectiveMaxZoom",void 0),(0,g._)([(0,P.Cb)({readOnly:!0})],ve.prototype,"effectiveMinScale",void 0),(0,g._)([(0,P.Cb)({readOnly:!0})],ve.prototype,"effectiveMaxScale",void 0),(0,g._)([(0,P.Cb)()],ve.prototype,"lods",void 0),(0,g._)([(0,P.Cb)()],ve.prototype,"minZoom",void 0),(0,g._)([(0,P.Cb)()],ve.prototype,"maxZoom",void 0),(0,g._)([(0,P.Cb)()],ve.prototype,"minScale",void 0),(0,g._)([(0,P.Cb)()],ve.prototype,"maxScale",void 0),(0,g._)([(0,P.Cb)()],ve.prototype,"snapToZoom",void 0);var ye=ve=he=(0,g._)([(0,L.j)("esri.views.2d.constraints.ZoomConstraint")],ve),ge=n(80885),me={base:null,key:"type",typeMap:{extent:E.Z,polygon:ge.Z}},_e=function(e){(0,f.Z)(n,e);var t=(0,v.Z)(n);function n(e){var i;return(0,u.Z)(this,n),(i=t.call(this,e)).lods=null,i.minScale=0,i.maxScale=0,i.minZoom=-1,i.maxZoom=-1,i.rotationEnabled=!0,i.snapToZoom=!0,i}return(0,c.Z)(n,[{key:"destroy",value:function(){this.view=null}},{key:"effectiveLODs",get:function(){return this._zoom.effectiveLODs}},{key:"effectiveMinScale",get:function(){return this._zoom.effectiveMinScale}},{key:"effectiveMaxScale",get:function(){return this._zoom.effectiveMaxScale}},{key:"effectiveMinZoom",get:function(){return this._zoom.effectiveMinZoom}},{key:"effectiveMaxZoom",get:function(){return this._zoom.effectiveMaxZoom}},{key:"geometry",set:function(e){e?this._set("geometry",e):this._set("geometry",null)}},{key:"version",get:function(){var e,t,n;return"".concat(null===(e=this._zoom)||void 0===e?void 0:e.uid,"/").concat(null===(t=this._rotation)||void 0===t?void 0:t.uid,"/").concat(null===(n=this._geometry)||void 0===n?void 0:n.uid)}},{key:"_defaultLODs",get:function(){var e,t,n,i=null===(e=this.view)||void 0===e||null===(t=e.defaultsFromMap)||void 0===t?void 0:t.tileInfo,r=null===(n=this.view)||void 0===n?void 0:n.spatialReference;return i&&r&&i.spatialReference.equals(r)?i.lods:null}},{key:"_geometry",get:function(){var e;return new de({geometry:this.geometry,spatialReference:null===(e=this.view)||void 0===e?void 0:e.spatialReference})}},{key:"_rotation",get:function(){return new fe({rotationEnabled:this.rotationEnabled})}},{key:"_zoom",get:function(){var e=this._get("_zoom"),t=this.lods||this._defaultLODs,n=this.minZoom,i=this.maxZoom,r=this.minScale,a=this.maxScale,o=this.snapToZoom;return e&&e.lods===t&&e.minZoom===n&&e.maxZoom===i&&e.minScale===r&&e.maxScale===a&&e.snapToZoom===o?e:new ye({lods:t,minZoom:n,maxZoom:i,minScale:r,maxScale:a,snapToZoom:o})}},{key:"canZoomInTo",value:function(e){var t=this.effectiveMaxScale;return 0===t||e>=t}},{key:"canZoomOutTo",value:function(e){var t=this.effectiveMinScale;return 0===t||e<=t}},{key:"constrain",value:function(e,t){return this._zoom.constrain(e,t),this._rotation.constrain(e,t),this._geometry.constrain(e,t),e}},{key:"constrainByGeometry",value:function(e){return this._geometry.constrain(e)}},{key:"fit",value:function(e){return this._zoom.fit(e)}},{key:"zoomToScale",value:function(e){return this._zoom.zoomToScale(e)}},{key:"scaleToZoom",value:function(e){return this._zoom.scaleToZoom(e)}},{key:"snapScale",value:function(e){return this._zoom.snapToClosestScale(e)}},{key:"snapToNextScale",value:function(e){return this._zoom.snapToNextScale(e)}},{key:"snapToPreviousScale",value:function(e){return this._zoom.snapToPreviousScale(e)}}]),n}(U.Z);(0,g._)([(0,P.Cb)({readOnly:!0})],_e.prototype,"effectiveLODs",null),(0,g._)([(0,P.Cb)({readOnly:!0})],_e.prototype,"effectiveMinScale",null),(0,g._)([(0,P.Cb)({readOnly:!0})],_e.prototype,"effectiveMaxScale",null),(0,g._)([(0,P.Cb)({readOnly:!0})],_e.prototype,"effectiveMinZoom",null),(0,g._)([(0,P.Cb)({readOnly:!0})],_e.prototype,"effectiveMaxZoom",null),(0,g._)([(0,P.Cb)({types:me,value:null})],_e.prototype,"geometry",null),(0,g._)([(0,P.Cb)({type:[ae.Z]})],_e.prototype,"lods",void 0),(0,g._)([(0,P.Cb)()],_e.prototype,"minScale",void 0),(0,g._)([(0,P.Cb)()],_e.prototype,"maxScale",void 0),(0,g._)([(0,P.Cb)()],_e.prototype,"minZoom",void 0),(0,g._)([(0,P.Cb)()],_e.prototype,"maxZoom",void 0),(0,g._)([(0,P.Cb)()],_e.prototype,"rotationEnabled",void 0),(0,g._)([(0,P.Cb)()],_e.prototype,"snapToZoom",void 0),(0,g._)([(0,P.Cb)()],_e.prototype,"view",void 0),(0,g._)([(0,P.Cb)({readOnly:!0})],_e.prototype,"version",null),(0,g._)([(0,P.Cb)()],_e.prototype,"_defaultLODs",null),(0,g._)([(0,P.Cb)({type:de})],_e.prototype,"_geometry",null),(0,g._)([(0,P.Cb)({type:fe})],_e.prototype,"_rotation",null),(0,g._)([(0,P.Cb)({readOnly:!0,type:ye})],_e.prototype,"_zoom",null);var be,we,ke=_e=(0,g._)([(0,L.j)("esri.views.2d.MapViewConstraints")],_e),Ce=n(6394),Me=n(29931),Ze=be=function(e){(0,f.Z)(n,e);var t=(0,v.Z)(n);function n(){var e;return(0,u.Z)(this,n),(e=t.apply(this,arguments)).left=0,e.top=0,e.right=0,e.bottom=0,e}return(0,c.Z)(n,[{key:"clone",value:function(){return new be({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}}]),n}(U.Z);(0,g._)([(0,P.Cb)()],Ze.prototype,"left",void 0),(0,g._)([(0,P.Cb)()],Ze.prototype,"top",void 0),(0,g._)([(0,P.Cb)()],Ze.prototype,"right",void 0),(0,g._)([(0,P.Cb)()],Ze.prototype,"bottom",void 0),Ze=be=(0,g._)([(0,L.j)("esri.views.2d.PaddedViewState.Padding")],Ze);var xe=we=function(e){(0,f.Z)(n,e);var t=(0,v.Z)(n);function n(){var e;(0,u.Z)(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).paddedViewState=new Me.Z,e._updateContent=function(){var t=(0,Ce.a)();return function(){var n=e._get("size"),i=e._get("padding");if(n&&i){var r=e.paddedViewState;(0,le.s)(t,i.left+i.right,i.top+i.bottom),(0,le.a)(t,n,t),(0,le.c)(r.size,t);var a=r.viewpoint;a&&(e.viewpoint=a)}}}(),e.addHandles((0,T.YP)((function(){return[e.size,e.padding]}),(function(){return e._updateContent()}),T.Z_)),e.padding=new Ze,e.size=[0,0],e}return(0,c.Z)(n,[{key:"padding",set:function(e){this._set("padding",e||new Ze)}},{key:"viewpoint",set:function(e){if(e){var t=e.clone();this.paddedViewState.viewpoint=e,(0,H.H4)(t,e,this._get("size"),this._get("padding"));var n=this._viewpoint2D,i=t.targetGeometry;n.center[0]=i.x,n.center[1]=i.y,n.rotation=t.rotation,n.scale=t.scale,n.spatialReference=i.spatialReference,this._update()}}},{key:"clone",value:function(){return new we({padding:this.padding.clone(),size:this.size.slice(),viewpoint:this.paddedViewState.viewpoint.clone(),pixelRatio:this.pixelRatio})}}]),n}(Me.Z);(0,g._)([(0,P.Cb)()],xe.prototype,"paddedViewState",void 0),(0,g._)([(0,P.Cb)({type:Ze})],xe.prototype,"padding",null),(0,g._)([(0,P.Cb)()],xe.prototype,"viewpoint",null);var Ie,Te=xe=we=(0,g._)([(0,L.j)("esri.views.2d.PaddedViewState")],xe),Se=(n(5131),n(37995)),Ae=(n(73828),n(32344),n(85269),n(100)),Fe=n(45371),Pe=n(41722),Le=function(e){(0,f.Z)(n,e);var t=(0,v.Z)(n);function n(e,i){var r;return(0,u.Z)(this,n),(r=t.call(this,!0))._view=e,r.registerIncoming("double-click",i,(function(e){return r._handleDoubleClick(e,i)})),r}return(0,c.Z)(n,[{key:"_handleDoubleClick",value:function(e,t){(0,Pe.h)(e.data,"primary")&&(e.stopPropagation(),t?this._view.mapViewNavigation.zoomOut([e.data.x,e.data.y]):this._view.mapViewNavigation.zoomIn([e.data.x,e.data.y]))}}]),n}(Fe.a),Ee=function(e){(0,f.Z)(n,e);var t=(0,v.Z)(n);function n(e,i,r){var a;return(0,u.Z)(this,n),(a=t.call(this,!0)).view=e,a.pointerType=i,a.registerIncoming("double-tap-drag",r,(function(e){return a._handleDoubleTapDrag(e)})),a}return(0,c.Z)(n,[{key:"_handleDoubleTapDrag",value:function(e){var t=e.data;if(t.pointerType===this.pointerType){e.stopPropagation();var n=t.action,i=t.delta,r=this.view,a=r.mapViewNavigation;switch(n){case"begin":var o=r.scale;this._startScale=o,this._currentScale=o,this._previousDelta=i,a.begin();break;case"update":if(this._previousDelta.y===i.y)return;this._previousDelta=i;var s=Math.pow(1.015,i.y),l=this._startScale*s,u=l/this._currentScale;a.setViewpointImmediate(u),this._currentScale=l;break;case"end":var c=r.constraints,d=c.effectiveLODs;if(!c.snapToZoom||!d)return void a.end();var p=c.snapScale(this._currentScale),h=(i.y>0?Math.max(p,c.snapToPreviousScale(this._startScale)):Math.min(p,c.snapToNextScale(this._startScale)))/this._currentScale;a.zoom(h)}}}}]),n}(Fe.a),Re=n(43308),Ve=function(e){(0,f.Z)(n,e);var t=(0,v.Z)(n);function n(e,i,r){var a;return(0,u.Z)(this,n),(a=t.call(this,!0)).view=e,a.pointerAction=i,a.registerIncoming("drag",r,(function(e){return a._handleDrag(e)})),a.registerIncoming("pointer-down",(function(){return a.stopMomentumNavigation()})),a}return(0,c.Z)(n,[{key:"onInstall",value:function(e){var t=this;(0,p.Z)((0,h.Z)(n.prototype),"onInstall",this).call(this,e),this._dragEventSeparator=new Re.H({start:function(e,n){t.view.mapViewNavigation.pan.begin(t.view,n.data),n.stopPropagation()},update:function(e,n){t.view.mapViewNavigation.pan.update(t.view,n.data),n.stopPropagation()},end:function(e,n){t.view.mapViewNavigation.pan.end(t.view,n.data),n.stopPropagation()},condition:function(e,n){return 1===e&&(0,Pe.h)(n.data,t.pointerAction)}})}},{key:"_handleDrag",value:function(e){var t=this.view.mapViewNavigation;t.pinch.zoomMomentum||t.pinch.rotateMomentum?this.stopMomentumNavigation():this._dragEventSeparator.handle(e)}},{key:"stopMomentumNavigation",value:function(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}}]),n}(Fe.a),Oe=function(e){(0,f.Z)(n,e);var t=(0,v.Z)(n);function n(e,i,r){var a;(0,u.Z)(this,n),(a=t.call(this,!0))._view=e,a.pointerAction=i;var o=a._view.mapViewNavigation;return a._dragEventSeparator=new Re.H({start:function(e,t){o.rotate.begin(a._view,t.data),t.stopPropagation()},update:function(e,t){o.rotate.update(a._view,t.data),t.stopPropagation()},end:function(e,t){o.rotate.end(),t.stopPropagation()},condition:function(e,t){return 1===e&&(0,Pe.h)(t.data,a.pointerAction)}}),a.registerIncoming("drag",r,(function(e){return a._dragEventSeparator.handle(e)})),a}return(0,c.Z)(n)}(Fe.a),De=n(73320),Ne=function(e){(0,f.Z)(n,e);var t=(0,v.Z)(n);function n(e){var i;return(0,u.Z)(this,n),(i=t.call(this,!0))._view=e,i._frameTask=null,i._watchHandles=new Ae.Z,i._currentDevice=null,i._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},i._handle=i.registerIncoming("gamepad",(function(e){return i._handleGamePadEvent(e)})),i._handle.pause(),i}return(0,c.Z)(n,[{key:"onInstall",value:function(e){var t=this;(0,p.Z)((0,h.Z)(n.prototype),"onInstall",this).call(this,e),this._watchHandles.add([(0,T.YP)((function(){var e;return null===(e=t._view.navigation.gamepad)||void 0===e?void 0:e.enabled}),(function(e){e?(t._handle.resume(),t._frameTask||(t._frameTask=(0,W.A)({update:function(e){return t._frameUpdate(e.deltaTime)}}))):(t._handle.pause(),t._frameTask&&(t._frameTask.remove(),t._frameTask=null))}),T.nn)])}},{key:"onUninstall",value:function(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),(0,p.Z)((0,h.Z)(n.prototype),"onUninstall",this).call(this)}},{key:"_handleGamePadEvent",value:function(e){var t=this._view.navigation.gamepad.device;t&&e.data.device!==t||this._currentDevice&&this._currentDevice!==e.data.device||("end"===e.data.action?(this._currentDevice=null,(0,De.cm)(this._transformation)):(this._currentDevice=e.data.device,(0,De.CY)(e.data,this._view.navigation.gamepad,this._transformation)))}},{key:"_frameUpdate",value:function(e){var t=this._transformation;if(!(0,De._r)(t)){var n=this._view.viewpoint.clone(),i=this._view.navigation.gamepad.velocityFactor,r=Be*i*e;(0,H.Rx)(n,n,[t.translation[0]*r,-t.translation[1]*r]);var a=1+t.translation[2]*Ge*e,o=this._view.constraints.rotationEnabled?-t.heading*ze*e:0,s=this._view.size,l=[s[0]/2,s[1]];(0,H.UZ)(n,n,a,o,l,s);var u=this._view.constraints.constrain(n,this._view.viewpoint);this._view.viewpoint=u}}}]),n}(Fe.a),ze=.06,Be=.7,Ge=6e-4,qe=function(e){(0,f.Z)(n,e);var t=(0,v.Z)(n);function n(e,i,r){var a,o;return(0,u.Z)(this,n),(o=t.call(this,!0)).view=e,o.keys=i,o._pressed=!1,o._keyMap=(a={},(0,s.Z)(a,i.left,"left"),(0,s.Z)(a,i.right,"right"),(0,s.Z)(a,i.up,"up"),(0,s.Z)(a,i.down,"down"),a),o.registerIncoming("key-down",r,(function(e){return o._handleKeyDown(e)})),o.registerIncoming("key-up",r,(function(e){return o._handleKeyUp(e)})),o.registerIncoming("blur",r,(function(){return o._handleBlur()})),o}return(0,c.Z)(n,[{key:"_handleKeyDown",value:function(e){e.data.repeat||this._handleKey(e,!0)}},{key:"_handleKeyUp",value:function(e){this._handleKey(e,!1)}},{key:"_handleBlur",value:function(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}},{key:"_handleKey",value:function(e,t){var n=this._keyMap[e.data.key];if(this._pressed=null!=n,this._pressed){if(t)switch(this.view.mapViewNavigation.begin(),n){case"left":this.view.mapViewNavigation.continousPanLeft();break;case"right":this.view.mapViewNavigation.continousPanRight();break;case"up":this.view.mapViewNavigation.continousPanUp();break;case"down":this.view.mapViewNavigation.continousPanDown()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}}]),n}(Fe.a),Ue=function(e){(0,f.Z)(n,e);var t=(0,v.Z)(n);function n(e,i,r){var a,o;return(0,u.Z)(this,n),(o=t.call(this,!0)).view=e,o.keys=i,o._pressed=!1,o._keyToDirection=(a={},(0,s.Z)(a,i.clockwiseOption1,"clockwise"),(0,s.Z)(a,i.clockwiseOption2,"clockwise"),(0,s.Z)(a,i.counterClockwiseOption1,"counterClockwise"),(0,s.Z)(a,i.counterClockwiseOption2,"counterClockwise"),(0,s.Z)(a,i.resetOption1,"reset"),(0,s.Z)(a,i.resetOption2,"reset"),a),o.registerIncoming("key-down",r,(function(e){return o._handleKeyDown(e)})),o.registerIncoming("key-up",r,(function(e){return o._handleKeyUp(e)})),o.registerIncoming("blur",r,(function(){return o._handleBlur()})),o}return(0,c.Z)(n,[{key:"_handleKeyDown",value:function(e){e.data.repeat||this._handleKey(e,!0)}},{key:"_handleKeyUp",value:function(e){this._handleKey(e,!1)}},{key:"_handleBlur",value:function(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}},{key:"_handleKey",value:function(e,t){var n=e.modifiers;if(!(n.size>0&&!n.has("Shift")||!this.view.constraints.rotationEnabled)){var i=this._keyToDirection[e.data.key];if(this._pressed=null!=i,this._pressed){if(t)switch(this.view.mapViewNavigation.begin(),i){case"clockwise":this.view.mapViewNavigation.continousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}}}]),n}(Fe.a);!function(e){e[e.IN=0]="IN",e[e.OUT=1]="OUT"}(Ie||(Ie={}));var We=function(e){(0,f.Z)(n,e);var t=(0,v.Z)(n);function n(e,i,r){var a;return(0,u.Z)(this,n),(a=t.call(this,!0)).view=e,a.keys=i,a._keysToZoomAction={},a.registerIncoming("key-down",r,(function(e){return a._handleKeyDown(e)})),i.zoomIn.forEach((function(e){return a._keysToZoomAction[e]=Ie.IN})),i.zoomOut.forEach((function(e){return a._keysToZoomAction[e]=Ie.OUT})),a}return(0,c.Z)(n,[{key:"_handleKeyDown",value:function(e){this._handleKey(e)}},{key:"_handleKey",value:function(e){var t=e.modifiers;if(!(t.size>0)||t.has("Shift")){var n=e.data.key;if(n in this._keysToZoomAction){var i=this._keysToZoomAction[n],r=this.view.mapViewNavigation,a=null;switch(i){case Ie.IN:a=r.zoomIn();break;case Ie.OUT:a=r.zoomOut();break;default:return}r.begin(),a.then((function(){return r.end()})),e.stopPropagation()}}}}]),n}(Fe.a),je=function(e){(0,f.Z)(n,e);var t=(0,v.Z)(n);function n(e,i){var r;return(0,u.Z)(this,n),(r=t.call(this,!0))._view=e,r._canZoom=!0,r.registerIncoming("mouse-wheel",i,(function(e){return r._handleMouseWheel(e)})),r}return(0,c.Z)(n,[{key:"_handleMouseWheel",value:function(e){var t=this;if(this._view.navigation.mouseWheelZoomEnabled&&(e.preventDefault(),e.stopPropagation(),this._canZoom)){var n=this._view.mapViewNavigation,i=e.data,r=i.x,a=i.y,o=i.deltaY,s=1/Math.pow(.6,1/60*o),l=n.zoom(s,[r,a]);l&&(this._canZoom=!1,l.catch((function(){})).then((function(){t._canZoom=!0,n.end()})))}}}]),n}(Fe.a),He=function(e){(0,f.Z)(n,e);var t=(0,v.Z)(n);function n(e){var i;(0,u.Z)(this,n),(i=t.call(this,!0)).view=e,i.registerIncoming("drag",(function(e){return i._handleDrag(e)})),i.registerIncoming("pointer-down",(function(){return i._stopMomentumNavigation()}));var r=i.view.mapViewNavigation;return i._dragEventSeparator=new Re.H({start:function(e,t){r.pinch.begin(i.view,t.data),t.stopPropagation()},update:function(e,t){r.pinch.update(i.view,t.data),t.stopPropagation()},end:function(e,t){r.pinch.end(i.view),t.stopPropagation()},condition:function(e){return e>=2}}),i}return(0,c.Z)(n,[{key:"_handleDrag",value:function(e){this._dragEventSeparator.handle(e)}},{key:"_stopMomentumNavigation",value:function(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}}]),n}(Fe.a),Ye=n(31822),Ke=n(1614),Qe=n(83659),Je=n(84702),Xe=n(77427),$e=n(46525),et=n(15646),tt=function(e){(0,f.Z)(n,e);var t=(0,v.Z)(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$e.M.maximumDoubleClickDelay,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$e.M.maximumDoubleClickDistance,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:$e.M.maximumDoubleTouchDelay,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:$e.M.maximumDoubleTouchDistance,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Je.m;return(0,u.Z)(this,n),(e=t.call(this,!1))._maximumDoubleClickDelay=i,e._maximumDoubleClickDistance=r,e._maximumDoubleTouchDelay=a,e._maximumDoubleTouchDistance=o,e._clock=s,e._doubleTapDragReady=!1,e._doubleTapDragActive=!1,e._dragStartCenter=(0,S.vW)(0,0),e._pointerState=new Map,e._doubleTapDrag=e.registerOutgoing("double-tap-drag"),e._dragEventSeparator=new Re.H({start:function(t,n){return e._dragStart(t,n)},update:function(t,n){return e._dragUpdate(n)},end:function(t,n){return e._dragEnd(n)}}),e.registerIncoming("drag",(function(t){return e._dragEventSeparator.handle(t)})),e.registerIncoming("pointer-down",(function(t){return e._handlePointerDown(t)})),e.registerIncoming("pointer-up",(function(){return e._handlePointerUp()})),e}return(0,c.Z)(n,[{key:"onUninstall",value:function(){this._pointerState.forEach((function(e){e.doubleTapTimeout=(0,x.hw)(e.doubleTapTimeout)}))}},{key:"hasPendingInputs",get:function(){return(0,Xe.oE)(this._pointerState,(function(e){return null!=e.doubleTapTimeout}))}},{key:"_clearPointerDown",value:function(e){var t=this._pointerState.get(e);t&&(t.doubleTapTimeout=(0,x.hw)(t.doubleTapTimeout),this._pointerState.delete(e),this.refreshHasPendingInputs())}},{key:"_createDoubleTapDragData",value:function(e,t,n){return{action:e,delta:t,button:n.button,buttons:n.buttons,pointer:n.pointer,pointers:n.pointers,pointerType:n.pointerType,timestamp:n.timestamp}}},{key:"_dragStart",value:function(e,t){if(this._doubleTapDragReady&&1===e){this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;var n=t.data,i=t.modifiers,r=n.center;this._dragStartCenter=r;var a=this._createDoubleTapDragData("begin",(0,S.vW)(0,0),n);this._doubleTapDrag.emit(a,void 0,i),t.stopPropagation()}}},{key:"_dragUpdate",value:function(e){if(this._doubleTapDragActive){var t=e.data,n=e.modifiers,i=t.center,r=(0,S.vW)(i.x-this._dragStartCenter.x,i.y-this._dragStartCenter.y),a=this._createDoubleTapDragData("update",r,t);this._doubleTapDrag.emit(a,void 0,n),e.stopPropagation()}}},{key:"_dragEnd",value:function(e){if(this._doubleTapDragActive){var t=e.data,n=e.modifiers,i=t.center,r=(0,S.vW)(i.x-this._dragStartCenter.x,i.y-this._dragStartCenter.y),a=this._createDoubleTapDragData("end",r,t);this._doubleTapDrag.emit(a,void 0,n),this._doubleTapDragActive=!1,e.stopPropagation()}}},{key:"_handlePointerDown",value:function(e){var t=e.data,n=(0,et.au)(t),i=this._pointerState.get(n),r=t.native.pointerType;if(i){var a="touch"===r?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;this._clearPointerDown(n),(0,et.nk)(i.event.data,t)>a?this._storePointerDown(e):this._doubleTapDragReady=!0}else this._storePointerDown(e)}},{key:"_handlePointerUp",value:function(){this._doubleTapDragReady=!1}},{key:"_storePointerDown",value:function(e){var t=this,n=e.data,i=n.native.pointerType,r=(0,et.au)(n),a="touch"===i?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,o=this._clock.setTimeout((function(){return t._clearPointerDown(r)}),a);this._pointerState.set(r,{event:e,doubleTapTimeout:o}),this.refreshHasPendingInputs()}}]),n}(Fe.a),nt=n(33666),it=n(11802),rt=n(64544),at="Ctrl",ot={left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},st={zoomIn:["=","+"],zoomOut:["-","_"]},lt={clockwiseOption1:"a",clockwiseOption2:"A",counterClockwiseOption1:"d",counterClockwiseOption2:"D",resetOption1:"n",resetOption2:"N"},ut=function(e){(0,f.Z)(n,e);var t=(0,v.Z)(n);function n(){var e;return(0,u.Z)(this,n),(e=t.apply(this,arguments))._handles=new Ae.Z,e}return(0,c.Z)(n,[{key:"initialize",value:function(){var e=this,t=function(){var t;return null===(t=e.view)||void 0===t?void 0:t.ready};this._handles.add([(0,T.gx)((function(){return!t()}),(function(){return e._disconnect()})),(0,T.gx)(t,(function(){return e._connect()}))])}},{key:"destroy",value:function(){this._handles=(0,x.SC)(this._handles),this._disconnect()}},{key:"latestPointerType",get:function(){var e;return null===(e=this._inputManager)||void 0===e?void 0:e.latestPointerType}},{key:"latestPointerLocation",get:function(){var e;return null===(e=this._inputManager)||void 0===e?void 0:e.latestPointerLocation}},{key:"multiTouchActive",get:function(){var e,t;return null!==(e=null===(t=this._inputManager)||void 0===t?void 0:t.multiTouchActive)&&void 0!==e&&e}},{key:"_disconnect",value:function(){this.view.viewEvents.disconnect(),this._inputManager=(0,x.SC)(this._inputManager)}},{key:"_connect",value:function(){var e=this,t=this.view.surface,n=new Ye.z(t,this.view.input),i=[new it.y,new rt.e,new $e.y,new nt.n(this.view.navigation),new tt],r=new Ke.$({eventSource:n,recognizers:i});r.installHandlers("prevent-context-menu",[new Qe.G],Ke.f.INTERNAL),r.installHandlers("navigation",[new He(this.view),new Ne(this.view),new je(this.view),new Le(this.view),new Le(this.view,[at]),new Ve(this.view,"primary"),new qe(this.view,ot),new We(this.view,st),new Ue(this.view,lt),new Oe(this.view,"secondary"),new Ee(this.view,"touch")],Ke.f.INTERNAL),this.view.viewEvents.connect(r),this._source=n,this._inputManager=r,(0,T.YP)((function(){var t,n;return null===(t=e.view)||void 0===t||null===(n=t.navigation)||void 0===n?void 0:n.browserTouchPanEnabled}),(function(t){e._source&&(e._source.browserTouchPanningEnabled=!t)}),T.nn)}},{key:"test",get:function(){return{inputManager:this._inputManager}}}]),n}(U.Z);(0,g._)([(0,P.Cb)()],ut.prototype,"view",void 0),(0,g._)([(0,P.Cb)()],ut.prototype,"latestPointerType",null),(0,g._)([(0,P.Cb)()],ut.prototype,"latestPointerLocation",null),(0,g._)([(0,P.Cb)()],ut.prototype,"multiTouchActive",null);var ct=ut=(0,g._)([(0,L.j)("esri.views.2d.input.MapViewInputManager")],ut),dt=n(15960),pt=n(64634),ht=n(84786);var ft=n(7796),vt=n(72612),yt=n(87770),gt=function(e){(0,f.Z)(n,e);var t=(0,v.Z)(n);function n(e){var i;return(0,u.Z)(this,n),(i=t.call(this,e)).components=["attribution","zoom"],i}return(0,c.Z)(n)}(n(41356).Z);(0,g._)([(0,P.Cb)()],gt.prototype,"components",void 0);var mt,_t,bt,wt,kt,Ct,Mt=gt=(0,g._)([(0,L.j)("esri.views.ui.2d.DefaultUI2D")],gt),Zt=n(53042);function xt(){return xt=(0,y.Z)((0,a.Z)().mark((function e(){var t,i,o,s,l,u,c,d,p;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([Promise.all([n.e(51378),n.e(62029),n.e(47428),n.e(60345)]).then(n.bind(n,60345)),Promise.all([n.e(51378),n.e(62029),n.e(33624),n.e(64542),n.e(98029),n.e(47428),n.e(9892),n.e(72878),n.e(9795),n.e(98991),n.e(7671),n.e(18016),n.e(99484),n.e(8131),n.e(483),n.e(46642),n.e(82022),n.e(64893),n.e(73789),n.e(49104),n.e(86401),n.e(59685)]).then(n.bind(n,61341))]);case 2:t=e.sent,i=(0,r.Z)(t,2),o=i[1],s=o.GraphicsView2D,l=o.GraphicContainer,u=o.LabelManager,c=o.MapViewNavigation,d=o.MagnifierView2D,p=o.Stage,_t=s,bt=l,wt=u,kt=c,Ct=d,mt=p;case 12:case"end":return e.stop()}}),e)}))),xt.apply(this,arguments)}var It=function(e){(0,f.Z)(n,e);var t=(0,v.Z)(n);function n(e){var i;return(0,u.Z)(this,n),(i=t.call(this,e))._magnifierView=null,i._stage=null,i._resolveWhenReady=[],i.rootLayerViews=new w.Z({getCollections:function(){var e,t;return[null===(e=i.basemapView)||void 0===e?void 0:e.baseLayerViews,i.layerViews,null===(t=i.basemapView)||void 0===t?void 0:t.referenceLayerViews]},getChildrenFunction:function(){return null}}),i.featuresTilingScheme=null,i.fullOpacity=1,i.graphicsView=null,i.labelManager=null,i.mapViewNavigation=null,i.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},i.rendering=!1,i.supersampleScreenshotsEnabled=!0,i.supportsGround=!1,i._stationaryTimer=null,i._gotoTask=null,i.frameTask=new J((0,d.Z)(i)),i._pePromise=null,i.floors=new b.Z,i.highlightOptions=new pt.Z,i.inputManager=new ct({view:(0,d.Z)(i)}),i.map=null,i.resizeAlign="center",i.spatialReferenceLocked=!1,i.timeline=new ht.T,i.type="2d",i.ui=new Mt,i._pixelFormat={flipY:!0,premultipliedAlpha:!0},i.constraints=new ke,i.padding={top:0,right:0,bottom:0,left:0},i.handles.add([(0,T.YP)((function(){return i.viewpoint}),(function(){i._lastStationaryEventTimestamp=performance.now(),i._flipStationary(160)}),T.Z_),i.on("resize",(function(e){return i._resizeHandler(e)})),(0,T.YP)((function(){var e;return null===(e=i.animationManager)||void 0===e?void 0:e.animation}),(function(e){i.animation=e}))]),(0,F.j2)(),i}return(0,c.Z)(n,[{key:"destroy",value:function(){this._set("preconditionsReady",!1),this._gotoTask=this.frameTask=null,this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}},{key:"graphicsTileStore",get:function(){return new dt.Z(this.featuresTilingScheme)}},{key:"initialExtentRequired",get:function(){var e,t=this.scale,n=this.constraints,i=this.center,r=this.viewpoint,a=this.extent,o=this.zoom;return!(this.map&&"initialViewProperties"in this.map&&null!==(e=this.map.initialViewProperties)&&void 0!==e&&e.viewpoint)&&!a&&(null!==n&&void 0!==n&&n.effectiveLODs||(o=-1),(!i||0===t&&-1===o)&&(!r||!(0,x.pC)(r.targetGeometry)||"extent"!==r.targetGeometry.type&&!r.scale))}},{key:"resourceManager",get:function(){return this._stage.resourceManager}},{key:"textureManager",get:function(){return this._stage.painter.textureManager}},{key:"_defaultsFromMapSettings",get:function(){return{required:{tileInfo:!0,heightModelInfo:!1,extent:!1},requiresExtentInSpatialReference:this.spatialReferenceLocked}}},{key:"_projectionEngineLoaded",get:function(){var e=this;return!!(0,V.kR)()||(this._pePromise||(this._pePromise=(0,V.zD)().finally((function(){e._pePromise=null}))),!1)}},{key:"typeSpecificPreconditionsReady",get:function(){var e=this._getDefaultViewpoint();if(!e)return!1;var t=this.spatialReference,n=(0,x.Wg)(e.targetGeometry);return!!(0,V.Up)(n.spatialReference,t)||this._projectionEngineLoaded}},{key:"animation",set:function(e){var t=this,n=this._get("animation");if(e!==n)if(n&&n.stop(),e&&!e.isFulfilled()){this._set("animation",e),this.frameTask.animationInProgress=!0;var i=function(){var n;e===t._get("animation")&&(t._set("animation",null),null!==(n=t.frameTask)&&void 0!==n&&n.requestFrame()),t.frameTask&&(t.frameTask.animationInProgress=!1)};e.when(i,i)}else this._set("animation",null)}},{key:"background",get:function(){return function(e){return"esri.WebMap"===(null===e||void 0===e?void 0:e.declaredClass)}(this.map)?this.map.initialViewProperties.background:null},set:function(e){this._override("background",e)}},{key:"center",get:function(){if(!this.ready)return this._get("center");var e=this.state.paddedViewState,t=e.center,n=e.spatialReference;return new R.Z({x:t[0],y:t[1],spatialReference:n})},set:function(e){if(null!=e){if(!this.ready)return this._set("center",e),void this.notifyChange("initialExtentRequired");var t;try{t=this._project(e,this.spatialReference)}catch(J){return void Z.Z.getLogger(this.declaredClass).error(new k.Z("mapview:invalid-center","could not project the value in the view's spatial reference",{input:e,error:J}))}var n=this.viewpoint;(0,H.o2)(n,n,t),this.viewpoint=n}}},{key:"constraints",set:function(e){var t=this,n=this._get("constraints");n&&(this.handles.remove("map-view-constraints"),n.destroy()),this._set("constraints",e),e&&(e.view=this,this.ready&&(this.state.viewpoint=e.fit(this.state.paddedViewState.viewpoint)),this.handles.add((0,T.YP)((function(){return e.version}),(function(){t.ready&&t.state&&(t.state.viewpoint=e.fit(t.state.paddedViewState.viewpoint))}),T.Z_),"map-view-constraints"))}},{key:"extent",get:function(){return this.ready?this.state.paddedViewState.extent.clone():this._get("extent")},set:function(e){if(null!=e)if(e.width&&e.height){if(!this.ready)return this._set("extent",e),this._set("center",null),this._set("viewpoint",null),this._set("scale",0),this._set("zoom",-1),void this.notifyChange("initialExtentRequired");var t;try{t=this._project(e,this.spatialReference)}catch(J){return void Z.Z.getLogger(this.declaredClass).error(new k.Z("mapview:invalid-extent","could not project the value in the view's spatial reference",{error:J}))}var n=this.viewpoint;(0,H.qf)(n,n,t,this.size,{constraints:this.constraints}),this.viewpoint=n}else Z.Z.getLogger(this.declaredClass).error(new k.Z("mapview:invalid-extent","invalid extent size"))}},{key:"padding",get:function(){return this.ready?this.state.padding:this._get("padding")},set:function(e){this.ready?(this.state.padding=e,this._set("padding",this.state.padding)):this._set("padding",e)}},{key:"resolution",get:function(){return this.state?this.state.resolution:0}},{key:"rotation",get:function(){return this.ready?this.state.rotation:this._get("rotation")},set:function(e){if(!isNaN(e))if(this.ready){var t=this.viewpoint;(0,H.YQ)(t,t,e),this.viewpoint=t}else this._set("rotation",e)}},{key:"scale",get:function(){return this.ready?this.state.scale:this._get("scale")},set:function(e){if(e&&!isNaN(e)){if(!this.ready){this._set("scale",e),this._set("zoom",-1);var t=this._get("extent");return t&&(this._set("extent",null),this._set("center",t.center)),void this.notifyChange("initialExtentRequired")}var n=this.viewpoint;(0,H.Hy)(n,n,e),this.viewpoint=n}}},{key:"stationary",get:function(){return!(this.animation||this.navigating||this.resizing||this._stationaryTimer)}},{key:"updating",get:function(){var e=!this.destroyed&&(!this.layerViewManager||!this.labelManager||!this.graphicsView||!0===this.layerViewManager.updating||!0===this.labelManager.updating||!0===this.graphicsView.updating||this.allLayerViews.some((function(e){return!e.destroyed&&!("layerViews"in e)&&!0===e.updating})));if((0,C.Z)("esri-2d-log-updating")){var t,n,i,r=this.allLayerViews.reduce((function(e,t){return(0,l.Z)((0,l.Z)({},e),{},(0,s.Z)({},t.layer.id,!t.destroyed&&!("layerViews"in t)&&t.updating))}),{});console.log("Updating MapView: ".concat(e,"\n-> Null LayerViewManager: ").concat(!this.layerViewManager,"\n-> Null LabelManager: ").concat(!this.labelManager,"\n-> Null GraphicsView: ").concat(!this.graphicsView,"\n-> layerViewManager.updating: ").concat(null===(t=this.layerViewManager)||void 0===t?void 0:t.updating,"\n-> labelManager.updating: ").concat(null===(n=this.labelManager)||void 0===n?void 0:n.updating,"\n-> graphicsView.updating: ").concat(null===(i=this.graphicsView)||void 0===i?void 0:i.updating,"\n-> allLayerViews: ").concat(JSON.stringify(r),"\n"))}return e}},{key:"viewpoint",get:function(){if(!this.ready)return this._get("viewpoint");var e=this.state.paddedViewState;return e&&e.viewpoint.clone()},set:function(e){if(null!=e){if(!this.ready)return this._set("viewpoint",e),this._set("extent",null),this._set("center",null),this._set("zoom",-1),this._set("scale",0),void this.notifyChange("initialExtentRequired");var t,n;try{t=this._project(e,this.spatialReference),!e.scale||isNaN(e.scale)?n=new k.Z("mapview:invalid-viewpoint","invalid scale value of ".concat(e.scale)):(0,x.Wi)(e.targetGeometry)&&(n=new k.Z("mapview:invalid-viewpoint","geometry not defined"))}catch(Le){n=new k.Z("mapview:invalid-viewpoint","could not project the value in the view's spatial reference",{error:Le})}if(n)Z.Z.getLogger(this.declaredClass).error(n);else{this._scaleBeforeChangingSpatialReference=null;var i=new _.Z({targetGeometry:new R.Z,scale:0,rotation:0});(0,H.JG)(i,t),this.constraints.constrain(i,this.state.paddedViewState.viewpoint),this.state.viewpoint=i,this.frameTask.requestFrame(),this._set("viewpoint",i)}}}},{key:"zoom",get:function(){return this.ready?this.constraints.scaleToZoom(this.scale):this._get("zoom")},set:function(e){if(null!=e){if(!this.ready){this._set("zoom",e),this._set("scale",0);var t=this._get("extent");return t&&(this._set("extent",null),this._set("center",t.center)),void this.notifyChange("initialExtentRequired")}if(this.constraints.effectiveLODs){var n=this.viewpoint;(0,H.Hy)(n,n,this.constraints.zoomToScale(e)),this.viewpoint=n,this._set("zoom",this.constraints.scaleToZoom(this.scale))}else this._set("zoom",-1)}}},{key:"navigating",get:function(){return!(!this.mapViewNavigation||!this.mapViewNavigation.interacting)}},{key:"goTo",value:function(e,t){var n=this;if(e)return this.animation&&(this.animation=null),this._createAnimation(),(0,T.N1)((function(){return n.ready}),t).then((function(){var i,r=(0,l.Z)({animate:!0},t),a=(0,H.Ue)(e,n);return null!==(i=n.animation)&&void 0!==i&&i.update(a),n._gotoTask={},r.animate?n._gotoAnimated(a,r):n._gotoImmediate(a,r)}));Z.Z.getLogger(this.declaredClass).error("#goTo()","target cannot be null or undefined")}},{key:"hitTest",value:function(){var e=(0,y.Z)((0,a.Z)().mark((function e(t,n){var i,r,s,l,u,c,d,p;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=(0,vt.Rw)(t)?(0,vt.s6)(this,t):t,this.ready&&!isNaN(i.x)&&!isNaN(i.y)){e.next=3;break}return e.abrupt("return",{screenPoint:i,results:[]});case 3:return r=new Set,s=!1,l=null,u=null,null!==n&&void 0!==n&&n.include?Ft(n.include,At(this,(function(e){return r.add(e)}),(function(e){l||(l=new Set),l.add(e)}),(function(e){return r.add(e)}),(function(){return s=!0}))):(s=!0,r=new Set(this.allLayerViews)),(null===n||void 0===n?void 0:n.exclude)&&Ft(n.exclude,At(this,(function(e){return r.delete(e)}),(function(e){u||(u=new Set),u.add(e)}))),c=this.allLayerViews.filter((function(e){return!e.suspended&&r.has(e)})).reverse(),d=this.toMap(i),e.t0=[],e.t1=(0,o.Z)(s?this.graphicsView.hitTest(d).map((function(e){return{type:"graphic",graphic:e,layer:null,mapPoint:d}})):[]),e.t2=o.Z,e.next=11,Promise.all(c.map((function(e){return e.hitTest(d,i)})).toArray());case 11:return e.t3=e.sent,e.t4=(0,e.t2)(e.t3),p=e.t0.concat.call(e.t0,e.t1,e.t4).filter(x.pC).flat().filter(x.pC),e.abrupt("return",(l&&(p=p.filter((function(e){var t;return!("graphic"in e)||!e.graphic||(null===(t=l)||void 0===t?void 0:t.has(St(e.graphic)))}))),u&&(p=p.filter((function(e){var t;return!("graphic"in e)||!e.graphic||(null===(t=u)||void 0===t?void 0:t.has(St(e.graphic)))}))),{screenPoint:i,results:p}));case 15:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"takeScreenshot",value:function(){var e=(0,y.Z)((0,a.Z)().mark((function e(t){var n,i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._createScreenshotPlan(t),e.next=3,this._stage.takeScreenshot(n);case 3:return i=e.sent,e.abrupt("return",(0,ft.cv)(i,{format:n.format,quality:n.quality,rotation:0,disableDecorations:!1},this._pixelFormat));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_takeScreenshot",value:function(){var e=(0,y.Z)((0,a.Z)().mark((function e(t){var n,i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._createScreenshotPlan(t),e.next=3,this._stage.takeScreenshot(n);case 3:return i=e.sent,e.abrupt("return",(0,ft.v8)(i,this._pixelFormat));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createScreenshotPlan",value:function(e){var t,n=this;e=null!==(t=e)&&void 0!==t?t:{};var i,r=this.supersampleScreenshotsEnabled?Math.min(4,(0,ft.RZ)(this.size,Math.min(4096,this._stage.context.parameters.maxTextureSize))):1;e.layers?(i=[],e.layers.forEach((function(e){var t=n.allLayerViews.find((function(t){return t.layer.id===e.id}));t&&"container"in t&&t.container&&i.push(t.container)}))):i=this._stage.children;var a=(0,ft.LI)(e.format,e.quality),o=a.format,s=a.quality;return function(e,t,n,i,r,a,o,s){e.ignorePadding&&(i={left:0,right:0,top:0,bottom:0});var l=null;null!=e.width&&null!=e.height?l=[e.width,e.height]:null==e.width&&null!=e.height?l=[e.height,e.height]:null!=e.width&&null==e.height?l=[e.width,e.width]:null==e.width&&null==e.height&&(l=null);var u,c,d=n[0]-(i.left+i.right),p=n[1]-(i.top+i.bottom),h=e.area||{x:0,y:0,width:d,height:p};if(l){var f=d/p,v=l[0]/l[1];if(v>f){var y=h.width/v;h={x:h.x,y:Math.round(h.y+(h.height-y)/2),width:h.width,height:Math.round(y)}}else{var g=h.height*v;h={x:Math.round(h.x+(h.width-g)/2),y:h.y,width:Math.round(g),height:h.height}}}else l=[h.width,h.height];return l[0]>h.width?(u=Math.min(l[0]/h.width,t),c=l[0]/h.width/u):(u=1,c=l[0]/h.width),{resolutionScale:u,cropArea:{x:Math.round((h.x+i.left)*u),y:Math.round((h.y+i.top)*u),width:Math.round(h.width*u),height:Math.round(h.height*u)},outputScale:c,format:r,quality:a,children:o,rotation:s}}(e,r,this.size,this.padding,o,s,i,e.rotation)}},{key:"test",get:function(){var e=this;return{takeScreenshot:function(t){return e._takeScreenshot(t)}}}},{key:"toMap",value:function(e){if(!this.ready)return null;var t=(0,vt.Rw)(e)?(0,vt.s6)(this,e):e,n=this.state.toMap([0,0],[t.x,t.y]),i=(0,r.Z)(n,2),a=i[0],o=i[1],s=this.spatialReference;return new R.Z({x:a,y:o,spatialReference:s})}},{key:"toScreen",value:function(e){if(!this.ready)return null;var t=this._project(e,this.spatialReference),n=[t.x,t.y];return this.state.toScreen(n,n),(0,S.vW)(n[0],n[1])}},{key:"on",value:function(e,t,i,r){return this.inputManager&&this.viewEvents.on(e,t,i,r)||(0,p.Z)((0,h.Z)(n.prototype),"on",this).call(this,e,t)}},{key:"hasEventListener",value:function(e){return(0,p.Z)((0,h.Z)(n.prototype),"hasEventListener",this).call(this,e)||this.viewEvents.hasHandler(e)}},{key:"whenLayerView",value:function(e){return(0,p.Z)((0,h.Z)(n.prototype),"whenLayerView",this).call(this,e)}},{key:"graphicChanged",value:function(e){this.graphicsView&&this.graphicsView.graphicUpdateHandler(e)}},{key:"whenReady",value:function(){var e=this;return new Promise((function(t){e.ready?t(e):e._resolveWhenReady.push(t)}))}},{key:"forceDOMReadyCycle",value:function(){this.forceReadyCycle()}},{key:"getDefaultSpatialReference",value:function(){var e,t,n;return this.map&&"initialViewProperties"in this.map&&(null===(e=this.map)||void 0===e||null===(t=e.initialViewProperties)||void 0===t?void 0:t.spatialReference)||(null===(n=this.defaultsFromMap)||void 0===n?void 0:n.spatialReference)||null}},{key:"hasLayerViewModule",value:function(e){return ie(e)}},{key:"importLayerView",value:function(e){return re(e)}},{key:"pixelSizeAt",value:function(){return this.ready?this.state.resolution:(Z.Z.getLogger(this.declaredClass).error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}},{key:"popupHitTest",value:function(e){var t=this;return this.hitTest(e).then((function(n){return(0,l.Z)((0,l.Z)({},n),{},{mapPoint:t.toMap(e)})}))}},{key:"requestUpdate",value:function(){this.ready&&this.frameTask.requestUpdate()}},{key:"validate",value:function(){var e=(0,yt.B)(this.type);return(0,C.Z)("safari")&&(0,C.Z)("safari")<9&&(e=new k.Z("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:(0,C.Z)("safari")})),(0,x.pC)(e)?(Z.Z.getLogger(this.declaredClass).warn("#validate()",e.message),Promise.reject(e)):function(){return xt.apply(this,arguments)}()}},{key:"_createAnimation",value:function(){return this.animation&&!this.animation.done||(this.animation=new q.Z),this.animation}},{key:"_cancellableGoTo",value:function(e,t,n){var i=this,r=function(){return e===i._gotoTask},a=n.then((function(){r()&&(i.animation=null)})).catch((function(e){throw r()&&(t&&!t.done&&(t.stop(),i.frameTask.animationInProgress=!1),i.animation=null),e})),o=new Promise((function(e){return e(a)}));return t.when().catch((function(){r()&&o.cancel&&o.cancel()})),o}},{key:"_gotoImmediate",value:function(e,t){var n=this,i=this._gotoTask,r=this.animation,a=e.then((function(e){if((0,I.k_)(t),i!==n._gotoTask)throw new k.Z("view:goto-interrupted","Goto was interrupted");n.viewpoint=r.target=e,r.finish()}));return this._cancellableGoTo(i,r,a)}},{key:"_flipStationary",value:function(e){var t=this;return null!==this._stationaryTimer||(this._stationaryTimer=setTimeout((function(){t._stationaryTimer=null;var e=performance.now()-t._lastStationaryEventTimestamp;e<160&&(t._stationaryTimer=t._flipStationary(e))}),e)),this._stationaryTimer}},{key:"_getDefaultViewpoint",value:function(){var e,t,n,i,r=this.constraints,a=this.initialExtent,o=this.map,s=this.padding,l=this.size;if(!r)return null;var u=o&&"initialViewProperties"in o?o.initialViewProperties:void 0,c={zoom:this._get("zoom"),scale:this._get("scale"),center:this._get("center"),extent:this._get("extent"),rotation:this._get("rotation"),viewpoint:this._get("viewpoint"),spatialReference:this._userSpatialReference};r.effectiveLODs?-1!==c.zoom&&(c.scale=r.zoomToScale(c.zoom)):c.zoom=-1;var d=null,p=null,h=0,f=c.viewpoint&&c.viewpoint.rotation,v=c.viewpoint&&c.viewpoint.targetGeometry;(0,x.pC)(v)&&("extent"===v.type?d=v:"point"===v.type&&(p=v,h=c.viewpoint.scale));var y=c.extent||d||(null===(e=(0,x.Wg)(null===u||void 0===u||null===(t=u.viewpoint)||void 0===t?void 0:t.targetGeometry))||void 0===e?void 0:e.extent)||a,g=c.center||p||(null===y||void 0===y?void 0:y.center),m=c.scale||h||(null===u||void 0===u||null===(n=u.viewpoint)||void 0===n?void 0:n.scale)||y&&(0,H.EK)(y,[l[0]-s.left-s.right,l[1]-s.top-s.bottom]),b=c.rotation||f||(null===u||void 0===u||null===(i=u.viewpoint)||void 0===i?void 0:i.rotation)||0;return g&&m?new _.Z({targetGeometry:g,scale:m,rotation:b}):null}},{key:"_gotoAnimated",value:function(e,t){var n=this,i=this._gotoTask,r=this.animation;if(!r)return Promise.resolve();var a=e.then((function(e){if((0,I.k_)(t),i!==n._gotoTask)throw new k.Z("view:goto-interrupted","Goto was interrupted");return r.update(e),n.animationManager.animate(r,n.viewpoint,t),r.when().then((function(){}),(function(){}))}));return this._cancellableGoTo(i,r,a)}},{key:"_project",value:function(e,t){var n,i=e&&e.targetGeometry||e;if(!t)return e;if(!i)return null;if(t.imageCoordinateSystem||null!==(n=i.spatialReference)&&void 0!==n&&n.imageCoordinateSystem)return e;if((0,O.fS)(t,i.spatialReference))return e;var r=(0,V.iV)(i,t);if(!r)throw new k.Z("mapview:projection-not-possible","projecting input geometry to target spatial reference returned a null value",{geometry:i,spatialReference:t});return function(e){return e&&"esri.Viewpoint"===e.declaredClass}(e)?(e.targetGeometry=r,e):r}},{key:"_resizeHandler",value:function(e){if(this.ready){var t=this.state,n=this.state.paddedViewState.viewpoint,i=this.state.paddedViewState.size.concat();t.size=[e.width,e.height],(0,H.SI)(n,n,i,this.state.paddedViewState.size,this.resizeAlign),n=this.constraints.constrain(n,void 0),this.state.viewpoint=n}}},{key:"_startup",value:function(){var e,t=this;this.timeline.begin("MapView Startup");var n=this._getDefaultViewpoint(),i=n.targetGeometry;try{this._project(n,this.spatialReference)}catch(Q){var r;Z.Z.getLogger(this.declaredClass).warn(new A.Z("mapview:startup-projection-error","projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.",{center:i.toJSON(),spatialReference:this.spatialReference,error:Q})),n.targetGeometry=(null===(r=this.defaultsFromMap.extent)||void 0===r?void 0:r.center)||new R.Z({x:0,y:0,spatialReference:this.spatialReference})}null!==(e=this.constraints)&&void 0!==e&&e.fit(n),this._set("state",new Te({padding:this._get("padding"),size:this.size,viewpoint:n})),this.graphics.owner=this;var a=new mt(this.surface,{canvas:this.renderCanvas,supersampleScreenshots:this.supersampleScreenshotsEnabled,contextOptions:{disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},renderingOptions:this.renderingOptions,timeline:this.timeline});this._stage=a,this._magnifierView=new Ct,this._magnifierView.magnifier=this.magnifier;var o=new wt({view:this});this._set("labelManager",o);var s=new Q({view:this});this._set("animationManager",s);var l=new kt({view:this,animationManager:s});this._set("mapViewNavigation",l),this._setupSpatialReferenceDependentProperties(),this.handles.add([this.rootLayerViews.on("change",(function(){return t._updateStageChildren()})),a.on("post-render",(function(){return t._set("rendering",a.renderRequested)})),a.on("will-render",(function(){return t._set("rendering",a.renderRequested)})),a.on("webgl-error",(function(e){return t.fatalError=e.error})),(0,T.YP)((function(){return t.stationary}),(function(e){return a.stationary=e}),T.tX),(0,T.YP)((function(){return t.background}),(function(e){a.background=e,t._magnifierView.background=e}),T.tX),(0,T.YP)((function(){return t.magnifier}),(function(e){return t._magnifierView.magnifier=e}),T.tX),(0,T.YP)((function(){return t.renderingOptions}),(function(e){return a.renderingOptions=e}),T.tX),(0,T.YP)((function(){return t.highlightOptions}),(function(e){return a.highlightOptions=e}),T.tX),(0,T.YP)((function(){return t.state.id}),(function(){return a.state=t.state}),T.tX)],"map-view"),this._updateStageChildren();var u=this._resolveWhenReady;this._resolveWhenReady=[],u.forEach((function(e){return e(t)})),this.timeline.end("MapView Startup"),this.frameTask&&this.frameTask.start(),this._set("ready",!0)}},{key:"_teardown",value:function(){this._destroySpatialReferenceDependentProperties(),this.handles.remove("map-view"),this.mapViewNavigation.destroy(),this._set("mapViewNavigation",null),this.animationManager.destroy(),this._set("animationManager",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._stage.destroy(),this._stage=null,this._set("graphicsView",null),this._magnifierView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,this.frameTask&&this.frameTask.stop(),this._stationaryTimer&&(clearTimeout(this._stationaryTimer),this._stationaryTimer=null),this._set("ready",!1);var e=this.state.paddedViewState,t=(0,r.Z)(e.center,2),n=t[0],i=t[1],a=e.spatialReference,o=e.rotation,s=e.scale,l=new R.Z({x:n,y:i,spatialReference:a});this._set("viewpoint",null),this._set("extent",null),this._set("center",l),this._set("zoom",-1),this._set("rotation",o),this._set("scale",s),this._set("spatialReference",a),this._set("state",null),this.animation=null}},{key:"_updateStageChildren",value:function(){var e=this;this._stage.removeAllChildren(),this.rootLayerViews.forEach((function(t){e._stage.addChild(t.container)}));var t=this.graphicsView;this._stage.addChild(t.container),this._stage.addChild(this._magnifierView)}},{key:"_setupSpatialReferenceDependentProperties",value:function(){var e=this,t=new Se.Z(D.Z.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set("featuresTilingScheme",t);var n=new _t({view:this,graphics:this.graphics,requestUpdateCallback:function(){return e.requestUpdate()},container:new bt(t)});this.frameTask.graphicsView=n,this._set("graphicsView",n)}},{key:"_destroySpatialReferenceDependentProperties",value:function(){var e=this.graphicsView;this._set("graphicsView",null),this.frameTask.graphicsView=null,e.destroy(),this._set("featuresTilingScheme",null)}},{key:"_spatialReferenceChanged",value:function(e){if(this.ready){this.frameTask.stop();var t,n=(0,i.Z)(this.allLayerViews);try{for(n.s();!(t=n.n()).done;){t.value.processDetach()}}catch(T){n.e(T)}finally{n.f()}this._destroySpatialReferenceDependentProperties();var a=this.state.paddedViewState.clone();if((0,x.Wi)(this._scaleBeforeChangingSpatialReference))this._scaleBeforeChangingSpatialReference=a.scale;else{var o=a.viewpoint.clone();o.scale=this._scaleBeforeChangingSpatialReference,a.viewpoint=o}var s=a.clone(),l=(0,r.Z)(a.center,2),u=l[0],c=l[1],d=null;try{d=this._project(new R.Z({x:u,y:c,spatialReference:a.spatialReference}),e)}catch(me){var p;(0,V.kR)()||Z.Z.getLogger(this.declaredClass).warn(new A.Z("mapview:spatial-reference-change","could not project the view's center to the new spatial reference",{center:null===(p=d)||void 0===p?void 0:p.toJSON(),spatialReference:e,error:me}))}d||(d=new R.Z({x:0,y:0,spatialReference:e}));var h=(0,H.o2)(new _.Z({targetGeometry:new R.Z,scale:0,rotation:0}),a.viewpoint,d);s.viewpoint=h;try{var f=[a.size[0]/2,a.size[1]/2],v=[f[0]+20,f[1]],y=a.toMap([0,0],v),g=this._project(new R.Z({x:y[0],y:y[1],spatialReference:a.spatialReference}),e),m=g.x,b=g.y;y[0]=m,y[1]=b,s.toScreen(y,y);var w=(0,H.dI)(f,y,v),k=Math.hypot(y[0]-f[0],y[1]-f[1])/20;!Number.isFinite(k)||Math.abs(k)>4?(h.rotation=0,h.targetGeometry=new R.Z({x:0,y:0,spatialReference:e})):(h.scale*=k,h.scale>(0,C.Z)("mapview-srswitch-adjust-rotation-scale-threshold")?h.rotation=0:h.rotation+=Number.isFinite(w)?w:0)}catch(S){}this._get("constraints").constrain(h,void 0),this._get("state").viewpoint=h,this._stage.state=this.state,this._setupSpatialReferenceDependentProperties();var M,I=(0,i.Z)(this.allLayerViews);try{for(I.s();!(M=I.n()).done;){M.value.processAttach()}}catch(T){I.e(T)}finally{I.f()}this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}}}]),n}((0,N.g)((0,z.f)((0,B.u)(G.Z))));It.type="2d",(0,g._)([(0,P.Cb)({readOnly:!0})],It.prototype,"animationManager",void 0),(0,g._)([(0,P.Cb)({constructOnly:!0})],It.prototype,"deactivatedWebGLExtensions",void 0),(0,g._)([(0,P.Cb)({constructOnly:!0})],It.prototype,"debugWebGLExtensions",void 0),(0,g._)([(0,P.Cb)({readOnly:!0})],It.prototype,"featuresTilingScheme",void 0),(0,g._)([(0,P.Cb)({readOnly:!0})],It.prototype,"fullOpacity",void 0),(0,g._)([(0,P.Cb)({readOnly:!0})],It.prototype,"graphicsTileStore",null),(0,g._)([(0,P.Cb)()],It.prototype,"graphicsView",void 0),(0,g._)([(0,P.Cb)({readOnly:!0})],It.prototype,"state",void 0),(0,g._)([(0,P.Cb)()],It.prototype,"initialExtentRequired",null),(0,g._)([(0,P.Cb)()],It.prototype,"labelManager",void 0),(0,g._)([(0,P.Cb)({readOnly:!0})],It.prototype,"resourceManager",null),(0,g._)([(0,P.Cb)({readOnly:!0})],It.prototype,"textureManager",null),(0,g._)([(0,P.Cb)({readOnly:!0})],It.prototype,"mapViewNavigation",void 0),(0,g._)([(0,P.Cb)({constructOnly:!0})],It.prototype,"renderCanvas",void 0),(0,g._)([(0,P.Cb)()],It.prototype,"renderingOptions",void 0),(0,g._)([(0,P.Cb)({readOnly:!0})],It.prototype,"rendering",void 0),(0,g._)([(0,P.Cb)({constructOnly:!0})],It.prototype,"supersampleScreenshotsEnabled",void 0),(0,g._)([(0,P.Cb)({readOnly:!0})],It.prototype,"supportsGround",void 0),(0,g._)([(0,P.Cb)()],It.prototype,"_stationaryTimer",void 0),(0,g._)([(0,P.Cb)()],It.prototype,"_defaultsFromMapSettings",null),(0,g._)([(0,P.Cb)()],It.prototype,"_pePromise",void 0),(0,g._)([(0,P.Cb)({readOnly:!0})],It.prototype,"typeSpecificPreconditionsReady",null),(0,g._)([(0,P.Cb)()],It.prototype,"animation",null),(0,g._)([(0,P.Cb)({type:Zt.Z})],It.prototype,"background",null),(0,g._)([(0,P.Cb)({value:null,type:R.Z,dependsOn:["state.id","ready"]})],It.prototype,"center",null),(0,g._)([(0,P.Cb)({type:ke})],It.prototype,"constraints",null),(0,g._)([(0,P.Cb)({value:null,type:E.Z,dependsOn:["state.id","ready"]})],It.prototype,"extent",null),(0,g._)([(0,P.Cb)()],It.prototype,"floors",void 0),(0,g._)([(0,P.Cb)({type:pt.Z})],It.prototype,"highlightOptions",void 0),(0,g._)([(0,P.Cb)({readOnly:!0})],It.prototype,"inputManager",void 0),(0,g._)([(0,P.Cb)()],It.prototype,"map",void 0),(0,g._)([(0,P.Cb)({value:{top:0,right:0,bottom:0,left:0},cast:function(e){return(0,l.Z)({top:0,right:0,bottom:0,left:0},e)}})],It.prototype,"padding",null),(0,g._)([(0,P.Cb)()],It.prototype,"resizeAlign",void 0),(0,g._)([(0,P.Cb)({readOnly:!0,dependsOn:["state.id"]})],It.prototype,"resolution",null),(0,g._)([(0,P.Cb)({value:0,type:Number,dependsOn:["state.id","ready"]})],It.prototype,"rotation",null),(0,g._)([(0,P.Cb)({value:0,type:Number,dependsOn:["state.id","ready"]})],It.prototype,"scale",null),(0,g._)([(0,P.Cb)({constructOnly:!0})],It.prototype,"spatialReferenceLocked",void 0),(0,g._)([(0,P.Cb)()],It.prototype,"stationary",null),(0,g._)([(0,P.Cb)({type:ht.T,readOnly:!0})],It.prototype,"timeline",void 0),(0,g._)([(0,P.Cb)({readOnly:!0})],It.prototype,"type",void 0),(0,g._)([(0,P.Cb)({readOnly:!0})],It.prototype,"updating",null),(0,g._)([(0,P.Cb)({value:null,type:_.Z,dependsOn:["state.id","ready"]})],It.prototype,"viewpoint",null),(0,g._)([(0,P.Cb)({value:-1,dependsOn:["state.id","ready"]})],It.prototype,"zoom",null),(0,g._)([(0,P.Cb)({readOnly:!0})],It.prototype,"navigating",null),(0,g._)([(0,P.Cb)({type:Mt})],It.prototype,"ui",void 0);var Tt=It=(0,g._)([(0,L.j)("esri.views.MapView")],It);function St(e){var t,n,i,r,a=e.getObjectId();return a?"".concat(null!==(t=null!==(n=null===(i=e.layer)||void 0===i?void 0:i.uid)&&void 0!==n?n:null===(r=e.sourceLayer)||void 0===r?void 0:r.uid)&&void 0!==t?t:"MapView","/").concat(a):'"MapView/'.concat(e.uid)}function At(e,t,n,i,r){return function(a){if(a instanceof m.Z){if(a.layer===e)null===r||void 0===r||r();else{var o=e.allLayerViews.find((function(e){return e.layer===a.layer}));o&&(null===i||void 0===i||i(o))}n(St(a))}else{var s=e.allLayerViews.find((function(e){return e.layer===a}));s&&t(s)}}}function Ft(e,t){if(e)if((0,M.TW)(e)){var n,r=(0,i.Z)(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;if((0,M.TW)(a)){var o,s=(0,i.Z)(a);try{for(s.s();!(o=s.n()).done;){t(o.value)}}catch(l){s.e(l)}finally{s.f()}}else t(a)}}catch(l){r.e(l)}finally{r.f()}}else t(e)}},28435:function(e,t,n){n.d(t,{u:function(){return v}});var i=n(37762),r=n(74165),a=n(93433),o=n(15861),s=n(15671),l=n(43144),u=n(60136),c=n(92572),d=n(27366),p=n(92026),h=n(66978),f=(n(32718),n(25243),n(63780),n(10064),n(93169),n(69912)),v=function(e){var t=function(e){(0,u.Z)(n,e);var t=(0,c.Z)(n);function n(){return(0,s.Z)(this,n),t.apply(this,arguments)}return(0,l.Z)(n,[{key:"fetchPopupFeatures",value:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t,n){var i,o,s,l,u,c,d,p;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.when();case 2:return e.next=4,this._prepareFetchPopupFeatures(t,n);case 4:return i=e.sent,o=i.location,s=i.queryArea,l=i.layerViewsAndGraphics,u=i.clientOnlyGraphics,c=Promise.resolve(u),d=this._queryLayerPopupFeatures(s,l,n),p=d.map((function(e){return e.promise})),e.abrupt("return",{location:o,clientOnlyGraphics:u,allGraphicsPromise:(0,h.WW)([c].concat((0,a.Z)(p))).then((function(e){return Array.from(new Set(e.flat()))})),promisesPerLayerView:d});case 13:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_queryLayerPopupFeatures",value:function(e,t,n){return t.map((function(t){var i=t.layerView,r={clientGraphics:t.graphics,event:(0,p.pC)(n)?n.event:void 0,signal:(0,p.pC)(n)?n.signal:void 0,defaultPopupTemplateEnabled:!!(0,p.pC)(n)&&!!n.defaultPopupTemplateEnabled},a=i.fetchPopupFeatures(e,r);return{layerView:i,promise:a}}))}},{key:"_isValidPopupGraphic",value:function(e,t){return e&&!!e.getEffectivePopupTemplate((0,p.pC)(t)&&t.defaultPopupTemplateEnabled)}},{key:"_prepareFetchPopupFeatures",value:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t,n){var i,a,o,s,l,u,c,d;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._popupHitTestGraphics(t,n);case 2:return i=e.sent,a=i.clientGraphics,o=i.queryArea,s=i.location,l=this._getFetchPopupLayerViews(),u=this._graphicsPerFetchPopupLayerView(a,l),c=u.layerViewsAndGraphics,d=u.clientOnlyGraphics,e.abrupt("return",{clientOnlyGraphics:d,layerViewsAndGraphics:c,queryArea:o,location:s});case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_popupHitTestGraphics",value:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t,n){var i,a,o,s,l,u=this;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.popupHitTest(t);case 2:return i=e.sent,a=i.results,o=i.mapPoint,s=a.filter((function(e){return"graphic"===e.type&&u._isValidPopupGraphic(e.graphic,n)})),l=s.length?s[0].mapPoint:null,e.abrupt("return",{clientGraphics:s.map((function(e){return e.graphic})),queryArea:o,location:o||l});case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_getFetchPopupLayerViews",value:function(){var e=this,t=[];return this.allLayerViews.forEach((function(n){e._isValidPopupLayerView(n)&&t.push(n)})),(0,p.pC)(this.graphicsView)&&this._isValidPopupLayerView(this.graphicsView)&&t.push(this.graphicsView),t.reverse()}},{key:"_isValidPopupLayerView",value:function(e){return(0,p.pC)(e)&&(!("layer"in e)||!e.suspended)&&"fetchPopupFeatures"in e}},{key:"_graphicsPerFetchPopupLayerView",value:function(e,t){var n,r=[],a=new Map,o=t.map((function(e){var t=[];return"layer"in e?a.set(e.layer,t):a.set(e.graphics,t),{layerView:e,graphics:t}})),s=(0,i.Z)(e);try{for(s.s();!(n=s.n()).done;){var l=n.value,u=a.get(l.layer)||a.get(l.sourceLayer)||null;u?u.push(l):r.push(l)}}catch(c){s.e(c)}finally{s.f()}return{layerViewsAndGraphics:o,clientOnlyGraphics:r}}}]),n}(e);return t=(0,d._)([(0,f.j)("esri.views.PopupView")],t)}},98921:function(e,t,n){n.d(t,{Z:function(){return Ve}});var i=n(74165),r=n(15861),a=n(1413),o=n(15671),s=n(43144),l=n(97326),u=n(11752),c=n(61120),d=n(60136),p=n(92572),h=n(27366),f=n(41649),v=n(62044),y=n(85015),g=n(14921),m=n(80987),_=n(77178),b=n(10064),w=n(91505),k=n(41691),C=n(42537),M=n(54472),Z=n(32718),x=n(92026),I=n(67426),T=n(66978),S=n(94172),A=n(49861),F=(n(25243),n(63780),n(69912)),P=n(68748),L=n(53866),E=n(90724),R=n(78952),V=n(92975),O=n(37319),D=n(78983),N=n(16354),z=function(e){(0,d.Z)(n,e);var t=(0,p.Z)(n);function n(e){var i;return(0,o.Z)(this,n),(i=t.call(this,e)).view=null,i.baseLayerViews=new m.Z,i.referenceLayerViews=new m.Z,i._loadingHandle=(0,S.YP)((function(){var e,t;return null===(e=i.view)||void 0===e||null===(t=e.map)||void 0===t?void 0:t.basemap}),(function(e){e&&e.load().catch((function(){}))}),S.nn),i}return(0,s.Z)(n,[{key:"destroy",value:function(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null)}},{key:"suspended",get:function(){return!this.view||this.view.suspended}},{key:"updating",get:function(){var e,t;if(this.view&&this.view.suspended)return!1;var n=null===(e=this.view)||void 0===e||null===(t=e.map)||void 0===t?void 0:t.basemap;return!!n&&!!n.loaded&&(this.baseLayerViews.some((function(e){return e.updating}))||this.referenceLayerViews.some((function(e){return e.updating})))}}]),n}(y.Z);(0,h._)([(0,A.Cb)({constructOnly:!0})],z.prototype,"view",void 0),(0,h._)([(0,A.Cb)({readOnly:!0})],z.prototype,"baseLayerViews",void 0),(0,h._)([(0,A.Cb)({readOnly:!0})],z.prototype,"referenceLayerViews",void 0),(0,h._)([(0,A.Cb)({readOnly:!0})],z.prototype,"suspended",null),(0,h._)([(0,A.Cb)({type:Boolean,readOnly:!0})],z.prototype,"updating",null),z=(0,h._)([(0,F.j)("esri.views.BasemapView")],z);var B=n(29439),G=n(37762),q=n(77427),U=n(99346),W=n(61826);var j=function(){function e(t,n,i){var r=this;(0,o.Z)(this,e),this.layer=t,this.view=n,this.layerViewImporter=i,this._controller=new AbortController,this._deferred=(0,T.dD)(),this._started=!1,this.done=!1,this.promise=this._deferred.promise,(0,T.fu)(this._controller.signal,(function(){var e=new b.Z("cancelled:layerview-create","layerview creation cancelled",{layer:t});r._deferred.reject(e)}))}return(0,s.Z)(e,[{key:"tryRecycle",value:function(e){var t=this;if(!this.done||!this.layerView||!function(e){return"tryRecycleWith"in e}(this.layerView))return null;for(var n=this.layer.type,i=this._controller.signal,r=function(r){var a=e[r];if(a.type!==n)return"continue";var o=t.layerView.tryRecycleWith(a,{signal:i});if(o){e.splice(r,1),t.layer=a;var s=t.layerView,l=s.view;return{v:(t.promise=Promise.race([o.then((function(){return(0,T.k_)(t._controller.signal),a.emit("layerview-destroy",{view:l,layerView:s}),l.emit("layerview-destroy",{view:l,layerView:s}),a.emit("layerview-create",{view:l,layerView:s}),l.emit("layerview-create",{view:l,layerView:s}),s})),new Promise((function(e,n){return(0,T.fu)(t._controller.signal,(function(){return n((0,T.zE)())}))}))]),t.promise)}}},a=0;a<e.length;a++){var o=r(a);if("continue"!==o&&"object"===typeof o)return o.v}return null}},{key:"destroy",value:function(){this._controller.abort();var e=this.layerView;if(e){var t=this.layer,n=this.view;t.emit("layerview-destroy",{view:n,layerView:e}),n.emit("layerview-destroy",{layer:t,layerView:e}),this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null}}},{key:"start",value:function(){var e=(0,r.Z)((0,i.Z)().mark((function e(){var t,n,r,a,o,s,l,u,c,d,p=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._started){e.next=2;break}return e.abrupt("return");case 2:return this._started=!0,t=this._controller.signal,n=this.layer,r=this.view,this._map=r.map,e.prev=5,e.next=8,n.load({signal:t});case 8:if(e.t0="prefetchResources"in n,!e.t0){e.next=12;break}return e.next=12,null===(a=n.prefetchResources)||void 0===a?void 0:a.call(n,{signal:t});case 12:if(!K(n)){e.next=18;break}return e.next=15,n.createLayerView(r,{signal:t});case 15:l=e.sent,e.next=24;break;case 18:if(this.layerViewImporter.hasLayerViewModule(n)){e.next=20;break}throw new b.Z("layer:view-not-supported","No layerview implementation was found");case 20:return e.next=22,this.layerViewImporter.importLayerView(n);case 22:c=e.sent,(0,T.k_)(t),l="default"in c?new c.default({layer:n,view:r}):new c({layer:n,view:r});case 24:return d=function(){u=(0,x.hw)(u),l.destroyed||l.destroy(),l.layer=null,l.parent=null,l.view=null,p.done=!0},u=(0,T.fu)(t,d),(0,T.k_)(t),e.prev=26,e.next=29,l.when();case 29:e.next=34;break;case 31:throw e.prev=31,e.t1=e.catch(26),d(),e.t1;case 34:if(null===(o=this._map)||void 0===o||null===(s=o.allLayers)||void 0===s?void 0:s.includes(n)){e.next=37;break}return e.abrupt("return",(d(),void this._deferred.reject(new b.Z("view:no-layerview-for-layer","The layer has been removed from the map",{layer:n}))));case 37:this.layerView=l,n.emit("layerview-create",{view:r,layerView:l}),r.emit("layerview-create",{layer:n,layerView:l}),this.done=!0,this._deferred.resolve(l),e.next=43;break;case 40:e.prev=40,e.t2=e.catch(5),n.emit("layerview-create-error",{view:r,error:e.t2}),r.emit("layerview-create-error",{layer:n,error:e.t2}),this.done=!0,this._deferred.reject(new b.Z("layerview:create-error","layerview creation failed",{layer:n,error:e.t2}));case 43:case"end":return e.stop()}}),e,this,[[5,40],[26,31]])})));return function(){return e.apply(this,arguments)}}()}]),e}(),H=function(e){(0,d.Z)(n,e);var t=(0,p.Z)(n);function n(e){var i;return(0,o.Z)(this,n),(i=t.call(this,e))._layerLayerViewInfoMap=new Map,i._recyclingInfoMap=new Map,i._watchUpdatingTracking=new W.t,i.supportsGround=!0,i._preloadLayerViewModules=function(){var e,t=null===(e=i.view.map)||void 0===e?void 0:e.allLayers;if(t){var n,r=(0,G.Z)(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;i.layerViewImporter.hasLayerViewModule(a)&&i.layerViewImporter.importLayerView(a)}}catch(o){r.e(o)}finally{r.f()}}},i._reschedule=function(){return(0,x.Wi)(i._workPromise)&&(i._workPromise=(0,T.dD)(),i._workPromise.promise.catch((function(){}))),i.removeHandles("reschedule"),i.addHandles((0,U.Os)(i._doWork),"reschedule"),i._workPromise.promise},i._doWork=function(){var e,t,n,r=i.view.map;if(i._map!==r&&(i.clear(),i._map=r),(0,x.Wi)(i._workPromise))i.notifyChange("updating");else{i.removeHandles("reschedule"),i.removeHandles("collection-change");var a,o=new Set,s=[],l=i.view.ready,u=function e(t){if(!(0,x.Wi)(t)){var n,r=(0,G.Z)(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a){o.add(a);var u=i._layerLayerViewInfoMap.get(a);u&&l?u.start():u||i._recyclingInfoMap.has(a)||s.push(a),"layers"in a&&a.layers&&e(a.layers)}}}catch(c){r.e(c)}finally{r.f()}}},c=(0,G.Z)(i._rootCollectionNames);try{for(c.s();!(a=c.n()).done;){var d=a.value;u(i.get(d))}}catch(M){c.e(M)}finally{c.f()}var p,h=(0,G.Z)(i._layerLayerViewInfoMap);try{var f=function(){var e=(0,B.Z)(p.value,2),t=e[0],n=e[1];if(!o.has(t)){i._layerLayerViewInfoMap.delete(n.layer);var r=n.tryRecycle(s);r?(i._recyclingInfoMap.set(n.layer,n),r.then((function(){i._recyclingInfoMap.delete(n.layer),i._layerLayerViewInfoMap.set(n.layer,n),i._reschedule()})).catch((function(){i._recyclingInfoMap.delete(n.layer),n.destroy(),i._reschedule()}))):n.destroy()}};for(h.s();!(p=h.n()).done;)f()}catch(M){h.e(M)}finally{h.f()}var v,y=(0,G.Z)(i._recyclingInfoMap);try{for(y.s();!(v=y.n()).done;){var g=(0,B.Z)(v.value,2),m=g[0],_=g[1];o.has(m)||(i._recyclingInfoMap.delete(_.layer),_.destroy())}}catch(M){y.e(M)}finally{y.f()}for(var b=0,w=s;b<w.length;b++){var k=w[b];i._createLayerView(k)}i._refreshCollections();var C=[null===r||void 0===r||null===(e=r.ground)||void 0===e?void 0:e.layers,null===r||void 0===r||null===(t=r.basemap)||void 0===t?void 0:t.baseLayers,null===r||void 0===r||null===(n=r.basemap)||void 0===n?void 0:n.referenceLayers,null===r||void 0===r?void 0:r.layers].filter((function(e){return!!e}));o.forEach((function(e){return"layers"in e&&C.push(e.layers)})),i.addHandles(C.map((function(e){return i._watchUpdatingTracking.addOnCollectionChange((function(){return e}),i._reschedule)})),"collection-change"),i._workPromise.resolve(),i._workPromise=null}},i}return(0,s.Z)(n,[{key:"initialize",value:function(){var e=this;this.own([(0,S.on)((function(){var t,n;return null===(t=e.view)||void 0===t||null===(n=t.map)||void 0===n?void 0:n.allLayers}),"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),(0,S.YP)((function(){var t=e.view,n=null===t||void 0===t?void 0:t.map;return[null===n||void 0===n?void 0:n.basemap,null===n||void 0===n?void 0:n.ground,null===n||void 0===n?void 0:n.layers,null===t||void 0===t?void 0:t.ready]}),(function(){return e._reschedule()}),S.tX)]),this._preloadLayerViewModules(),this._reschedule()}},{key:"destroy",value:function(){this.clear(),this._watchUpdatingTracking.destroy(),this._map=null,(0,x.pC)(this._workPromise)&&(this._workPromise.reject((0,T.zE)()),this._workPromise=null)}},{key:"_layersToLayerViews",get:function(){var e=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&e.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(e)}},{key:"_rootCollectionNames",get:function(){return Array.from(this._layersToLayerViews.keys())}},{key:"updating",get:function(){return(0,x.pC)(this._workPromise)||this._watchUpdatingTracking.updating||(0,q.oE)(this._layerLayerViewInfoMap,(function(e){return!e.done}))}},{key:"updatingRemaining",get:function(){var e,t=0,n=(0,G.Z)(this._layerLayerViewInfoMap.values());try{for(n.s();!(e=n.n()).done;){e.value.done||++t}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"clear",value:function(){if(!this.destroyed){var e,t=(0,G.Z)(this._layerLayerViewInfoMap.values());try{for(t.s();!(e=t.n()).done;){e.value.destroy()}}catch(n){t.e(n)}finally{t.f()}this._layerLayerViewInfoMap.clear(),this._refreshCollections()}}},{key:"whenLayerView",value:function(){var e=(0,r.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._reschedule();case 2:if(this._layerLayerViewInfoMap.has(t)){e.next=6;break}if(!this._recyclingInfoMap.has(t)){e.next=5;break}return e.abrupt("return",this._recyclingInfoMap.get(t).promise);case 5:throw new b.Z("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:t});case 6:return e.abrupt("return",this._layerLayerViewInfoMap.get(t).promise);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_refreshCollections",value:function(){var e,t=(0,G.Z)(this._layersToLayerViews);try{for(t.s();!(e=t.n()).done;){var n=(0,B.Z)(e.value,2),i=n[0],r=n[1];this._populateLayerViewsOwners(this.get(i),this.get(r),this.view)}}catch(a){t.e(a)}finally{t.f()}this.notifyChange("updating"),this.notifyChange("updatingRemaining")}},{key:"_populateLayerViewsOwners",value:function(e,t,n){if(e&&t){var i,r=0,a=(0,G.Z)(e);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=this._layerLayerViewInfoMap.get(o);if(s&&s.layerView){var l=s.layerView;l.layer=o,l.parent=n,t.getItemAt(r)!==l&&t.splice(r,0,l),o.layers&&this._populateLayerViewsOwners(o.layers,l.layerViews,l),r+=1}}}catch(u){a.e(u)}finally{a.f()}r<t.length&&t.splice(r,t.length)}else t&&t.removeAll()}},{key:"_createLayerView",value:function(e){var t=this;e.load().catch((function(){})),this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e);var n=new j(e,this.view,this.layerViewImporter);n.promise.then((function(){return t._refreshCollections()}),(function(n){var i,r;n&&((0,T.D_)(n)||"cancelled:layerview-create"===n.name)||Z.Z.getLogger(t.declaredClass).error("Failed to create layerview for layer title:'".concat(null!==(i=e.title)&&void 0!==i?i:"no title","', id:'").concat(null!==(r=e.id)&&void 0!==r?r:"no id","' of type '").concat(e.type,"'."),{layer:e,error:n}),t._refreshCollections()})),this._layerLayerViewInfoMap.set(e,n),this.view.ready&&n.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}}]),n}(y.Z);(0,h._)([(0,A.Cb)()],H.prototype,"_workPromise",void 0),(0,h._)([(0,A.Cb)({readOnly:!0})],H.prototype,"_watchUpdatingTracking",void 0),(0,h._)([(0,A.Cb)({readOnly:!0})],H.prototype,"_layersToLayerViews",null),(0,h._)([(0,A.Cb)({readOnly:!0})],H.prototype,"_rootCollectionNames",null),(0,h._)([(0,A.Cb)()],H.prototype,"layerViewImporter",void 0),(0,h._)([(0,A.Cb)()],H.prototype,"supportsGround",void 0),(0,h._)([(0,A.Cb)({readOnly:!0})],H.prototype,"updating",null),(0,h._)([(0,A.Cb)({readOnly:!0})],H.prototype,"updatingRemaining",null),(0,h._)([(0,A.Cb)({constructOnly:!0})],H.prototype,"view",void 0);var Y=H=(0,h._)([(0,F.j)("esri.views.LayerViewManager")],H);function K(e){return"createLayerView"in e&&null!=e.createLayerView}var Q=n(17842),J=function(e){(0,d.Z)(n,e);var t=(0,p.Z)(n);function n(e){var i;return(0,o.Z)(this,n),(i=t.call(this,e)).factor=1.5,i.offset=(0,Q.vW)(0,0),i.position=null,i.size=120,i.maskUrl=null,i.maskEnabled=!0,i.overlayUrl=null,i.overlayEnabled=!0,i.visible=!0,i}return(0,s.Z)(n,[{key:"version",get:function(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}}]),n}(y.Z);(0,h._)([(0,A.Cb)({type:Number})],J.prototype,"factor",void 0),(0,h._)([(0,A.Cb)({nonNullable:!0})],J.prototype,"offset",void 0),(0,h._)([(0,A.Cb)()],J.prototype,"position",void 0),(0,h._)([(0,A.Cb)({type:Number,range:{min:0}})],J.prototype,"size",void 0),(0,h._)([(0,A.Cb)()],J.prototype,"maskUrl",void 0),(0,h._)([(0,A.Cb)()],J.prototype,"maskEnabled",void 0),(0,h._)([(0,A.Cb)()],J.prototype,"overlayUrl",void 0),(0,h._)([(0,A.Cb)()],J.prototype,"overlayEnabled",void 0),(0,h._)([(0,A.Cb)({readOnly:!0})],J.prototype,"version",null),(0,h._)([(0,A.Cb)({type:Boolean})],J.prototype,"visible",void 0);var X=J=(0,h._)([(0,F.j)("esri.views.Magnifier")],J),$=n(93433),ee=(n(93169),n(84779)),te=n(1614),ne=n(84057),ie=n(99034);function re(e){return e.visible&&null!=e.getEditableFlag&&e.getEditableFlag(ie.bH.USER)&&e.getEditableFlag(ie.bH.MANAGER)}var ae=n(83704),oe=n(16889),se=n(72612),le=function(){function e(){(0,o.Z)(this,e),this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._revertToNullActiveTool=!1,this._cursor=null}return(0,s.Z)(e,[{key:"cursor",get:function(){return this._cursor}},{key:"handleInputEvent",value:function(e,t){var n=function(){return e.stopPropagation()};switch(e.type){case"pointer-move":ue(e.pointerType)&&this._pointerLocations.set(e.pointerId,{x:e.x,y:e.y,pointerType:e.pointerType});break;case"drag":this._grabbedManipulators.size>0&&(this._stopDrag=!0),this._stopDrag&&(n(),"end"===e.action&&(this._stopDrag=!1));break;case"pointer-down":if(!ce(e))break;var i=(0,se.vT)(e),r=this._intersect(i,e.pointerType,t.forEachTool);if((0,x.Wi)(r))break;var a=r.manipulator,o=r.tool;!((0,x.pC)(a)&&(0,x.pC)(o)&&a.interactive)||a.grabbable&&a.grabbableForEvent(e)||!a.grabbing||a.dragging||this._ungrabManipulatorBeforeDragging(a,e,t),(0,x.pC)(a)&&(0,x.pC)(o)&&a.interactive&&a.grabbable&&a.grabbableForEvent(e)&&!a.grabbing&&(this._grabbedManipulators.set(e.pointerId,{manipulator:a,tool:o,start:i,pointerType:e.pointerType}),1===this._grabbedManipulators.size&&(0,x.Wi)(t.activeTool)&&(this._revertToNullActiveTool=!0,t.setActiveTool(r.tool)),a.grabbing=!0,a.events.emit("grab-changed",{action:"start",pointerType:e.pointerType,screenPoint:i}),n());break;case"pointer-up":this._draggedManipulators.has(e.pointerId)||this._handlePointerEnd(e,t);break;case"pointer-drag":if(!ce(e))break;var s=this._grabbedManipulators.get(e.pointerId),l=(0,x.yw)(s,(function(e){return e.manipulator})),u=(0,x.yw)(s,(function(e){return e.tool}));if((0,x.Wi)(l)||(0,x.Wi)(u))break;var c=(0,se.vT)(e);c.x=(0,oe.uZ)(c.x,0,t.view.width),c.y=(0,oe.uZ)(c.y,0,t.view.height);var d=(0,x.Wg)(s).start,p=this._draggedManipulators.get(e.pointerId);switch(e.action){case"start":case"update":"update"!==e.action&&1!==this._grabbedManipulators.size||(l.dragging=!0,p?l.events.emit("drag",{action:"update",start:d,screenPoint:c}):l.events.emit("drag",{action:"start",start:d,screenPoint:c,pointerType:e.pointerType}),this._draggedManipulators.set(e.pointerId,{tool:u,manipulator:l,start:d}));break;case"end":l.dragging=!1,p&&l.events.emit("drag",{action:"end",start:d,screenPoint:c}),this._draggedManipulators.delete(e.pointerId),this._handlePointerEnd(e,t)}n();break;case"immediate-click":var h=(0,se.vT)(e),f=this._intersect(h,e.pointerType,t.forEachTool);if(function(e){return!!e.native.shiftKey}(e)||t.forEachTool((function(e){if((!(0,x.pC)(f)||f.tool!==e||e.automaticManipulatorSelection)&&e.manipulators){var t=!1;e.manipulators.forEach((function(e){var n=e.manipulator;n.selected&&(n.selected=!1,t=!0)})),t&&e.onManipulatorSelectionChanged&&e.onManipulatorSelectionChanged()}})),(0,x.Wi)(f))break;var v=f.manipulator,y=f.tool;if(!v.interactive)break;v.selectable&&y.automaticManipulatorSelection&&(v.selected=!v.selected,y.onManipulatorSelectionChanged&&y.onManipulatorSelectionChanged());var g=e.native.shiftKey;v.events.emit("immediate-click",{screenPoint:h,button:e.button,pointerType:e.pointerType,shiftKey:g,stopPropagation:n});break;case"click":var m=(0,se.vT)(e),_=this._intersect(m,e.pointerType,t.forEachTool),b=(0,x.pC)(_)?_.manipulator:null;if((0,x.Wi)(b)||!b.interactive)break;var w=e.native.shiftKey;b.events.emit(e.type,{screenPoint:m,button:e.button,pointerType:e.pointerType,shiftKey:w}),n();break;case"double-click":var k=(0,se.vT)(e),C=this._intersect(k,e.pointerType,t.forEachTool),M=(0,x.pC)(C)?C.manipulator:null;if((0,x.Wi)(M)||!M.interactive)break;var Z=e.native.shiftKey;M.events.emit("double-click",{screenPoint:k,button:e.button,pointerType:e.pointerType,shiftKey:Z,stopPropagation:n});break;case"immediate-double-click":var I=(0,se.vT)(e),T=this._intersect(I,e.pointerType,t.forEachTool),S=(0,x.pC)(T)?T.manipulator:null;if((0,x.Wi)(S)||!S.interactive)break;var A=e.native.shiftKey;S.events.emit("immediate-double-click",{screenPoint:I,button:e.button,pointerType:e.pointerType,shiftKey:A,stopPropagation:n})}this._onFocusChange(t.forEachTool)}},{key:"_ungrabManipulatorBeforeDragging",value:function(e,t,n){var i=this;e.grabbing=!1,e.events.emit("grab-changed",{action:"end",pointerType:t.pointerType,screenPoint:(0,se.vT)(t)}),this._grabbedManipulators.forEach((function(t,n){t.manipulator===e&&i._grabbedManipulators.delete(n)})),this._afterManipulatorUngrab(n.setActiveTool)}},{key:"_handlePointerEnd",value:function(e,t){var n=(0,x.yw)(this._grabbedManipulators.get(e.pointerId),(function(e){return e.manipulator}));(0,x.Wi)(n)||n.grabbing&&(n.grabbing=!1,n.events.emit("grab-changed",{action:"end",pointerType:e.pointerType,screenPoint:(0,se.vT)(e)}),this._grabbedManipulators.delete(e.pointerId),this._afterManipulatorUngrab(t.setActiveTool))}},{key:"_cursorFromMap",value:function(e){var t=null;return(0,q.oE)(e,(function(e){var n=e.manipulator;return!((0,x.Wi)(n)||!n.interactive)&&(n.grabbing&&n.grabCursor?(t=n.grabCursor,!0):!!n.cursor&&(t=n.cursor,!0))})),t}},{key:"_onFocusChange",value:function(e){this._updateCursor(),this._updateFocusedManipulatorTools(e)}},{key:"_updateCursor",value:function(){this._grabbedManipulators.size>0?this._cursor=this._cursorFromMap(this._grabbedManipulators)||"grabbing":this._hoveredManipulators.size>0?this._cursor=this._cursorFromMap(this._hoveredManipulators)||"pointer":this._cursor=null}},{key:"_updateFocusedManipulatorTools",value:function(e){var t=this,n=new Set,i=new Set;this._grabbedManipulators.forEach((function(e){var t=e.tool;n.add(t)})),this._hoveredManipulators.forEach((function(e){var t=e.tool;i.add(t)})),e((function(e){e.hasGrabbedManipulators=n.has(e),e.hasHoveredManipulators=i.has(e);var r=t._grabbedManipulators.values(),a=(0,ae.sE)(r,(function(t){return t.tool===e}));e.firstGrabbedManipulator=(0,x.pC)(a)?a.manipulator:null}))}},{key:"clearPointers",value:function(e,t){var n=this,i=t.forEachTool,r=t.setActiveTool,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=arguments.length>3?arguments[3]:void 0,s=function(t,n){return t===e&&((0,x.Wi)(o)||o===n)};this._grabbedManipulators.forEach((function(e,t){var i=e.tool,r=e.manipulator,a=e.pointerType;s(i,r)&&(n._grabbedManipulators.delete(t),r.grabbing=!1,r.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:a}))})),this._draggedManipulators.forEach((function(e,t){var i=e.tool,r=e.manipulator;s(i,r)&&(n._draggedManipulators.delete(t),r.dragging=!1,r.events.emit("drag",{action:"cancel"}))})),a&&this._hoveredManipulators.forEach((function(e,t){var i=e.tool,r=e.manipulator;s(i,r)&&(n._hoveredManipulators.delete(t),r.hovering=!1)})),this._afterManipulatorUngrab(r),this._onFocusChange(i)}},{key:"_intersect",value:function(e,t,n){var i=null;return n((function(n){if(null==n.manipulators||!re(n))return!1;var r=n.manipulators.intersect(e,t);return!(0,x.Wi)(r)&&(i={tool:n,manipulator:r},!0)})),i}},{key:"updateHoveredStateFromKnownPointers",value:function(e){var t=this;this._pointerLocations.forEach((function(n,i){t._updateHoveredStateForPointerAtScreenPosition((0,Q.vW)(n.x,n.y),i,n.pointerType,e)}))}},{key:"handleHoverEvent",value:function(e,t){"pointer-up"!==e.type&&"immediate-click"!==e.type&&"pointer-move"!==e.type||!ue(e.pointerType)||this._updateHoveredStateForPointerAtScreenPosition((0,se.vT)(e),e.pointerId,e.pointerType,t)}},{key:"_updateHoveredStateForPointerAtScreenPosition",value:function(e,t,n,i){var r=this._intersect(e,n,i),a=(0,x.yw)(this._hoveredManipulators.get(t),(function(e){return e.manipulator}));(0,x.pC)(r)&&!r.manipulator.interactive&&(r=null),(0,x.pC)(r)&&a===r.manipulator||((0,x.pC)(a)&&(a.hovering=!1),(0,x.pC)(r)?(r.manipulator.hovering=!0,this._hoveredManipulators.set(t,r)):this._hoveredManipulators.delete(t),this._onFocusChange(i))}},{key:"_afterManipulatorUngrab",value:function(e){0===this._grabbedManipulators.size&&this._revertToNullActiveTool&&(e(null),this._revertToNullActiveTool=!1)}}]),e}();function ue(e){return"mouse"===e}function ce(e){return"mouse"!==e.pointerType||0===e.button}var de="attached",pe="tools",he=function(e){(0,d.Z)(n,e);var t=(0,p.Z)(n);function n(e){var i;return(0,o.Z)(this,n),(i=t.call(this,e))._manipulatorState=new le,i.tools=new m.Z,i.cursor=null,i._forEachTool=function(e){var t,n=(0,G.Z)(i.tools.items);try{for(n.s();!(t=n.n()).done;){if(e(t.value))return}}catch(r){n.e(r)}finally{n.f()}},i}return(0,s.Z)(n,[{key:"initialize",value:function(){var e,t=this;this.handles.add([this.view.on(ne.uS,(function(e){t._handleInputEvent(e)}),te.f.TOOL)].concat((0,$.Z)([(e=this.tools).on("before-add",(function(t){var n=t.item;if(null==n||e.includes(n))return Z.Z.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void t.preventDefault();n.onAdd()})),e.on("after-remove",(function(e){var t=e.item;t.active&&(t.view.activeTool=null),t.destroy()}))]),[this.tools.on("before-add",(function(e){var n=e.item;t._updateToolEditableFlag(n)})),this.tools.on("before-remove",(function(e){var n=e.item;t._manipulatorState.clearPointers(n,t._manipulatorStateEventArgs),t._updateCursor()})),this.tools.on("change",(function(){t._refreshToolWatchers()}))]))}},{key:"destroy",value:function(){this.detach(),this.handles.removeAll()}},{key:"_manipulatorStateEventArgs",get:function(){var e=this;return{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:function(t){e.activeTool=t},view:this.view}}},{key:"activeTool",set:function(e){if(!(0,x.pC)(e)||this.view.ready){if(e!==this.activeTool){var t=this.activeTool;this._set("activeTool",e),(0,x.pC)(t)&&t.deactivate(),(0,x.pC)(e)&&e.activate(),this._removeIncompleteTools(e);var n,i=(0,G.Z)(this.tools);try{for(i.s();!(n=i.n()).done;){var r=n.value;this._updateToolEditableFlag(r);var a=re(r);!(0,x.Wi)(this.activeTool)&&a||this._manipulatorState.clearPointers(r,this._manipulatorStateEventArgs,!a)}}catch(o){i.e(o)}finally{i.f()}this._updateCursor()}}else Z.Z.getLogger(this.declaredClass).error("Cannot set active tool while view is not ready.")}},{key:"updating",get:function(){var e,t;return this.updatingHandles.updating||this.tools.some((function(e){return e.updating}))||null!==(e=null===(t=this.textures)||void 0===t?void 0:t.updating)&&void 0!==e&&e}},{key:"attach",value:function(){var e,t=this;"3d"===this.view.type?(this._set("textures",new ee.G(this.view._stage,this.view.resourceController.scheduler)),this.handles.add([(0,S.YP)((function(){var e=t.view.state;return"camera"in e&&e.camera}),(function(){return t._forEachManipulator((function(e){return e.onViewChange()}))})),null===(e=this.view.elevationProvider)||void 0===e?void 0:e.on("elevation-change",(function(e){return t._forEachManipulator((function(t){return t.onElevationChange(e)}))})),(0,C.kB)((function(){return t._set("textures",(0,x.SC)(t.textures))}))],de)):this.handles.add((0,S.YP)((function(){return t.view.extent}),(function(){return t._forEachManipulator((function(e){return e.onViewChange()}))})))}},{key:"detach",value:function(){(0,x.pC)(this.activeTool)&&(this.activeTool=null),this.tools.removeAll(),this.handles.remove(de)}},{key:"_forEachManipulator",value:function(e){this._forEachTool((function(t){t.manipulators&&t.manipulators.forEach((function(n){var i=n.manipulator;return e(i,t)}))}))}},{key:"_handleInputEvent",value:function(e){var t=!1,n=(0,a.Z)((0,a.Z)({},e),{},{stopPropagation:function(){t=!0,e.stopPropagation()}});(0,x.pC)(this.activeTool)?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(n):this._forEachTool((function(e){!t&&e.visible&&e.handleInputEvent(n)})),!t&&"key-down"===e.type&&"Escape"===e.key&&this.activeTool&&(e.stopPropagation(),this.activeTool=null),this._manipulatorState.handleInputEvent(n,this._manipulatorStateEventArgs),!t&&(0,x.pC)(this.activeTool)&&this.activeTool.handleInputEventAfter(n),this._manipulatorState.handleHoverEvent(n,this._forEachTool),this._updateCursor()}},{key:"_refreshToolWatchers",value:function(){var e=this;this.handles.remove(pe),this._forEachTool((function(t){if(t instanceof y.Z){var n=(0,S.YP)((function(){return[t.cursor,t.visible,t.editable]}),(function(){re(t)||e._manipulatorState.clearPointers(t,e._manipulatorStateEventArgs),e._updateCursor()}));e.handles.add(n,pe)}t.manipulators&&e.handles.add([t.manipulators.on("after-remove",(function(n){e._manipulatorState.clearPointers(t,e._manipulatorStateEventArgs,!0,n.item.manipulator)})),t.manipulators.on("change",(function(){e._manipulatorState.updateHoveredStateFromKnownPointers(e._forEachTool),e._updateCursor()}))],pe)})),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}},{key:"_updateToolEditableFlag",value:function(e){var t;null===(t=e.setEditableFlag)||void 0===t||t.call(e,ie.bH.MANAGER,(0,x.Wi)(this.activeTool)||e===this.activeTool)}},{key:"_updateCursor",value:function(){var e=this._manipulatorState.cursor;(0,x.Wi)(e)&&this._forEachTool((function(t){return!(!(0,x.pC)(t.cursor)||!t.visible)&&(e=t.cursor,!0)})),this._get("cursor")!==e&&this._set("cursor",e)}},{key:"_removeIncompleteTools",value:function(e){var t=this;this.tools.filter((function(t){return((0,x.Wi)(e)||t!==e)&&!t.created&&t.removeIncompleteOnCancel})).forEach((function(e){t.tools.remove(e)}))}}]),n}(k.r);(0,h._)([(0,A.Cb)({constructOnly:!0,nonNullable:!0})],he.prototype,"view",void 0),(0,h._)([(0,A.Cb)({readOnly:!0,nonNullable:!0})],he.prototype,"textures",void 0),(0,h._)([(0,A.Cb)({value:null})],he.prototype,"activeTool",null),(0,h._)([(0,A.Cb)({readOnly:!0,type:m.Z})],he.prototype,"tools",void 0),(0,h._)([(0,A.Cb)({readOnly:!0})],he.prototype,"cursor",void 0),(0,h._)([(0,A.Cb)({readOnly:!0})],he.prototype,"updating",null);var fe=he=(0,h._)([(0,F.j)("esri.views.ToolViewManager")],he),ve=n(5977),ye=function(e){(0,d.Z)(n,e);var t=(0,p.Z)(n);function n(){var e;(0,o.Z)(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).devices=new m.Z,e.enabledFocusMode="document",e}return(0,s.Z)(n)}(y.Z);(0,h._)([(0,A.Cb)({type:m.Z.ofType(ve.Z),readOnly:!0})],ye.prototype,"devices",void 0),(0,h._)([(0,A.Cb)({type:["document","view","none"]})],ye.prototype,"enabledFocusMode",void 0);var ge=ye=(0,h._)([(0,F.j)("esri.views.input.gamepad.GamepadSettings")],ye),me=function(e){(0,d.Z)(n,e);var t=(0,p.Z)(n);function n(){var e;return(0,o.Z)(this,n),(e=t.apply(this,arguments)).gamepad=new ge,e}return(0,s.Z)(n)}(y.Z);(0,h._)([(0,A.Cb)({readOnly:!0})],me.prototype,"gamepad",void 0);var _e=me=(0,h._)([(0,F.j)("esri.views.input.Input")],me),be=function(e){(0,d.Z)(n,e);var t=(0,p.Z)(n);function n(e){var i;return(0,o.Z)(this,n),(i=t.call(this,e)).enabled=!0,i.device=null,i.mode="pan",i.tiltDirection="forward-down",i.velocityFactor=1,i}return(0,s.Z)(n)}(y.Z);(0,h._)([(0,A.Cb)({type:Boolean,nonNullable:!0})],be.prototype,"enabled",void 0),(0,h._)([(0,A.Cb)({type:ve.Z})],be.prototype,"device",void 0),(0,h._)([(0,A.Cb)({type:["pan","zoom"],nonNullable:!0})],be.prototype,"mode",void 0),(0,h._)([(0,A.Cb)({type:["forward-down","forward-up"],nonNullable:!0})],be.prototype,"tiltDirection",void 0),(0,h._)([(0,A.Cb)({type:Number,nonNullable:!0})],be.prototype,"velocityFactor",void 0);var we=be=(0,h._)([(0,F.j)("esri.views.navigation.gamepad.GamepadSettings")],be),ke=function(e){(0,d.Z)(n,e);var t=(0,p.Z)(n);function n(e){var i;return(0,o.Z)(this,n),(i=t.call(this,e)).browserTouchPanEnabled=!0,i.gamepad=new we,i.momentumEnabled=!0,i.mouseWheelZoomEnabled=!0,i}return(0,s.Z)(n)}(y.Z);(0,h._)([(0,A.Cb)({type:Boolean})],ke.prototype,"browserTouchPanEnabled",void 0),(0,h._)([(0,A.Cb)({type:we,nonNullable:!0})],ke.prototype,"gamepad",void 0),(0,h._)([(0,A.Cb)({type:Boolean})],ke.prototype,"momentumEnabled",void 0),(0,h._)([(0,A.Cb)({type:Boolean})],ke.prototype,"mouseWheelZoomEnabled",void 0);var Ce,Me=ke=(0,h._)([(0,F.j)("esri.views.navigation.Navigation")],ke),Ze=n(5354),xe=n(50951),Ie=n(79803),Te=null;function Se(e){return Ae.apply(this,arguments)}function Ae(){return(Ae=(0,r.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Te||(Te=n.e(67387).then(n.bind(n,67387)).then((function(e){return Ce=e}))),e.next=3,Te;case 3:(0,T.k_)(t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Fe(e,t,n,i){return Pe.apply(this,arguments)}function Pe(){return Pe=(0,r.Z)((0,i.Z)().mark((function e(t,n,r,a){var o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:if(o=t.spatialReference,!(0,Ie.kR)()&&!(0,Ie.Up)(o,n)){e.next=7;break}e.t0=(0,Ie.iV)(t,n),e.next=15;break;case 7:if(!Ce){e.next=11;break}e.t1=Ce.projectGeometry(t,n,r,a),e.next=14;break;case 11:return e.next=13,Promise.race([Se(a),(0,Ie.zD)(a)]);case 13:e.t1=Fe(t,n,r,a);case 14:e.t0=e.t1;case 15:return e.abrupt("return",e.t0);case 16:case"end":return e.stop()}}),e)}))),Pe.apply(this,arguments)}var Le,Ee=function(e){(0,d.Z)(n,e);var t=(0,p.Z)(n);function n(e){var i;return(0,o.Z)(this,n),(i=t.call(this,e)).required={tileInfo:!1,heightModelInfo:!1,extent:!1},i.defaultSpatialReference=null,i.userSpatialReference=null,i.sourcePreloadCount=10,i.priorityCollection=null,i.requiresExtentInSpatialReference=!0,i.suspended=!1,i._projectExtentTask={task:null,input:null,output:null,spatialReference:null},i}return(0,s.Z)(n,[{key:"destroy",value:function(){this._projectExtentTask.task&&(this._projectExtentTask.task=(0,x.IM)(this._projectExtentTask.task)),this._set("map",null)}},{key:"ready",get:function(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}},{key:"heightModelInfoReady",get:function(){return!this._heightModelInfoTask.updating}},{key:"spatialReference",get:function(){return(0,x.pC)(this.userSpatialReference)?this.userSpatialReference:(0,x.Wg)(this._spatialReferenceTask.spatialReference)}},{key:"extent",get:function(){return(0,x.Wg)(this._extentTask.extent)}},{key:"heightModelInfo",get:function(){return(0,x.Wg)(this._heightModelInfoTask.heightModelInfo)}},{key:"vcsWkid",get:function(){return(0,x.Wg)(this._heightModelInfoTask.vcsWkid)}},{key:"latestVcsWkid",get:function(){return(0,x.Wg)(this._heightModelInfoTask.latestVcsWkid)}},{key:"viewingMode",get:function(){return(0,x.Wi)(this.userSpatialReference)||this.userSpatialReference.equals((0,x.Wg)(this._spatialReferenceTask.spatialReference))?(0,x.Wg)(this._spatialReferenceTask.viewingMode):null}},{key:"tileInfo",get:function(){return(0,x.Wg)(this._tileInfoTask.tileInfo)}},{key:"mapCollections",get:function(){var e,t,n,i,r=null===(e=this.map)||void 0===e?void 0:e.call(this),a=[];return(0,x.pC)(this.priorityCollection)&&a.push(this.priorityCollection),a.push({parent:null===r||void 0===r?void 0:r.basemap,layers:null===r||void 0===r||null===(t=r.basemap)||void 0===t?void 0:t.baseLayers},{layers:null===r||void 0===r?void 0:r.layers},{parent:null===r||void 0===r?void 0:r.ground,layers:null===r||void 0===r||null===(n=r.ground)||void 0===n?void 0:n.layers},{parent:null===r||void 0===r?void 0:r.basemap,layers:null===r||void 0===r||null===(i=r.basemap)||void 0===i?void 0:i.referenceLayers}),a}},{key:"_allLayers",get:function(){return this._collectLayers(this.mapCollections)}},{key:"_spatialReferenceTask",get:function(){var e;if(this.suspended)return null!==(e=this._get("_spatialReferenceTask"))&&void 0!==e?e:{updating:!1};var t,n=this._allLayers,i=n.layers,r=n.updating,a=null,o=(0,G.Z)(i);try{for(o.s();!(t=o.n()).done;){var s=t.value,l=this._getSupportedSpatialReferences(s);if(l.length>0){var u=this._narrowDownSpatialReferenceCandidates(a,l);(0,x.pC)(u)&&(a=u)}if((0,x.pC)(a)&&1===a.length)break}}catch(d){o.e(d)}finally{o.f()}if(r&&((0,x.Wi)(a)||1!==a.length))return{updating:!0};var c=this._pickSpatialReferenceCandidate(a);return{spatialReference:(0,x.pC)(c)?c.spatialReference:null,viewingMode:(0,x.pC)(c)?c.viewingMode:null,updating:!1}}},{key:"_tileInfoTask",get:function(){var e,t,n,i,r,a,o,s;if(!this.required.tileInfo)return null!==(e=this._get("_tileInfoTask"))&&void 0!==e?e:{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};var l=this._collectLayers([{parent:null===(t=this.map)||void 0===t||null===(n=t.call(this))||void 0===n?void 0:n.basemap,layers:null===(i=this.map)||void 0===i||null===(r=i.call(this))||void 0===r||null===(a=r.basemap)||void 0===a?void 0:a.baseLayers},{layers:null===(o=this.map)||void 0===o||null===(s=o.call(this))||void 0===s?void 0:s.layers}]),u=l.layers,c=l.updating;if(u&&u.length>0&&"tileInfo"in u[0]){var d=u[0].tileInfo;return{tileInfo:d&&d.spatialReference.equals(this.spatialReference)?d:null,updating:!1}}return{updating:c}}},{key:"_heightModelInfoTask",get:function(){var e,t;if(!this.required.heightModelInfo||this.suspended&&null!==(e=this._get("_heightModelInfoTask"))&&void 0!==e&&e.heightModelInfo)return null!==(t=this._get("_heightModelInfoTask"))&&void 0!==t?t:{updating:!1};var n,i=this._allLayers,r=i.layers,a=i.updating,o=(0,G.Z)(r);try{for(o.s();!(n=o.n()).done;){var s=n.value;if((0,Ze.qC)(s)){var l,u,c=(0,Ze.Ku)(s);if(c)return{heightModelInfo:c,vcsWkid:null===(l=s.spatialReference)||void 0===l?void 0:l.vcsWkid,latestVcsWkid:null===(u=s.spatialReference)||void 0===u?void 0:u.latestVcsWkid,updating:!1}}}}catch(d){o.e(d)}finally{o.f()}return{updating:a}}},{key:"_extentCandidatesTask",get:function(){var e,t=this;if(this.suspended||!this.required.extent)return null!==(e=this._get("_extentCandidatesTask"))&&void 0!==e?e:{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};var n,i=this._allLayers,r=i.updating,a=[],o=(0,G.Z)(i.layers);try{for(o.s();!(n=o.n()).done;){var s,l=n.value,u="fullExtents"in l&&l.fullExtents||((0,x.pC)(l.fullExtent)?[l.fullExtent]:[]),c=this.requiresExtentInSpatialReference?null:u[0],d=null!==(s=u.find((function(e){return e.spatialReference.equals(t.spatialReference)})))&&void 0!==s?s:c;if(d)return{candidates:[{extent:d,layer:l}],updating:!1};if(this._getSupportedSpatialReferences(l).length>0){var p,h=(0,G.Z)(u);try{for(h.s();!(p=h.n()).done;){var f=p.value;a.push({extent:f,layer:l})}}catch(v){h.e(v)}finally{h.f()}}}}catch(v){o.e(v)}finally{o.f()}return{candidates:a,updating:r}}},{key:"_extentTask",get:function(){var e=this,t=this._extentCandidatesTask,n=t.candidates,o=t.updating;if(o)return{updating:o};if((0,x.Wi)(n)||0===n.length)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};var s=this._pickExtentCandidate(n),l=this.spatialReference;return s.extent.equals(this._projectExtentTask.input)&&l.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:(0,x.pC)(this._projectExtentTask.task)&&!this._projectExtentTask.task.finished}:((0,x.pC)(this._projectExtentTask.task)&&(this._projectExtentTask.task=(0,x.IM)(this._projectExtentTask.task)),this._projectExtentTask={input:s.extent.clone(),output:null,spatialReference:l.clone(),task:(0,g.vr)(function(){var t=(0,r.Z)((0,i.Z)().mark((function t(n){var r;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Fe(s.extent,l,s.layer.portalItem,n);case 3:r=t.sent,e._projectExtentTask=(0,a.Z)((0,a.Z)({},e._projectExtentTask),{},{task:null,output:r}),t.next=12;break;case 7:if(t.prev=7,t.t0=t.catch(0),!(0,T.Hc)(n)){t.next=11;break}return t.abrupt("return");case 11:e._projectExtentTask=(0,a.Z)((0,a.Z)({},e._projectExtentTask),{},{task:null});case 12:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}())},{updating:!0})}},{key:"_narrowDownSpatialReferenceCandidates",value:function(e,t){if((0,x.Wi)(e))return t;var n,i=[],r=function(e,t){return(0,x.pC)(e)?(0,x.pC)(t)?e===t&&e:e:t},a=(0,G.Z)(e);try{for(a.s();!(n=a.n()).done;){var o,s=n.value,l=(0,G.Z)(t);try{for(l.s();!(o=l.n()).done;){var u=o.value;if(s.spatialReference.equals(u.spatialReference)){var c=r(s.viewingMode,u.viewingMode);if(!1!==c){i.push({spatialReference:s.spatialReference,viewingMode:c});break}}}}catch(d){l.e(d)}finally{l.f()}}}catch(d){a.e(d)}finally{a.f()}return i.length>0?i:null}},{key:"_pickSpatialReferenceCandidate",value:function(e){var t=this.defaultSpatialReference;return(0,x.Wi)(e)||e.length<1?(0,x.pC)(t)?{spatialReference:t,viewingMode:null}:null:((0,x.pC)(t)&&e.length>1&&e.some((function(e){return e.spatialReference.equals(t)}))&&(e=e.filter((function(e){return e.spatialReference.equals(t)}))),e.length>1&&e.some((function(e){return e.viewingMode!==xe.JY.Local}))&&(e=e.filter((function(e){return e.viewingMode!==xe.JY.Local}))),e[0])}},{key:"_getSupportedSpatialReferences",value:function(e){var t="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(0===t.length)return[];var n,i=[],r=(0,G.Z)(t);try{for(r.s();!(n=r.n()).done;){var a=n.value,o=this.getSpatialReferenceSupport({spatialReference:a,layer:e});if((0,x.pC)(o)){var s,l=(0,x.pC)(o.constraints)?o.constraints:[{spatialReference:a,viewingMode:null}],u=(0,G.Z)(l);try{for(u.s();!(s=u.n()).done;){var c=s.value,d=c.spatialReference,p=c.viewingMode;(!this.requiresExtentInSpatialReference||(0,x.Wi)(this.userSpatialReference)||d.equals(this.userSpatialReference))&&i.push({spatialReference:d,viewingMode:p})}}catch(h){u.e(h)}finally{u.f()}}}}catch(h){r.e(h)}finally{r.f()}return i}},{key:"_pickExtentCandidate",value:function(e){var t=this.spatialReference;return e.find((function(e){var n=e.extent;return t.equals(n.spatialReference)}))||e[0]}},{key:"_collectLayers",value:function(e){var t;if("loaded"!==this._loadMaybe(null===(t=this.map)||void 0===t?void 0:t.call(this)))return{layers:[],updating:!0};var n,i={layers:[],preloading:-1,updating:!1},r=(0,G.Z)(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(this._collectCollection(a,i),i.preloading===this.sourcePreloadCount)break}}catch(o){r.e(o)}finally{r.f()}return{layers:i.layers,updating:i.updating}}},{key:"_collectCollection",value:function(e,t){if(e.layers){switch(this._loadMaybe(e.parent)){case"loading":return t.updating=!0,void++t.preloading;case"failed":return}var n,i=(0,G.Z)(e.layers);try{for(i.s();!(n=i.n()).done;){var r=n.value;switch(this._loadMaybe(r)){case"failed":continue;case"loading":t.updating=!0,++t.preloading;break;case"loaded":t.updating||t.layers.push(r),"layers"in r&&this._collectCollection({layers:r.layers},t)}if(t.preloading===this.sourcePreloadCount)break}}catch(a){i.e(a)}finally{i.f()}}}},{key:"_loadMaybe",value:function(e){return e&&"loadStatus"in e&&null!=e.loadStatus?"not-loaded"===e.loadStatus?(e.load().catch((function(){})),"loading"):e.loadStatus:"loaded"}}]),n}(y.Z);(0,h._)([(0,A.Cb)()],Ee.prototype,"required",void 0),(0,h._)([(0,A.Cb)({constructOnly:!0})],Ee.prototype,"map",void 0),(0,h._)([(0,A.Cb)({constructOnly:!0})],Ee.prototype,"getSpatialReferenceSupport",void 0),(0,h._)([(0,A.Cb)()],Ee.prototype,"defaultSpatialReference",void 0),(0,h._)([(0,A.Cb)()],Ee.prototype,"userSpatialReference",void 0),(0,h._)([(0,A.Cb)()],Ee.prototype,"sourcePreloadCount",void 0),(0,h._)([(0,A.Cb)()],Ee.prototype,"priorityCollection",void 0),(0,h._)([(0,A.Cb)()],Ee.prototype,"requiresExtentInSpatialReference",void 0),(0,h._)([(0,A.Cb)()],Ee.prototype,"suspended",void 0),(0,h._)([(0,A.Cb)({readOnly:!0})],Ee.prototype,"ready",null),(0,h._)([(0,A.Cb)({readOnly:!0})],Ee.prototype,"heightModelInfoReady",null),(0,h._)([(0,A.Cb)({readOnly:!0})],Ee.prototype,"spatialReference",null),(0,h._)([(0,A.Cb)({readOnly:!0})],Ee.prototype,"extent",null),(0,h._)([(0,A.Cb)({readOnly:!0})],Ee.prototype,"heightModelInfo",null),(0,h._)([(0,A.Cb)({readOnly:!0})],Ee.prototype,"vcsWkid",null),(0,h._)([(0,A.Cb)({readOnly:!0})],Ee.prototype,"latestVcsWkid",null),(0,h._)([(0,A.Cb)({readOnly:!0})],Ee.prototype,"viewingMode",null),(0,h._)([(0,A.Cb)({readOnly:!0})],Ee.prototype,"tileInfo",null),(0,h._)([(0,A.Cb)({readOnly:!0})],Ee.prototype,"mapCollections",null),(0,h._)([(0,A.Cb)({readOnly:!0})],Ee.prototype,"_allLayers",null),(0,h._)([(0,A.Cb)({readOnly:!0})],Ee.prototype,"_spatialReferenceTask",null),(0,h._)([(0,A.Cb)({readOnly:!0})],Ee.prototype,"_tileInfoTask",null),(0,h._)([(0,A.Cb)({readOnly:!0})],Ee.prototype,"_heightModelInfoTask",null),(0,h._)([(0,A.Cb)({readOnly:!0})],Ee.prototype,"_extentCandidatesTask",null),(0,h._)([(0,A.Cb)()],Ee.prototype,"_extentTask",null),(0,h._)([(0,A.Cb)()],Ee.prototype,"_projectExtentTask",void 0),Ee=(0,h._)([(0,F.j)("esri.views.support.DefaultsFromMap")],Ee);var Re=Le=function(e){(0,d.Z)(n,e);var t=(0,p.Z)(n);function n(e){var i;return(0,o.Z)(this,n),(i=t.call(this,e))._userSpatialReference=null,i._cursor=null,i.allLayerViews=new _.Z({getCollections:function(){var e,t,n;return[null===(e=i.basemapView)||void 0===e?void 0:e.baseLayerViews,null===(t=i.groundView)||void 0===t?void 0:t.layerViews,i.layerViews,null===(n=i.basemapView)||void 0===n?void 0:n.referenceLayerViews]},getChildrenFunction:function(e){return e.layerViews}}),i.groundView=null,i.basemapView=null,i.fatalError=null,i.graphics=new D.J,i.analyses=new O.J,i.typeSpecificPreconditionsReady=!0,i.layerViews=new m.Z,i.magnifier=new X,i.padding={left:0,top:0,right:0,bottom:0},i.ready=!1,i.spatialReferenceWarningDelay=1e3,i.supportsGround=!0,i.timeExtent=null,i.timeReference=new N.Z,i.type=null,i.scale=null,i.updating=!1,i.initialExtentRequired=!0,i.input=new _e,i.navigation=new Me,i.layerViewManager=null,i.analysisViewManager=null,i.isHeightModelInfoRequired=!1,i.width=null,i.height=null,i.resizing=!1,i.suspended=!1,i.viewEvents=new ne.CE((0,l.Z)(i)),i.persistableViewModels=new m.Z,i._isValid=!1,i._readyCycleForced=!1,i._currentSpatialReference=null,i.handles.add((0,S.YP)((function(){return i.preconditionsReady}),(function(e){var t,n;e?(i._currentSpatialReference=i.spatialReference,Le.views.add((0,l.Z)(i))):(i._currentSpatialReference=null,Le.views.remove((0,l.Z)(i))),i.notifyChange("spatialReference"),!e&&i.ready?(null!==(t=i.toolViewManager)&&void 0!==t&&t.detach(),(0,x.pC)(i.analysisViewManager)&&i.analysisViewManager.detach(),null!==(n=i.layerViewManager)&&void 0!==n&&n.clear(),i._teardown()):e&&!i.ready&&(i._startup(),(0,x.pC)(i.analysisViewManager)&&i.analysisViewManager.attach(),i.toolViewManager.attach())}),S.Z_)),i}return(0,s.Z)(n,[{key:"initialize",value:function(){var e=this;this.addResolvingPromise(this.validate().then((function(){return e._isValid=!0,(0,S.N1)((function(){return e.ready}))}))),this.basemapView=new z({view:this}),this.layerViewManager=new Y({view:this,layerViewImporter:{importLayerView:function(t){return e.importLayerView(t)},hasLayerViewModule:function(t){return e.hasLayerViewModule(t)}},supportsGround:this.supportsGround}),this.toolViewManager=new fe({view:this}),this._setupSpatialReferenceLogger(),this.handles.add([(0,S.YP)((function(){return e.initialExtentRequired}),(function(t){return e.defaultsFromMap.required=(0,a.Z)((0,a.Z)({},e.defaultsFromMap.required),{},{extent:t})}),{sync:!0,initial:!0}),(0,S.YP)((function(){return e.ready}),(function(t){e.defaultsFromMap&&(e.defaultsFromMap.suspended=t,e.defaultsFromMap.userSpatialReference=t?e.spatialReference:e._userSpatialReference)}),{sync:!0}),(0,S.YP)((function(){return e._userSpatialReference}),(function(t){e.defaultsFromMap&&(e.defaultsFromMap.userSpatialReference=t)}),{sync:!0,initial:!0})])}},{key:"_setupSpatialReferenceLogger",value:function(){var e=this,t=null;this.handles.add([(0,S.YP)((function(){var t;return null===(t=e.defaultsFromMap)||void 0===t?void 0:t.ready}),(function(n){var a,o=(null===(a=e.map)||void 0===a?void 0:a.allLayers.length)>0;if(n&&!e.spatialReference&&o){if((0,x.pC)(t))return;var s=(0,C.kB)((function(){return t=(0,x.IM)(t)}));t=(0,g.vr)(function(){var n=(0,r.Z)((0,i.Z)().mark((function n(r){return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,(0,T.e4)(e.spatialReferenceWarningDelay,null,r);case 3:n.next=8;break;case 5:return n.prev=5,n.t0=n.catch(0),n.abrupt("return");case 8:return n.prev=8,t=null,n.finish(8);case 11:Z.Z.getLogger(e.declaredClass).warn("#spatialReference","no spatial reference could be derived from the currently added map layers");case 12:case"end":return n.stop()}}),n,null,[[0,5,8,11]])})));return function(e){return n.apply(this,arguments)}}()),e.handles.add(s,"spatial-reference-logger-task")}else e.handles.remove("spatial-reference-logger-task")}),{sync:!0})])}},{key:"destroy",value:function(){if(!this.destroyed){this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=(0,x.SC)(this.graphics),this.analyses=(0,x.SC)(this.analyses),this.handles.remove("defaultsFromMap"),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),(0,x.SC)(this.analysisViewManager),this.toolViewManager=(0,x.SC)(this.toolViewManager),this.layerViewManager=(0,x.SC)(this.layerViewManager),this.basemapView=(0,x.SC)(this.basemapView),this.invalidate(),this._emitter.clear(),this.handles.removeAll();var e=this.map;this.map=null,null===e||void 0===e||e.destroy()}}},{key:"_startup",value:function(){this._set("ready",!0)}},{key:"_teardown",value:function(){this._set("ready",!1)}},{key:"whenReady",value:function(){return Promise.resolve(this)}},{key:"toMap",value:function(){return Z.Z.getLogger(this.declaredClass).error("#toMap()","Not implemented on this instance of View"),null}},{key:"activeTool",get:function(){var e;return null===(e=this.toolViewManager)||void 0===e?void 0:e.activeTool},set:function(e){this.toolViewManager&&(this.toolViewManager.activeTool=e)}},{key:"animation",get:function(){return this._get("animation")},set:function(e){this._set("animation",e)}},{key:"center",get:function(){return null}},{key:"_defaultsFromMapSettings",get:function(){return{}}},{key:"defaultsFromMap",get:function(){var e=this;return new Ee((0,a.Z)({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:function(){return e.map},getSpatialReferenceSupport:function(t){return e.getSpatialReferenceSupport(t)}},this._defaultsFromMapSettings))}},{key:"extent",get:function(){return this._get("extent")},set:function(e){this._set("extent",e)}},{key:"heightModelInfo",get:function(){return this.getDefaultHeightModelInfo()}},{key:"interacting",get:function(){return this.navigating}},{key:"navigating",get:function(){return!1}},{key:"preconditionsReady",get:function(){var e;return!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||M.Z.isLoadable(this.map)&&!this.map.loaded||0===this.width||0===this.height||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._currentSpatialReference&&(null===(e=this.defaultsFromMap)||void 0===e||!e.ready)||!this.typeSpecificPreconditionsReady)}},{key:"resolution",get:function(){return 0}},{key:"map",set:function(e){var t;e!==this._get("map")&&(null!==(t=e)&&void 0!==t&&t.destroyed&&(Z.Z.getLogger(this.declaredClass).warn("#map","The provided map is already destroyed",{map:e}),e=null),M.Z.isLoadable(e)&&e.load().catch((function(){})),this.constructed&&(this.forceReadyCycle(),this._currentSpatialReference=null),this._set("map",e))}},{key:"spatialReference",get:function(){var e,t,n=this._userSpatialReference||this._currentSpatialReference||this.getDefaultSpatialReference()||null;return n&&null!==(e=this.defaultsFromMap)&&void 0!==e&&null!==(t=e.required)&&void 0!==t&&t.heightModelInfo&&((n=n.clone()).vcsWkid=this.defaultsFromMap.vcsWkid,n.latestVcsWkid=this.defaultsFromMap.latestVcsWkid),n},set:function(e){var t=!(0,V.fS)(e,this._get("spatialReference"));this._set("_userSpatialReference",e),t&&(this._set("spatialReference",e),this._spatialReferenceChanged(e))}},{key:"_spatialReferenceChanged",value:function(e){}},{key:"stationary",get:function(){return!this.animation&&!this.navigating&&!this.resizing}},{key:"tools",get:function(){var e;return null===(e=this.toolViewManager)||void 0===e?void 0:e.tools}},{key:"initialExtent",get:function(){var e;return null===(e=this.defaultsFromMap)||void 0===e?void 0:e.extent}},{key:"cursor",get:function(){var e=this.toolViewManager?this.toolViewManager.cursor:null;return(0,x.pC)(e)?e:this._cursor||"default"},set:function(e){this._cursor=e,this.notifyChange("cursor")}},{key:"size",get:function(){return[this.width,this.height]}},{key:"whenLayerView",value:function(e){return this.layerViewManager.whenLayerView(e)}},{key:"getDefaultSpatialReference",value:function(){var e;return null===(e=this.defaultsFromMap)||void 0===e?void 0:e.spatialReference}},{key:"getDefaultHeightModelInfo",value:function(){var e,t,n;return null!==(e=null!==(t=this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)&&void 0!==t?t:null===(n=this.defaultsFromMap)||void 0===n?void 0:n.heightModelInfo)&&void 0!==e?e:null}},{key:"importLayerView",value:function(e){throw new b.Z("importLayerView() not implemented")}},{key:"hasLayerViewModule",value:function(e){return!1}},{key:"validate",value:function(){var e=(0,r.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"invalidate",value:function(){this._isValid=!1}},{key:"getSpatialReferenceSupport",value:function(){return{constraints:null}}},{key:"_validateSpatialReference",value:function(e){return(0,x.pC)(this.getSpatialReferenceSupport({spatialReference:e}))}},{key:"when",value:function(e,t){return this.isResolved()&&!this.ready&&Z.Z.getLogger(this.declaredClass).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),(0,u.Z)((0,c.Z)(n.prototype),"when",this).call(this,e,t)}},{key:"forceReadyCycle",value:function(){var e=this;this.ready&&((0,S.gx)((function(){return!1===e.preconditionsReady}),(function(){return e._readyCycleForced=!1}),{once:!0}),this._readyCycleForced=!0)}},{key:"addAndActivateTool",value:function(e){this.toolViewManager.tools.add(e),this.activeTool=e}},{key:"tryFatalErrorRecovery",value:function(){this.fatalError=null}}]),n}((0,k.p)(w.Z.EventedMixin((0,I.v)(y.Z))));Re.views=new m.Z,(0,h._)([(0,A.Cb)()],Re.prototype,"_userSpatialReference",void 0),(0,h._)([(0,A.Cb)()],Re.prototype,"activeTool",null),(0,h._)([(0,A.Cb)({readOnly:!0})],Re.prototype,"allLayerViews",void 0),(0,h._)([(0,A.Cb)()],Re.prototype,"groundView",void 0),(0,h._)([(0,A.Cb)()],Re.prototype,"animation",null),(0,h._)([(0,A.Cb)()],Re.prototype,"basemapView",void 0),(0,h._)([(0,A.Cb)()],Re.prototype,"center",null),(0,h._)([(0,A.Cb)({readOnly:!0})],Re.prototype,"_defaultsFromMapSettings",null),(0,h._)([(0,A.Cb)()],Re.prototype,"defaultsFromMap",null),(0,h._)([(0,A.Cb)()],Re.prototype,"fatalError",void 0),(0,h._)([(0,A.Cb)({type:L.Z})],Re.prototype,"extent",null),(0,h._)([(0,A.Cb)((0,P.z)(D.J,"graphics"))],Re.prototype,"graphics",void 0),(0,h._)([(0,A.Cb)((0,P.z)(O.J,"analyses"))],Re.prototype,"analyses",void 0),(0,h._)([(0,A.Cb)({readOnly:!0,type:E.Z})],Re.prototype,"heightModelInfo",null),(0,h._)([(0,A.Cb)({readOnly:!0})],Re.prototype,"interacting",null),(0,h._)([(0,A.Cb)({readOnly:!0})],Re.prototype,"navigating",null),(0,h._)([(0,A.Cb)({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_currentSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],Re.prototype,"preconditionsReady",null),(0,h._)([(0,A.Cb)({readOnly:!0})],Re.prototype,"typeSpecificPreconditionsReady",void 0),(0,h._)([(0,A.Cb)({type:m.Z,readOnly:!0})],Re.prototype,"layerViews",void 0),(0,h._)([(0,A.Cb)()],Re.prototype,"resolution",null),(0,h._)([(0,A.Cb)({type:X})],Re.prototype,"magnifier",void 0),(0,h._)([(0,A.Cb)({value:null,type:f.Z})],Re.prototype,"map",null),(0,h._)([(0,A.Cb)()],Re.prototype,"padding",void 0),(0,h._)([(0,A.Cb)({readOnly:!0})],Re.prototype,"ready",void 0),(0,h._)([(0,A.Cb)({type:R.Z})],Re.prototype,"spatialReference",null),(0,h._)([(0,A.Cb)()],Re.prototype,"spatialReferenceWarningDelay",void 0),(0,h._)([(0,A.Cb)()],Re.prototype,"stationary",null),(0,h._)([(0,A.Cb)({readOnly:!0})],Re.prototype,"supportsGround",void 0),(0,h._)([(0,A.Cb)({type:v.Z})],Re.prototype,"timeExtent",void 0),(0,h._)([(0,A.Cb)({type:N.Z,nonNullable:!0})],Re.prototype,"timeReference",void 0),(0,h._)([(0,A.Cb)()],Re.prototype,"tools",null),(0,h._)([(0,A.Cb)()],Re.prototype,"toolViewManager",void 0),(0,h._)([(0,A.Cb)({readOnly:!0})],Re.prototype,"type",void 0),(0,h._)([(0,A.Cb)({type:Number})],Re.prototype,"scale",void 0),(0,h._)([(0,A.Cb)({readOnly:!0})],Re.prototype,"updating",void 0),(0,h._)([(0,A.Cb)({readOnly:!0})],Re.prototype,"initialExtentRequired",void 0),(0,h._)([(0,A.Cb)({readOnly:!0})],Re.prototype,"initialExtent",null),(0,h._)([(0,A.Cb)()],Re.prototype,"cursor",null),(0,h._)([(0,A.Cb)({readOnly:!0})],Re.prototype,"input",void 0),(0,h._)([(0,A.Cb)({type:Me,nonNullable:!0})],Re.prototype,"navigation",void 0),(0,h._)([(0,A.Cb)()],Re.prototype,"layerViewManager",void 0),(0,h._)([(0,A.Cb)()],Re.prototype,"analysisViewManager",void 0),(0,h._)([(0,A.Cb)()],Re.prototype,"width",void 0),(0,h._)([(0,A.Cb)()],Re.prototype,"height",void 0),(0,h._)([(0,A.Cb)({readOnly:!0})],Re.prototype,"resizing",void 0),(0,h._)([(0,A.Cb)({value:null,readOnly:!0})],Re.prototype,"size",null),(0,h._)([(0,A.Cb)({readOnly:!0})],Re.prototype,"suspended",void 0),(0,h._)([(0,A.Cb)({readOnly:!0})],Re.prototype,"viewEvents",void 0),(0,h._)([(0,A.Cb)({readOnly:!0})],Re.prototype,"persistableViewModels",void 0),(0,h._)([(0,A.Cb)()],Re.prototype,"_isValid",void 0),(0,h._)([(0,A.Cb)()],Re.prototype,"_readyCycleForced",void 0),(0,h._)([(0,A.Cb)()],Re.prototype,"_currentSpatialReference",void 0);var Ve=Re=Le=(0,h._)([(0,F.j)("esri.views.View")],Re)},9918:function(e,t,n){n.d(t,{Z:function(){return f}});var i=n(15671),r=n(43144),a=n(60136),o=n(92572),s=n(27366),l=n(10064),u=n(67426),c=n(66978),d=n(49861),p=(n(25243),n(63780),n(69912)),h=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).state="running",r.target=null,r._dfd=null,r}return(0,r.Z)(n,[{key:"initialize",value:function(){var e=this;this.addResolvingPromise(new Promise((function(t,n){return e._dfd={resolve:t,reject:n}})))}},{key:"done",get:function(){return"finished"===this.state||"stopped"===this.state}},{key:"stop",value:function(){var e;"stopped"!==this.state&&"finished"!==this.state&&(this._set("state","stopped"),null===(e=this._dfd)||void 0===e||e.reject(new l.Z("ViewAnimation stopped")))}},{key:"finish",value:function(){var e;"stopped"!==this.state&&"finished"!==this.state&&(this._set("state","finished"),null===(e=this._dfd)||void 0===e||e.resolve())}},{key:"update",value:function(e,t){t||(t=(0,c.y8)(e)?"waiting-for-target":"running"),this._set("target",e),this._set("state",t)}}]),n}(u.D);(0,s._)([(0,d.Cb)({readOnly:!0})],h.prototype,"done",null),(0,s._)([(0,d.Cb)({readOnly:!0,type:String})],h.prototype,"state",void 0),(0,s._)([(0,d.Cb)()],h.prototype,"target",void 0),h=(0,s._)([(0,p.j)("esri.views.ViewAnimation")],h),(h||(h={})).State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"};var f=h},50951:function(e,t,n){var i;function r(e){return"global"===e?i.Global:i.Local}function a(e){return e===i.Global?"global":"local"}n.d(t,{JY:function(){return i},M7:function(){return a},wg:function(){return r}}),function(e){e[e.Global=1]="Global",e[e.Local=2]="Local"}(i||(i={}))},31822:function(e,t,n){n.d(t,{z:function(){return _}});var i=n(15671),r=n(43144),a=n(93169),o=n(92026),s=n(67750),l=n(99346),u=n(5977);function c(e){var t=e.native;return t?{buttons:t.buttons.map((function(e){return e.pressed?e.value?e.value:1:0})),axes:t.axes.map((function(t){return function(e,t){var n=Math.abs(e);return n<t?0:Math.sign(e)*(n-t)/(1-t)}(t,e.axisThreshold)}))}:{buttons:[],axes:[]}}var d=function(){function e(t,n){var r=this;(0,i.Z)(this,e),this._element=t,this._input=n,this._hasEventListeners=!1,this._onConnectGamepad=function(e){r._connectGamepad(e.gamepad)},this._onDisconnectGamepad=function(e){var t=e.gamepad,n=t.index,i=r._inputDevices[n];i&&(r._emitGamepadEvent(t,c(i),!1),r._inputDevices.splice(n,1),r._latestUpdate.splice(n,1),r._input.gamepad.devices.remove(i),r.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;var a="getGamepads"in window.navigator,o=window.isSecureContext;this.supported=a&&o,this.supported&&(this._forEachGamepad((function(e){return r._connectGamepad(e)})),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}return(0,r.Z)(e,[{key:"destroy",value:function(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}},{key:"hasEventListeners",set:function(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState())}},{key:"_eventsEnabled",get:function(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}},{key:"onEvent",set:function(e){this._callback=e}},{key:"_connectGamepad",value:function(e){var t=new u.Z(e);"unknown"!==t.deviceType&&(this._inputDevices[e.index]=t,this._input.gamepad.devices.add(t)),this.ensurePollingState()}},{key:"ensurePollingState",value:function(){this._eventsEnabled?this._startPolling():this._stopPolling()}},{key:"_startPolling",value:function(){var e=this;null==this._frameTask&&(this._frameTask=(0,l.A)({update:function(){return e._readGamepadState()}}))}},{key:"_stopPolling",value:function(){null!=this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}},{key:"_readGamepadState",value:function(){var e=this,t=document.hasFocus(),n=this._element.contains(document.activeElement),i="document"===this._input.gamepad.enabledFocusMode&&!t||"view"===this._input.gamepad.enabledFocusMode&&!n;this._forEachGamepad((function(t){var n=e._inputDevices[t.index];if(n){var r=e._latestUpdate[t.index],a=c(n),o=i||function(e){for(var t=0;t<e.axes.length;t++)if(0!==e.axes[t])return!1;for(var n=0;n<e.buttons.length;n++)if(0!==e.buttons[n])return!1;return!0}(a);if(r){if(r.timestamp===t.timestamp)return;if(!r.active&&o)return;if(function(e,t){if(e.axes.length!==t.axes.length)return!1;if(e.buttons.length!==t.buttons.length)return!1;for(var n=0;n<e.axes.length;n++)if(e.axes[n]!==t.axes[n])return!1;for(var i=0;i<e.buttons.length;i++)if(e.buttons[i]!==t.buttons[i])return!1;return!0}(r.state,a))return}e._emitGamepadEvent(t,a,!o)}}))}},{key:"_forEachGamepad",value:function(e){for(var t=window.navigator.getGamepads(),n=0;n<t.length;n++){var i=t[n];this._validate(i)&&e(i)}}},{key:"_emitGamepadEvent",value:function(e,t,n){var i=this._latestUpdate[e.index],r=i&&i.active;if(r||n){var a=!r&&n?"start":r&&n?"update":"end";this._latestUpdate[e.index]={timestamp:e.timestamp,state:t,active:n},this._callback&&this._callback({device:this._inputDevices[e.index],state:t,action:a})}}},{key:"_validate",value:function(e){if(!e)return!1;if(!e.connected)return!1;for(var t=0;t<e.axes.length;t++)if(isNaN(e.axes[t]))return!1;return!0}}]),e}(),p=n(72612),h=(0,a.Z)("edge"),f=(0,a.Z)("chrome"),v=(0,a.Z)("ff"),y=(0,a.Z)("safari"),g="esri-view-surface",m={touchNone:"".concat(g,"--touch-none"),touchPan:"".concat(g,"--touch-pan")},_=function(){function e(t,n){var r=this;(0,i.Z)(this,e),this._input=n,this._active={},this._callback=function(){},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=t,t.getAttribute("tabindex")||t.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new d(t,this._input),this._gamepadSource.onEvent=function(e){return r._callback("gamepad",e)}}return(0,r.Z)(e,[{key:"destroy",value:function(){var e=this;this._callback=function(){},this.activeEvents=null,this._activePointerCaptures.forEach((function(t){e._releasePointerCaptureSafe(t)})),this._gamepadSource=(0,o.SC)(this._gamepadSource),this._activePointerCaptures=null,this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}},{key:"browserTouchPanningEnabled",get:function(){return this._browserTouchPanningEnabled},set:function(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling()}},{key:"onEventReceived",set:function(e){this._callback=e}},{key:"activeEvents",set:function(e){var t,n=this;for(var i in this._active)if(!e||!e.has(i)){var r=this._active[i];this._element.removeEventListener(b[i],r),delete this._active[i]}e&&e.forEach((function(e){if(!n._active[e]&&b[e]){var t=(n._eventHandlers[e]||n._handleDefault).bind(n,e);n._element.addEventListener(b[e],t),n._active[e]=t}})),this._gamepadSource.hasEventListeners=null!==(t=null===e||void 0===e?void 0:e.has("gamepad"))&&void 0!==t&&t}},{key:"setPointerCapture",value:function(e,t){t?(this._element.setPointerCapture(e.pointerId),this._activePointerCaptures.add(e.pointerId)):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId))}},{key:"_updateTouchAction",value:function(){this._element.classList.remove(this._browserTouchPanningEnabled?m.touchNone:m.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?m.touchPan:m.touchNone)}},{key:"_updateTouchEventHandling",value:function(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}},{key:"_removeTouchAction",value:function(){this._element.classList.remove(m.touchNone),this._element.classList.remove(m.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}},{key:"_releasePointerCaptureSafe",value:function(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e)}catch(t){}}},{key:"_updateNormalizedPointerLikeEvent",value:function(t,n){var i=(0,p.Eu)(this._element,t);return e.test.disableSubpixelCoordinates&&(i.x=Math.round(i.x),i.y=Math.round(i.y)),n.x=i.x,n.y=i.y,n}},{key:"_handleKey",value:function(e,t){var n=(0,s.kK)(t);n&&"key-up"===e&&this._keyDownState.delete(n);var i={native:t,key:n,repeat:!!n&&this._keyDownState.has(n)};n&&"key-down"===e&&this._keyDownState.add(i.key),this._callback(e,i)}},{key:"_handlePointer",value:function(e,t){var n=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});this._callback(e,n)}},{key:"_handlePointerPreventDefault",value:function(e,t){var n=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});t.preventDefault(),this._callback(e,n)}},{key:"_handleMouseWheel",value:function(e,t){var n=t.deltaY;switch(t.deltaMode){case 0:h&&(n=n/document.documentElement.clientHeight*600);break;case 1:n*=30;break;case 2:n*=900}h?n*=.7:f||y?n*=.6:v&&(n*=1.375);var i=Math.abs(n);if(i>100){n=n/i*200/(1+Math.exp(-.02*(i-100)))}var r=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,deltaY:n});this._callback(e,r)}},{key:"_handlePointerCaptureLost",value:function(e,t){this._activePointerCaptures.delete(t.pointerId),this._handleDefault(e,t)}},{key:"_handleDefault",value:function(e,t){var n={native:t};t.preventDefault(),this._callback(e,n)}},{key:"_preventAltKeyDefault",value:function(e){"Alt"===e.key&&e.preventDefault()}},{key:"_preventMultiTouchPanning",value:function(e){e.touches.length>1&&e.preventDefault()}}]),e}();_.test={disableSubpixelCoordinates:!1};var b={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"}},43308:function(e,t,n){n.d(t,{H:function(){return a}});var i=n(15671),r=n(43144),a=function(){function e(t){(0,i.Z)(this,e),this._callbacks=t,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=function(){return!0})}return(0,r.Z)(e,[{key:"handle",value:function(e){var t=e.data,n=t.pointers.size;switch(t.action){case"start":this._currentCount=n,this._emitStart(e);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=n,this._emitStart(e);break;case"update":this._emitUpdate(e);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=n,this._emitStart(e);break;case"end":this._emitEnd(e),this._currentCount=0}this._previousEvent=e}},{key:"_emitStart",value:function(e){var t,n;this._startEvent=e,(null===(t=(n=this._callbacks).condition)||void 0===t?void 0:t.call(n,this._currentCount,e))&&this._callbacks.start(this._currentCount,e,this._startEvent)}},{key:"_emitUpdate",value:function(e){var t,n;(null===(t=(n=this._callbacks).condition)||void 0===t?void 0:t.call(n,this._currentCount,e))&&this._callbacks.update(this._currentCount,e,this._startEvent)}},{key:"_emitEnd",value:function(e){var t,n;null!==(t=(n=this._callbacks).condition)&&void 0!==t&&t.call(n,this._currentCount,e)&&this._callbacks.end(this._currentCount,e,this._startEvent),this._startEvent=null}}]),e}()},63920:function(e,t,n){var i;n.d(t,{t:function(){return i}}),function(e){e[e.Left=0]="Left",e[e.Middle=1]="Middle",e[e.Right=2]="Right"}(i||(i={}))},84057:function(e,t,n){n.d(t,{CE:function(){return v},uS:function(){return p}});var i=n(60136),r=n(92572),a=n(15671),o=n(43144),s=n(37762),l=(n(93169),n(16889)),u=n(17842),c=n(45371),d=n(1614),p=(n(63920),["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"]),h={};function f(e){return!!h[e]}p.forEach((function(e){h[e]=!0}));var v=function(){function e(t){(0,a.Z)(this,e),this._handlers=new Map,this._counter=0,this._handlerCounts=new Map,this.view=t,this.inputManager=null}return(0,o.Z)(e,[{key:"connect",value:function(e){var t=this;e&&this.disconnect(),this.inputManager=e,this._handlers.forEach((function(e,n){var i,r=e.handler,a=e.priority;return null===(i=t.inputManager)||void 0===i?void 0:i.installHandlers(n,[r],a)}))}},{key:"disconnect",value:function(){var e=this;this.inputManager&&this._handlers.forEach((function(t,n){var i;return null===(i=e.inputManager)||void 0===i?void 0:i.uninstallHandlers(n)})),this.inputManager=null}},{key:"destroy",value:function(){this.disconnect(),this._handlers.clear(),this.view=null}},{key:"on",value:function(e,t,n,i){var r,a,o=this,l=Array.isArray(e)?e:e.split(",");if(!function(e){var t,n=(0,s.Z)(e);try{for(n.s();!(t=n.n()).done;)if(!f(t.value))return!1}catch(i){n.e(i)}finally{n.f()}return!0}(l))return l.some(f)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;Array.isArray(t)?a=t:(r=t,a=[]),"function"==typeof n?r=n:i=n,i=null!=i?i:d.f.DEFAULT;var u=this._createUniqueGroupName(),c=new y(this.view,l,a,r);this._handlers.set(u,{handler:c,priority:i});var p,h=(0,s.Z)(l);try{for(h.s();!(p=h.n()).done;){var v=p.value,g=this._handlerCounts.get(v)||0;this._handlerCounts.set(v,g+1)}}catch(m){h.e(m)}finally{h.f()}return this.inputManager&&this.inputManager.installHandlers(u,[c],i),{remove:function(){return o._removeHandler(u,l)}}}},{key:"hasHandler",value:function(e){return!!this._handlerCounts.get(e)}},{key:"_removeHandler",value:function(e,t){if(this._handlers.has(e)){this._handlers.delete(e);var n,i=(0,s.Z)(t);try{for(i.s();!(n=i.n()).done;){var r=n.value,a=this._handlerCounts.get(r);void 0===a?console.error("Trying to remove handler for event that has no handlers registered: ",r):1===a?this._handlerCounts.delete(r):this._handlerCounts.set(r,a-1)}}catch(o){i.e(o)}finally{i.f()}}this.inputManager&&this.inputManager.uninstallHandlers(e)}},{key:"_createUniqueGroupName",value:function(){return this._counter+=1,"viewEvents_".concat(this._counter)}}]),e}(),y=function(e){(0,i.Z)(n,e);var t=(0,r.Z)(n);function n(e,i,r,o){var l;(0,a.Z)(this,n),(l=t.call(this,!0))._latestDragStart=void 0,l.view=e;var u,c=(0,s.Z)(i);try{for(c.s();!(u=c.n()).done;){switch(u.value){case"click":l.registerIncoming("click",r,(function(e){return o(l._wrapClick(e))}));break;case"double-click":l.registerIncoming("double-click",r,(function(e){return o(l._wrapDoubleClick(e))}));break;case"immediate-click":l.registerIncoming("immediate-click",r,(function(e){return o(l._wrapImmediateClick(e))}));break;case"immediate-double-click":l.registerIncoming("immediate-double-click",r,(function(e){return o(l._wrapImmediateDoubleClick(e))}));break;case"hold":l.registerIncoming("hold",r,(function(e){return o(l._wrapHold(e))}));break;case"drag":l.registerIncoming("drag",r,(function(e){var t=l._wrapDrag(e);t&&o(t)}));break;case"key-down":l.registerIncoming("key-down",r,(function(e){return o(l._wrapKeyDown(e))}));break;case"key-up":l.registerIncoming("key-up",r,(function(e){return o(l._wrapKeyUp(e))}));break;case"pointer-down":l.registerIncoming("pointer-down",r,(function(e){return o(l._wrapPointer(e,"pointer-down"))}));break;case"pointer-move":l.registerIncoming("pointer-move",r,(function(e){return o(l._wrapPointer(e,"pointer-move"))}));break;case"pointer-up":l.registerIncoming("pointer-up",r,(function(e){return o(l._wrapPointer(e,"pointer-up"))}));break;case"pointer-drag":l.registerIncoming("pointer-drag",r,(function(e){return o(l._wrapPointerDrag(e))}));break;case"mouse-wheel":l.registerIncoming("mouse-wheel",r,(function(e){return o(l._wrapMouseWheel(e))}));break;case"pointer-enter":l.registerIncoming("pointer-enter",r,(function(e){return o(l._wrapPointer(e,"pointer-enter"))}));break;case"pointer-leave":l.registerIncoming("pointer-leave",r,(function(e){return o(l._wrapPointer(e,"pointer-leave"))}));break;case"gamepad":l.registerIncoming("gamepad",r,(function(e){o(l._wrapGamepad(e))}));break;case"focus":l.registerIncoming("focus",r,(function(e){o(l._wrapFocus(e))}));break;case"blur":l.registerIncoming("blur",r,(function(e){o(l._wrapBlur(e))}))}}}catch(d){c.e(d)}finally{c.f()}return l}return(0,o.Z)(n,[{key:"_wrapFocus",value:function(e){return{type:"focus",timestamp:e.timestamp,native:e.data.native,cancelable:e.cancelable,stopPropagation:function(){return e.stopPropagation()},async:function(t){return e.async(t)},preventDefault:function(){return e.preventDefault()}}}},{key:"_wrapBlur",value:function(e){return{type:"blur",timestamp:e.timestamp,native:e.data.native,cancelable:e.cancelable,stopPropagation:function(){return e.stopPropagation()},async:function(t){return e.async(t)},preventDefault:function(){return e.preventDefault()}}}},{key:"_wrapClick",value:function(e){var t=e.data,n=t.pointerType,i=t.button,r=t.buttons,a=t.x,o=t.y,s=t.native,l=t.eventId,c=e.cancelable;return{type:"click",pointerType:n,button:i,buttons:r,x:a,y:o,native:s,timestamp:e.timestamp,screenPoint:(0,u.vW)(a,o),mapPoint:this._getMapPoint(a,o),eventId:l,cancelable:c,stopPropagation:function(){return e.stopPropagation()},async:function(t){return e.async(t)},preventDefault:function(){return e.preventDefault()}}}},{key:"_wrapDoubleClick",value:function(e){var t=e.data,n=t.pointerType,i=t.button,r=t.buttons,a=t.x,o=t.y,s=t.native,l=t.eventId,u=e.cancelable;return{type:"double-click",pointerType:n,button:i,buttons:r,x:a,y:o,native:s,timestamp:e.timestamp,mapPoint:this._getMapPoint(a,o),eventId:l,cancelable:u,stopPropagation:function(){return e.stopPropagation()},async:function(t){return e.async(t)},preventDefault:function(){return e.preventDefault()}}}},{key:"_wrapImmediateClick",value:function(e){var t=e.data,n=t.pointerType,i=t.button,r=t.buttons,a=t.x,o=t.y,s=t.native,l=t.eventId,u=s.pointerId,c=e.cancelable;return{type:"immediate-click",pointerId:u,pointerType:n,button:i,buttons:r,x:a,y:o,native:s,timestamp:e.timestamp,mapPoint:this._getMapPoint(a,o),eventId:l,cancelable:c,stopPropagation:function(){return e.stopPropagation()},async:function(t){return e.async(t)},preventDefault:function(){return e.preventDefault()}}}},{key:"_wrapImmediateDoubleClick",value:function(e){var t=e.data,n=t.pointerType,i=t.button,r=t.buttons,a=t.x,o=t.y,s=t.native,l=t.eventId,u=s.pointerId,c=e.cancelable;return{type:"immediate-double-click",pointerId:u,pointerType:n,button:i,buttons:r,x:a,y:o,native:s,timestamp:e.timestamp,mapPoint:this._getMapPoint(a,o),eventId:l,cancelable:c,stopPropagation:function(){return e.stopPropagation()},async:function(t){return e.async(t)},preventDefault:function(){return e.preventDefault()}}}},{key:"_wrapHold",value:function(e){var t=e.data,n=t.pointerType,i=t.button,r=t.buttons,a=t.x,o=t.y,s=t.native,l=e.cancelable;return{type:"hold",pointerType:n,button:i,buttons:r,x:a,y:o,native:s,timestamp:e.timestamp,mapPoint:this._getMapPoint(a,o),cancelable:l,stopPropagation:function(){return e.stopPropagation()},async:function(t){return e.async(t)},preventDefault:function(){return e.preventDefault()}}}},{key:"_getMapPoint",value:function(e,t){return this.view.toMap((0,u.vW)(e,t),{exclude:[]})}},{key:"_wrapDrag",value:function(e){var t=e.data,n=t.center,i=n.x,r=n.y,a=t.action,o=t.pointerType,s=t.button;if("start"===a&&(this._latestDragStart=t),this._latestDragStart){var u=t.pointer.native,c=t.buttons,d=e.cancelable,p=e.timestamp,h={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};return"end"===a&&(this._latestDragStart=void 0),{type:"drag",action:a,x:i,y:r,origin:h,pointerType:o,button:s,buttons:c,radius:t.radius,angle:(0,l.BV)(t.angle),native:u,timestamp:p,cancelable:d,stopPropagation:function(){return e.stopPropagation()},async:function(t){return e.async(t)},preventDefault:function(){return e.preventDefault()}}}}},{key:"_wrapKeyDown",value:function(e){var t=e.data,n=t.key,i=t.repeat,r=t.native,a=e.cancelable;return{type:"key-down",key:n,repeat:i,native:r,timestamp:e.timestamp,cancelable:a,stopPropagation:function(){return e.stopPropagation()},async:function(t){return e.async(t)},preventDefault:function(){return e.preventDefault()}}}},{key:"_wrapKeyUp",value:function(e){var t=e.data,n=t.key,i=t.native,r=e.cancelable;return{type:"key-up",key:n,native:i,timestamp:e.timestamp,cancelable:r,stopPropagation:function(){return e.stopPropagation()},async:function(t){return e.async(t)},preventDefault:function(){return e.preventDefault()}}}},{key:"_wrapPointer",value:function(e,t){var n=e.data,i=n.x,r=n.y,a=n.button,o=n.buttons,s=n.native,l=n.eventId,u=s.pointerId,c=s.pointerType,d=e.cancelable;return{type:t,x:i,y:r,pointerId:u,pointerType:c,button:a,buttons:o,native:s,timestamp:e.timestamp,eventId:l,cancelable:d,stopPropagation:function(){return e.stopPropagation()},async:function(t){return e.async(t)},preventDefault:function(){return e.preventDefault()}}}},{key:"_wrapPointerDrag",value:function(e){var t=e.data.currentEvent,n=t.x,i=t.y,r=t.buttons,a=t.native,o=t.eventId,s=e.data.startEvent.button,l=e.data.startEvent.native.pointerId,u=e.data.startEvent.native.pointerType,c=e.data.action,d={x:e.data.startEvent.x,y:e.data.startEvent.y},p=e.cancelable;return{type:"pointer-drag",x:n,y:i,pointerId:l,pointerType:u,button:s,buttons:r,action:c,origin:d,native:a,timestamp:e.timestamp,eventId:o,cancelable:p,stopPropagation:function(){return e.stopPropagation()},async:function(t){return e.async(t)},preventDefault:function(){return e.preventDefault()}}}},{key:"_wrapMouseWheel",value:function(e){var t=e.cancelable,n=e.data,i=e.timestamp;return{type:"mouse-wheel",x:n.x,y:n.y,deltaY:n.deltaY,native:n.native,timestamp:i,cancelable:t,stopPropagation:function(){return e.stopPropagation()},async:function(t){return e.async(t)},preventDefault:function(){return e.preventDefault()}}}},{key:"_wrapGamepad",value:function(e){var t=e.data,n=t.action,i=t.state,r=t.device,a=e.cancelable;return{type:"gamepad",device:r,timestamp:e.timestamp,action:n,buttons:i.buttons,axes:i.axes,cancelable:a,stopPropagation:function(){return e.stopPropagation()},async:function(t){return e.async(t)},preventDefault:function(){return e.preventDefault()}}}}]),n}(c.a)},5977:function(e,t,n){n.d(t,{Z:function(){return f}});var i=n(15671),r=n(43144),a=n(60136),o=n(92572),s=n(27366),l=n(85015),u=n(49861),c=(n(25243),n(63780),n(69912)),d=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this)).nativeIndex=null,r._detectedDeviceType="unknown","standard"===e.mapping?r._detectedDeviceType="standard":p.test(e.id)?r._detectedDeviceType="spacemouse":r._detectedDeviceType="unknown",r.nativeIndex=e.index,r}return(0,r.Z)(n,[{key:"native",get:function(){var e=navigator.getGamepads?navigator.getGamepads():[];return null!=this.nativeIndex&&this.nativeIndex<e.length?e[this.nativeIndex]:null}},{key:"deviceType",get:function(){return this._detectedDeviceType}},{key:"axisThreshold",get:function(){return h[this.deviceType]}}]),n}(l.Z);(0,s._)([(0,u.Cb)({nonNullable:!0,readOnly:!0})],d.prototype,"nativeIndex",void 0),(0,s._)([(0,u.Cb)({type:String,readOnly:!0})],d.prototype,"deviceType",null),(0,s._)([(0,u.Cb)({type:Number,readOnly:!0})],d.prototype,"axisThreshold",null),d=(0,s._)([(0,c.j)("esri.views.input.gamepad.GamepadInputDevice")],d);var p=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),h={standard:.15,spacemouse:.025,unknown:0},f=d},83659:function(e,t,n){n.d(t,{G:function(){return s}});var i=n(43144),r=n(15671),a=n(60136),o=n(92572),s=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(){var e;return(0,r.Z)(this,n),(e=t.call(this,!0)).registerIncoming("context-menu",(function(e){e.data.native.preventDefault()})),e}return(0,i.Z)(n)}(n(45371).a)},41722:function(e,t,n){function i(e,t){switch(t){case"primary":return"touch"===e.pointerType||0===e.button;case"secondary":return"touch"!==e.pointerType&&2===e.button;case"tertiary":return"touch"!==e.pointerType&&1===e.button}}function r(e,t){if("touch"===e.pointerType)return!1;switch(t){case"primary":return 0===e.button;case"secondary":return 2===e.button;case"tertiary":return 1===e.button}}n.d(t,{b:function(){return r},h:function(){return i}})},33666:function(e,t,n){n.d(t,{n:function(){return f}});var i,r,a=n(15671),o=n(43144),s=n(97326),l=n(60136),u=n(92572),c=n(17842),d=n(38499),p=n(45371),h=n(15646),f=function(e){(0,l.Z)(n,e);var t=(0,u.Z)(n);function n(e){var i;return(0,a.Z)(this,n),(i=t.call(this,!1))._navigationTouch=e,i._startStateModifiers=new Set,i._activePointerMap=new Map,i._isDragging=!1,i._isCurrentDragSuppressed=!1,i._drag=i.registerOutgoing("drag"),i.registerIncoming("pointer-drag",i._handlePointerDrag.bind((0,s.Z)(i))),i.registerIncoming("pointer-up",i._handlePointerUpAndPointerLost.bind((0,s.Z)(i))),i.registerIncoming("pointer-capture-lost",i._handlePointerUpAndPointerLost.bind((0,s.Z)(i))),i.registerIncoming("pointer-cancel",i._handlePointerUpAndPointerLost.bind((0,s.Z)(i))),i}return(0,o.Z)(n,[{key:"_createPayload",value:function(e,t,n,i){return{action:e,pointerType:this._pointerType,button:this._mouseButton,buttons:t.buttons,timestamp:i,pointers:g(this._activePointerMap),pointer:t,angle:n.angle,radius:n.radius,center:n.center}}},{key:"_addPointer",value:function(e){var t=e.native.pointerId,n=y(this._activePointerMap).angle,i={event:e,initialAngle:0,lastAngle:0};this._activePointerMap.set(t,i);var r=m(i,v(this._activePointerMap));i.initialAngle=r,i.lastAngle=r,this._updatePointerAngles(n)}},{key:"_updatePointer",value:function(e){if(!e||null!=e.x||null!=e.y){var t=e.native.pointerId,n=this._activePointerMap.get(t);n?n.event=e:this._addPointer(e)}}},{key:"_removePointer",value:function(e){var t=y(this._activePointerMap).angle;this._activePointerMap.delete(e),this._updatePointerAngles(t)}},{key:"_updatePointerAngles",value:function(e){var t=y(this._activePointerMap);this._activePointerMap.forEach((function(n){n.initialAngle=m(n,t)-e,n.lastAngle=m(n,t)-e}))}},{key:"_emitEvent",value:function(e,t,n){var i=y(this._activePointerMap);this._drag.emit(this._createPayload(e,t,i,n),void 0,this._startStateModifiers)}},{key:"_handlePointerUpAndPointerLost",value:function(e){var t=e.data.native.pointerId,n=(0,d.HA)(e.timestamp);this._activePointerMap.get(t)&&(1===this._activePointerMap.size?(this._updatePointer(e.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",e.data,n),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(t)):(this._removePointer(t),this._emitEvent("removed",e.data,(0,d.HA)(e.timestamp))))}},{key:"_handlePointerDrag",value:function(e){var t=e.data,n=t.currentEvent,i=(0,d.HA)(e.timestamp);switch(t.action){case"start":case"update":this._isDragging?this._activePointerMap.has(n.native.pointerId)?(this._updatePointer(n),!this._isCurrentDragSuppressed&&this._emitEvent("update",n,i)):(this._addPointer(n),this._emitEvent("added",n,i),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(n),this._pointerType=e.data.startEvent.pointerType,this._mouseButton=e.data.startEvent.button,this._startStateModifiers=e.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",n,i))}}},{key:"_isSuppressed",get:function(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&"touch"===this._pointerType&&1===this._activePointerMap.size}}]),n}(p.a);function v(e){var t=[];return e.forEach((function(e){t.push((0,c.vW)(e.event.x,e.event.y))})),(0,h.y_)(t)}function y(e){var t=v(e),n=0;return e.forEach((function(e){for(var i=m(e,t),r=i-e.lastAngle;r>Math.PI;)r-=2*Math.PI;for(;r<-Math.PI;)r+=2*Math.PI;i=e.lastAngle+r,e.lastAngle=i;var a=i-e.initialAngle;n+=a})),{angle:n/=e.size||1,radius:t.radius,center:t.center}}function g(e){var t=new Map;return e.forEach((function(e,n){return t.set(n,e.event)})),t}function m(e,t){var n=e.event,i=n.x-t.center.x,r=n.y-t.center.y;return Math.atan2(r,i)}(r=i||(i={}))[r.Left=0]="Left",r[r.Middle=1]="Middle",r[r.Right=2]="Right",r[r.Back=3]="Back",r[r.Forward=4]="Forward",r[r.Undefined=-1]="Undefined"},11802:function(e,t,n){n.d(t,{y:function(){return f}});var i=n(15671),r=n(43144),a=n(97326),o=n(11752),s=n(61120),l=n(60136),u=n(92572),c=n(84702),d=n(45371),p=n(46525),h=n(15646),f=function(e){(0,l.Z)(n,e);var t=(0,u.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p.M.maximumDoubleClickDelay,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p.M.maximumDoubleClickDistance,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:p.M.maximumDoubleTouchDelay,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:p.M.maximumDoubleTouchDistance,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:c.m;return(0,i.Z)(this,n),(e=t.call(this,!1))._maximumDoubleClickDelay=r,e._maximumDoubleClickDistance=o,e._maximumDoubleTouchDelay=s,e._maximumDoubleTouchDistance=l,e._clock=u,e._pointerState=new Map,e._immediateDoubleClick=e.registerOutgoing("immediate-double-click"),e.registerIncoming("pointer-down",e._handlePointerDown.bind((0,a.Z)(e))),e.registerIncoming("pointer-up",e._handlePointerUp.bind((0,a.Z)(e))),e}return(0,r.Z)(n,[{key:"onUninstall",value:function(){this._pointerState.forEach((function(e){e.immediateDoubleClick&&e.immediateDoubleClick.timeoutHandle.remove()})),(0,o.Z)((0,s.Z)(n.prototype),"onUninstall",this).call(this)}},{key:"_handlePointerDown",value:function(e){var t=e.data,n=(0,h.au)(t);if(!this._pointerState.has(n)){var i={downButton:t.native.button,immediateDoubleClick:null};this._pointerState.set(n,i),this.startCapturingPointer(t.native)}}},{key:"_handlePointerUp",value:function(e){var t=e.data,n=(0,h.au)(t),i=this._pointerState.get(n);if(i&&i.downButton===t.native.button){var r=i.immediateDoubleClick;if(r){r.timeoutHandle.remove();var a="touch"===e.data.native.pointerType?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;(0,h.nk)(r,e.data)>a?this._startImmediateDoubleClick(e,i):(this._immediateDoubleClick.emit(e.data,void 0,r.modifiers),this._removeState(t))}else this._startImmediateDoubleClick(e,i)}}},{key:"_startImmediateDoubleClick",value:function(e,t){var n=this,i="touch"===e.data.native.pointerType?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay;t.immediateDoubleClick={x:e.data.x,y:e.data.y,modifiers:e.modifiers,timeoutHandle:this._clock.setTimeout((function(){return n._removeState(e.data)}),i)}}},{key:"_removeState",value:function(e){var t=(0,h.au)(e);this._pointerState.delete(t),this.stopCapturingPointer(e.native),this.refreshHasPendingInputs()}}]),n}(d.a)},64544:function(e,t,n){n.d(t,{e:function(){return _}});var i=n(15671),r=n(43144),a=n(97326),o=n(11752),s=n(61120),l=n(60136),u=n(92572),c=n(84702),d=n(92026),p=n(45371),h=n(15646),f=300,v=1.5,y=6,g=6,m=500,_=function(e){(0,l.Z)(n,e);var t=(0,u.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:g,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:m,d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:c.m;return(0,i.Z)(this,n),(e=t.call(this,!1))._maximumClickDelay=r,e._movementUntilMouseDrag=o,e._movementUntilPenDrag=s,e._movementUntilTouchDrag=l,e._holdDelay=u,e._clock=d,e._pointerState=new Map,e._pointerDrag=e.registerOutgoing("pointer-drag"),e._immediateClick=e.registerOutgoing("immediate-click"),e._pointerHold=e.registerOutgoing("hold"),e.registerIncoming("pointer-down",e._handlePointerDown.bind((0,a.Z)(e))),e.registerIncoming("pointer-up",(function(t){e._handlePointerLoss(t,"pointer-up")})),e.registerIncoming("pointer-capture-lost",(function(t){e._handlePointerLoss(t,"pointer-capture-lost")})),e.registerIncoming("pointer-cancel",(function(t){e._handlePointerLoss(t,"pointer-cancel")})),e._moveHandle=e.registerIncoming("pointer-move",e._handlePointerMove.bind((0,a.Z)(e))),e._moveHandle.pause(),e}return(0,r.Z)(n,[{key:"onUninstall",value:function(){this._pointerState.forEach((function(e){e.holdTimeout=(0,d.hw)(e.holdTimeout)})),(0,o.Z)((0,s.Z)(n.prototype),"onUninstall",this).call(this)}},{key:"_handlePointerDown",value:function(e){var t=this,n=e.data,i=n.native.pointerId,r=null;0===this._pointerState.size&&(r=this._clock.setTimeout((function(){var n=t._pointerState.get(i);if(n){if(!n.isDragging){var r=n.previousEvent;t._pointerHold.emit(r,void 0,e.modifiers),n.holdEmitted=!0}n.holdTimeout=null}}),this._holdDelay));var a={startEvent:n,previousEvent:n,startTimestamp:e.timestamp,isDragging:!1,downButton:n.native.button,holdTimeout:r,modifiers:new Set};this._pointerState.set(i,a),this.startCapturingPointer(n.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(e)}},{key:"_createPointerDragData",value:function(e,t,n){return{action:e,startEvent:t.startEvent,previousEvent:t.previousEvent,currentEvent:n}}},{key:"_handlePointerMove",value:function(e){var t=e.data,n=t.native.pointerId,i=this._pointerState.get(n);i&&(i.isDragging?this._pointerDrag.emit(this._createPointerDragData("update",i,t),void 0,i.modifiers):(0,h.WI)(t,i.startEvent)>this._getDragThreshold(t.native.pointerType)&&this._startDragging(e),i.previousEvent=t)}},{key:"_getDragThreshold",value:function(e){switch(e){case"touch":return this._movementUntilTouchDrag;case"pen":return this._movementUntilPenDrag;default:return this._movementUntilMouseDrag}}},{key:"_startDragging",value:function(e){var t=this,n=e.data,i=n.native.pointerId;this._pointerState.forEach((function(r){null!=r.holdTimeout&&(r.holdTimeout.remove(),r.holdTimeout=null),r.isDragging||(r.modifiers=e.modifiers,r.isDragging=!0,i===r.startEvent.native.pointerId?t._pointerDrag.emit(t._createPointerDragData("start",r,n)):t._pointerDrag.emit(t._createPointerDragData("start",r,r.previousEvent),e.timestamp))}))}},{key:"_handlePointerLoss",value:function(e,t){var n=e.data,i=n.native.pointerId,r=this._pointerState.get(i);r&&(null!=r.holdTimeout&&(r.holdTimeout.remove(),r.holdTimeout=null),r.isDragging?this._pointerDrag.emit(this._createPointerDragData("end",r,"pointer-up"===t?n:r.previousEvent),void 0,r.modifiers):"pointer-up"===t&&r.downButton===n.native.button&&e.timestamp-r.startTimestamp<=this._maximumClickDelay&&!r.holdEmitted&&this._immediateClick.emit(n),this._pointerState.delete(i),this.stopCapturingPointer(n.native),0===this._pointerState.size&&this._moveHandle.pause())}}]),n}(p.a)},46525:function(e,t,n){n.d(t,{M:function(){return h},y:function(){return f}});var i=n(15671),r=n(43144),a=n(97326),o=n(60136),s=n(92572),l=n(84702),u=n(77427),c=n(92026),d=n(45371),p=n(15646),h={maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,maximumDoubleTouchDistance:35},f=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h.maximumDoubleClickDelay,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h.maximumDoubleClickDistance,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h.maximumDoubleTouchDelay,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:h.maximumDoubleTouchDistance,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:l.m;return(0,i.Z)(this,n),(e=t.call(this,!1))._maximumDoubleClickDelay=r,e._maximumDoubleClickDistance=o,e._maximumDoubleTouchDelay=s,e._maximumDoubleTouchDistance=u,e._clock=c,e._pointerState=new Map,e._click=e.registerOutgoing("click"),e._doubleClick=e.registerOutgoing("double-click"),e.registerIncoming("immediate-click",e._handleImmediateClick.bind((0,a.Z)(e))),e.registerIncoming("pointer-down",e._handlePointerDown.bind((0,a.Z)(e))),e}return(0,r.Z)(n,[{key:"onUninstall",value:function(){this._pointerState.forEach((function(e){return e.doubleClickTimer=(0,c.hw)(e.doubleClickTimer)}))}},{key:"hasPendingInputs",get:function(){return(0,u.oE)(this._pointerState,(function(e){return null!=e.doubleClickTimer}))}},{key:"_clearDoubleClickTimer",value:function(e,t){var n=this._pointerState.get(e);n&&(n.doubleClickTimer=(0,c.hw)(n.doubleClickTimer),t&&this._click.emit(n.event.data,void 0,n.event.modifiers),this._pointerState.delete(e),this.refreshHasPendingInputs())}},{key:"_doubleClickTimeoutExceeded",value:function(e){var t=this._pointerState.get(e);1===t.pointerDownCount&&this._click.emit(t.event.data,void 0,t.event.modifiers),t.doubleClickTimer=null,this._pointerState.delete(e),this.refreshHasPendingInputs()}},{key:"_getPointerId",value:function(e){var t=e.native,n=t.pointerId,i=t.pointerType,r=t.button;return"mouse"===i?"".concat(n,":").concat(r):"".concat(i)}},{key:"_handleImmediateClick",value:function(e){var t=e.data,n=t.native.pointerType,i=this._getPointerId(t);if(this._pointerState.has(i)){var r=this._pointerState.get(i),a=r.event,o=a.data,s=a.modifiers,l="touch"===n?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;(0,p.nk)(o,t)>l?(this._clearDoubleClickTimer(i,!0),this._startClick(e)):(this._clearDoubleClickTimer(i,!1),2===r.pointerDownCount&&this._doubleClick.emit(o,void 0,s))}else this._startClick(e)}},{key:"_handlePointerDown",value:function(e){var t=(0,p.au)(e.data),n=this._pointerState.get(t);n&&(n.pointerDownCount+=1)}},{key:"_startClick",value:function(e){var t=this,n=e.data,i=n.native.pointerType,r=(0,p.au)(n),a="touch"===i?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,o=this._clock.setTimeout((function(){return t._doubleClickTimeoutExceeded(r)}),a);this._pointerState.set(r,{event:e,doubleClickTimer:o,pointerDownCount:1}),this.refreshHasPendingInputs()}}]),n}(d.a)},15646:function(e,t,n){n.d(t,{WI:function(){return o},au:function(){return l},nk:function(){return a},y_:function(){return s}});var i=n(29439),r=n(17842);function a(e,t){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)}function o(e,t){var n=t.x-e.x,i=t.y-e.y;return Math.sqrt(n*n+i*i)}function s(e,t){if(t?(t.radius=0,t.center.x=0,t.center.y=0):t={radius:0,center:(0,r.vW)()},0===e.length)return t;if(1===e.length)return t.center.x=e[0].x,t.center.y=e[0].y,t;if(2===e.length){var n=(0,i.Z)(e,2),a=n[0],o=n[1],s=o.x-a.x,l=o.y-a.y;return t.radius=Math.sqrt(s*s+l*l)/2,t.center.x=(a.x+o.x)/2,t.center.y=(a.y+o.y)/2,t}for(var u=0,c=0,d=0;d<e.length;d++)u+=e[d].x,c+=e[d].y;u/=e.length,c/=e.length;for(var p=e.map((function(e){return e.x-u})),h=e.map((function(e){return e.y-c})),f=0,v=0,y=0,g=0,m=0,_=0,b=0,w=0;w<p.length;w++){var k=p[w],C=h[w],M=k*k,Z=C*C;f+=M,v+=Z,y+=k*C,g+=M*k,m+=Z*C,_+=k*Z,b+=C*M}var x=.5*(g+_),I=.5*(m+b),T=f*v-y*y,S=(x*v-I*y)/T,A=(f*I-y*x)/T,F=(0,r.vW)(S+u,A+c);return{radius:Math.sqrt(S*S+A*A+(f+v)/e.length),center:F}}function l(e){var t=e.native,n=t.pointerId,i=t.button,r=t.pointerType;return"mouse"===r?"".concat(n,":").concat(i):"".concat(r)}},99034:function(e,t,n){var i,r,a;n.d(t,{Q9:function(){return r},bH:function(){return i},jg:function(){return a}}),function(e){e[e.USER=0]="USER",e[e.MANAGER=1]="MANAGER"}(i||(i={})),function(e){e[e.None=0]="None",e[e.Unfocused=1]="Unfocused",e[e.Focused=2]="Focused",e[e.Unselected=4]="Unselected",e[e.Selected=8]="Selected",e[e.All=15]="All"}(r||(r={})),function(e){e[e.None=0]="None",e[e.Custom1=16]="Custom1",e[e.Custom2=32]="Custom2",e[e.Custom3=64]="Custom3",e[e.Custom4=128]="Custom4",e[e.Custom5=256]="Custom5",e[e.Custom6=512]="Custom6",e[e.Custom7=1024]="Custom7",e[e.Custom8=2048]="Custom8",e[e.Custom9=4096]="Custom9",e[e.Custom10=8192]="Custom10",e[e.Custom11=16384]="Custom11",e[e.Custom12=32768]="Custom12",e[e.All=65520]="All"}(a||(a={}))},73320:function(e,t,n){n.d(t,{CY:function(){return o},U_:function(){return s},_r:function(){return l},cm:function(){return a}});var i=n(11186);function r(e){var t=e*e;return e<0&&(t*=-1),t}function a(e){return e.translation[0]=0,e.translation[1]=0,e.translation[2]=0,e.heading=0,e.tilt=0,e}function o(e,t,n){var a=n,o=e.state,s=e.device,l="forward-down"===t.tiltDirection?1:-1;return"standard"===s.deviceType?(a.translation[0]=r(o.axes[0]),a.translation[1]=r(o.axes[1]),a.translation[2]=r(o.buttons[7])-r(o.buttons[6]),a.heading=r(o.axes[2]),a.tilt=r(o.axes[3])):"spacemouse"===s.deviceType&&(a.translation[0]=1.2*r(o.axes[0]),a.translation[1]=1.2*r(o.axes[1]),a.translation[2]=2*-r(o.axes[2]),a.heading=1.2*r(o.axes[5]),a.tilt=1.2*r(o.axes[3])),a.tilt*=l,(0,i.g)(a.translation,a.translation,1),a}function s(e,t){var n=t;return n.translation[0]=e[1]-e[0],n.translation[1]=e[3]-e[2],n.translation[2]=e[4]-e[5],n.heading=e[7]-e[6],n.tilt=e[8]-e[9],n.zoom=e[10]-e[11],n}function l(e){return 0===e.translation[0]&&0===e.translation[1]&&0===e.translation[2]&&0===e.heading&&0===e.tilt&&0===e.zoom}},87770:function(e,t,n){n.d(t,{B:function(){return o}});var i=n(10064),r=n(90316),a=n(49800);function o(e){var t=(0,r.hc)(e);if(!t.available)return new i.Z("webgl:required","WebGL is required but not supported.");if("3d"===e&&t.majorPerformanceCaveat)return new i.Z("webgl:major-performance-caveat-detected","Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist.");if(!t.supportsHighPrecisionFragment)return new i.Z("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported.");if(!t.supportsVertexShaderSamplers)return new i.Z("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported.");if(t.type===a.zO.WEBGL1){if(!t.supportsElementIndexUint)return new i.Z("webgl:element-index-uint-required","WebGL support for uint vertex indices is required but not supported.");if(!t.supportsStandardDerivatives)return new i.Z("webgl:standard-derivatives-required","WebGL support for standard derivatives is required but not supported.");if(!t.supportsInstancedArrays)return new i.Z("webgl:instanced-arrays-required","WebGL support for instanced rendering is required but not supported.")}return null}},69787:function(e,t,n){n.d(t,{Av:function(){return s},_1:function(){return a},lu:function(){return l},rs:function(){return o},tl:function(){return r}});var i=n(92026);function r(e){return e&&"function"==typeof e.highlight}function a(e){return e&&"function"==typeof e.maskOccludee}function o(e,t,n){return(0,i.Wi)(e)||e>n&&(0===t||e<t)}function s(e,t){return(0,i.pC)(e)&&e>0||(0,i.pC)(t)&&t>0}function l(e){var t,n,i=e.effectiveScaleRange;return{minScale:null!==(t=null===i||void 0===i?void 0:i.minScale)&&void 0!==t?t:0,maxScale:null!==(n=null===i||void 0===i?void 0:i.maxScale)&&void 0!==n?n:0}}},7796:function(e,t,n){n.d(t,{$3:function(){return y},LI:function(){return h},RZ:function(){return f},TT:function(){return v},cv:function(){return l},uz:function(){return s},v8:function(){return u}});var i=n(1413),r=(n(93169),n(16889)),a=n(92026);function o(e,t){var n=e||{},i=n.format,a=n.quality,o=n.rotation,s=n.disableDecorations,l=g(e,t.padding),u=function(e,t){var n={x:0,y:0,width:t.width,height:t.height};if(e&&e.area){null!=e.area.x&&(n.x=Math.floor(e.area.x)),null!=e.area.y&&(n.y=Math.floor(e.area.y));var i=null!=e.area.width?Math.floor(e.area.width):null,r=null!=e.area.height?Math.floor(e.area.height):null;if(n.width=t.width-n.x,n.height=t.height-n.y,null!=i&&null!=r)n.width=Math.min(n.width,i),n.height=Math.min(n.height,r);else if(null==i&&null!=r){var a=Math.min(n.width,i);n.height=a/n.width*n.height,n.width=a}else if(null!=i&&null==r){var o=Math.min(n.height,r);n.width=o/n.height*n.width,n.height=o}}return function(e,t){var n=Math.floor(Math.max(e.x,0)),i=Math.floor(Math.max(e.y,0)),r={x:n,y:i,width:Math.floor(Math.min(e.width,t.width-n)),height:Math.floor(Math.min(e.height,t.height-i))},a=r.width/r.height,o=e.width/e.height;if(o===a)return r;if(o>a){var s=Math.floor(r.width/o),l=r.height-s;return{x:r.x,y:Math.floor(r.y+l/2),width:r.width,height:s}}var u=Math.floor(r.height*o),c=r.width-u;return{x:Math.floor(r.x+c/2),y:r.y,width:u,height:r.height}}(function(e,t){if(!t||null==t.width||null==t.height)return e;var n=t.width/t.height,i=e.width/e.height;if(i===n)return e;if(i<n){var r=Math.floor(e.height*n);return e.x-=(r-e.width)/2,e.width=r,e}var a=Math.floor(e.width/n);return e.y-=(a-e.height)/2,e.height=a,e}(n,e),t)}(e,{width:t.width-l.left-l.right,height:t.height-l.top-l.bottom}),c=function(e,t){if(!e)return t;var n=e.width,i=e.height;if(null!=n&&null!=i)return{width:Math.floor(n),height:Math.floor(i)};if(null==n&&null==i)return t;var r=t.width/t.height;return null==i?{width:Math.floor(n),height:Math.floor(n/r)}:{width:Math.floor(i*r),height:Math.floor(i)}}(e,u),d=c.width,p=c.height,h=m(i),f=w[h];return{format:h,quality:(0,r.uZ)(null!=a?a:f,0,100),area:u,width:d,height:p,rotation:o,disableDecorations:!!s,ignoreBackground:!(!e||!e.ignoreBackground),ignorePadding:!(!e||!e.ignorePadding)}}function s(e,t){var n=o(e,t),i=n.area,r=n.width/i.width,a=g(n,t.padding),s=a.left+a.right,l=a.top+a.bottom,u=t.width-s,c=t.height-l,d=Math.floor(u*r+s),p=Math.floor(c*r+l),h=e&&e.layers?e.layers:[],f=n.ignoreBackground,v=n.ignorePadding;return{framebufferWidth:d,framebufferHeight:p,region:{x:Math.floor(i.x*r)+a.left,y:Math.floor(i.y*r)+a.top,width:n.width,height:n.height},format:n.format,quality:n.quality,rotation:n.rotation,pixelRatio:r,layers:h,disableDecorations:n.disableDecorations,ignoreBackground:f,ignorePadding:v,objectAndLayerIdColor:!1}}function l(e,t,n){var i=c(e,n),r=i.ctx,a=i.canvas,o=r.getImageData(0,0,e.width,e.height),s=function(e,t){var n=_[t.format],i=t.quality/100;return e.toDataURL(n,i)}(a,t);return d(a),{dataUrl:s,data:o}}function u(e,t){var n=c(e,t),i=n.ctx,r=n.canvas,a=i.getImageData(0,0,e.width,e.height);return d(r),a}function c(e,t){var n=((0,a.Wi)(p)&&(p=document.createElement("canvas")),p);t.premultipliedAlpha&&function(e){for(var t=e.data,n=t.length,i=0;i<n;i+=4){var r=t[i+3];if(255!==r&&r>0){var a=255/r;t[i+0]=t[i+0]*a,t[i+1]=t[i+1]*a,t[i+2]=t[i+2]*a}}}(e),n.width=e.width,n.height=e.height;var i=n.getContext("2d",{willReadFrequently:!0});return i.putImageData(e,0,0),t.flipY&&function(e){e.save(),e.globalCompositeOperation="copy",e.scale(1,-1),e.translate(0,-e.canvas.height),e.drawImage(e.canvas,0,0),e.restore()}(i),{ctx:i,canvas:n}}function d(e){e.width=0,e.height=0}var p=null;function h(e,t){var n=m(e),i=w[n];return{format:n,quality:(0,r.uZ)(null!=t?t:i,0,100)}}function f(e,t){return t/Math.max(e[0],e[1])}function v(e,t,n){for(var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e.width-i,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:e.height-r,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=e.data,u=t.width,c=t.height,d=t.data,p=a/u,h=o/c,f=Math.ceil(p/2),v=Math.ceil(h/2),y=e.width,g=0;g<c;g++)for(var m=0;m<u;m++){for(var _=4*(m+(s?c-g-1:g)*u),b=0,w=0,k=0,C=0,M=0,Z=0,x=(g+.5)*h,I=Math.floor(g*h);I<(g+1)*h;I++)for(var T=Math.abs(x-(I+.5))/v,S=(m+.5)*p,A=T*T,F=Math.floor(m*p);F<(m+1)*p;F++){var P=Math.abs(S-(F+.5))/f,L=Math.sqrt(A+P*P);if(!(L>=1)){var E=2*L*L*L-3*L*L+1,R=4*(i+F+(r+I)*y);Z+=E*l[R+3],w+=E,!n&&l[R+3]<255&&(E=E*l[R+3]/255),k+=E*l[R],C+=E*l[R+1],M+=E*l[R+2],b+=E}}d[_]=k/b,d[_+1]=C/b,d[_+2]=M/b,d[_+3]=Z/w}return t}function y(e,t,n){if(!t)return e;var r=e.framebufferWidth,a=e.framebufferHeight,o=e.pixelRatio,s=e.region,l=g(e,n),u=l.left+l.right,c=l.top+l.bottom,d=r-u,p=a-c,h=Math.min(8,Math.min((2048-u)/d,(2048-c)/p));return h<1.5?e:(0,i.Z)((0,i.Z)({},e),{},{framebufferWidth:Math.round(d*h)+u,framebufferHeight:Math.round(p*h)+c,pixelRatio:o*h,resample:{region:{x:Math.round((s.x-l.left)*h)+l.left,y:Math.round((s.y-l.top)*h)+l.top,width:Math.round(s.width*h),height:Math.round(s.height*h)},width:r,height:a}})}function g(e,t){return!t||e&&e.ignorePadding?k:t}function m(e){switch(e){case"png":case"jpg":case"jpeg":return e;default:return b}}var _={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},b="png",w={png:100,jpg:98,jpeg:98},k={top:0,right:0,bottom:0,left:0}},41356:function(e,t,n){n.d(t,{Z:function(){return Be}});var i=n(15671),r=n(43144),a=n(11752),o=n(61120),s=n(60136),l=n(92572),u=n(27366),c=(n(93169),n(32718),n(94172)),d=n(49861),p=(n(25243),n(63780),n(69912)),h=n(85015),f=n(50093),v=n(89125);var y="esri-component",g=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(){var e;return(0,i.Z)(this,n),(e=t.apply(this,arguments)).widget=null,e}return(0,r.Z)(n,[{key:"destroy",value:function(){this.widget&&this.widget.destroy(),this.node=null}},{key:"id",get:function(){return this.get("widget.id")||this.get("node.id")}},{key:"node",set:function(e){var t=this._get("node");e!==t&&(e&&e.classList.add(y),t&&t.classList.remove(y),this._set("node",e))}},{key:"castNode",value:function(e){return e?"string"==typeof e||function(e){return e&&"nodeType"in e}(e)?(this._set("widget",null),(0,f.L7)(e)):(function(e){return e&&"function"==typeof e.render}(e)&&!e.domNode&&(e.domNode=document.createElement("div")),this._set("widget",e),e.domNode):(this._set("widget",null),null)}}]),n}(h.Z);(0,u._)([(0,d.Cb)({dependsOn:[]})],g.prototype,"id",null),(0,u._)([(0,d.Cb)()],g.prototype,"node",null),(0,u._)([(0,v.p)("node")],g.prototype,"castNode",null),(0,u._)([(0,d.Cb)({readOnly:!0})],g.prototype,"widget",void 0);var m=g=(0,u._)([(0,p.j)("esri.views.ui.Component")],g),_=n(1413),b=n(37762),w=n(29439),k=(n(59166),n(91505)),C=n(37384),M=n(37680),Z=n(36257),x={left:0,top:0,bottom:0,right:0},I={bottom:30,top:15,right:15,left:15},T="manual",S="esri-ui",A={ui:S,corner:"".concat(S,"-corner"),innerContainer:"".concat(S,"-inner-container"),manualContainer:"".concat(S,"-manual-container"),cornerContainer:"".concat(S,"-corner-container"),topLeft:"".concat(S,"-top-left"),topRight:"".concat(S,"-top-right"),bottomLeft:"".concat(S,"-bottom-left"),bottomRight:"".concat(S,"-bottom-right")};function F(e){var t=e,n="object"==typeof t&&null!==t&&Object.getPrototypeOf(t);return null!==n&&n!==Object.prototype||!("component"in t||"index"in t||"position"in t)?null:e}function P(e,t){var n=t.top,i=t.bottom,r=t.left,a=t.right;e.style.top=n,e.style.bottom=i,e.style.left=r,e.style.right=a}var L=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e))._cornerNameToContainerLookup={},r._positionNameToContainerLookup={},r._components=new Array,r._componentToKey=new Map,r._locale=(0,Z.Kd)(),r.view=null,r._applyViewPadding=function(){var e=r.container;e&&P(e,r._toPxPosition(r._getViewPadding()))},r._applyUIPadding=function(){var e=r._innerContainer;e&&P(e,r._toPxPosition(r.padding))},r._initContainers(),r}return(0,r.Z)(n,[{key:"initialize",value:function(){var e=this;this.addHandles([(0,c.YP)((function(){var t;return[null===(t=e.view)||void 0===t?void 0:t.padding,e.container]}),this._applyViewPadding,c.nn),(0,c.YP)((function(){return e.padding}),this._applyUIPadding,c.nn),(0,c.YP)((function(){return[e.container,e._locale]}),(function(e){var t=(0,w.Z)(e,2),n=t[0],i=t[1];n&&n.setAttribute("lang",i)}),c.nn),(0,Z.qe)((function(t){e._locale=t}))])}},{key:"destroy",value:function(){this.container=null;var e,t=(0,b.Z)(this._components);try{for(t.s();!(e=t.n()).done;){e.value.destroy()}}catch(n){t.e(n)}finally{t.f()}this._components.length=0,this._componentToKey.clear()}},{key:"container",set:function(e){var t=this._get("container");e!==t&&(e&&(e.classList.add(A.ui),(0,C.V$)(e),this._attachContainers(e)),t&&(t.classList.remove(A.ui),P(t,{top:"",bottom:"",left:"",right:""}),(0,f.cS)(t)),this._set("container",e))}},{key:"height",get:function(){var e=this.get("view.height")||0;if(0===e)return e;var t=this._getViewPadding(),n=t.top+t.bottom;return Math.max(e-n,0)}},{key:"padding",get:function(){return this._get("padding")},set:function(e){this._overrideIfSome("padding",e)}},{key:"castPadding",value:function(e){return"number"==typeof e?{bottom:e,top:e,right:e,left:e}:(0,_.Z)((0,_.Z)({},I),e)}},{key:"width",get:function(){var e=this.get("view.width")||0;if(0===e)return e;var t=this._getViewPadding(),n=t.left+t.right;return Math.max(e-n,0)}},{key:"add",value:function(e,t){var n,i,r,a,o=this;if(Array.isArray(e))e.forEach((function(e){return o.add(e,t)}));else{var s=F(e);s&&(r=(n=s).index,t=n.position,e=n.component,a=n.key),t&&"object"==typeof t&&(r=(i=t).index,a=i.key,t=i.position),!e||t&&!this._isValidPosition(t)||this._add(e,t,r,a)}}},{key:"remove",value:function(e,t){var n=this;if(e){if(Array.isArray(e))return e.map((function(e){return n.remove(e,t)}));var i=this._find(e);if(i){var r=this._componentToKey;if(r.has(e)&&r.get(e)!==t)return;var a=this._components.indexOf(i);return i.node.parentNode&&i.node.parentNode.removeChild(i.node),this._componentToKey.delete(e),this._components.splice(a,1)[0]}}}},{key:"empty",value:function(e){var t=this;return Array.isArray(e)?e.map((function(e){return t.empty(e)})).reduce((function(e,t){return e.concat(t)})):(e=e||T)===T?Array.prototype.slice.call(this._manualContainer.children).filter((function(e){return!e.classList.contains(A.corner)})).map((function(e){return t.remove(e)})):this._isValidPosition(e)?Array.prototype.slice.call(this._cornerNameToContainerLookup[e].children).map(this.remove,this):null}},{key:"move",value:function(e,t){var n=this;if(Array.isArray(e)&&e.forEach((function(e){return n.move(e,t)})),e){var i,r=F(e)||F(t);if(r&&(i=r.index,t=r.position,e=r.component||e),!t||this._isValidPosition(t)){var a=this.remove(e);a&&this.add(a,{position:t,index:i})}}}},{key:"find",value:function(e){if(!e)return null;var t=this._findById(e);return t&&(t.widget||t.node)}},{key:"getPosition",value:function(e){for(var t in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[t].contains(e))return t;return null}},{key:"_add",value:function(e,t,n,i){e instanceof m||(e=new m({node:e})),this._place({component:e,position:t,index:n}),this._components.push(e),i&&this._componentToKey.set(e,i)}},{key:"_find",value:function(e){return e?e instanceof m?this._findByComponent(e):"string"==typeof e?this._findById(e):this._findByNode(e.domNode||e):null}},{key:"_getViewPadding",value:function(){return this.get("view.padding")||x}},{key:"_attachContainers",value:function(e){e.appendChild(this._innerContainer),e.appendChild(this._manualContainer)}},{key:"_initContainers",value:function(){var e=document.createElement("div");e.classList.add(A.innerContainer),e.classList.add(A.cornerContainer);var t=document.createElement("div");t.classList.add(A.innerContainer),t.classList.add(A.manualContainer);var n=document.createElement("div");n.classList.add(A.topLeft),n.classList.add(A.corner),e.appendChild(n);var i=document.createElement("div");i.classList.add(A.topRight),i.classList.add(A.corner),e.appendChild(i);var r=document.createElement("div");r.classList.add(A.bottomLeft),r.classList.add(A.corner),e.appendChild(r);var a=document.createElement("div");a.classList.add(A.bottomRight),a.classList.add(A.corner),e.appendChild(a),this._innerContainer=e,this._manualContainer=t;var o=(0,M.dZ)();this._cornerNameToContainerLookup={"top-left":n,"top-right":i,"bottom-left":r,"bottom-right":a,"top-leading":o?i:n,"top-trailing":o?n:i,"bottom-leading":o?a:r,"bottom-trailing":o?r:a},this._positionNameToContainerLookup=(0,_.Z)({manual:t},this._cornerNameToContainerLookup)}},{key:"_isValidPosition",value:function(e){return!!this._positionNameToContainerLookup[e]}},{key:"_place",value:function(e){var t=e.component,n=e.position||T,i=e.index,r=this._positionNameToContainerLookup[n],a=null!=i&&i>-1;if(function(e){return e&&!e._started&&"function"==typeof e.postMixInProperties&&"function"==typeof e.buildRendering&&"function"==typeof e.postCreate&&"function"==typeof e.startup}(t.widget)&&t.widget.startup(),a){var o=Array.prototype.slice.call(r.children);0!==i?i>=o.length?r.appendChild(t.node):(0,f.Vt)(t.node,o[i]):r.firstChild?(0,f.Vt)(t.node,r.firstChild):r.appendChild(t.node)}else r.appendChild(t.node)}},{key:"_toPxPosition",value:function(e){return{top:this._toPxUnit(e.top),left:this._toPxUnit(e.left),right:this._toPxUnit(e.right),bottom:this._toPxUnit(e.bottom)}}},{key:"_toPxUnit",value:function(e){return 0===e?"0":e+"px"}},{key:"_findByComponent",value:function(e){var t,n=null;return this._components.some((function(i){return(t=i===e)&&(n=i),t})),n}},{key:"_findById",value:function(e){var t,n=null;return this._components.some((function(i){return(t=i.id===e)&&(n=i),t})),n}},{key:"_findByNode",value:function(e){var t,n=null;return this._components.some((function(i){return(t=i.node===e)&&(n=i),t})),n}}]),n}(k.Z.EventedAccessor);(0,u._)([(0,d.Cb)()],L.prototype,"_locale",void 0),(0,u._)([(0,d.Cb)()],L.prototype,"container",null),(0,u._)([(0,d.Cb)()],L.prototype,"height",null),(0,u._)([(0,d.Cb)({value:I})],L.prototype,"padding",null),(0,u._)([(0,v.p)("padding")],L.prototype,"castPadding",null),(0,u._)([(0,d.Cb)()],L.prototype,"view",void 0),(0,u._)([(0,d.Cb)()],L.prototype,"width",null);var E=L=(0,u._)([(0,p.j)("esri.views.ui.UI")],L),R=n(4942),V=n(37056),O=n(74165),D=n(15861),N=(n(59486),n(14921)),z=n(80987),B=n(41691),G=n(34066),q=n(81753),U=n(78952);function W(e,t){return e&&"copyright"in e&&(!t||"function"==typeof e.originOf&&"user"===e.originOf("copyright"))}function j(e,t,n){n&&t&&(e.find((function(e){return e.layerView===t&&e.text===n}))||e.push({text:n,layerView:t}))}function H(e){return"bing-maps"===e.type}var Y=[],K=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e))._clear=function(){r._fetchedAttributionData.clear(),r._pendingAttributions.clear(),r.handles.remove("suspension"),r.notifyChange("state")},r._pendingAttributions=new Set,r._fetchedAttributionData=new Map,r.items=new z.Z,r.view=null,r._allLayerViewsChange=function(e){r.handles.remove("suspension");var t=r.get("view.allLayerViews");t&&r.handles.add(t.map((function(e){return(0,c.YP)((function(){var t;return[e.suspended,null===(t=e.layer)||void 0===t?void 0:t.attributionVisible]}),(function(){return r._updateAttributionItems()}))})),"suspension"),e&&e.removed&&e.removed.forEach((function(e){r._pendingAttributions.delete(e),r._fetchedAttributionData.delete(e)})),r._updateAttributionItems()},r.handles.add([(0,c.on)((function(){var e;return null===(e=r.view)||void 0===e?void 0:e.allLayerViews}),"change",(function(e){return r._allLayerViewsChange(e)}),{onListenerAdd:function(){return r._allLayerViewsChange()},onListenerRemove:r._clear}),(0,c.gx)((function(){var e;return!0===(null===(e=r.view)||void 0===e?void 0:e.stationary)}),(function(){return r._updateAttributionItems()}))]),r}return(0,r.Z)(n,[{key:"destroy",value:function(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}},{key:"state",get:function(){return this.get("view.ready")?this._pendingAttributions.size>0?"loading":"ready":"disabled"}},{key:"_updateAttributionItems",value:function(){var e=this,t=this.view,n=null===t||void 0===t?void 0:t.allLayerViews;Y.length=0,t&&n?(n.forEach((function(n){var i;if(!n.suspended&&null!==(i=n.layer)&&void 0!==i&&i.attributionVisible){var r=n.layer;if(W(r,"user"))j(Y,n,r.copyright);else if(r.hasAttributionData){if(e._fetchedAttributionData.has(n)){var a=e._fetchedAttributionData.get(n);return void(a?j(Y,n,e._getDynamicAttribution(a,t,r)):W(r)&&j(Y,n,r.copyright))}e._fetchAttributionData(n)}else{var o=r.get("portalItem.accessInformation");j(Y,n,o||r.copyright)}}})),function(e,t){return e.length!==t.length||e.some((function(e,n){return e.text!==t[n].text}))}(this.items,Y)&&(this.items.removeAll(),this.items.addMany(Y)),Y.length=0,this.notifyChange("state")):this._clear()}},{key:"_fetchAttributionData",value:function(){var e=(0,D.Z)((0,O.Z)().mark((function e(t){var n,i;return(0,O.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._pendingAttributions.has(t)){e.next=2;break}return e.abrupt("return");case 2:return this._pendingAttributions.add(t),e.next=5,(0,N.q6)(t.layer.fetchAttributionData());case 5:n=e.sent,this._pendingAttributions.has(t)&&(i=n.ok?this._createContributionIndex(n.value,H(t.layer)):null,this._pendingAttributions.delete(t),this._fetchedAttributionData.set(t,i)),this._updateAttributionItems();case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createContributionIndex",value:function(e,t){var n=e.contributors,i={};if(!n)return i;for(var r=0;r<n.length;r++){var a=n[r],o=a.coverageAreas;if(!o)return;var s,l=(0,b.Z)(o);try{for(l.s();!(s=l.n()).done;)for(var u=s.value,c=u.bbox,d=u.zoomMin-(t&&u.zoomMin?1:0),p=u.zoomMax-(t&&u.zoomMax?1:0),h={xmin:c[1],ymin:c[0],xmax:c[3],ymax:c[2],spatialReference:U.Z.WGS84},f={extent:(0,q.$)(h),attribution:a.attribution||"",score:null!=u.score?u.score:100,id:r},v=d;v<=p;v++)i[v]=i[v]||[],i[v].push(f)}catch(y){l.e(y)}finally{l.f()}}return i.maxKey=Math.max.apply(null,Object.keys(i)),i}},{key:"_getDynamicAttribution",value:function(e,t,n){var i,r,a,o=t.extent,s=t.scale,l=null!==(i=null===(r=n.tileInfo)||void 0===r?void 0:r.scaleToZoom(s))&&void 0!==i?i:0;if(l=Math.min(null!==(a=e.maxKey)&&void 0!==a?a:0,Math.round(l)),!o||null==l||l<=-1)return"";var u=e[l],c=(0,q.iV)(o.center.clone().normalize(),t.spatialReference),d={};return u?u.filter((function(e){var t=e.id,n=!d[t]&&c&&e.extent&&(0,G.aV)(e.extent,c);return n&&(d[t]=!0),n})).sort((function(e,t){return t.score-e.score||e.objectId-t.objectId})).map((function(e){return e.attribution})).join(", "):""}}]),n}(B.r);(0,u._)([(0,d.Cb)({readOnly:!0,type:z.Z})],K.prototype,"items",void 0),(0,u._)([(0,d.Cb)({readOnly:!0})],K.prototype,"state",null),(0,u._)([(0,d.Cb)()],K.prototype,"view",void 0);var Q=K=(0,u._)([(0,p.j)("esri.widgets.Attribution.AttributionViewModel")],K),J=n(78088),X=n(80532),$=n(67005),ee="esri-attribution",te={base:"".concat(ee," esri-widget"),poweredBy:"".concat(ee,"__powered-by"),sources:"".concat(ee,"__sources"),open:"".concat(ee,"--open"),sourcesOpen:"".concat(ee,"__sources--open"),link:"".concat(ee,"__link"),widgetIcon:"esri-icon-description",interactive:"esri-interactive"},ne=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e,r){var a;return(0,i.Z)(this,n),(a=t.call(this,e,r))._isOpen=!1,a._attributionTextOverflowed=!1,a._prevSourceNodeHeight=0,a._resizeObserver=new ResizeObserver((function(e){return e.forEach((function(e){var t=e.target;return a._checkSourceTextOverflow(t)}))})),a.iconClass=te.widgetIcon,a.itemDelimiter=" | ",a.messages=null,a.viewModel=new Q,a}return(0,r.Z)(n,[{key:"initialize",value:function(){var e=this;this.addHandles((0,c.on)((function(){var t;return null===(t=e.viewModel)||void 0===t?void 0:t.items}),"change",(function(){return e.scheduleRender()})))}},{key:"destroy",value:function(){var e;null===(e=this._resizeObserver)||void 0===e||e.disconnect()}},{key:"_isInteractive",get:function(){return this._isOpen||this._attributionTextOverflowed}},{key:"attributionText",get:function(){return this.viewModel.items.reduce((function(e,t){return e.includes(t.text)||e.push(t.text),e}),[]).join(this.itemDelimiter)}},{key:"label",get:function(){var e,t;return null!==(e=null===(t=this.messages)||void 0===t?void 0:t.widgetLabel)&&void 0!==e?e:""},set:function(e){this._overrideIfSome("label",e)}},{key:"view",get:function(){return this.viewModel.view},set:function(e){this.viewModel.view=e}},{key:"render",value:function(){var e=(0,R.Z)({},te.open,this._isOpen);return(0,$.u)("div",{bind:this,class:this.classes(te.base,e),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this.renderSourcesNode(),this.renderPoweredBy())}},{key:"renderPoweredBy",value:function(){return(0,$.u)("div",{class:te.poweredBy},"Powered by"," ",(0,$.u)("a",{class:te.link,href:"http://www.esri.com/",target:"_blank",rel:"noreferrer"},"Esri"))}},{key:"renderSourcesNode",value:function(){var e,t=this._isOpen,n=this._isInteractive,i=n?"0":"",r=this.attributionText,a=(e={},(0,R.Z)(e,te.sourcesOpen,t),(0,R.Z)(e,te.interactive,n),e);return(0,$.u)("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(te.sources,a),innerHTML:r,tabindex:i})}},{key:"_afterSourcesNodeCreate",value:function(e){this._prevSourceNodeHeight=e.clientWidth,this._resizeObserver.observe(e)}},{key:"_checkSourceTextOverflow",value:function(e){var t=!1,n=e.clientHeight,i=e.clientWidth,r=e.scrollWidth>i,a=this._attributionTextOverflowed!==r;if(this._attributionTextOverflowed=r,a&&(t=!0),this._isOpen){var o=n<this._prevSourceNodeHeight;this._prevSourceNodeHeight=n,o&&(this._isOpen=!1,t=!0)}t&&this.scheduleRender()}},{key:"_toggleState",value:function(){this._isInteractive&&(this._isOpen=!this._isOpen)}}]),n}(V.Z);(0,u._)([(0,d.Cb)()],ne.prototype,"_isOpen",void 0),(0,u._)([(0,d.Cb)()],ne.prototype,"_isInteractive",null),(0,u._)([(0,d.Cb)()],ne.prototype,"_attributionTextOverflowed",void 0),(0,u._)([(0,d.Cb)()],ne.prototype,"_prevSourceNodeHeight",void 0),(0,u._)([(0,d.Cb)({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],ne.prototype,"attributionText",null),(0,u._)([(0,d.Cb)()],ne.prototype,"iconClass",void 0),(0,u._)([(0,d.Cb)()],ne.prototype,"itemDelimiter",void 0),(0,u._)([(0,d.Cb)()],ne.prototype,"label",null),(0,u._)([(0,d.Cb)(),(0,X.H)("esri/widgets/Attribution/t9n/Attribution")],ne.prototype,"messages",void 0),(0,u._)([(0,d.Cb)()],ne.prototype,"view",null),(0,u._)([(0,d.Cb)({type:Q})],ne.prototype,"viewModel",void 0),(0,u._)([(0,J.h)()],ne.prototype,"_toggleState",null);var ie=ne=(0,u._)([(0,p.j)("esri.widgets.Attribution")],ne),re=n(97326),ae=n(100),oe=n(92026),se=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e))._handles=new ae.Z,r.orientation={x:0,y:0,z:0},r.view=null,r._updateForCamera=r._updateForCamera.bind((0,re.Z)(r)),r._updateForRotation=r._updateForRotation.bind((0,re.Z)(r)),r._updateRotationWatcher=r._updateRotationWatcher.bind((0,re.Z)(r)),r}return(0,r.Z)(n,[{key:"initialize",value:function(){var e=this;this._handles.add((0,c.YP)((function(){return e.view}),this._updateRotationWatcher,c.nn))}},{key:"destroy",value:function(){(0,oe.hw)(this._handles),this.view=null}},{key:"canShowNorth",get:function(){var e=this.get("view.spatialReference");return!(!e||!e.isWebMercator&&!e.isGeographic)}},{key:"state",get:function(){return this.get("view.ready")?this.canShowNorth?"compass":"rotation":"disabled"}},{key:"reset",value:function(){var e;if(this.get("view.ready")){var t={};"2d"===(null===(e=this.view)||void 0===e?void 0:e.type)?t.rotation=0:t.heading=0,this.callGoTo({target:t})}}},{key:"_updateForRotation",value:function(e){null!=e&&(this.orientation={z:e})}},{key:"_updateForCamera",value:function(e){if(e){var t=-e.heading;this.orientation={x:0,y:0,z:t}}}},{key:"_updateRotationWatcher",value:function(e){this._handles.removeAll(),e&&this._handles.add("2d"===e.type?(0,c.YP)((function(){return null===e||void 0===e?void 0:e.rotation}),this._updateForRotation,c.nn):(0,c.YP)((function(){return null===e||void 0===e?void 0:e.camera}),this._updateForCamera,c.nn))}}]),n}((0,n(99505)._)(h.Z));(0,u._)([(0,d.Cb)({readOnly:!0})],se.prototype,"canShowNorth",null),(0,u._)([(0,d.Cb)()],se.prototype,"orientation",void 0),(0,u._)([(0,d.Cb)({readOnly:!0})],se.prototype,"state",null),(0,u._)([(0,d.Cb)()],se.prototype,"view",void 0);var le=se=(0,u._)([(0,p.j)("esri.widgets.CompassViewModel")],se),ue="esri-compass esri-widget--button esri-widget",ce="esri-icon-font-fallback-text",de="esri-compass__icon",pe="esri-icon-dial",he="esri-icon-compass",fe="esri-icon-locate-circled",ve="esri-interactive",ye="esri-disabled",ge=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e,r){var a;return(0,i.Z)(this,n),(a=t.call(this,e,r)).iconClass=fe,a.messages=null,a.viewModel=new le,a}return(0,r.Z)(n,[{key:"goToOverride",get:function(){return this.viewModel.goToOverride},set:function(e){this.viewModel.goToOverride=e}},{key:"label",get:function(){var e,t;return null!==(e=null===(t=this.messages)||void 0===t?void 0:t.widgetLabel)&&void 0!==e?e:""},set:function(e){this._overrideIfSome("label",e)}},{key:"view",get:function(){return this.viewModel.view},set:function(e){this.viewModel.view=e}},{key:"reset",value:function(){return this.viewModel.reset()}},{key:"render",value:function(){var e,t,n=this.viewModel,i=n.orientation,r=n.state,a="disabled"===r,o="compass"===("rotation"===r?"rotation":"compass"),s=a?-1:0,l=(e={},(0,R.Z)(e,ye,a),(0,R.Z)(e,ve,!a),e),u=(t={},(0,R.Z)(t,he,o),(0,R.Z)(t,pe,!o),t),c=this.messages;return(0,$.u)("div",{bind:this,class:this.classes(ue,l),onclick:this._reset,onkeydown:this._reset,role:"button",tabIndex:s,"aria-label":c.reset,title:c.reset},(0,$.u)("span",{"aria-hidden":"true",class:this.classes(de,u),styles:this._toRotationTransform(i)}),(0,$.u)("span",{class:ce},c.reset))}},{key:"_reset",value:function(){this.viewModel.reset()}},{key:"_toRotationTransform",value:function(e){return{transform:"rotateZ(".concat(e.z,"deg)")}}}]),n}(V.Z);(0,u._)([(0,d.Cb)()],ge.prototype,"goToOverride",null),(0,u._)([(0,d.Cb)()],ge.prototype,"iconClass",void 0),(0,u._)([(0,d.Cb)()],ge.prototype,"label",null),(0,u._)([(0,d.Cb)(),(0,X.H)("esri/widgets/Compass/t9n/Compass")],ge.prototype,"messages",void 0),(0,u._)([(0,d.Cb)()],ge.prototype,"view",null),(0,u._)([(0,d.Cb)({type:le})],ge.prototype,"viewModel",void 0),(0,u._)([(0,J.h)()],ge.prototype,"_reset",null);var me=ge=(0,u._)([(0,p.j)("esri.widgets.Compass")],ge),_e="esri-navigation-toggle",be={base:"".concat(_e," esri-widget"),button:"".concat(_e,"__button esri-widget--button"),activeButton:"".concat(_e,"__button--active"),panButton:"".concat(_e,"__button--pan"),rotateButton:"".concat(_e,"__button--rotate"),isLayoutHorizontal:"".concat(_e,"--horizontal"),rotationIcon:"esri-icon-rotate",panIcon:"esri-icon-pan",widgetIcon:"esri-icon-pan2",disabled:"esri-disabled"},we=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).navigationMode="pan",r.view=null,r}return(0,r.Z)(n,[{key:"initialize",value:function(){var e=this;this.own((0,c.gx)((function(){var t;return null===(t=e.view)||void 0===t?void 0:t.inputManager}),(function(){return e._setNavigationMode()})))}},{key:"destroy",value:function(){this.view=null}},{key:"state",get:function(){var e;return this.get("view.ready")&&"3d"===(null===(e=this.view)||void 0===e?void 0:e.type)?"ready":"disabled"}},{key:"toggle",value:function(){"disabled"!==this.state&&(this.navigationMode="pan"!==this.navigationMode?"pan":"rotate",this._setNavigationMode())}},{key:"_setNavigationMode",value:function(){this.get("view.inputManager").primaryDragAction="pan"===this.navigationMode?"pan":"rotate"}}]),n}(h.Z);(0,u._)([(0,d.Cb)({readOnly:!0})],we.prototype,"state",null),(0,u._)([(0,d.Cb)()],we.prototype,"navigationMode",void 0),(0,u._)([(0,d.Cb)()],we.prototype,"view",void 0);var ke=we=(0,u._)([(0,p.j)("esri.widgets.NavigationToggleViewModel")],we),Ce=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e,r){var a;return(0,i.Z)(this,n),(a=t.call(this,e,r)).iconClass=be.widgetIcon,a.messages=null,a.viewModel=new ke,a}return(0,r.Z)(n,[{key:"label",get:function(){var e,t;return null!==(e=null===(t=this.messages)||void 0===t?void 0:t.widgetLabel)&&void 0!==e?e:""},set:function(e){this._overrideIfSome("label",e)}},{key:"layout",set:function(e){"horizontal"!==e&&(e="vertical"),this._set("layout",e)}},{key:"view",get:function(){return this.viewModel.view},set:function(e){this.viewModel.view=e}},{key:"toggle",value:function(){return this.viewModel.toggle()}},{key:"render",value:function(){var e,t="disabled"===this.get("viewModel.state"),n="pan"===this.get("viewModel.navigationMode"),i=(e={},(0,R.Z)(e,be.disabled,t),(0,R.Z)(e,be.isLayoutHorizontal,"horizontal"===this.layout),e),r=(0,R.Z)({},be.activeButton,n),a=(0,R.Z)({},be.activeButton,!n),o=t?-1:0,s=this.messages.toggle;return(0,$.u)("div",{bind:this,class:this.classes(be.base,i),onclick:this._toggle,onkeydown:this._toggle,tabIndex:o,"aria-label":s,title:s},(0,$.u)("div",{class:this.classes(be.button,be.panButton,r)},(0,$.u)("span",{class:be.panIcon})),(0,$.u)("div",{class:this.classes(be.button,be.rotateButton,a)},(0,$.u)("span",{class:be.rotationIcon})))}},{key:"_toggle",value:function(){this.toggle()}}]),n}(V.Z);(0,u._)([(0,d.Cb)()],Ce.prototype,"iconClass",void 0),(0,u._)([(0,d.Cb)()],Ce.prototype,"label",null),(0,u._)([(0,d.Cb)({value:"vertical"})],Ce.prototype,"layout",null),(0,u._)([(0,d.Cb)(),(0,X.H)("esri/widgets/NavigationToggle/t9n/NavigationToggle")],Ce.prototype,"messages",void 0),(0,u._)([(0,d.Cb)()],Ce.prototype,"view",null),(0,u._)([(0,d.Cb)({type:ke})],Ce.prototype,"viewModel",void 0),(0,u._)([(0,J.h)()],Ce.prototype,"_toggle",null);var Me=Ce=(0,u._)([(0,p.j)("esri.widgets.NavigationToggle")],Ce),Ze="esri-widget--button esri-widget",xe="esri-disabled",Ie="esri-interactive",Te="esri-icon-font-fallback-text",Se="esri-icon",Ae=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(){var e;return(0,i.Z)(this,n),(e=t.apply(this,arguments)).enabled=!0,e.iconClass="",e.title="",e}return(0,r.Z)(n,[{key:"render",value:function(){var e,t=this.enabled?0:-1,n=(e={},(0,R.Z)(e,xe,!this.enabled),(0,R.Z)(e,Ie,this.enabled),e),i=(0,R.Z)({},this.iconClass,!!this.iconClass);return(0,$.u)("div",{bind:this,class:this.classes(Ze,n),onclick:this._triggerAction,onkeydown:this._triggerAction,role:"button",tabIndex:t,title:this.title},(0,$.u)("span",{"aria-hidden":"true",role:"presentation",class:this.classes(Se,i)}),(0,$.u)("span",{class:Te},this.title))}},{key:"_triggerAction",value:function(){this.action.call(this)}}]),n}(V.Z);(0,u._)([(0,d.Cb)()],Ae.prototype,"action",void 0),(0,u._)([(0,d.Cb)()],Ae.prototype,"enabled",void 0),(0,u._)([(0,d.Cb)()],Ae.prototype,"iconClass",void 0),(0,u._)([(0,d.Cb)()],Ae.prototype,"title",void 0),(0,u._)([(0,J.h)()],Ae.prototype,"_triggerAction",null);var Fe=Ae=(0,u._)([(0,p.j)("esri.widgets.IconButton")],Ae),Pe=n(58266),Le="esri-zoom esri-widget",Ee="esri-zoom--horizontal",Re="esri-icon-plus",Ve="esri-icon-minus",Oe="esri-icon-zoom-in-magnifying-glass",De=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e,r){var a;return(0,i.Z)(this,n),(a=t.call(this,e,r)).iconClass=Oe,a.messages=null,a.viewModel=new Pe.Z,a}return(0,r.Z)(n,[{key:"initialize",value:function(){this._zoomInButton=new Fe({action:this.zoomIn.bind(this),iconClass:Re}),this._zoomOutButton=new Fe({action:this.zoomOut.bind(this),iconClass:Ve})}},{key:"destroy",value:function(){this._zoomInButton=(0,oe.SC)(this._zoomInButton),this._zoomOutButton=(0,oe.SC)(this._zoomOutButton)}},{key:"label",get:function(){var e,t;return null!==(e=null===(t=this.messages)||void 0===t?void 0:t.widgetLabel)&&void 0!==e?e:""},set:function(e){this._overrideIfSome("label",e)}},{key:"layout",set:function(e){"horizontal"!==e&&(e="vertical"),this._set("layout",e)}},{key:"view",get:function(){return this.viewModel.view},set:function(e){this.viewModel.view=e}},{key:"render",value:function(){var e=this.viewModel,t=(0,R.Z)({},Ee,"horizontal"===this.layout),n=e.canZoomIn,i=e.canZoomOut;this._zoomInButton.enabled=n,this._zoomOutButton.enabled=i;var r=this.messages,a=r.zoomIn,o=r.zoomOut;return this._zoomInButton.title=a,this._zoomOutButton.title=o,(0,$.u)("div",{class:this.classes(Le,t)},this._zoomInButton.render(),this._zoomOutButton.render())}},{key:"zoomIn",value:function(){return this.viewModel.zoomIn()}},{key:"zoomOut",value:function(){return this.viewModel.zoomOut()}}]),n}(V.Z);(0,u._)([(0,d.Cb)()],De.prototype,"iconClass",void 0),(0,u._)([(0,d.Cb)()],De.prototype,"label",null),(0,u._)([(0,d.Cb)({value:"vertical"})],De.prototype,"layout",null),(0,u._)([(0,d.Cb)(),(0,X.H)("esri/widgets/Zoom/t9n/Zoom")],De.prototype,"messages",void 0),(0,u._)([(0,d.Cb)()],De.prototype,"view",null),(0,u._)([(0,d.Cb)({type:Pe.Z})],De.prototype,"viewModel",void 0);var Ne=De=(0,u._)([(0,p.j)("esri.widgets.Zoom")],De);var ze=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e))._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},r.components=[],r}return(0,r.Z)(n,[{key:"initialize",value:function(){var e=this;this.addHandles([(0,c.YP)((function(){return e.components}),this._componentsWatcher.bind(this),c.nn),(0,c.YP)((function(){return e.view}),this._updateViewAwareWidgets.bind(this),c.nn)])}},{key:"_add",value:function(e,t,i,r){var s=e;if("string"==typeof e&&this._defaultPositionLookup[e]){if(this._find(e))return;s=this._createComponent(e)}(0,a.Z)((0,o.Z)(n.prototype),"_add",this).call(this,s,t,i,r)}},{key:"_removeComponents",value:function(e){var t=this;e.forEach((function(e){var n=t._find(e);n&&(t.remove(n),n.destroy())}))}},{key:"_updateViewAwareWidgets",value:function(e){var t=this;this.components.forEach((function(n){var i=t._find(n),r=i&&i.widget;(function(e){return e&&void 0!==e.view})(r)&&(r.view=e)}))}},{key:"_componentsWatcher",value:function(e,t){this._removeComponents(t),this._addComponents(e),this._adjustPadding(e)}},{key:"_adjustPadding",value:function(e){if(!e.includes("attribution")&&!this._isOverridden("padding")){var t=this.padding.top;this.padding=t}}},{key:"_addComponents",value:function(e){var t=this;this.constructed&&e.forEach((function(e){return t.add(t._createComponent(e),t._defaultPositionLookup[e])}))}},{key:"_createComponent",value:function(e){var t=this._createWidget(e);if(t)return new m({id:e,node:t})}},{key:"_createWidget",value:function(e){return"attribution"===e?this._createAttribution():"compass"===e?this._createCompass():"navigation-toggle"===e?this._createNavigationToggle():"zoom"===e?this._createZoom():void 0}},{key:"_createAttribution",value:function(){return new ie({view:this.view})}},{key:"_createCompass",value:function(){return new me({view:this.view})}},{key:"_createNavigationToggle",value:function(){return new Me({view:this.view})}},{key:"_createZoom",value:function(){return new Ne({view:this.view})}}]),n}(E);(0,u._)([(0,d.Cb)()],ze.prototype,"components",void 0);var Be=ze=(0,u._)([(0,p.j)("esri.views.ui.DefaultUI")],ze)},90316:function(e,t,n){n.d(t,{hc:function(){return d}});var i,r,a=n(60136),o=n(92572),s=n(43144),l=n(15671),u=n(92026),c=n(49800);function d(e){for(var t=(0,c.Sh)(e);t.length>1;){var n=p(t.shift());if(n.available)return n}return p(t.shift())}function p(e){switch(e){case c.zO.WEBGL1:return i||(i=function(){var e=new f,t=y(c.zO.WEBGL1,e);return(0,u.Wi)(t)||(e.supportsElementIndexUint=null!==t.getExtension("OES_element_index_uint"),e.supportsStandardDerivatives=null!==t.getExtension("OES_standard_derivatives"),e.supportsInstancedArrays=null!==t.getExtension("ANGLE_instanced_arrays"),e.supportsTextureFloat=null!==t.getExtension("OES_texture_float"),e.supportsTextureHalfFloat=null!==t.getExtension("OES_texture_half_float"),e.supportsColorBufferFloat=null!==t.getExtension("WEBGL_color_buffer_float"),e.supportsColorBufferFloatBlend=null!==t.getExtension("EXT_float_blend"),e.supportsColorBufferHalfFloat=null!==t.getExtension("EXT_color_buffer_half_float")),e}()),i;case c.zO.WEBGL2:return r||(r=function(){var e=new v,t=y(c.zO.WEBGL2,e);return(0,u.Wi)(t)||(e.supportsColorBufferFloat=null!==t.getExtension("EXT_color_buffer_float"),e.supportsColorBufferFloatBlend=null!==t.getExtension("EXT_float_blend"),e.supportsColorBufferHalfFloat=e.supportsColorBufferFloat||null!==t.getExtension("EXT_color_buffer_half_float")),e}()),r}}var h=(0,s.Z)((function e(){(0,l.Z)(this,e),this.available=!1,this.majorPerformanceCaveat=!1,this.maxTextureSize=0,this.supportsVertexShaderSamplers=!1,this.supportsHighPrecisionFragment=!1,this.supportsElementIndexUint=!1,this.supportsStandardDerivatives=!1,this.supportsInstancedArrays=!1,this.supportsTextureFloat=!1,this.supportsTextureHalfFloat=!1,this.supportsColorBufferFloat=!1,this.supportsColorBufferFloatBlend=!1,this.supportsColorBufferHalfFloat=!1})),f=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(){var e;return(0,l.Z)(this,n),(e=t.apply(this,arguments)).type=c.zO.WEBGL1,e}return(0,s.Z)(n)}(h),v=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(){var e;return(0,l.Z)(this,n),(e=t.apply(this,arguments)).type=c.zO.WEBGL2,e.supportsElementIndexUint=!0,e.supportsStandardDerivatives=!0,e.supportsInstancedArrays=!0,e.supportsTextureFloat=!0,e.supportsTextureHalfFloat=!0,e}return(0,s.Z)(n)}(h);function y(e,t){if(e===c.zO.WEBGL1&&"undefined"==typeof WebGLRenderingContext||e===c.zO.WEBGL2&&"undefined"==typeof WebGL2RenderingContext)return null;var n=document.createElement("canvas");if(!n)return null;var i=(0,c.kr)(n,e,{failIfMajorPerformanceCaveat:!0});if((0,u.Wi)(i)&&(i=(0,c.kr)(n,e),(0,u.pC)(i)&&(t.majorPerformanceCaveat=!0)),(0,u.Wi)(i))return i;if(e===c.zO.WEBGL1){var r,a=null===(r=i.getParameter(i.VERSION))||void 0===r?void 0:r.match(/^WebGL\s+([\d.]*)/);if(a){var o=parseFloat(a[1]);t.available=o>=.94}}else t.available=!0;t.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),t.supportsVertexShaderSamplers=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0;var s=i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT);return s&&(t.supportsHighPrecisionFragment=s.precision>0),i}},41190:function(e,t,n){n.d(t,{Nw:function(){return f}});var i=n(10064),r=n(84652),a=n(92026),o=n(18202),s=n(13922),l=n(37933),u=new Set(["bing-maps","imagery","imagery-tile","map-image","open-street-map","tile","unknown","unsupported","vector-tile","web-tile","wms","wmts"]),c=new Set(["csv","feature","geo-rss","geojson","group","imagery","imagery-tile","kml","map-image","map-notes","media","ogc-feature","route","subtype-group","tile","unknown","unsupported","vector-tile","web-tile","wfs","wms","wmts"]);function d(e,t){if(t.restrictedWebMapWriting){var n=function(e){return"basemap"===e.layerContainerType?u:"operational-layers"===e.layerContainerType?c:null}(t);return!(0,a.pC)(n)||n.has(e.type)&&!(0,l.rQ)(e)}return!0}function p(e,t){var n,i;"maxScale"in e&&(t.maxScale=null!==(n=(0,s.k)(e.maxScale))&&void 0!==n?n:void 0),"minScale"in e&&(t.minScale=null!==(i=(0,s.k)(e.minScale))&&void 0!==i?i:void 0)}function h(e,t){var n;if(function(e,t){if(t)if((0,l.rQ)(e)){var n=(0,o.hS)("featureCollection.layers",t),i=n&&n[0]&&n[0].layerDefinition;i&&p(e,i)}else"stream"===e.type?p(e,t.layerDefinition=t.layerDefinition||{}):"group"!==e.type&&p(e,t)}(e,t),t&&("blendMode"in e&&(t.blendMode=e.blendMode,"normal"===t.blendMode&&delete t.blendMode),t.opacity=null!==(n=(0,s.k)(e.opacity))&&void 0!==n?n:void 0,t.title=e.title||"Layer",t.visibility=e.visible,"legendEnabled"in e&&"wmts"!==e.type))if((0,l.rQ)(e)){var i=t.featureCollection;i&&(i.showLegend=e.legendEnabled)}else t.showLegend=e.legendEnabled}function f(e,t,n){if(!("write"in e)||!e.write)return n&&n.messages&&n.messages.push(new i.Z("layer:unsupported","Layers (".concat(e.title,", ").concat(e.id,") of type '").concat(e.declaredClass,"' cannot be persisted"),{layer:e})),null;if(d(e,n)){var o={};return e.write(o,n)?o:null}return(0,a.pC)(t)&&h(e,t=(0,r.d9)(t)),t}},53042:function(e,t,n){n.d(t,{Z:function(){return v}});var i,r=n(15671),a=n(43144),o=n(60136),s=n(92572),l=n(27366),u=n(51995),c=n(46784),d=n(84652),p=n(49861),h=(n(25243),n(69912)),f=i=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(e){var i;return(0,r.Z)(this,n),(i=t.call(this,e)).color=new u.Z([0,0,0,1]),i}return(0,a.Z)(n,[{key:"clone",value:function(){return new i((0,d.d9)({color:this.color}))}}]),n}(c.wq);(0,l._)([(0,p.Cb)({type:u.Z,json:{write:!0}})],f.prototype,"color",void 0);var v=f=i=(0,l._)([(0,h.j)("esri.webmap.background.ColorBackground")],f)},99505:function(e,t,n){n.d(t,{_:function(){return d}});var i=n(15671),r=n(43144),a=n(60136),o=n(92572),s=n(27366),l=n(92026),u=n(49861),c=(n(25243),n(63780),n(69912)),d=function(e){var t=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(){var e;(0,i.Z)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).goToOverride=null,e.view=null,e}return(0,r.Z)(n,[{key:"callGoTo",value:function(e){var t=this.view;return(0,l.O3)(t),this.goToOverride?this.goToOverride(t,e):t.goTo(e.target,e.options)}}]),n}(e);return(0,s._)([(0,u.Cb)()],t.prototype,"goToOverride",void 0),(0,s._)([(0,u.Cb)()],t.prototype,"view",void 0),t=(0,s._)([(0,c.j)("esri.widgets.support.GoTo")],t)}},28907:function(e,t,n){n.d(t,{s:function(){return r}});var i=n(93433);function r(e){return function(t){t.hasOwnProperty("_delegatedEventNames")||(t._delegatedEventNames=t._delegatedEventNames?t._delegatedEventNames.slice():[]);var n=t._delegatedEventNames,r=Array.isArray(e)?e:function(e){return e.split(",").map((function(e){return e.trim()}))}(e);n.push.apply(n,(0,i.Z)(r))}}},53963:function(e,t,n){n.d(t,{Qd:function(){return i},o:function(){return r}});n(78088),n(67005),n(37680);function i(e){return e&&"function"==typeof e.render}function r(e){return e&&"function"==typeof e.postMixInProperties&&"function"==typeof e.buildRendering&&"function"==typeof e.postCreate&&"function"==typeof e.startup}}}]);
//# sourceMappingURL=99303.98cfda4d.chunk.js.map