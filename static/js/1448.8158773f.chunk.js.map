{"version":3,"file":"static/js/1448.8158773f.chunk.js","mappings":"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","sources":["../.yalc/@esri/hub-components/dist/esm/arcgis-d4c06398.js","../.yalc/@esri/hub-components/dist/esm/arcgis-hub-discussions-map-integrator.entry.js","../.yalc/@esri/hub-components/dist/esm/call-when-744df66d.js","../.yalc/@esri/hub-components/dist/esm/debounce-2015d676.js","../.yalc/@esri/hub-components/dist/esm/debounce-89fe9847.js"],"sourcesContent":["import { c as createCommonjsModule, a as commonjsGlobal } from './_commonjsHelpers-11ca3be1.js';\nimport { version } from '@arcgis/core/kernel.js';\n\nvar esriLoader = createCommonjsModule(function (module, exports) {\n(function (global, factory) {\n\tfactory(exports) ;\n}(commonjsGlobal, (function (exports) {\n/* Copyright (c) 2022 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nvar isBrowser = typeof window !== 'undefined';\n// allow consuming libraries to provide their own Promise implementations\nvar utils = {\n    Promise: isBrowser ? window['Promise'] : undefined\n};\n\n/* Copyright (c) 2022 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nvar DEFAULT_VERSION = '4.25';\nvar NEXT = 'next';\nfunction parseVersion(version) {\n    if (version.toLowerCase() === NEXT) {\n        return NEXT;\n    }\n    var match = version && version.match(/^(\\d)\\.(\\d+)/);\n    return match && {\n        major: parseInt(match[1], 10),\n        minor: parseInt(match[2], 10)\n    };\n}\n/**\n * Get the CDN url for a given version\n *\n * @param version Ex: '4.25' or '3.42'. Defaults to the latest 4.x version.\n */\nfunction getCdnUrl(version) {\n    if (version === void 0) { version = DEFAULT_VERSION; }\n    return \"https://js.arcgis.com/\".concat(version, \"/\");\n}\n/**\n * Get the CDN url for a the CSS for a given version and/or theme\n *\n * @param version Ex: '4.25', '3.42', or 'next'. Defaults to the latest 4.x version.\n */\nfunction getCdnCssUrl(version) {\n    if (version === void 0) { version = DEFAULT_VERSION; }\n    var baseUrl = getCdnUrl(version);\n    var parsedVersion = parseVersion(version);\n    if (parsedVersion !== NEXT && parsedVersion.major === 3) {\n        // NOTE: at 3.11 the CSS moved from the /js folder to the root\n        var path = parsedVersion.minor <= 10 ? 'js/' : '';\n        return \"\".concat(baseUrl).concat(path, \"esri/css/esri.css\");\n    }\n    else {\n        // assume 4.x\n        return \"\".concat(baseUrl, \"esri/themes/light/main.css\");\n    }\n}\n\n/* Copyright (c) 2022 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nfunction createStylesheetLink(href) {\n    var link = document.createElement('link');\n    link.rel = 'stylesheet';\n    link.href = href;\n    return link;\n}\nfunction insertLink(link, before) {\n    if (before) {\n        // the link should be inserted before a specific node\n        var beforeNode = document.querySelector(before);\n        beforeNode.parentNode.insertBefore(link, beforeNode);\n    }\n    else {\n        // append the link to then end of the head tag\n        document.head.appendChild(link);\n    }\n}\n// check if the css url has been injected or added manually\nfunction getCss(url) {\n    return document.querySelector(\"link[href*=\\\"\".concat(url, \"\\\"]\"));\n}\nfunction getCssUrl(urlOrVersion) {\n    return !urlOrVersion || parseVersion(urlOrVersion)\n        // if it's a valid version string return the CDN URL\n        ? getCdnCssUrl(urlOrVersion)\n        // otherwise assume it's a URL and return that\n        : urlOrVersion;\n}\n// lazy load the CSS needed for the ArcGIS API\nfunction loadCss(urlOrVersion, before) {\n    var url = getCssUrl(urlOrVersion);\n    var link = getCss(url);\n    if (!link) {\n        // create & load the css link\n        link = createStylesheetLink(url);\n        insertLink(link, before);\n    }\n    return link;\n}\n\n/* Copyright (c) 2022 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nvar defaultOptions = {};\nfunction createScript(url) {\n    var script = document.createElement('script');\n    script.type = 'text/javascript';\n    script.src = url;\n    script.setAttribute('data-esri-loader', 'loading');\n    return script;\n}\n// add a one-time load handler to script\n// and optionally add a one time error handler as well\nfunction handleScriptLoad(script, callback, errback) {\n    var onScriptError;\n    if (errback) {\n        // set up an error handler as well\n        onScriptError = handleScriptError(script, errback);\n    }\n    var onScriptLoad = function () {\n        // pass the script to the callback\n        callback(script);\n        // remove this event listener\n        script.removeEventListener('load', onScriptLoad, false);\n        if (onScriptError) {\n            // remove the error listener as well\n            script.removeEventListener('error', onScriptError, false);\n        }\n    };\n    script.addEventListener('load', onScriptLoad, false);\n}\n// add a one-time error handler to the script\nfunction handleScriptError(script, callback) {\n    var onScriptError = function (e) {\n        // reject the promise and remove this event listener\n        callback(e.error || new Error(\"There was an error attempting to load \".concat(script.src)));\n        // remove this event listener\n        script.removeEventListener('error', onScriptError, false);\n    };\n    script.addEventListener('error', onScriptError, false);\n    return onScriptError;\n}\n// allow the user to configure default script options rather than passing options to `loadModules` each time\nfunction setDefaultOptions(options) {\n    if (options === void 0) { options = {}; }\n    defaultOptions = options;\n}\n// get the script injected by this library\nfunction getScript() {\n    return document.querySelector('script[data-esri-loader]');\n}\n// has ArcGIS API been loaded on the page yet?\nfunction isLoaded() {\n    var globalRequire = window['require'];\n    // .on() ensures that it's Dojo's AMD loader\n    return globalRequire && globalRequire.on;\n}\n// load the ArcGIS API on the page\nfunction loadScript(options) {\n    if (options === void 0) { options = {}; }\n    // we would have liked to use spread like { ...defaultOptions, ...options }\n    // but TS would inject a polyfill that would require use to configure rollup w content: 'window'\n    // if we have another occasion to use spread, let's do that and replace this for...in\n    var opts = {};\n    [defaultOptions, options].forEach(function (obj) {\n        for (var prop in obj) {\n            if (Object.prototype.hasOwnProperty.call(obj, prop)) {\n                opts[prop] = obj[prop];\n            }\n        }\n    });\n    // URL to load\n    var version = opts.version;\n    var url = opts.url || getCdnUrl(version);\n    return new utils.Promise(function (resolve, reject) {\n        var script = getScript();\n        if (script) {\n            // the API is already loaded or in the process of loading...\n            // NOTE: have to test against scr attribute value, not script.src\n            // b/c the latter will return the full url for relative paths\n            var src = script.getAttribute('src');\n            if (src !== url) {\n                // potentially trying to load a different version of the API\n                reject(new Error(\"The ArcGIS API for JavaScript is already loaded (\".concat(src, \").\")));\n            }\n            else {\n                if (isLoaded()) {\n                    // the script has already successfully loaded\n                    resolve(script);\n                }\n                else {\n                    // wait for the script to load and then resolve\n                    handleScriptLoad(script, resolve, reject);\n                }\n            }\n        }\n        else {\n            if (isLoaded()) {\n                // the API has been loaded by some other means\n                // potentially trying to load a different version of the API\n                reject(new Error(\"The ArcGIS API for JavaScript is already loaded.\"));\n            }\n            else {\n                // this is the first time attempting to load the API\n                var css = opts.css;\n                if (css) {\n                    var useVersion = css === true;\n                    // load the css before loading the script\n                    loadCss(useVersion ? version : css, opts.insertCssBefore);\n                }\n                // create a script object whose source points to the API\n                script = createScript(url);\n                // _currentUrl = url;\n                // once the script is loaded...\n                handleScriptLoad(script, function () {\n                    // update the status of the script\n                    script.setAttribute('data-esri-loader', 'loaded');\n                    // return the script\n                    resolve(script);\n                }, reject);\n                // load the script\n                document.body.appendChild(script);\n            }\n        }\n    });\n}\n\n/* Copyright (c) 2022 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\n// wrap Dojo's require() in a promise\nfunction requireModules(modules) {\n    return new utils.Promise(function (resolve, reject) {\n        // If something goes wrong loading the esri/dojo scripts, reject with the error.\n        var errorHandler = window['require'].on('error', reject);\n        window['require'](modules, function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            // remove error handler\n            errorHandler.remove();\n            // Resolve with the parameters from dojo require as an array.\n            resolve(args);\n        });\n    });\n}\n// returns a promise that resolves with an array of the required modules\n// also will attempt to lazy load the ArcGIS API if it has not already been loaded\nfunction loadModules(modules, loadScriptOptions) {\n    if (loadScriptOptions === void 0) { loadScriptOptions = {}; }\n    if (!isLoaded()) {\n        // script is not yet loaded, is it in the process of loading?\n        var script = getScript();\n        var src = script && script.getAttribute('src');\n        if (!loadScriptOptions.url && src) {\n            // script is still loading and user did not specify a URL\n            // in this case we want to default to the URL that's being loaded\n            // instead of defaulting to the latest 4.x URL\n            loadScriptOptions.url = src;\n        }\n        // attempt to load the script then load the modules\n        return loadScript(loadScriptOptions).then(function () { return requireModules(modules); });\n    }\n    else {\n        // script is already loaded, just load the modules\n        return requireModules(modules);\n    }\n}\n\n/*\n  Copyright (c) 2022 Esri\n  Licensed under the Apache License, Version 2.0 (the \"License\");\n  you may not use this file except in compliance with the License.\n  You may obtain a copy of the License at\n    http://www.apache.org/licenses/LICENSE-2.0\n  Unless required by applicable law or agreed to in writing, software\n  distributed under the License is distributed on an \"AS IS\" BASIS,\n  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n  See the License for the specific language governing permissions and\n  limitations under the License.\n*/\n// re-export the functions that are part of the public API\n\nexports.utils = utils;\nexports.loadModules = loadModules;\nexports.getScript = getScript;\nexports.isLoaded = isLoaded;\nexports.loadScript = loadScript;\nexports.setDefaultOptions = setDefaultOptions;\nexports.loadCss = loadCss;\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\n})));\n//# sourceMappingURL=esri-loader.js.map\n});\n\n// NOTE: we only use esri-loader to load the ArcGIS CSS\n// TODO: consider replacing module scoped variables\n// w/ something like session storage\nconst CSS_OPTIONS = {\n  themeOrUrl: 'light'\n};\n/**\n * Call this once _before_ calling loadArcGisCss() or rendering\n * any mapping components to override the default options\n * @param options\n */\nconst setArcGisCssOptions = (options) => {\n  CSS_OPTIONS.themeOrUrl = options.themeOrUrl;\n  CSS_OPTIONS.insertBefore = options.insertBefore;\n};\n/**\n * Lazy-load the ArcGIS CSS for the current version of the API.\n * By default this will load the light theme from the CDN,\n * but you can change that by first calling setArcGisCssOptions()\n */\nconst loadArcGisCss = () => {\n  // first check if the CSS has been loaded _for this version_\n  // b/c loadCss will check the exact URL\n  const apiStyleSheet = document.querySelector('link[rel=\"stylesheet\"][href*=\"/esri/themes\"]');\n  if (apiStyleSheet) {\n    // stylesheet exists, but warn if version out of sync\n    const isVersionMatch = (new RegExp(version)).test(apiStyleSheet.href);\n    if (!isVersionMatch) {\n      console.warn(`Your ArcGIS API for JavaScript StyleSheet file should match the current hub-components version: ${version}.`);\n    }\n  }\n  else {\n    // not yet loaded, so inject a link\n    const { themeOrUrl, insertBefore } = CSS_OPTIONS;\n    const url = ['light', 'dark'].includes(themeOrUrl)\n      // build a URL that points to the theme's stylesheet on the CDN\n      ? `https://js.arcgis.com/${version}/esri/themes/${themeOrUrl}/main.css`\n      // otherwise assume it's a valid URL\n      : themeOrUrl;\n    esriLoader.loadCss(url, insertBefore);\n  }\n};\n\nexport { loadArcGisCss as l, setArcGisCssOptions as s };\n","import { r as registerInstance, c as createEvent, h, H as Host, g as getElement } from './index-0d95d9d4.js';\nimport { b as bind } from './context-7d8f7366.js';\nimport { p as postsToFeatureCollection, P as PostSort, S as SortOrder, b as searchPostAggregates, d as postToFeatures, g as arcgisToGeoJSON, h as fetchSubjectDetails, i as parseDiscussionURI, j as geojsonToArcGIS, k as convertGeometryTypeToTelemetryString } from './discussions-0e185b12.js';\nimport { generalize } from '@arcgis/core/geometry/geometryEngine.js';\nimport { D as DebounceDecoratorFactory } from './debounce-2015d676.js';\nimport { C as CallWhenFactory } from './call-when-744df66d.js';\nimport { i as intlManager } from './intl-manager-821aea3b.js';\nimport { d as dist } from './index-bcc98773.js';\nimport GraphicsLayer from '@arcgis/core/layers/GraphicsLayer.js';\nimport { watch } from '@arcgis/core/core/watchUtils.js';\nimport { webMercatorToGeographic } from '@arcgis/core/geometry/support/webMercatorUtils.js';\nimport Extent from '@arcgis/core/geometry/Extent.js';\nimport Graphic from '@arcgis/core/Graphic.js';\nimport { isAbortError } from '@arcgis/core/core/promiseUtils.js';\nimport { l as loadArcGisCss } from './arcgis-d4c06398.js';\nimport './getPortalBaseFromOrgUrl-6a5781aa.js';\nimport './tslib.es6-3669ad41.js';\nimport './get-portal-url-423a76f5.js';\nimport './clean-url-be7c0879.js';\nimport './request-c15cc2af.js';\nimport './get-859a2960.js';\nimport './append-custom-params-fd9b7e72.js';\nimport './get-portal-06f7947b.js';\nimport './query-15c2c6ed.js';\nimport './tslib.es6-b2e8cdb8.js';\nimport './fetch-eff7ab83.js';\nimport './tslib.es6-e75776ba.js';\nimport './_enrichments-9747f1f3.js';\nimport './util-2150bd9e.js';\nimport './get-prop-d82e4fa6.js';\nimport './get-with-default-6db049d8.js';\nimport './_internal-f8d6239a.js';\nimport './get-portal-api-url-2391fbac.js';\nimport './extent-0f42acfc.js';\nimport './helpers-a80c0291.js';\nimport './OperationError-85fd80c7.js';\nimport './get-f2cd18e7.js';\nimport './getService-49b539e3.js';\nimport './slugs-150ad0db.js';\nimport './is-guid-8127621d.js';\nimport './request-be948455.js';\nimport './api-3826163b.js';\nimport './compose-cc2f466a.js';\nimport './get-structured-license-d1e63636.js';\nimport './get-item-thumbnail-url-7608a737.js';\nimport './update-fec93fc5.js';\nimport './debounce-89fe9847.js';\nimport './index-4e91769f.js';\nimport './_commonjsHelpers-11ca3be1.js';\nimport '@arcgis/core/kernel.js';\n\n/**\n * Optional map states for symbol\n */\nvar SYMBOL_STATE;\n(function (SYMBOL_STATE) {\n  SYMBOL_STATE[\"ACTIVE\"] = \"active\";\n  SYMBOL_STATE[\"HOVER\"] = \"hover\";\n  SYMBOL_STATE[\"DEFAULT\"] = \"default\";\n})(SYMBOL_STATE || (SYMBOL_STATE = {}));\n/**\n * Generalization (simplify) operation\n * @param {Object} geometry - Esri geometry to simplify\n * @param {Object} view - Esri view\n * @param {number} maxDeviation - Maximum allowed deviation from original geometry\n * @returns {object} Object - Simplified geometry object\n */\nfunction simplify(geometry, view, maxDeviation = 3.5) {\n  const { resolution } = view;\n  return generalize(geometry, resolution * maxDeviation, false);\n}\n\nfunction callout (state, properties = defaultLayerThemeOptions.callout, count) {\n  const { backgroundColor, textColor, hoverColor, activeColor, width, isOffset, is3D } = properties;\n  const totalCount = count + 1;\n  let strokeColor = [255, 255, 255];\n  if (state === SYMBOL_STATE.HOVER) {\n    strokeColor = hoverColor;\n  }\n  else if (state === SYMBOL_STATE.ACTIVE) {\n    strokeColor = activeColor;\n  }\n  return {\n    type: 'cim',\n    data: {\n      type: \"CIMSymbolReference\",\n      symbol: {\n        type: \"CIMPointSymbol\",\n        symbolLayers: [{\n            // TEXT SYMBOL\n            type: \"CIMVectorMarker\",\n            enable: true,\n            size: 30,\n            frame: { xmin: -4, ymin: -4, xmax: 4, ymax: 4 },\n            markerGraphics: [\n              {\n                type: \"CIMMarkerGraphic\",\n                geometry: {\n                  x: isOffset ? 4.5 : 4,\n                  y: isOffset ? (is3D ? 9 : 11) : 4\n                },\n                symbol: {\n                  type: \"CIMTextSymbol\",\n                  fontFamilyName: \"Arial\",\n                  fontStyleName: \"Bold\",\n                  height: 3.25,\n                  horizontalAlignment: \"Center\",\n                  symbol: {\n                    type: \"CIMPolygonSymbol\",\n                    symbolLayers: [\n                      {\n                        type: \"CIMSolidFill\",\n                        enable: true,\n                        color: [\n                          ...textColor,\n                          255\n                        ]\n                      }\n                    ]\n                  },\n                  verticalAlignment: \"Center\",\n                },\n                textString: totalCount > 99 ? '99+' : `${totalCount}`\n              }\n            ],\n            scaleSymbolsProportionally: true\n          }, {\n            type: \"CIMVectorMarker\",\n            enable: true,\n            size: 30,\n            frame: {\n              xmin: isOffset ? -5 : -4,\n              ymin: isOffset ? (is3D ? -9 : -11) : -4,\n              xmax: isOffset ? 3 : 4,\n              ymax: isOffset ? (is3D ? -1 : -3) : 4\n            },\n            markerGraphics: [{\n                type: \"CIMMarkerGraphic\",\n                geometry: {\n                  rings: [\n                    [[0, 0], [4, 0], [4.35, 0.02], [4.69, 0.06],\n                      [5.04, 0.14], [5.37, 0.24], [5.69, 0.37], [6, 0.54],\n                      [6.29, 0.72], [6.57, 0.94], [6.83, 1.17], [7.06, 1.43],\n                      [7.28, 1.71], [7.46, 2], [7.63, 2.31], [7.76, 2.63],\n                      [7.86, 2.96], [7.94, 3.31], [7.98, 3.65], [8, 4],\n                      [7.98, 4.35], [7.94, 4.69], [7.86, 5.04], [7.76, 5.37],\n                      [7.63, 5.69], [7.46, 6], [7.28, 6.29], [7.06, 6.57],\n                      [6.83, 6.83], [6.57, 7.06], [6.29, 7.28], [6, 7.46],\n                      [5.69, 7.63], [5.37, 7.76], [5.04, 7.86], [4.69, 7.94],\n                      [4.35, 7.98], [4, 8], [3.65, 7.98], [3.31, 7.94],\n                      [2.96, 7.86], [2.63, 7.76], [2.31, 7.63], [2, 7.46],\n                      [1.71, 7.28], [1.43, 7.06], [1.17, 6.83], [0.94, 6.57],\n                      [0.72, 6.29], [0.54, 6], [0.37, 5.69], [0.24, 5.37],\n                      [0.14, 5.04], [0.06, 4.69], [0.02, 4.35], [0, 4], [0, 0]]\n                  ]\n                },\n                symbol: {\n                  type: \"CIMPolygonSymbol\",\n                  symbolLayers: [\n                    {\n                      type: \"CIMSolidStroke\",\n                      enable: true,\n                      capStyle: \"Round\",\n                      joinStyle: \"Round\",\n                      lineStyle3D: \"Strip\",\n                      miterLimit: 10,\n                      width: width,\n                      color: [\n                        ...strokeColor,\n                        255\n                      ]\n                    },\n                    {\n                      type: \"CIMSolidFill\",\n                      enable: true,\n                      color: [\n                        ...backgroundColor,\n                        255\n                      ]\n                    }\n                  ]\n                }\n              }]\n          }]\n      }\n    }\n  };\n}\n\nfunction point (properties = defaultLayerThemeOptions.point) {\n  const { color } = properties;\n  return {\n    type: 'text',\n    color: [\n      ...color,\n      0.9\n    ],\n    text: `\\ue61d`,\n    font: {\n      size: 24,\n      family: 'CalciteWebCoreIcons'\n    }\n  };\n}\n\nfunction polyline (properties = defaultLayerThemeOptions.polyline) {\n  const { color, width } = properties;\n  return {\n    type: 'simple-line',\n    color: [\n      ...color,\n      1\n    ],\n    width,\n    style: 'solid'\n  };\n}\n\nfunction polygon (properties = defaultLayerThemeOptions.polygon) {\n  const { color, width } = properties;\n  return {\n    type: 'simple-fill',\n    color: [\n      ...color,\n      0.15\n    ],\n    outline: {\n      color: [\n        ...color,\n        1\n      ],\n      width\n    }\n  };\n}\n\n// Geometry Defaults\nconst DEFAULT_GEOM_COLOR = [115, 96, 167];\nconst DEFAULT_GEOM_STROKE_WIDTH = 2;\n// Callout Defaults\nconst DEFAULT_CALLOUT_BACKGROUND_COLOR = [255, 255, 255];\nconst DEFAULT_CALLOUT_HOVER_COLOR = [169, 169, 169];\nconst DEFAULT_CALLOUT_ACTIVE_COLOR = [39, 129, 153];\nconst DEFAULT_CALLOUT_TEXT_COLOR = [0, 0, 0];\nconst DEFAULT_CALLOUT_STROKE_WIDTH = 2;\n/**\n * Default theme options\n */\nconst defaultLayerThemeOptions = {\n  point: {\n    color: DEFAULT_GEOM_COLOR\n  },\n  polyline: {\n    color: DEFAULT_GEOM_COLOR,\n    width: DEFAULT_GEOM_STROKE_WIDTH\n  },\n  polygon: {\n    color: DEFAULT_GEOM_COLOR,\n    width: DEFAULT_GEOM_STROKE_WIDTH\n  },\n  callout: {\n    backgroundColor: DEFAULT_CALLOUT_BACKGROUND_COLOR,\n    textColor: DEFAULT_CALLOUT_TEXT_COLOR,\n    hoverColor: DEFAULT_CALLOUT_HOVER_COLOR,\n    activeColor: DEFAULT_CALLOUT_ACTIVE_COLOR,\n    width: DEFAULT_CALLOUT_STROKE_WIDTH,\n    isOffset: false\n  }\n};\nconst symbols = {\n  callout,\n  point,\n  polyline,\n  polygon\n};\n\n// A world geometry object for filtering to any extent\nconst geometry = {\n  \"type\": \"Polygon\",\n  \"coordinates\": [\n    [[180, -90], [180, 90], [-180, 90], [-180, -90], [180, -90]]\n  ]\n};\n/**\n * A wait function for thottling\n * @param ms Time in MilliSeconds\n */\nconst wait = (ms) => {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n};\n/**\n * Dynamically calculates a throttle wait time in MilliSeconds to reduce load\n * on Discussions API\n * @param totalResults The total number of results to fetch\n * @param batchSize The number of results per request\n * @param totalWaitTime The total cumulative wait time for all requests to be fired\n * @param numRequestsThreshold The max number of requests to allow at dynamice throttle.  If number\n * of requests exceed this threshold, all requests will be thottled to fixed 500ms.\n * @returns Dynamic thottle time in MilliSeconds\n */\nconst getThrottleMS = (totalResults, batchSize, totalWaitTime, numRequestsThreshold, thresholdExceededWaitTime) => {\n  const numRequests = Math.ceil(totalResults / batchSize);\n  if (numRequests > numRequestsThreshold) {\n    console.warn(`Discussions requests exceeds desired threshold, throttling to ${thresholdExceededWaitTime}ms per batch.`);\n    return thresholdExceededWaitTime;\n  }\n  return totalWaitTime / numRequests;\n};\n/**\n *\n * @param discussion Discussion URI\n * @param hubRequestOptions IHubRequestOptions (serialized)\n * @param token Token\n * @param batchSize Total number of results per paginated post request (Default: 10)\n * @param throttle Optional throttling of requests (Default: true)\n * @returns\n */\nconst getPostsWithLocation = async (discussion, hubRequestOptions, batchSize = 10, throttle = true) => {\n  const searchPosts = async ({ discussion = null, geometry = null, start = 1 }) => {\n    const options = Object.assign(Object.assign(Object.assign({ discussion }, (geometry && { geometry })), { parents: [], sortBy: PostSort.UPDATED_AT, sortOrder: SortOrder.DESC, start, num: batchSize }), hubRequestOptions);\n    const result = searchPostAggregates(options);\n    if (start === 1) {\n      // first request must be synchronous to get total\n      const { total } = await result;\n      let nextStart = start + batchSize;\n      const results = [result];\n      const throttleMS = throttle\n        ? getThrottleMS(total, batchSize, 2500, 10, 250)\n        : 0;\n      while (nextStart <= total) {\n        await wait(throttleMS);\n        results.push(...await searchPosts({\n          discussion,\n          geometry,\n          start: nextStart\n        }));\n        nextStart = nextStart + batchSize;\n      }\n      return results;\n    }\n    return [result];\n  };\n  try {\n    const pagedResponses = await Promise.all([\n      // posts with related features\n      ...await searchPosts({\n        discussion: `${discussion}%?id=%`\n      }),\n      // posts with geometry\n      ...await searchPosts({\n        discussion: `${discussion}%`,\n        geometry: JSON.stringify(geometry)\n      })\n    ]);\n    const getPost = (postAggregate) => {\n      const { postDetails, replyDetails, channelDetails } = postAggregate;\n      const post = replyDetails ? replyDetails.post : postDetails.post;\n      const parentId = replyDetails ? postDetails.postId : null;\n      const channelId = channelDetails.channelId;\n      return Object.assign(Object.assign({}, post), { channelId,\n        parentId });\n    };\n    const uniquePostIds = [];\n    const posts = pagedResponses\n      .map(({ items }) => {\n      return items.map((postAggregate) => {\n        return getPost(postAggregate);\n      });\n    })\n      .flat()\n      .filter((post) => {\n      if (!uniquePostIds.includes(post.id)) {\n        uniquePostIds.push(post.id);\n        return true;\n      }\n      return false;\n    });\n    return postsToFeatureCollection(posts);\n  }\n  catch (error) {\n    const { message } = error;\n    console.error('Could not fetch on-map discussions:', message);\n  }\n};\n\nconst arcgisHubDiscussionsMapIntegratorCss = \".sc-arcgis-hub-discussions-map-integrator-h{display:block}@media only screen and (min-width: 640px){arcgis-hub-discussions.sc-arcgis-hub-discussions-map-integrator{position:absolute}arcgis-hub-discussions.sc-arcgis-hub-discussions-map-integrator{z-index:10}arcgis-hub-discussions.sc-arcgis-hub-discussions-map-integrator{width:25rem}arcgis-hub-discussions.sc-arcgis-hub-discussions-map-integrator{padding:0px}arcgis-hub-discussions.sc-arcgis-hub-discussions-map-integrator{top:calc(var(--top-offset) + 4.5rem);left:calc(var(--left-offset) - 5rem - 25rem);max-height:calc(var(--panel-height) - 6rem)}arcgis-hub-discussions-map-preview.sc-arcgis-hub-discussions-map-integrator{position:absolute}arcgis-hub-discussions-map-preview.sc-arcgis-hub-discussions-map-integrator{z-index:10}arcgis-hub-discussions-map-preview.sc-arcgis-hub-discussions-map-integrator{width:25rem}arcgis-hub-discussions-map-preview.sc-arcgis-hub-discussions-map-integrator{top:calc(var(--top-offset));left:calc(var(--left-offset))}}@media only screen and (max-width: 640px){arcgis-hub-discussions.sc-arcgis-hub-discussions-map-integrator{position:absolute}arcgis-hub-discussions.sc-arcgis-hub-discussions-map-integrator{z-index:10}arcgis-hub-discussions.sc-arcgis-hub-discussions-map-integrator{width:calc(var(--panel-width) + 0.05rem);top:calc(var(--top-offset) + var(--panel-height) * .5);max-height:calc(var(--panel-height) * .5);height:calc(var(--panel-height) * .5);left:0.95rem}arcgis-hub-discussions-map-preview.sc-arcgis-hub-discussions-map-integrator{position:absolute}arcgis-hub-discussions-map-preview.sc-arcgis-hub-discussions-map-integrator{z-index:10}arcgis-hub-discussions-map-preview.sc-arcgis-hub-discussions-map-integrator{width:calc(var(--panel-width) - 0.95rem);top:calc(var(--panel-height) + 3.2rem);left:0.5rem}}\";\n\nvar __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\n  var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\")\n    r = Reflect.decorate(decorators, target, key, desc);\n  else\n    for (var i = decorators.length - 1; i >= 0; i--)\n      if (d = decorators[i])\n        r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nconst ArcgisHubDiscussionsMapIntegrator = class {\n  /**\n   * Constructor function, pre-binds context to relevant methods\n   */\n  constructor(hostRef) {\n    registerInstance(this, hostRef);\n    this.arcgisHubMapPopoverOpen = createEvent(this, \"arcgisHubMapPopoverOpen\", 7);\n    this.arcgisHubMapPopoverClear = createEvent(this, \"arcgisHubMapPopoverClear\", 7);\n    this.hubTelemetry = createEvent(this, \"hubTelemetry\", 7);\n    /**\n     * True when esri modules are loaded and layers are added to the view\n     */\n    this.initialized = false;\n    /**\n     * Cache of Discussion post features\n     */\n    this.cachedFeatures = [];\n    /**\n     * Unsaved original geometry used when editing original geometry on a post\n     */\n    this.unsavedExistingGeometry = [];\n    /**\n     * Cache of feature layer geometries used to avoid duplicate queries\n     * to feature service\n     */\n    this.cachedRelatedFeatureGeometry = {};\n    /**\n     * Unique ID's for discussion layers\n     */\n    this.layerIds = [];\n    /**\n     * Staged attribute to signal graphic should persist on map\n     */\n    this.persistAttribute = '__persist__';\n    /**\n     * Options to configure symbol styles to hosting app theme\n     */\n    this.theme = {};\n    /**\n     * Whether the discussions element is displaying in preview mode\n     */\n    this.preview = true;\n    bind(this, 'makeGraphic', 'makeCalloutGraphic', 'getRelatedFeature', 'setCalloutSymbolOnPointerMove', 'handleMapClickDiscussions', 'handleViewSizeChange', 'handleMapDrawSelect', 'addRelatedFeature', 'removeRelatedFeature', 'renderAddLocation', 'renderRemoveLocation', 'calculateOffsets');\n  }\n  /**\n   * Component will load lifecycle method, handles initial JSAPI initialization\n   */\n  async componentWillLoad() {\n    this.initialize();\n    this.intl = await intlManager.loadIntlForComponent(this.element);\n    loadArcGisCss();\n  }\n  /**\n   * Disconnected callback lifecycle method, handles teardown of\n   * layers on map to return to original state.  Also removes any\n   * outstanding map handlers for garbage collection.\n   */\n  disconnectedCallback() {\n    this.teardown();\n  }\n  /**\n   * Determines if target of an event originated from the connected discussions component or floating\n   * discussions map panel\n   * @param event An event\n   * @returns True if target is a reference to connected discussions component or floating discussions map panel\n   */\n  eventTargetIsDiscussionsRef(event) {\n    return (event.target === this.discussionsRef) || (event.target === this.onMapDiscussionsRef) || (event.target === this.onMapDiscussionsPreviewRef);\n  }\n  emitHubTelemetry(telemetry) {\n    this.hubTelemetry.emit(Object.assign(Object.assign({}, telemetry), { postId: this.sketchPostId, channelId: this.currentDiscussionsRef.channelId }));\n  }\n  /**\n   * Handles initial JSAPI initialization in instances where MapView is not available\n   * during componentWillLoad lifecycle method.  If a different MapView is\n   * provided, it will teardown the old MapView and initialize the new one\n   * @param view JSAPI MapView\n   * @param prevView Old JSAPI MapView\n   */\n  attachView(view, prevView) {\n    const { initialized } = this;\n    if (view && view !== prevView) {\n      if (initialized) {\n        this.teardown();\n      }\n      // initialize with new view\n      this.initialize();\n    }\n    else if (!view && initialized) {\n      // view detached - so gracefully teardown\n      this.teardown();\n    }\n  }\n  /**\n   * Setup and teardown of map when discussions is connected / disconnected\n   * @param discussionsRef HTML Element reference to discussions component\n   */\n  attachdiscussionsRef(discussionsRef) {\n    const { initialized } = this;\n    if (discussionsRef && !initialized) {\n      this.initialize();\n    }\n  }\n  /**\n   * Preserve drawRef props when it's connected\n   */\n  handleDrawRefUpdate() {\n    this.saveInitialDrawOptions();\n  }\n  /**\n   * Calculates position offsets for discussions element\n   */\n  calculateOffsets() {\n    const { view, preview, graphicGeometry, isOffset, previewHeight, activeMapDiscussion } = this;\n    if (view && activeMapDiscussion) {\n      const { container } = view;\n      const { top, left, right } = container.getBoundingClientRect();\n      const graphicScreenPos = view.toScreen(graphicGeometry);\n      const graphicLeft = isOffset ? graphicScreenPos.x + 5 : graphicScreenPos.x;\n      const graphicTop = isOffset ? graphicScreenPos.y - 34 : graphicScreenPos.y;\n      this.leftOffset = preview ? graphicLeft + left : right;\n      this.topOffset = preview ? graphicTop + top - previewHeight : top;\n    }\n  }\n  /**\n   * Gets height of preview element\n   * @param evt CustomEvent\n   */\n  handlePreviewDidLoad(evt) {\n    const { detail: height } = evt;\n    this.previewHeight = 0;\n    this.previewHeight = height;\n  }\n  /**\n   * Expands the discussions component\n   */\n  handlePreviewExpanded() {\n    this.preview = false;\n  }\n  /**\n   * Handles request to ease to current discussions graphics\n   */\n  handleGeometryGoTo(event) {\n    const { detail: thread } = event;\n    const graphics = [...this.geometryGraphicsLayer.graphics.toArray(), ...this.calloutGraphicsLayer.graphics.toArray()];\n    let activeGraphics = [];\n    if (thread) {\n      const postParentId = thread.postDetails.postId;\n      const postId = (thread.replyDetails) ? thread.replyDetails.postId : thread.postDetails.postId;\n      activeGraphics = graphics.filter(({ attributes: { id, parentId } }) => {\n        return (id === postId) || (postParentId && parentId === postParentId);\n      });\n    }\n    else {\n      const { activeMapDiscussion: { locationId } } = this;\n      activeGraphics = graphics.filter(({ attributes: { relatedFeatureId } }) => {\n        return relatedFeatureId === locationId;\n      });\n    }\n    if (activeGraphics.length) {\n      this.goTo(activeGraphics);\n    }\n  }\n  handleGeometryFeature(event) {\n    const { detail: { post, create } } = event;\n    this.unsavedExistingGeometry = [];\n    this.cachedFeatures = this.cachedFeatures.filter(({ properties: { id } }) => {\n      return id !== post.id;\n    });\n    const newFeatures = postToFeatures(post);\n    if (newFeatures) {\n      this.cachedFeatures = [...this.cachedFeatures, ...postToFeatures(post)];\n      if (create) {\n        this.cachedFeatures.map((feature) => {\n          const { properties: { id } } = feature;\n          const { parentId } = post;\n          if (id === parentId) {\n            if (!('replyCount' in feature.properties)) {\n              feature.properties.replyCount = 0;\n            }\n            feature.properties.replyCount += 1;\n          }\n          return feature;\n        });\n      }\n      this.refreshFeatures(this.cachedFeatures);\n      this.clearHoverActiveGraphics(true);\n    }\n  }\n  handleGeometryFeatureDeleted(event) {\n    const { detail: { id: deletedPostId, parentId: deletedPostParentId } } = event;\n    this.cachedFeatures = this.cachedFeatures.filter(({ properties: { id } }) => {\n      return id !== deletedPostId;\n    }).map((feature) => {\n      const { properties: { id } } = feature;\n      if (id === deletedPostParentId) {\n        feature.properties.replyCount -= 1;\n      }\n      return feature;\n    });\n    this.refreshFeatures(this.cachedFeatures);\n    this.clearHoverActiveGraphics(true);\n  }\n  /**\n   * Handles event that requests that a feature be selected on the map\n   * @param event\n   */\n  handleGeometryFeatureSelect(event) {\n    const { detail: { properties: { id, relatedFeatureId, index, unsaved } } } = event;\n    if (unsaved) {\n      let target = this.unsavedGeometryGraphicsLayer.graphics.getItemAt(index);\n      if (relatedFeatureId) {\n        target = this.makeGraphic(event.detail);\n      }\n      this.goTo(target);\n    }\n    else {\n      const graphic = this.calloutGraphicsLayer.graphics.find((graphic) => {\n        const { attributes: { relatedFeatureId: _relatedFeatureId, id: postId, __index__: postIndex } } = graphic;\n        return relatedFeatureId\n          ? relatedFeatureId == _relatedFeatureId\n          : postId == id && (postIndex === null || index == postIndex);\n      });\n      if (graphic) {\n        this.addHighlightGraphic(graphic, SYMBOL_STATE.ACTIVE, false);\n        const target = relatedFeatureId\n          ? this.cachedRelatedFeatureGeometry[relatedFeatureId].arcgis\n          : this.getGraphicById(id, index);\n        this.goTo(target);\n      }\n    }\n  }\n  /**\n   * Handles event that requests that a feature be highlighted on the map\n   * @param event\n   */\n  handleGeometryFeatureHighlight(event) {\n    const { detail: { properties: { id, relatedFeatureId, index, unsaved } } } = event;\n    if (unsaved) {\n      this.clearHoverActiveGraphics();\n    }\n    else {\n      const graphic = this.calloutGraphicsLayer.graphics.find((graphic) => {\n        const { attributes: { relatedFeatureId: _relatedFeatureId, id: postId, __index__: postIndex } } = graphic;\n        return relatedFeatureId\n          ? relatedFeatureId == _relatedFeatureId\n          : postId == id && (postIndex === null || index == postIndex);\n      });\n      if (graphic) {\n        this.addHighlightGraphic(graphic, SYMBOL_STATE.HOVER, false);\n      }\n    }\n  }\n  /**\n   * During a post editing session, removes unsaved features or related features\n   */\n  handleFeatureRemove(event) {\n    const { detail: { properties: { id, relatedFeatureId, index, unsaved } } } = event;\n    const { currentDiscussionsRef: { unsavedFeatures, unsavedRelatedFeatures } } = this;\n    if (unsaved) {\n      if (relatedFeatureId) {\n        this.currentDiscussionsRef.unsavedRelatedFeatures = [\n          ...unsavedRelatedFeatures.slice(0, index),\n          ...unsavedRelatedFeatures.slice(index + 1, unsavedRelatedFeatures.length)\n        ];\n      }\n      else {\n        this.currentDiscussionsRef.unsavedFeatures = [\n          ...unsavedFeatures.slice(0, index),\n          ...unsavedFeatures.slice(index + 1, unsavedFeatures.length)\n        ];\n        const graphic = this.unsavedGeometryGraphicsLayer.graphics.getItemAt(index);\n        this.unsavedGeometryGraphicsLayer.graphics.remove(graphic);\n      }\n    }\n    else {\n      const findMatch = (graphic) => {\n        const { attributes: { relatedFeatureId: _relatedFeatureId, id: postId, __index__: postIndex } } = graphic;\n        return relatedFeatureId\n          ? relatedFeatureId == _relatedFeatureId\n          : postId == id && (postIndex === null || index == postIndex);\n      };\n      const calloutGraphic = this.calloutGraphicsLayer.graphics.find(findMatch);\n      if (calloutGraphic) {\n        calloutGraphic.visible = false;\n      }\n      const geometryGraphic = this.geometryGraphicsLayer.graphics.find(findMatch);\n      if (geometryGraphic) {\n        geometryGraphic.visible = false;\n      }\n    }\n    this.clearHoverActiveGraphics(true);\n  }\n  handleGeometryDrawCreate(event) {\n    const { detail: postId } = event;\n    this.sketchPostId = postId;\n    this.drawRef.buffer = false;\n    this.drawRef.disablePrimaryOptions = true;\n    this.drawRef.disableEditOptions = true;\n  }\n  handleGeometryDrawTypeSelect(event) {\n    this.drawRef.setActiveTool(event.detail);\n  }\n  /**\n   * Handles event that requests that a feature's drawn geometry\n   * be edited\n   * @param event\n   */\n  handleGeometryDrawEdit(event) {\n    const { drawRef } = this;\n    const { detail: { properties: { id, index, unsaved } } } = event;\n    const { geometry } = unsaved\n      ? this.unsavedGeometryGraphicsLayer.graphics.getItemAt(index)\n      : this.getGraphicById(id, index);\n    this.hideLayers();\n    this.goTo(geometry);\n    this.sketchPostId = id;\n    this.sketchIndex = index;\n    this.sketchIsUnsaved = unsaved;\n    drawRef.geometry = geometry;\n    drawRef.disablePrimaryOptions = true;\n    drawRef.buffer = false;\n  }\n  /**\n   * Handles event to stop a current edit session\n   * @param event\n   */\n  handleGeometryDrawEditCancel() {\n    this.currentDiscussionsRef.unsavedFeatures = [\n      ...this.currentDiscussionsRef.unsavedFeatures\n    ];\n    this.drawRef.forceReset();\n    this.showLayers();\n  }\n  handleDrawGraphicsChange(event) {\n    const { detail: { graphics, save, canceled, unsaved } } = event;\n    const { sketchPostId, sketchIndex, sketchIsUnsaved } = this;\n    const graphic = graphics.getItemAt(0);\n    graphic.geometry = simplify(graphic.geometry.clone(), this.view);\n    if (save && this.drawRef.disablePrimaryOptions) {\n      // Editing existing unsaved or saved graphics\n      const geographicGeom = webMercatorToGeographic(graphic.geometry);\n      const geometry = arcgisToGeoJSON(geographicGeom);\n      if (sketchIsUnsaved) {\n        // Unsaved / New graphics on post\n        const updateStagedFeatures = this.currentDiscussionsRef.unsavedFeatures.map((feature, index) => {\n          if (index === this.sketchIndex) {\n            feature.geometry = geometry;\n          }\n          return feature;\n        });\n        this.currentDiscussionsRef.unsavedFeatures = updateStagedFeatures;\n        this.unsavedGeometryGraphicsLayer.graphics.getItemAt(this.sketchIndex).geometry = graphic.geometry;\n      }\n      else {\n        // Saving edits to existing graphic on post\n        const feature = this.postToGeoJSON(geometry, {\n          index: sketchIndex,\n          id: sketchPostId\n        });\n        this.currentDiscussionsRef.unsavedExistingFeatures = [\n          ...this.currentDiscussionsRef.unsavedExistingFeatures.filter(({ properties: { index } }) => index !== sketchIndex),\n          feature\n        ];\n        const originalGraphic = this.getGraphicById(sketchPostId, sketchIndex);\n        const unsavedExistingGeometryExists = this.unsavedExistingGeometry.filter(({ id, index }) => {\n          return id === sketchPostId && index === sketchIndex;\n        });\n        if (!unsavedExistingGeometryExists.length) {\n          this.unsavedExistingGeometry.push({\n            id: sketchPostId,\n            index: sketchIndex,\n            geometry: originalGraphic.geometry.clone()\n          });\n        }\n        originalGraphic.geometry = graphic.geometry;\n      }\n      this.drawRef.forceReset();\n      this.showLayers();\n      const type = convertGeometryTypeToTelemetryString(geometry);\n      this.emitHubTelemetry(dist.dictionary.category.content.action.update.label.location.details[type]);\n    }\n    else if (canceled) {\n      // Cancelling edits\n      this.currentDiscussionsRef.unsavedFeatures = [\n        ...this.currentDiscussionsRef.unsavedFeatures\n      ];\n      this.drawRef.forceReset();\n      this.showLayers();\n    }\n    else if (unsaved) {\n      // Adding new unsaved graphics\n      this.drawRef.forceReset();\n      graphic.symbol = symbols[graphic.geometry.type](this.themeWithDefaults[graphic.geometry.type]);\n      this.addGraphicsToGraphicsLayer(this.unsavedGeometryGraphicsLayer, [graphic]);\n      const features = [];\n      graphics.forEach((graphic) => {\n        const geographicGeom = webMercatorToGeographic(graphic.geometry);\n        const geometry = arcgisToGeoJSON(geographicGeom);\n        features.push({\n          type: 'Feature',\n          geometry,\n          properties: {\n            id: this.sketchPostId\n          }\n        });\n        const type = convertGeometryTypeToTelemetryString(geometry);\n        this.emitHubTelemetry(dist.dictionary.category.content.action.create.label.location.details[type]);\n      });\n      this.currentDiscussionsRef.unsavedFeatures = [\n        ...this.currentDiscussionsRef.unsavedFeatures,\n        ...features\n      ];\n    }\n  }\n  /**\n   * Handles event to force drawing tools to reset\n   * @param event\n   */\n  handleGeometryDrawReset() {\n    this.currentDiscussionsRef.unsavedFeatures = [\n      ...this.currentDiscussionsRef.unsavedFeatures\n    ];\n    this.restoreInitialDrawOptions();\n    this.showLayers();\n  }\n  handleGeometryClearAll() {\n    this.resetStagedFeatures();\n    this.restoreInitialDrawOptions();\n    this.showLayers();\n    this.unsavedGeometryGraphicsLayer.graphics.removeAll();\n    const makeVisible = (graphic) => { graphic.visible = true; };\n    this.geometryGraphicsLayer.graphics.forEach(makeVisible);\n    this.calloutGraphicsLayer.graphics.forEach(makeVisible);\n  }\n  addRelatedFeature() {\n    const objectIdField = this.selectedGraphic.layer.objectIdField;\n    const objectId = this.selectedGraphic.attributes[objectIdField];\n    this.selectedGraphic.geometry = webMercatorToGeographic(this.selectedGraphic.geometry);\n    const relatedFeature = {\n      postId: this.sketchPostId,\n      objectId,\n      feature: arcgisToGeoJSON(this.selectedGraphic.toJSON())\n    };\n    this.currentDiscussionsRef.unsavedRelatedFeatures = [\n      ...this.currentDiscussionsRef.unsavedRelatedFeatures,\n      relatedFeature\n    ];\n    this.highlightGraphic();\n    this.arcgisHubMapPopoverClear.emit();\n    this.emitHubTelemetry(dist.dictionary.category.interaction.action.select.label.content);\n  }\n  removeRelatedFeature() {\n    const { currentDiscussionsRef: { unsavedRelatedFeatures } } = this;\n    const objectIdField = this.selectedGraphic.layer.objectIdField;\n    const objectId = this.selectedGraphic.attributes[objectIdField];\n    const index = this.currentDiscussionsRef.unsavedRelatedFeatures.findIndex((feature) => feature.objectId == objectId);\n    this.currentDiscussionsRef.unsavedRelatedFeatures = [\n      ...unsavedRelatedFeatures.slice(0, index),\n      ...unsavedRelatedFeatures.slice(index + 1, unsavedRelatedFeatures.length)\n    ];\n    this.arcgisHubMapPopoverClear.emit();\n    this.clearHighlights();\n    this.emitHubTelemetry(dist.dictionary.category.interaction.action.deselect.label.content);\n  }\n  renderAddLocation() {\n    return (h(\"calcite-action-pad\", { \"expand-disabled\": true, expanded: true, layout: \"horizontal\" }, h(\"calcite-action\", { icon: \"pin-plus\", onClick: this.addRelatedFeature, text: this.intl.t('location.add'), textEnabled: true })));\n  }\n  renderRemoveLocation() {\n    return (h(\"calcite-action-pad\", { \"expand-disabled\": true, expanded: true, layout: \"horizontal\" }, h(\"calcite-action\", { icon: \"trash\", onClick: this.removeRelatedFeature, text: this.intl.t('location.remove'), textEnabled: true })));\n  }\n  async handleMapDrawSelect(event) {\n    const { detail } = event;\n    const { targetLayer } = this;\n    const { results: [result] } = await this.view.hitTest(detail, { include: targetLayer });\n    if ((result === null || result === void 0 ? void 0 : result.graphic) && this.drawRef.disableEditOptions) {\n      const { graphic } = result;\n      const objectIdField = graphic.layer.objectIdField;\n      const objectId = graphic.attributes[objectIdField];\n      if (!graphic.attributes.hasOwnProperty(targetLayer.displayField)) {\n        // It is not guaranteed that the targetLayer was configured with necessary outFields\n        // prior to being added to the view.  If not, perform additional query to the service \n        // to obtain additional fields.\n        const { features: [feature] } = await targetLayer.queryFeatures({ objectIds: [objectId], outFields: ['*'], returnGeometry: false });\n        if (feature) {\n          graphic.attributes = feature.attributes;\n        }\n      }\n      // check if objectID exists in current unsaved features\n      const unsavedRelatedFeatureIds = this.currentDiscussionsRef.unsavedRelatedFeatures.map((feature) => feature.objectId);\n      let renderFn = this.renderAddLocation;\n      if (unsavedRelatedFeatureIds.includes(objectId)) {\n        renderFn = this.renderRemoveLocation;\n      }\n      this.selectedGraphic = graphic;\n      this.arcgisHubMapPopoverOpen.emit({\n        geometry: graphic.geometry,\n        view: this.view,\n        render: renderFn\n      });\n      this.highlightGraphic(graphic);\n    }\n    else {\n      this.selectedGraphic = null;\n      this.highlightGraphic();\n    }\n  }\n  handleDiscussionsClose(event) {\n    if (event.target === this.onMapDiscussionsRef || event.target === this.onMapDiscussionsPreviewRef) {\n      // clear current active discussion\n      this.activeMapDiscussion = undefined;\n      this.clearHoverActiveGraphics(true);\n    }\n  }\n  /**\n   * Used to inform connected discussions component if map is available\n   * @param hasMap Boolean - if map is available\n   */\n  setDiscussionsRefHasMap(hasMap) {\n    if (this.discussionsRef) {\n      this.discussionsRef.hasMap = hasMap;\n    }\n  }\n  /**\n   * Initialization - loads JSAPI modules and adds necessary layers\n   */\n  async initialize() {\n    const { view, context } = this;\n    this.saveInitialDrawOptions();\n    if (view && context) {\n      await view.when();\n      this.addGeometryGraphicsLayer();\n      this.addStagedGeometryGraphicsLayer();\n      this.addCalloutGraphicsLayer();\n      this.addHighlightGraphicsLayer();\n      this.fetchSubject();\n      this.fetchPosts();\n      this.handleViewSizeChange();\n      if (this.cachedFeatures.length) {\n        try {\n          await this.refreshFeatures(this.cachedFeatures);\n        }\n        catch (e) {\n          console.warn('Cannot add discussions features to the map', e.message);\n        }\n      }\n      this.setDiscussionsRefHasMap(true);\n      this.mapViewSizeChangeHandler = watch(view, 'size', this.handleViewSizeChange);\n      this.mapViewCenterChangeHandler = watch(view, 'center', this.calculateOffsets);\n      this.initialized = true;\n    }\n  }\n  /**\n   * Teardown of component to return map to original state\n   * and remove map handlers\n   */\n  teardown() {\n    this.initialized = false;\n    this.clearHighlights();\n    this.removeViewHandlers();\n    this.removeLayers();\n    this.resetSelect();\n    this.setDiscussionsRefHasMap(false);\n  }\n  /**\n   * Pre-fetches subject details for faster initial discussions\n   * on-map panel load time\n   */\n  fetchSubject() {\n    const { discussion, context } = this;\n    fetchSubjectDetails(Object.assign({ discussion }, context.hubRequestOptions));\n  }\n  /**\n   * Fetches all posts with location to load onto map for\n   * current discussion\n  */\n  fetchPosts() {\n    getPostsWithLocation(this.discussion, this.context.hubRequestOptions).then((featureCollection) => {\n      if (featureCollection === null || featureCollection === void 0 ? void 0 : featureCollection.features) {\n        this.cachedFeatures = featureCollection.features;\n        if (this.initialized) {\n          this.refreshFeatures(featureCollection.features);\n        }\n      }\n    });\n  }\n  /**\n   * Add graphics layer that will hold post graphics\n   */\n  addGeometryGraphicsLayer() {\n    this.geometryGraphicsLayer = new GraphicsLayer({\n      graphics: [],\n      elevationInfo: {\n        mode: 'on-the-ground'\n      }\n    });\n    this.view.map.add(this.geometryGraphicsLayer);\n    this.layerIds.push(this.geometryGraphicsLayer.id);\n  }\n  /**\n   * Adds graphics layer that will temporarily hold graphics for post that is being edited\n   */\n  addStagedGeometryGraphicsLayer() {\n    this.unsavedGeometryGraphicsLayer = new GraphicsLayer({\n      graphics: [],\n      elevationInfo: {\n        mode: 'on-the-ground'\n      }\n    });\n    this.view.map.add(this.unsavedGeometryGraphicsLayer);\n    this.layerIds.push(this.geometryGraphicsLayer.id);\n  }\n  // Add Callout Graphic Layer that will hold callout graphics\n  addCalloutGraphicsLayer() {\n    this.calloutGraphicsLayer = new GraphicsLayer({\n      graphics: [],\n      effect: 'drop-shadow(0px, 2px, 8px, rgba(0, 0, 0, .20))',\n      elevationInfo: {\n        mode: 'relative-to-ground'\n      }\n    });\n    this.view.map.add(this.calloutGraphicsLayer);\n    this.layerIds.push(this.calloutGraphicsLayer.id);\n    // Set hover graphic symbol state\n    this.mapPointerMoveHandler = this.view.on('pointer-move', this.setCalloutSymbolOnPointerMove);\n    this.mapClickDiscussionsHandler = this.view.on('click', this.handleMapClickDiscussions);\n  }\n  // Add Highlight Graphics Layer that will hold active graphic highlights\n  addHighlightGraphicsLayer() {\n    this.highlightGraphicsLayer = new GraphicsLayer({\n      graphics: [],\n      elevationInfo: {\n        mode: 'relative-to-ground'\n      }\n    });\n    this.view.map.add(this.highlightGraphicsLayer);\n    this.layerIds.push(this.highlightGraphicsLayer.id);\n  }\n  /**\n   * Add graphic to highlight layer and clear non-persisted graphics\n   * @param graphic An Esri JSAPI Graphic\n   * @param state SYMBOL_STATE\n   * @param persist If graphic should stay active until overwritten\n   */\n  addHighlightGraphic(graphic, state, persist) {\n    var _a, _b;\n    const { themeWithDefaults, highlightGraphicsLayer, persistAttribute, is3D } = this;\n    const graphicCopy = graphic.clone();\n    graphicCopy.symbol = symbols.callout(state, Object.assign(Object.assign({}, themeWithDefaults.callout), { isOffset: (_a = graphic === null || graphic === void 0 ? void 0 : graphic.attributes) === null || _a === void 0 ? void 0 : _a.isOffset, is3D }), (_b = graphicCopy.attributes) === null || _b === void 0 ? void 0 : _b.totalCount);\n    graphicCopy.attributes[persistAttribute] = persist;\n    this.clearHoverActiveGraphics(persist);\n    highlightGraphicsLayer.add(graphicCopy);\n  }\n  /**\n   * Add styled hover graphic for post callouts when the mouse intersects an existing callout\n   * @param event Esri JSAPI ViewPointerMoveEvent\n   */\n  setCalloutSymbolOnPointerMove(event) {\n    this.view.hitTest(event, { include: this.calloutGraphicsLayer }).then((r) => {\n      if (r.results.length) {\n        const [result] = r.results;\n        const { graphic } = result;\n        this.addHighlightGraphic(graphic, SYMBOL_STATE.HOVER, false);\n      }\n      else {\n        this.clearHoverActiveGraphics(false);\n      }\n    });\n  }\n  /**\n   * Remove layers from the map\n   */\n  removeLayers() {\n    [this.geometryGraphicsLayer, this.unsavedGeometryGraphicsLayer, this.calloutGraphicsLayer, this.highlightGraphicsLayer]\n      .forEach(layer => this.removeLayer(layer));\n  }\n  /**\n   * Hide layers on the map by setting opacity to .10\n   */\n  hideLayers() {\n    [this.geometryGraphicsLayer, this.unsavedGeometryGraphicsLayer, this.calloutGraphicsLayer, this.highlightGraphicsLayer]\n      .forEach(layer => layer.opacity = 0.10);\n  }\n  /**\n   * Show layers on the map by setting opacity to 1\n   */\n  showLayers() {\n    [this.geometryGraphicsLayer, this.unsavedGeometryGraphicsLayer, this.calloutGraphicsLayer, this.highlightGraphicsLayer]\n      .forEach(layer => layer.opacity = 1);\n  }\n  /**\n   * Remove a layer from the map\n   * @param layer Esri JSAPI GraphicsLayer\n   */\n  removeLayer(layer) {\n    if (layer) {\n      layer.destroy();\n    }\n  }\n  /**\n   * Empties any graphics from existing graphics layers\n   */\n  emptyFeatures() {\n    [this.geometryGraphicsLayer, this.unsavedGeometryGraphicsLayer, this.calloutGraphicsLayer].forEach(layer => layer.removeAll());\n  }\n  /**\n   * Adds graphics to a specified graphics layer\n   * @param layer Esri JSAPI GraphicsLayer\n   * @param graphics Array of Esri JSAPI Graphics\n   */\n  addGraphicsToGraphicsLayer(layer, graphics) {\n    layer.addMany(graphics);\n  }\n  /**\n   * Takes array of GeoJSON features and adds them to the map, replacing all previous features\n   * @param features An array of GeoJSON Features\n   */\n  async refreshFeatures(features) {\n    this.emptyFeatures();\n    this.resetSelect();\n    features.forEach((feature) => { var _a; return feature.properties.totalCount = (_a = feature.properties.replyCount) !== null && _a !== void 0 ? _a : 0; });\n    // create graphics for underlying geometry and callout CIM symbol\n    const hasGeometry = ({ geometry }) => Boolean(geometry);\n    const postGraphics = features.map(this.makeGraphic).filter(hasGeometry);\n    const geometryCallout = features.map(this.makeCalloutGraphic).filter(hasGeometry);\n    // Build cache of post related feature geometries by feature ID\n    const hasFeatures = ({ properties }) => Boolean(parseDiscussionURI(properties.discussion).features);\n    const postsWithRelatedFeatures = features.filter(hasFeatures);\n    const relatedFeatureIds = Array.from(new Set(postsWithRelatedFeatures\n      .map(({ properties: { discussion } }) => parseDiscussionURI(discussion).features.map(id => id))\n      .flat()));\n    await this.cacheRelatedFeatureGeometry(relatedFeatureIds);\n    // Build related feature array and update callout counts\n    const relatedFeatures = [];\n    const postIds = [];\n    for (const post of postsWithRelatedFeatures) {\n      if (postIds.includes(post.properties.id)) {\n        // a single post can be divided for n + 1 geometries, but only increment once\n        continue;\n      }\n      else {\n        postIds.push(post.properties.id);\n      }\n      const { properties: postProperties } = post;\n      const { features } = parseDiscussionURI(postProperties.discussion);\n      postProperties.totalCount = 0;\n      features.forEach((postFeatureId) => {\n        var _a;\n        const matchesFeatureId = ({ properties: { relatedFeatureId } }) => {\n          return relatedFeatureId == postFeatureId;\n        };\n        const existingFeature = relatedFeatures.find(matchesFeatureId);\n        if (existingFeature) {\n          // the related feature has already been found, so increment count\n          const { properties: featureProperties } = existingFeature;\n          const postTotalCount = ((_a = postProperties.totalCount) !== null && _a !== void 0 ? _a : 0) + 1;\n          featureProperties.totalCount += postTotalCount;\n        }\n        else {\n          try {\n            // get post related feature from cache\n            const feature = this.getRelatedFeature(postFeatureId);\n            // add reference to related feature ID\n            feature.properties = Object.assign(Object.assign({}, post.properties), { relatedFeatureId: postFeatureId });\n            relatedFeatures.push(feature);\n          }\n          catch (error) {\n            // related features referenced by a post may have been removed from service\n            console.warn(`Failed to access post related feature:`, error.message);\n          }\n        }\n      });\n    }\n    const relatedFeaturesCallout = relatedFeatures.map(this.makeCalloutGraphic);\n    const calloutGraphics = [...geometryCallout, ...relatedFeaturesCallout];\n    // Add graphics to map\n    this.addGraphicsToGraphicsLayer(this.geometryGraphicsLayer, postGraphics);\n    this.addGraphicsToGraphicsLayer(this.calloutGraphicsLayer, calloutGraphics);\n  }\n  /**\n   * Creates an extent from a point, used for determining zoom level\n   * @param geometry Esri JSAPI Point Geometry\n   * @param tolerance Number in Degrees to expand point extent\n   * @returns\n   */\n  pointToExtent(geometry, tolerance = 0.0025) {\n    const { x, y, spatialReference } = geometry;\n    const extent = new Extent({\n      xmin: x - tolerance,\n      ymin: y - tolerance,\n      xmax: x + tolerance,\n      ymax: y + tolerance,\n      spatialReference\n    });\n    return extent;\n  }\n  /**\n   * Eases map to given location\n   * @param target Target location / viewpoint to navigate to\n   */\n  goTo(goToTarget) {\n    if (!this.view) {\n      return;\n    }\n    let target = goToTarget;\n    if (target.geometry && target.geometry.type === 'point') {\n      target = this.pointToExtent(target.geometry);\n    }\n    if (target.extent) {\n      target = target.extent.clone().expand(2);\n    }\n    this.view.goTo({\n      target\n    }, {\n      duration: 1000,\n      easing: 'ease'\n    }).catch((error) => {\n      if (!isAbortError(error)) {\n        console.error(`Failed to zoom map to target feature or extent:`, error.message);\n      }\n    });\n  }\n  /**\n   * Constructs a valid GeoJSON object given a geometry type and properties object\n   * @param geometry GeoJSON geometry type string\n   * @param properties GeoJSON properties object\n   * @returns GeoJSON Feature\n   */\n  postToGeoJSON(geometry, properties) {\n    return {\n      type: 'Feature',\n      geometry,\n      properties\n    };\n  }\n  /**\n   * Construct an Esri Graphic from a GeoJSON Feature\n   * @param feature GeoJSON Feature\n   * @returns Esri JSAPI Graphic\n   */\n  makeGraphic(feature) {\n    var _a;\n    const arcgisJson = geojsonToArcGIS(feature);\n    const graphic = Graphic.fromJSON(arcgisJson);\n    if ((_a = graphic === null || graphic === void 0 ? void 0 : graphic.geometry) === null || _a === void 0 ? void 0 : _a.type) {\n      graphic.symbol = symbols[graphic.geometry.type](this.themeWithDefaults[graphic.geometry.type]);\n    }\n    return graphic;\n  }\n  /**\n   * Construct an Esri Graphic that is a callout icon for the underlying GeoJSON Feature\n   * @param feature GeoJSON Feature\n   * @returns Esri JSAPI Graphic\n   */\n  makeCalloutGraphic(feature) {\n    var _a;\n    const { is3D } = this;\n    const { callout } = symbols;\n    const { geometry, properties } = feature;\n    // IMPROVEMENT: we should think about where callout should be placed, currently just grabs first coord\n    const [x, y] = geometry.coordinates.flat(Infinity);\n    const isOffset = !properties.relatedFeatureId && feature.geometry.type === 'Point';\n    const arcgisJson = geojsonToArcGIS({\n      type: 'Feature',\n      geometry: {\n        type: 'Point',\n        coordinates: [x, y]\n      },\n      properties: Object.assign(Object.assign({}, properties), { replyCount: properties.replyCount || 0, isOffset })\n    });\n    const graphic = Graphic.fromJSON(arcgisJson);\n    graphic.symbol = callout(SYMBOL_STATE.DEFAULT, Object.assign(Object.assign({}, this.themeWithDefaults.callout), { isOffset,\n      is3D }), (_a = feature.properties) === null || _a === void 0 ? void 0 : _a.totalCount);\n    return graphic;\n  }\n  /**\n   * Queries feature service for related feature geometry and constructs GeoJSON feature\n   * @param feature GeoJSON Feature\n   * @returns Promise that resolves with a GeoJSON Feature\n   */\n  getRelatedFeature(objectId) {\n    const geometry = this.cachedRelatedFeatureGeometry[objectId].geojson;\n    return {\n      type: 'Feature',\n      geometry,\n      properties: {}\n    };\n  }\n  /**\n   * Caches realted feature geometry in single optimized query\n   * @param objectIds Array of feature service object ids\n   */\n  async cacheRelatedFeatureGeometry(objectIds) {\n    // determine which features are currently not cached and cache them\n    const { cachedRelatedFeatureGeometry, targetLayer } = this;\n    if (!targetLayer) {\n      // TODO: We should, as an improvement, not require the underlying discussions \n      // service layer to already exist on the map.  Rather, we should check if the service\n      // exists on the map, and if not add it (featching service from item ID)\n      console.warn('Discussions service layer not defined; ingnoring related features');\n      return;\n    }\n    const cachedIds = Object.keys(cachedRelatedFeatureGeometry);\n    const nonCachedIds = objectIds.filter((id) => !cachedIds.includes(`${id}`));\n    if (nonCachedIds.length) {\n      const query = { where: \"1=1\", objectIds: nonCachedIds.map(id => +id), returnGeometry: true, outSpatialReference: { wkid: 4326 }, outFields: [this.targetLayer.objectIdField, this.targetLayer.displayField] };\n      const { features } = await this.targetLayer.queryFeatures(query);\n      features.forEach(({ geometry, attributes }) => {\n        const geometryGeoJSON = arcgisToGeoJSON(geometry);\n        this.cachedRelatedFeatureGeometry[attributes[this.targetLayer.objectIdField]] = {\n          arcgis: geometry,\n          geojson: geometryGeoJSON\n        };\n      });\n    }\n  }\n  /**\n   * Query graphics layer for existing graphic matching post ID\n   * @param id Unique identifier of feature (post id)\n   * @returns\n   */\n  getGraphicById(id, index) {\n    const graphic = this.geometryGraphicsLayer.graphics.find(({ attributes: { id: postId, __index__: postIndex } }) => {\n      const matchIndex = index !== null ? index == postIndex : true;\n      return postId === id && matchIndex;\n    });\n    return graphic;\n  }\n  /**\n   * Highlight a feature on the map\n   * @param graphic Esri JSAPI Graphic to highlight\n   * @returns\n   */\n  highlightGraphic(graphic) {\n    this.clearHighlights();\n    if (!graphic) {\n      return;\n    }\n    this.clearHighlights();\n    this.view.whenLayerView(graphic.layer).then((layerView) => {\n      this.highlightHandle = layerView.highlight(graphic);\n    });\n  }\n  /**\n   * Clear any existing highlighted graphics\n   */\n  clearHighlights() {\n    if (this.highlightHandle) {\n      this.highlightHandle.remove();\n      this.highlightHandle = null;\n    }\n  }\n  /**\n   * Clear any existing active or hover graphics\n   */\n  clearHoverActiveGraphics(all) {\n    const { persistAttribute, highlightGraphicsLayer } = this;\n    if (all) {\n      highlightGraphicsLayer.removeAll();\n    }\n    else {\n      const tempGraphics = highlightGraphicsLayer.graphics.filter(({ attributes }) => {\n        return !attributes[persistAttribute];\n      });\n      highlightGraphicsLayer.removeMany(tempGraphics.toArray());\n    }\n  }\n  /**\n   * Remove MapView handlers for garbage collection\n   */\n  removeViewHandlers() {\n    [this.mapPointerMoveHandler, this.mapClickDiscussionsHandler, this.mapViewSizeChangeHandler, this.mapViewCenterChangeHandler].forEach((handler) => {\n      if (handler) {\n        handler.remove();\n        handler = null;\n      }\n    });\n  }\n  /**\n   * Remove map click handler used for selecting related features\n   */\n  resetSelect() {\n    this.clearHighlights();\n  }\n  saveInitialDrawOptions() {\n    const { drawRef: { buffer, disableEditOptions, disablePrimaryOptions } } = this;\n    this.initialDrawOptions = {\n      buffer,\n      disableEditOptions,\n      disablePrimaryOptions\n    };\n  }\n  restoreInitialDrawOptions() {\n    const { initialDrawOptions: { buffer, disableEditOptions, disablePrimaryOptions } } = this;\n    this.drawRef.buffer = buffer;\n    this.drawRef.disableEditOptions = disableEditOptions;\n    this.drawRef.disablePrimaryOptions = disablePrimaryOptions;\n    this.drawRef.setActiveTool(undefined);\n    this.drawRef.forceReset();\n  }\n  resetStagedFeatures() {\n    this.currentDiscussionsRef.unsavedFeatures = [];\n    this.currentDiscussionsRef.unsavedRelatedFeatures = [];\n    this.currentDiscussionsRef.unsavedExistingFeatures = [];\n    this.unsavedExistingGeometry.forEach(({ id, index, geometry }) => {\n      // revert edits on existing geometry\n      const graphic = this.getGraphicById(id, index);\n      graphic.geometry = geometry;\n    });\n    this.unsavedExistingGeometry = [];\n  }\n  /**\n   * When map is clicked on discussions geometries, set active discussion for on map discussions panel\n   * @param event Esri JSAPI ViewClickEvent\n   */\n  handleMapClickDiscussions(event) {\n    this.view.hitTest(event, { include: [this.calloutGraphicsLayer] }).then((r) => {\n      if (r.results.length) {\n        this.preview = true;\n        const [result] = r.results;\n        const { graphic } = result;\n        this.graphicGeometry = graphic.geometry;\n        this.isOffset = graphic.attributes.isOffset;\n        const { attributes: { parentId, channelId, id, relatedFeatureId } } = graphic;\n        if (relatedFeatureId) {\n          const locationId = relatedFeatureId;\n          this.activeMapDiscussion = { channelId, locationId };\n        }\n        else {\n          const postId = !parentId\n            ? id\n            : parentId;\n          const replyId = parentId\n            ? id\n            : undefined;\n          this.activeMapDiscussion = { channelId, postId, replyId };\n        }\n        // Set active graphic\n        this.addHighlightGraphic(graphic, SYMBOL_STATE.ACTIVE, true);\n      }\n    });\n  }\n  handleViewSizeChange() {\n    const { view: { height, width } } = this;\n    this.viewHeight = height;\n    this.viewWidth = width;\n  }\n  get currentDiscussionsRef() {\n    return this.activeMapDiscussion ? this.onMapDiscussionsRef : this.discussionsRef;\n  }\n  /**\n   * Returns default theme mixed with any custom theme options\n   */\n  get themeWithDefaults() {\n    const { theme } = this;\n    const _themeWithDefaults = {};\n    ['point', 'polyline', 'polygon', 'callout'].forEach((type) => {\n      _themeWithDefaults[type] = Object.assign(Object.assign({}, defaultLayerThemeOptions[type]), theme[type]);\n    });\n    return _themeWithDefaults;\n  }\n  /**\n   * Returns true if current view is a SceneView\n   */\n  get is3D() {\n    const { view } = this;\n    return view.hasOwnProperty('camera');\n  }\n  /**\n   * The primary feature layer for current discussion\n   */\n  get targetLayer() {\n    return this.view.map.allLayers.filter((layer) => {\n      return (layer.type === 'feature' && (!this.layerIds.includes(layer.id)));\n    }).getItemAt(0);\n  }\n  get styles() {\n    const { view, viewWidth, viewHeight, leftOffset, topOffset, previewHeight, preview } = this;\n    let styles = {};\n    if (view) {\n      const { container } = view;\n      const { top, left, right, bottom } = container.getBoundingClientRect();\n      styles = {\n        '--left-offset': `${leftOffset}px`,\n        '--top-offset': `${topOffset}px`,\n        '--panel-left': `${left}px`,\n        '--panel-height': `${preview ? (viewHeight - previewHeight) : (bottom - top)}px`,\n        '--panel-width': `${right - left}px`,\n        '--view-width': `${viewWidth}px`,\n        '--view-height': `${viewHeight}px`\n      };\n    }\n    return styles;\n  }\n  render() {\n    const { activeMapDiscussion, styles, context, discussion, isHub, preview } = this;\n    return (activeMapDiscussion\n      &&\n        h(Host, { \"data-element\": \"discussions-map-integrator\", style: styles }, preview ? (h(\"arcgis-hub-discussions-map-preview\", { channelId: activeMapDiscussion.channelId, context: context, discussion: discussion, locationId: activeMapDiscussion.locationId, postId: activeMapDiscussion.postId, ref: (element) => { this.onMapDiscussionsPreviewRef = element; }, replyId: activeMapDiscussion.replyId })) : (h(\"arcgis-hub-discussions\", { channelId: activeMapDiscussion.channelId, context: context, disableNavigation: !activeMapDiscussion.locationId, discussion: discussion, dismissible: true, enableGoTo: true, hasMap: true, isHub: isHub, locationId: activeMapDiscussion.locationId, postId: activeMapDiscussion.postId, ref: (element) => { this.onMapDiscussionsRef = element; }, replyId: activeMapDiscussion.replyId }))));\n  }\n  static get assetsDirs() { return [\"locales\"]; }\n  get element() { return getElement(this); }\n  static get watchers() { return {\n    \"view\": [\"attachView\"],\n    \"discussionsRef\": [\"attachdiscussionsRef\"],\n    \"drawRef\": [\"handleDrawRefUpdate\"],\n    \"preview\": [\"calculateOffsets\"],\n    \"previewHeight\": [\"calculateOffsets\"],\n    \"context\": [\"initialize\"]\n  }; }\n};\n__decorate([\n  CallWhenFactory({ when(event) { return this.eventTargetIsDiscussionsRef(event); } })\n], ArcgisHubDiscussionsMapIntegrator.prototype, \"handleGeometryGoTo\", null);\n__decorate([\n  CallWhenFactory({ when(event) { return this.eventTargetIsDiscussionsRef(event); } })\n], ArcgisHubDiscussionsMapIntegrator.prototype, \"handleGeometryFeature\", null);\n__decorate([\n  CallWhenFactory({ when(event) { return this.eventTargetIsDiscussionsRef(event); } })\n], ArcgisHubDiscussionsMapIntegrator.prototype, \"handleGeometryFeatureDeleted\", null);\n__decorate([\n  CallWhenFactory({ when(event) { return this.eventTargetIsDiscussionsRef(event); } })\n], ArcgisHubDiscussionsMapIntegrator.prototype, \"handleGeometryFeatureSelect\", null);\n__decorate([\n  CallWhenFactory({ when(event) { return this.eventTargetIsDiscussionsRef(event); } })\n], ArcgisHubDiscussionsMapIntegrator.prototype, \"handleGeometryFeatureHighlight\", null);\n__decorate([\n  CallWhenFactory({ when(event) { return this.eventTargetIsDiscussionsRef(event); } })\n], ArcgisHubDiscussionsMapIntegrator.prototype, \"handleFeatureRemove\", null);\n__decorate([\n  CallWhenFactory({ when(event) { return this.eventTargetIsDiscussionsRef(event); } })\n], ArcgisHubDiscussionsMapIntegrator.prototype, \"handleGeometryDrawCreate\", null);\n__decorate([\n  CallWhenFactory({ when(event) { return this.eventTargetIsDiscussionsRef(event); } })\n], ArcgisHubDiscussionsMapIntegrator.prototype, \"handleGeometryDrawTypeSelect\", null);\n__decorate([\n  CallWhenFactory({ when(event) { return this.eventTargetIsDiscussionsRef(event); } })\n], ArcgisHubDiscussionsMapIntegrator.prototype, \"handleGeometryDrawEdit\", null);\n__decorate([\n  CallWhenFactory({ when(event) { return this.eventTargetIsDiscussionsRef(event); } })\n], ArcgisHubDiscussionsMapIntegrator.prototype, \"handleGeometryDrawEditCancel\", null);\n__decorate([\n  CallWhenFactory({ when(event) {\n      return event.target === this.drawRef;\n    } })\n], ArcgisHubDiscussionsMapIntegrator.prototype, \"handleDrawGraphicsChange\", null);\n__decorate([\n  CallWhenFactory({ when(event) { return this.eventTargetIsDiscussionsRef(event); } })\n], ArcgisHubDiscussionsMapIntegrator.prototype, \"handleGeometryDrawReset\", null);\n__decorate([\n  CallWhenFactory({ when(event) { return this.eventTargetIsDiscussionsRef(event); } })\n], ArcgisHubDiscussionsMapIntegrator.prototype, \"handleGeometryClearAll\", null);\n__decorate([\n  CallWhenFactory({ when(event) { return this.eventTargetIsDiscussionsRef(event); } })\n], ArcgisHubDiscussionsMapIntegrator.prototype, \"handleDiscussionsClose\", null);\n__decorate([\n  CallWhenFactory({ when(features) { return features; } })\n], ArcgisHubDiscussionsMapIntegrator.prototype, \"refreshFeatures\", null);\n__decorate([\n  CallWhenFactory({ when() { return this.drawRef; } })\n], ArcgisHubDiscussionsMapIntegrator.prototype, \"saveInitialDrawOptions\", null);\n__decorate([\n  CallWhenFactory({ when() { return this.drawRef && this.initialDrawOptions; } })\n], ArcgisHubDiscussionsMapIntegrator.prototype, \"restoreInitialDrawOptions\", null);\n__decorate([\n  CallWhenFactory({ when() { return this.currentDiscussionsRef; } })\n], ArcgisHubDiscussionsMapIntegrator.prototype, \"resetStagedFeatures\", null);\n__decorate([\n  DebounceDecoratorFactory({ timeout: 50 })\n], ArcgisHubDiscussionsMapIntegrator.prototype, \"handleViewSizeChange\", null);\nArcgisHubDiscussionsMapIntegrator.style = arcgisHubDiscussionsMapIntegratorCss;\n\nexport { ArcgisHubDiscussionsMapIntegrator as arcgis_hub_discussions_map_integrator };\n","/**\n * A method decorator factory function for the callWhen decorator\n * @param params An ICallWhenDecoratorParams object\n * @returns The callWhen method decorator function\n */\nfunction CallWhenFactory(params) {\n  /**\n   * A decorator function that conditionally call a method if when function returns truthy\n   *\n   * @param _target A reference to the class prototype\n   * @param _propertyKey The name of the method being decorated\n   * @param descriptor A PropertyDescriptor for the method being decorated\n   * @returns A new PropertyDescriptor that aguments the decorated method with conditional call behavior\n   */\n  function callWhen(_target, _propertyKey, descriptor) {\n    const { value: original } = descriptor;\n    const { when } = params;\n    const value = function callWhen(...args) {\n      const isTruthy = when.apply(this, args);\n      if (isTruthy) {\n        // when() condition passed, so call method\n        return original.apply(this, args);\n      }\n    };\n    return Object.assign(Object.assign({}, descriptor), { value });\n  }\n  return callWhen;\n}\n\nexport { CallWhenFactory as C };\n","import { d as debounce } from './debounce-89fe9847.js';\n\nfunction DebounceDecoratorFactory(params) {\n  function DebounceDecorator(_target, propertyKey, descriptor) {\n    const { value: original } = descriptor;\n    const debouncedKey = `${propertyKey.toString()}Debounced`;\n    const value = function (...args) {\n      if (!this[debouncedKey]) {\n        Object.defineProperty(this, debouncedKey, {\n          value: debounce(original, params.timeout),\n        });\n      }\n      this[debouncedKey](this, ...args);\n    };\n    return Object.assign(Object.assign({}, descriptor), { value });\n  }\n  return DebounceDecorator;\n}\n\nexport { DebounceDecoratorFactory as D };\n","/**\n * A util to debounce another function. It will return a function\n * that, as long as it continues to be invoked, will not be triggered\n * until the designated timeout has passed.\n */\nfunction debounce(fn, timeout = 300) {\n  let timeoutId;\n  return function (context, ...args) {\n    clearTimeout(timeoutId);\n    timeoutId = setTimeout(() => fn.apply(context, args), timeout);\n  };\n}\n\nexport { debounce as d };\n"],"names":["esriLoader","createCommonjsModule","module","exports","commonjsGlobal","utils","Promise","window","undefined","DEFAULT_VERSION","NEXT","parseVersion","version","toLowerCase","match","major","parseInt","minor","getCdnUrl","concat","getCdnCssUrl","baseUrl","parsedVersion","path","createStylesheetLink","href","link","document","createElement","rel","insertLink","before","beforeNode","querySelector","parentNode","insertBefore","head","appendChild","getCss","url","getCssUrl","urlOrVersion","loadCss","defaultOptions","createScript","script","type","src","setAttribute","handleScriptLoad","callback","errback","onScriptError","handleScriptError","onScriptLoad","removeEventListener","addEventListener","e","error","Error","setDefaultOptions","options","getScript","isLoaded","globalRequire","on","loadScript","opts","forEach","obj","prop","Object","prototype","hasOwnProperty","call","resolve","reject","getAttribute","css","insertCssBefore","body","requireModules","modules","errorHandler","args","_i","arguments","length","remove","loadModules","loadScriptOptions","then","defineProperty","value","factory","CSS_OPTIONS","themeOrUrl","loadArcGisCss","apiStyleSheet","RegExp","test","console","warn","includes","SYMBOL_STATE","DEFAULT_GEOM_COLOR","defaultLayerThemeOptions","point","color","polyline","width","polygon","callout","backgroundColor","textColor","hoverColor","activeColor","isOffset","symbols","state","properties","count","is3D","totalCount","strokeColor","HOVER","ACTIVE","data","symbol","symbolLayers","enable","size","frame","xmin","ymin","xmax","ymax","markerGraphics","geometry","x","y","fontFamilyName","fontStyleName","height","horizontalAlignment","verticalAlignment","textString","scaleSymbolsProportionally","rings","capStyle","joinStyle","lineStyle3D","miterLimit","text","font","family","style","outline","wait","ms","setTimeout","getThrottleMS","totalResults","batchSize","totalWaitTime","numRequestsThreshold","thresholdExceededWaitTime","numRequests","Math","ceil","getPostsWithLocation","discussion","hubRequestOptions","throttle","searchPosts","start","assign","parents","sortBy","PostSort","sortOrder","SortOrder","num","result","searchPostAggregates","total","nextStart","results","throttleMS","push","JSON","stringify","all","pagedResponses","getPost","postAggregate","postDetails","replyDetails","channelDetails","post","parentId","postId","channelId","uniquePostIds","posts","map","items","flat","filter","id","postsToFeatureCollection","message","__decorate","decorators","target","key","desc","d","c","r","getOwnPropertyDescriptor","Reflect","decorate","i","ArcgisHubDiscussionsMapIntegrator","hostRef","registerInstance","this","arcgisHubMapPopoverOpen","createEvent","arcgisHubMapPopoverClear","hubTelemetry","initialized","cachedFeatures","unsavedExistingGeometry","cachedRelatedFeatureGeometry","layerIds","persistAttribute","theme","preview","bind","initialize","intlManager","element","intl","teardown","event","discussionsRef","onMapDiscussionsRef","onMapDiscussionsPreviewRef","telemetry","emit","sketchPostId","currentDiscussionsRef","view","prevView","saveInitialDrawOptions","graphicGeometry","previewHeight","activeMapDiscussion","container","getBoundingClientRect","top","left","right","graphicScreenPos","toScreen","graphicLeft","graphicTop","leftOffset","topOffset","evt","detail","thread","graphics","geometryGraphicsLayer","toArray","calloutGraphicsLayer","activeGraphics","postParentId","attributes","locationId","relatedFeatureId","goTo","create","postToFeatures","feature","replyCount","refreshFeatures","clearHoverActiveGraphics","deletedPostId","deletedPostParentId","index","unsaved","unsavedGeometryGraphicsLayer","getItemAt","makeGraphic","graphic","find","_relatedFeatureId","postIndex","__index__","addHighlightGraphic","arcgis","getGraphicById","unsavedFeatures","unsavedRelatedFeatures","slice","findMatch","calloutGraphic","visible","geometryGraphic","drawRef","buffer","disablePrimaryOptions","disableEditOptions","setActiveTool","hideLayers","sketchIndex","sketchIsUnsaved","forceReset","showLayers","save","canceled","maxDeviation","resolution","generalize","simplify","clone","geographicGeom","webMercatorToGeographic","arcgisToGeoJSON","updateStagedFeatures","postToGeoJSON","unsavedExistingFeatures","originalGraphic","convertGeometryTypeToTelemetryString","emitHubTelemetry","dist","themeWithDefaults","addGraphicsToGraphicsLayer","features","restoreInitialDrawOptions","resetStagedFeatures","removeAll","makeVisible","objectIdField","selectedGraphic","layer","objectId","relatedFeature","toJSON","highlightGraphic","findIndex","clearHighlights","h","expanded","layout","icon","onClick","addRelatedFeature","t","textEnabled","removeRelatedFeature","targetLayer","hitTest","include","displayField","queryFeatures","objectIds","outFields","returnGeometry","unsavedRelatedFeatureIds","renderFn","renderAddLocation","renderRemoveLocation","render","hasMap","context","when","addGeometryGraphicsLayer","addStagedGeometryGraphicsLayer","addCalloutGraphicsLayer","addHighlightGraphicsLayer","fetchSubject","fetchPosts","handleViewSizeChange","setDiscussionsRefHasMap","mapViewSizeChangeHandler","watch","mapViewCenterChangeHandler","calculateOffsets","removeViewHandlers","removeLayers","resetSelect","fetchSubjectDetails","featureCollection","GraphicsLayer","elevationInfo","mode","add","effect","mapPointerMoveHandler","setCalloutSymbolOnPointerMove","mapClickDiscussionsHandler","handleMapClickDiscussions","highlightGraphicsLayer","persist","_a","_b","graphicCopy","removeLayer","opacity","destroy","addMany","emptyFeatures","hasGeometry","Boolean","postGraphics","geometryCallout","makeCalloutGraphic","hasFeatures","parseDiscussionURI","postsWithRelatedFeatures","relatedFeatureIds","Array","from","Set","cacheRelatedFeatureGeometry","relatedFeatures","postIds","postProperties","postFeatureId","existingFeature","featureProperties","postTotalCount","getRelatedFeature","relatedFeaturesCallout","calloutGraphics","tolerance","spatialReference","extent","Extent","goToTarget","pointToExtent","expand","duration","easing","catch","isAbortError","arcgisJson","geojsonToArcGIS","Graphic","coordinates","Infinity","DEFAULT","geojson","cachedIds","keys","nonCachedIds","query","where","outSpatialReference","wkid","geometryGeoJSON","whenLayerView","layerView","highlightHandle","highlight","tempGraphics","removeMany","handler","initialDrawOptions","replyId","viewHeight","viewWidth","_themeWithDefaults","allLayers","styles","bottom","isHub","Host","ref","disableNavigation","dismissible","enableGoTo","getElement","CallWhenFactory","eventTargetIsDiscussionsRef","DebounceDecoratorFactory","timeout","params","_target","_propertyKey","descriptor","original","isTruthy","apply","propertyKey","debouncedKey","toString","debounce","fn","timeoutId","clearTimeout"],"sourceRoot":""}