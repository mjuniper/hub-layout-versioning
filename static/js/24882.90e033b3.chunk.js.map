{"version":3,"file":"static/js/24882.90e033b3.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/views/2d/engine/webgl/TileContainer.js","../node_modules/@arcgis/core/views/2d/engine/webgl/TiledDisplayObject.js","../node_modules/@arcgis/core/views/2d/layers/WMTSLayerView2D.js","../node_modules/@arcgis/core/views/layers/RefreshableLayerView.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport has from\"../../../../core/has.js\";import{WGLDrawPhase as e}from\"./enums.js\";import r from\"./WGLContainer.js\";import s from\"./brushes/WGLBrushInfo.js\";import t from\"./brushes/WGLBrushStencil.js\";const n=(e,r)=>e.key.level-r.key.level!=0?e.key.level-r.key.level:e.key.row-r.key.row!=0?e.key.row-r.key.row:e.key.col-r.key.col;class i extends r{constructor(e){super(),this._tileInfoView=e}get requiresDedicatedFBO(){return!1}renderChildren(e){this.sortChildren(n),this.setStencilReference(e),super.renderChildren(e)}createRenderParams(e){const{state:r}=e,s=super.createRenderParams(e);return s.requiredLevel=this._tileInfoView.getClosestInfoForScale(r.scale).level,s.displayLevel=this._tileInfoView.tileInfo.scaleToZoom(r.scale),s}prepareRenderPasses(r){const n=super.prepareRenderPasses(r);return n.push(r.registerRenderPass({name:\"stencil\",brushes:[t],drawPhase:e.DEBUG|e.MAP|e.HIGHLIGHT,target:()=>this.getStencilTarget()})),has(\"esri-tiles-debug\")&&n.push(r.registerRenderPass({name:\"tileInfo\",brushes:[s],drawPhase:e.DEBUG,target:()=>this.children})),n}getStencilTarget(){return this.children}setStencilReference(e){let r=1;for(const s of this.children)s.stencilRef=r++}}export{i as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{s as t,m as s}from\"../../../../chunks/mat3.js\";import{DisplayObject as i}from\"../DisplayObject.js\";import e from\"../../tiling/TileKey.js\";class r extends i{constructor(t,s,i,r,h,o,n=h,a=o){super(),this.triangleCountReportedInDebug=0,this.triangleCount=0,this.texture=null,this.key=new e(t),this.resolution=s,this.x=i,this.y=r,this.width=h,this.height=o,this.rangeX=n,this.rangeY=a}destroy(){this.texture&&(this.texture.dispose(),this.texture=null)}setTransform(i){const e=this.resolution/(i.resolution*i.pixelRatio),r=this.transforms.tileMat3,[h,o]=i.toScreenNoRotation([0,0],[this.x,this.y]),n=this.width/this.rangeX*e,a=this.height/this.rangeY*e;t(r,n,0,0,0,a,0,h,o,1),s(this.transforms.dvs,i.displayViewMat3,r)}}export{r as TiledDisplayObject};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Logger.js\";import{isAbortError as i}from\"../../../core/promiseUtils.js\";import{watch as s}from\"../../../core/reactiveUtils.js\";import{property as r}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import{subclass as a}from\"../../../core/accessorSupport/decorators/subclass.js\";import{equals as l}from\"../../../geometry/support/spatialReferenceUtils.js\";import{BitmapTileLayerView2D as o}from\"./BitmapTileLayerView2D.js\";import{LayerView2DMixin as h}from\"./LayerView2D.js\";import{resampleImage as c}from\"./support/imageUtils.js\";import n from\"../tiling/TileInfoView.js\";import u from\"../tiling/TileKey.js\";import p from\"../tiling/TileQueue.js\";import f from\"../tiling/TileStrategy.js\";import m from\"../../layers/LayerView.js\";import d from\"../../layers/RefreshableLayerView.js\";const y=[102113,102100,3857,3785,900913],_=[0,0];let w=class extends(d(o(h(m)))){constructor(){super(...arguments),this._tileStrategy=null,this._fetchQueue=null,this._tileRequests=new Map,this.layer=null}get tileMatrixSet(){const e=this._getTileMatrixSetBySpatialReference(this.layer.activeLayer);return e?(e.id!==this.layer.activeLayer.tileMatrixSetId&&(this.layer.activeLayer.tileMatrixSetId=e.id),e):null}update(e){this._fetchQueue.pause(),this._fetchQueue.state=e.state,this._tileStrategy.update(e),this._fetchQueue.resume()}attach(){const e=this.tileMatrixSet?.tileInfo;e&&(this._tileInfoView=new n(e),this._fetchQueue=new p({tileInfoView:this._tileInfoView,concurrency:16,process:(e,t)=>this.fetchTile(e,t)}),this._tileStrategy=new f({cachePolicy:\"keep\",resampling:!0,acquireTile:e=>this.acquireTile(e),releaseTile:e=>this.releaseTile(e),tileInfoView:this._tileInfoView}),this.addAttachHandles(s((()=>[this.layer?.activeLayer?.styleId,this.tileMatrixSet]),(()=>this._refresh()))),super.attach())}detach(){super.detach(),this._tileStrategy?.destroy(),this._fetchQueue?.destroy(),this._fetchQueue=this._tileStrategy=this._tileInfoView=null}moveStart(){this.requestUpdate()}viewChange(){this.requestUpdate()}moveEnd(){this.requestUpdate()}releaseTile(e){this._fetchQueue.abort(e.key.id),this._bitmapView.removeChild(e),e.once(\"detach\",(()=>e.destroy())),this.requestUpdate()}acquireTile(e){const t=this._bitmapView.createTile(e),i=t.bitmap;return[i.x,i.y]=this._tileInfoView.getTileCoords(_,t.key),i.resolution=this._tileInfoView.getTileResolution(t.key),[i.width,i.height]=this._tileInfoView.tileInfo.size,this._enqueueTileFetch(t),this._bitmapView.addChild(t),this.requestUpdate(),t}async doRefresh(){!this.attached||this.updateRequested||this.suspended||this._refresh()}isUpdating(){return this._fetchQueue?.updating??!1}async fetchTile(e,t={}){const s=\"tilemapCache\"in this.layer?this.layer.tilemapCache:null,{signal:r,resamplingLevel:a=0}=t;if(!s)return this._fetchImage(e,r);const l=new u(0,0,0,0);let o;try{await s.fetchAvailabilityUpsample(e.level,e.row,e.col,l,{signal:r}),o=await this._fetchImage(l,r)}catch(h){if(i(h))throw h;if(a<3){const i=this._tileInfoView.getTileParentId(e.id);if(i){const s=new u(i),r=await this.fetchTile(s,{...t,resamplingLevel:a+1});return c(this._tileInfoView,r,s,e)}}throw h}return c(this._tileInfoView,o,l,e)}canResume(){const e=super.canResume();return e?null!==this.tileMatrixSet:e}supportsSpatialReference(e){return this.layer.activeLayer.tileMatrixSets?.some((t=>l(t.tileInfo?.spatialReference,e)))??!1}async _enqueueTileFetch(e){if(!this._fetchQueue.has(e.key.id)){try{const t=await this._fetchQueue.push(e.key);e.bitmap.source=t,e.bitmap.width=this._tileInfoView.tileInfo.size[0],e.bitmap.height=this._tileInfoView.tileInfo.size[1],e.once(\"attach\",(()=>this.requestUpdate()))}catch(s){i(s)||t.getLogger(this.declaredClass).error(s)}this.requestUpdate()}}async _fetchImage(e,t){return this.layer.fetchImageBitmapTile(e.level,e.row,e.col,{signal:t})}_refresh(){this._fetchQueue.reset(),this._tileStrategy.tiles.forEach((e=>{if(!e.bitmap.source)return;const t={id:e.key.id,fulfilled:!1,promise:this._fetchQueue.push(e.key).then((t=>{e.bitmap.source=t})).catch((t=>{i(t)||(e.bitmap.source=null)})).finally((()=>{e.requestRender(),t.fulfilled=!0}))};this._tileRequests.set(e,t)}))}_getTileMatrixSetBySpatialReference(e){const t=this.view.spatialReference;if(!e.tileMatrixSets)return null;let i=e.tileMatrixSets.find((e=>l(e.tileInfo?.spatialReference,t)));return!i&&t.isWebMercator&&(i=e.tileMatrixSets.find((e=>y.includes(e.tileInfo?.spatialReference.wkid??-1)))),i}};e([r()],w.prototype,\"_fetchQueue\",void 0),e([r({readOnly:!0})],w.prototype,\"tileMatrixSet\",null),w=e([a(\"esri.views.2d.layers.WMTSLayerView2D\")],w);const g=w;export{g as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../chunks/tslib.es6.js\";import e from\"../../core/Logger.js\";import{isAbortError as s}from\"../../core/promiseUtils.js\";import{on as o}from\"../../core/reactiveUtils.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/arrayUtils.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";const i=i=>{let c=class extends i{initialize(){this.handles.add(o((()=>this.layer),\"refresh\",(r=>{this.doRefresh(r.dataChanged).catch((r=>{s(r)||e.getLogger(this.declaredClass).error(r)}))})),\"RefreshableLayerView\")}};return r([t()],c.prototype,\"layer\",void 0),c=r([a(\"esri.layers.mixins.RefreshableLayerView\")],c),c};export{i as default};\n"],"names":["n","e","r","key","level","row","col","i","_tileInfoView","get","this","sortChildren","setStencilReference","state","s","requiredLevel","getClosestInfoForScale","scale","displayLevel","tileInfo","scaleToZoom","push","registerRenderPass","name","brushes","t","drawPhase","target","getStencilTarget","has","children","stencilRef","h","o","a","triangleCountReportedInDebug","triangleCount","texture","resolution","x","y","width","height","rangeX","rangeY","dispose","pixelRatio","transforms","tileMat3","toScreenNoRotation","dvs","displayViewMat3","_","w","arguments","_tileStrategy","_fetchQueue","_tileRequests","Map","layer","_getTileMatrixSetBySpatialReference","activeLayer","id","tileMatrixSetId","pause","update","resume","tileMatrixSet","p","tileInfoView","concurrency","process","fetchTile","f","cachePolicy","resampling","acquireTile","releaseTile","addAttachHandles","styleId","_refresh","destroy","requestUpdate","abort","_bitmapView","removeChild","once","createTile","bitmap","getTileCoords","getTileResolution","size","_enqueueTileFetch","addChild","attached","updateRequested","suspended","updating","tilemapCache","signal","resamplingLevel","_fetchImage","l","u","fetchAvailabilityUpsample","getTileParentId","c","tileMatrixSets","some","spatialReference","source","declaredClass","error","fetchImageBitmapTile","reset","tiles","forEach","fulfilled","promise","then","catch","finally","requestRender","set","view","find","isWebMercator","includes","wkid","d","m","prototype","readOnly","g","handles","add","doRefresh","dataChanged"],"sourceRoot":""}