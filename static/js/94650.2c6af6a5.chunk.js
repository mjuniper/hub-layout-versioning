"use strict";(self.webpackChunkhub_layout_versioning=self.webpackChunkhub_layout_versioning||[]).push([[94650],{25899:function(e,r,n){n.d(r,{B5:function(){return d},DR:function(){return p},G:function(){return S},M8:function(){return m},Nm:function(){return h},Qc:function(){return v},XG:function(){return w},a7:function(){return b},h3:function(){return I},ld:function(){return y},wH:function(){return g}});var t=n(29439),a=n(92026),u=n(35995),i=n(53283),s={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer"},l=Object.values(s),o=new RegExp("^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(".concat(l.join("|"),"))(?:\\/(?:layers\\/)?(\\d+))?"),"i"),c=new RegExp("^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(".concat(l.join("|"),"))(?:\\/(?:layers\\/)?(\\d+))?"),"i"),f=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function d(e){return!!o.test(e)}function v(e){if((0,a.Wi)(e))return null;var r=(0,u.mN)(e),n=r.path.match(o)||r.path.match(c);if(!n)return null;var i=(0,t.Z)(n,5),l=i[1],f=i[2],d=i[3],v=i[4],p=f.indexOf("/");return{title:y(-1!==p?f.slice(p+1):f),serverType:s[d.toLowerCase()],sublayer:null!=v&&""!==v?parseInt(v,10):null,url:{path:l}}}function p(e){var r=(0,u.mN)(e).path.match(f);return r?{serviceUrl:r[1],sublayerId:Number(r[2])}:null}function y(e){return(e=e.replace(/\s*[/_]+\s*/g," "))[0].toUpperCase()+e.slice(1)}function b(e,r){var n=[];if(e){var t=v(e);(0,a.pC)(t)&&t.title&&n.push(t.title)}if(r){var u=y(r);n.push(u)}if(2===n.length){if(n[0].toLowerCase().includes(n[1].toLowerCase()))return n[0];if(n[1].toLowerCase().includes(n[0].toLowerCase()))return n[1]}return n.join(" - ")}function m(e){if(!e)return!1;var r=(e=e.toLowerCase()).includes(".arcgis.com/"),n=e.includes("//services")||e.includes("//tiles")||e.includes("//features");return r&&n}function h(e,r){return e?(0,u.Qj)((0,u.Hu)(e,r)):e}function w(e){var r=e.url;if(!r)return{url:r};r=(0,u.Hu)(r,e.logger);var n,t=(0,u.mN)(r),i=v(t.path);if((0,a.pC)(i))null!=i.sublayer&&null==e.layer.layerId&&(n=i.sublayer),r=i.url.path;else if(e.nonStandardUrlAllowed){var s=p(t.path);(0,a.pC)(s)&&(r=s.serviceUrl,n=s.sublayerId)}return{url:(0,u.Qj)(r),layerId:n}}function g(e,r,n,t,a){(0,i.w)(r,t,"url",a),t.url&&null!=e.layerId&&(t.url=(0,u.v_)(t.url,n,e.layerId.toString()))}function S(e){if(!e)return!1;var r=e.toLowerCase(),n=r.includes("/services/"),t=r.includes("/mapserver/wmsserver"),a=r.includes("/imageserver/wmsserver"),u=r.includes("/wmsserver");return n&&(t||a||u)}function I(e){var r;if(!e)return!1;var n=null===(r=new u.R9((0,u.hF)(e)).authority)||void 0===r?void 0:r.toLowerCase();return"server.arcgisonline.com"===n||"services.arcgisonline.com"===n}},94650:function(e,r,n){n.r(r),n.d(r,{fromUrl:function(){return y}});var t=n(74165),a=n(1413),u=n(15861),i=n(10064),s=n(92026),l=n(35995),o=n(25899),c=n(74368),f=n(37933),d=n(19610),v=n(41226),p={FeatureLayer:!0,SceneLayer:!0};function y(e){return b.apply(this,arguments)}function b(){return(b=(0,u.Z)((0,t.Z)().mark((function e(r){var u,i,s,l,o;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=null===(u=r.properties)||void 0===u?void 0:u.customParameters,e.next=3,w(r.url,i);case 3:if(s=e.sent,l=(0,a.Z)((0,a.Z)({},r.properties),{},{url:r.url}),s.sublayerIds){e.next=7;break}return e.abrupt("return",(null!=s.layerOrTableId&&(l.layerId=s.layerOrTableId,l.sourceJSON=s.sourceJSON),new s.Constructor(l)));case 7:return e.next=10,Promise.all([n.e(79803),n.e(98995),n.e(70361),n.e(46037),n.e(60676),n.e(13127)]).then(n.bind(n,65069));case 10:return e.t0=e.sent.default,e.t1={title:s.parsedUrl.title},o=new e.t0(e.t1),e.abrupt("return",(h(o,s,l),o));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e,r){return e?e.find((function(e){return e.id===r})):null}function h(e,r,n){function t(e,t){var u=(0,a.Z)((0,a.Z)({},n),{},{layerId:e,sublayerTitleMode:"service-name"});return(0,s.pC)(t)&&(u.sourceJSON=t),new r.Constructor(u)}r.sublayerIds.forEach((function(n){var a=t(n,m(r.sublayerInfos,n));e.add(a)})),r.tableIds.forEach((function(n){var a=t(n,m(r.tableInfos,n));e.tables.add(a)}))}function w(e,r){return g.apply(this,arguments)}function g(){return g=(0,u.Z)((0,t.Z)().mark((function e(r,n){var a,u,l,c,d,y,b,m,h,w,g,I,x,L,T,O,P,N,U,E,j;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=(0,o.Qc)(r),e.t0=(0,s.Wi)(a),!e.t0){e.next=6;break}return e.next=5,S(r,n);case 5:a=e.sent;case 6:if(!(0,s.Wi)(a)){e.next=8;break}throw new i.Z("arcgis-layers:url-mismatch","The url '${url}' is not a valid arcgis resource",{url:r});case 8:l=(u=a).serverType,c=u.sublayer,y={FeatureServer:"FeatureLayer",StreamServer:"StreamLayer",VectorTileServer:"VectorTileLayer"},e.t1=l,e.next="MapServer"===e.t1?13:"ImageServer"===e.t1?26:"SceneServer"===e.t1?33:38;break;case 13:if(null==c){e.next=17;break}d="FeatureLayer",e.next=25;break;case 17:return e.next=19,Z(r,n);case 19:if(!e.sent){e.next=23;break}e.t2="TileLayer",e.next=24;break;case 23:e.t2="MapImageLayer";case 24:d=e.t2;case 25:return e.abrupt("break",39);case 26:return e.next=28,(0,v.T)(r,{customParameters:n});case 28:return m=e.sent,h=m.tileInfo,w=m.cacheType,d=h?"LERC"!==(null===h||void 0===h||null===(b=h.format)||void 0===b?void 0:b.toUpperCase())||w&&"elevation"!==w.toLowerCase()?"ImageryTileLayer":"ElevationLayer":"ImageryLayer",e.abrupt("break",39);case 33:return e.next=35,(0,v.T)(a.url.path,{customParameters:n});case 35:return g=e.sent,d="SceneLayer",g&&(I=null===g||void 0===g?void 0:g.layers,"Voxel"===(null===g||void 0===g?void 0:g.layerType)?d="VoxelLayer":null!==I&&void 0!==I&&I.length&&null!=(L=null===(x=I[0])||void 0===x?void 0:x.layerType)&&null!=f.fb[L]&&(d=f.fb[L])),e.abrupt("break",39);case 38:d=y[l];case 39:if(O={parsedUrl:a,Constructor:null,layerOrTableId:(T="FeatureServer"===l)?c:void 0,sublayerIds:null,tableIds:null},!p[d]||null!=c){e.next=46;break}return e.next=43,C(r,l,n);case 43:j=e.sent,T&&(O.sublayerInfos=j.layerInfos,O.tableInfos=j.tableInfos),1!==j.layerIds.length+j.tableIds.length?(O.sublayerIds=j.layerIds,O.tableIds=j.tableIds):T&&(O.layerOrTableId=null!==(P=j.layerIds[0])&&void 0!==P?P:j.tableIds[0],O.sourceJSON=null!==(N=null===(U=j.layerInfos)||void 0===U?void 0:U[0])&&void 0!==N?N:null===(E=j.tableInfos)||void 0===E?void 0:E[0]);case 46:return e.next=48,k(d);case 48:return O.Constructor=e.sent,e.abrupt("return",O);case 50:case"end":return e.stop()}}),e)}))),g.apply(this,arguments)}function S(e,r){return I.apply(this,arguments)}function I(){return I=(0,u.Z)((0,t.Z)().mark((function e(r,n){var a,u,i,c,f,d,p;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,v.T)(r,{customParameters:n});case 2:if(i=e.sent,c=null,f=null,"Feature Layer"===(d=i.type)||"Table"===d?(c="FeatureServer",f=null!==(a=i.id)&&void 0!==a?a:null):"indexedVector"===d?c="VectorTileServer":i.hasOwnProperty("mapName")?c="MapServer":i.hasOwnProperty("bandCount")&&i.hasOwnProperty("pixelSizeX")?c="ImageServer":i.hasOwnProperty("maxRecordCount")&&i.hasOwnProperty("allowGeometryUpdates")?c="FeatureServer":i.hasOwnProperty("streamUrls")?c="StreamServer":x(i)?(c="SceneServer",f=i.id):i.hasOwnProperty("layers")&&x(null===(u=i.layers)||void 0===u?void 0:u[0])&&(c="SceneServer"),c){e.next=7;break}return e.abrupt("return",null);case 7:return p=null!=f?(0,o.DR)(r):null,e.abrupt("return",{title:(0,s.pC)(p)&&i.name||(0,l.vt)(r),serverType:c,sublayer:f,url:{path:(0,s.pC)(p)?p.serviceUrl:(0,l.mN)(r).path}});case 9:case"end":return e.stop()}}),e)}))),I.apply(this,arguments)}function x(e){return null!=e&&e.hasOwnProperty("store")&&e.hasOwnProperty("id")&&"number"==typeof e.id}function C(e,r,n){return L.apply(this,arguments)}function L(){return(L=(0,u.Z)((0,t.Z)().mark((function e(r,n,a){var u,i,s,l,o,f,d;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=!1,"FeatureServer"!==n){e.next=8;break}return e.next=4,(0,c.V)(r,{customParameters:a});case 4:o=e.sent,l=!!o.layersJSON,s=o.layersJSON||o.serviceJSON,e.next=11;break;case 8:return e.next=10,(0,v.T)(r,{customParameters:a});case 10:s=e.sent;case 11:return f=null===(u=s)||void 0===u?void 0:u.layers,d=null===(i=s)||void 0===i?void 0:i.tables,e.abrupt("return",{layerIds:(null===f||void 0===f?void 0:f.map((function(e){return e.id})).reverse())||[],tableIds:(null===d||void 0===d?void 0:d.map((function(e){return e.id})).reverse())||[],layerInfos:l?f:[],tableInfos:l?d:[]});case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e){return T.apply(this,arguments)}function T(){return(T=(0,u.Z)((0,t.Z)().mark((function e(r){return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.T[r])());case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(e,r){return O.apply(this,arguments)}function O(){return(O=(0,u.Z)((0,t.Z)().mark((function e(r,n){return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,v.T)(r,{customParameters:n});case 2:return e.abrupt("return",e.sent.tileInfo);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},37933:function(e,r,n){n.d(r,{A2:function(){return f},Am:function(){return v},CY:function(){return o},S1:function(){return g},Tv:function(){return d},fb:function(){return c},iC:function(){return l},ln:function(){return S},mt:function(){return m},oP:function(){return h},rQ:function(){return y},sy:function(){return p},y2:function(){return b}});var t=n(74165),a=n(15861),u=n(19545),i=n(76200),s=n(92026);function l(e){var r=null===e||void 0===e?void 0:e.type;return"base-tile"===r||"tile"===r||"elevation"===r||"imagery-tile"===r||"base-elevation"===r||"open-street-map"===r||"wcs"===r||"web-tile"===r||"wmts"===r||"vector-tile"===r}function o(e){return null!=e&&"type"in e&&"group"===e.type}var c={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};function f(e){var r=null===e||void 0===e?void 0:e.type;return"building-scene"===r||"integrated-mesh"===r||"point-cloud"===r||"scene"===r}function d(e){return"voxel"===(null===e||void 0===e?void 0:e.type)}function v(e){return"imagery-tile"===(null===e||void 0===e?void 0:e.type)}function p(e){return null!=e&&null!=e.parent&&"declaredClass"in e.parent&&"esri.Basemap"===e.parent.declaredClass&&e.parent.baseLayers.includes(e)}function y(e){var r;return"feature"===(null===e||void 0===e?void 0:e.type)&&!e.url&&"memory"===(null===(r=e.source)||void 0===r?void 0:r.type)}function b(e){var r;return"feature"===(null===e||void 0===e?void 0:e.type)&&"feature-layer"===(null===(r=e.source)||void 0===r?void 0:r.type)}function m(e){if(e.activeLayer){var r=e.activeLayer.tileMatrixSet;if(r)return r;var n=e.activeLayer.tileMatrixSets;if(n)return n}return null}function h(e,r){return w.apply(this,arguments)}function w(){return w=(0,a.Z)((0,t.Z)().mark((function e(r,n){var a,l,o,c,f,d;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(null===(a=null===u.id||void 0===u.id?void 0:u.id.findServerInfo(r))||void 0===a?void 0:a.currentVersion)){e.next=3;break}return e.abrupt("return",a.owningSystemUrl||null);case 3:if(-1!==(l=r.toLowerCase().indexOf("/rest/services"))){e.next=6;break}return e.abrupt("return",null);case 6:return o="".concat(r.substring(0,l),"/rest/info"),c=(0,s.pC)(n)?n.signal:null,e.next=10,(0,i.default)(o,{query:{f:"json"},responseType:"json",signal:c});case 10:return f=e.sent,d=f.data,e.abrupt("return",(null===d||void 0===d?void 0:d.owningSystemUrl)||null);case 13:case"end":return e.stop()}}),e)}))),w.apply(this,arguments)}function g(e){return function(e){if(!("capabilities"in e))return!1;switch(e.type){case"csv":case"feature":case"geojson":case"imagery":case"knowledge-graph-sublayer":case"ogc-feature":case"oriented-imagery":case"scene":case"subtype-group":case"subtype-sublayer":case"wfs":return!0;default:return!1}}(e)?"effectiveCapabilities"in e?e.effectiveCapabilities:e.capabilities:null}function S(e){return!!function(e){if(!("editingEnabled"in e))return!1;switch(e.type){case"csv":case"feature":case"geojson":case"oriented-imagery":case"scene":case"subtype-group":case"subtype-sublayer":return!0;default:return!1}}(e)&&("effectiveEditingEnabled"in e?e.effectiveEditingEnabled:e.editingEnabled)}}}]);
//# sourceMappingURL=94650.2c6af6a5.chunk.js.map