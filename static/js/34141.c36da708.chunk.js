"use strict";(self.webpackChunkhub_layout_versioning=self.webpackChunkhub_layout_versioning||[]).push([[34141],{67077:function(e,t,i){function n(){return[0,0,0,0]}function r(e){return[e[0],e[1],e[2],e[3]]}function o(e,t,i,n){return[e,t,i,n]}function a(e){for(var t=[0,0,0,0],i=Math.min(4,e.length),n=0;n<i;++n)t[n]=e[n];return t}function s(e,t){return new Float64Array(e,t,4)}function l(){return[0,0,0,0]}function c(){return o(1,1,1,1)}function p(){return o(1,0,0,0)}function h(){return o(0,1,0,0)}function u(){return o(0,0,1,0)}function v(){return o(0,0,0,1)}i.d(t,{O:function(){return f},Z:function(){return d},a:function(){return s},b:function(){return a},c:function(){return n},d:function(){return r},f:function(){return o}});var d=[0,0,0,0],f=c(),y=p(),_=h(),g=u(),m=v();Object.freeze(Object.defineProperty({__proto__:null,ONES:f,UNIT_W:m,UNIT_X:y,UNIT_Y:_,UNIT_Z:g,ZEROS:d,clone:r,create:n,createView:s,fromArray:a,fromValues:o,ones:c,unitW:v,unitX:p,unitY:h,unitZ:u,zeros:l},Symbol.toStringTag,{value:"Module"}))},14921:function(e,t,i){i.d(t,{Ed:function(){return f},UI:function(){return y},mt:function(){return k},q6:function(){return x},vr:function(){return G},w6:function(){return w}});var n=i(74165),r=i(15671),o=i(43144),a=i(60136),s=i(92572),l=i(15861),c=i(27366),p=i(85015),h=i(92026),u=i(66978),v=i(49861),d=(i(25243),i(63780),i(69912));function f(e,t,i){return(0,u.as)(e.map((function(e,n){return t.apply(i,[e,n])})))}function y(e,t,i){return _.apply(this,arguments)}function _(){return(_=(0,l.Z)((0,n.Z)().mark((function e(t,i,r){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,u.as)(t.map((function(e,t){return i.apply(r,[e,t])})));case 2:return e.abrupt("return",e.sent.map((function(e){return e.value})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return{ok:!0,value:e}}function m(e){return{ok:!1,error:e}}function x(e){return b.apply(this,arguments)}function b(){return(b=(0,l.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,h.Wi)(t)){e.next=2;break}return e.abrupt("return",{ok:!1,error:new Error("no promise provided")});case 2:return e.prev=2,e.t0=g,e.next=6,t;case 6:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 10:return e.prev=10,e.t2=e.catch(2),e.abrupt("return",m(e.t2));case 13:case"end":return e.stop()}}),e,null,[[2,10]])})))).apply(this,arguments)}function k(e){return Z.apply(this,arguments)}function Z(){return(Z=(0,l.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=g,e.next=4,t;case 4:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 8:return e.prev=8,e.t2=e.catch(0),e.abrupt("return",((0,u.r9)(e.t2),m(e.t2)));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function w(e){if(!0===e.ok)return e.value;throw e.error}function G(e,t){return new C(e,t)}var C=function(e){(0,a.Z)(i,e);var t=(0,s.Z)(i);function i(e,n){var o;(0,r.Z)(this,i),(o=t.call(this,{}))._result=null,o._abortHandle=null,o.abort=function(){o._abortController=(0,h.IM)(o._abortController)},o.remove=o.abort,o._abortController=new AbortController;var a=o._abortController.signal;return o.promise=e(a),o.promise.then((function(e){o._result=g(e),o._cleanup()}),(function(e){o._result=m(e),o._cleanup()})),o._abortHandle=(0,u.fu)(n,o.abort),o}return(0,o.Z)(i,[{key:"value",get:function(){return e=this._result,(0,h.pC)(e)&&!0===e.ok?e.value:null;var e}},{key:"error",get:function(){return e=this._result,(0,h.pC)(e)&&!1===e.ok?e.error:null;var e}},{key:"finished",get:function(){return(0,h.pC)(this._result)}},{key:"normalizeCtorArgs",value:function(){return{}}},{key:"destroy",value:function(){this.abort()}},{key:"_cleanup",value:function(){this._abortHandle=(0,h.hw)(this._abortHandle),this._abortController=null}}]),i}(p.Z);(0,c._)([(0,v.Cb)()],C.prototype,"value",null),(0,c._)([(0,v.Cb)()],C.prototype,"error",null),(0,c._)([(0,v.Cb)()],C.prototype,"finished",null),(0,c._)([(0,v.Cb)()],C.prototype,"promise",void 0),(0,c._)([(0,v.Cb)()],C.prototype,"_result",void 0),C=(0,c._)([(0,d.j)("esri.core.asyncUtils.ReactiveTask")],C)},83362:function(e,t,i){i.r(t),i.d(t,{default:function(){return ae}});var n=i(74165),r=i(15861),o=i(1413),a=i(29439),s=i(37762),l=i(60136),c=i(92572),p=i(43144),h=i(15671),u=i(27366),v=(i(59486),i(52639)),d=i(14921),f=i(80987),y=i(10064),_=i(91505),g=i(100),m=i(32718),x=i(92026),b=i(47898),k=i(94172),Z=i(17842),w=i(49861),G=(i(25243),i(63780),i(69912)),C=i(69662),V=i(93655),M=i(16072),S=i(50951),I=i(85577),E=i(20008),T=i(53503),O=i(74982),R=i(83089),H=i(70040),A=i(1614),z=i(87888),U=i(87268),W=i(77560),F=i(34019),L=i(12494),P=i(40524),D=i(21971),q=i(59418),j=i(29909),N=i(585),X=(0,p.Z)((function e(t,i,n){(0,h.Z)(this,e),this.graphic=t,this.mover=i,this.selected=n,this.type="reshape-start"})),Y=(0,p.Z)((function e(t,i,n){(0,h.Z)(this,e),this.graphic=t,this.mover=i,this.selected=n,this.type="reshape"})),Q=(0,p.Z)((function e(t,i,n){(0,h.Z)(this,e),this.graphic=t,this.mover=i,this.selected=n,this.type="reshape-stop"})),J=(0,p.Z)((function e(t,i,n){(0,h.Z)(this,e),this.mover=t,this.dx=i,this.dy=n,this.type="move-start"})),K=(0,p.Z)((function e(t,i,n){(0,h.Z)(this,e),this.mover=t,this.dx=i,this.dy=n,this.type="move"})),$=(0,p.Z)((function e(t,i,n){(0,h.Z)(this,e),this.mover=t,this.dx=i,this.dy=n,this.type="move-stop"})),B=(0,p.Z)((function e(t){(0,h.Z)(this,e),this.added=t,this.type="vertex-select"})),ee=(0,p.Z)((function e(t){(0,h.Z)(this,e),this.removed=t,this.type="vertex-deselect"})),te=(0,p.Z)((function e(t,i,n,r){(0,h.Z)(this,e),this.added=t,this.graphic=i,this.oldGraphic=n,this.vertices=r,this.type="vertex-add"})),ie=(0,p.Z)((function e(t,i,n,r){(0,h.Z)(this,e),this.removed=t,this.graphic=i,this.oldGraphic=n,this.vertices=r,this.type="vertex-remove"})),ne=H.X.reshapeGraphics,re={vertices:{default:new M.Z({style:"circle",size:ne.vertex.size,color:ne.vertex.color,outline:{color:ne.vertex.outlineColor,width:1}}),hover:new M.Z({style:"circle",size:ne.vertex.hoverSize,color:ne.vertex.hoverColor,outline:{color:ne.vertex.hoverOutlineColor,width:1}}),selected:new M.Z({style:"circle",size:ne.selected.size,color:ne.selected.color,outline:{color:ne.selected.outlineColor,width:1}})},midpoints:{default:new M.Z({style:"circle",size:ne.midpoint.size,color:ne.midpoint.color,outline:{color:ne.midpoint.outlineColor,width:1}}),hover:new M.Z({style:"circle",size:ne.midpoint.size,color:ne.midpoint.color,outline:{color:ne.midpoint.outlineColor,width:1}})}},oe=function(e){(0,l.Z)(i,e);var t=(0,c.Z)(i);function i(e){var n;return(0,h.Z)(this,i),(n=t.call(this,e))._activeOperationInfo=null,n._editGeometryOperations=null,n._handles=new g.Z,n._graphicAttributes={esriSketchTool:"box"},n._mover=null,n._snappingContext=null,n._snappingTask=null,n._stagedVertex=null,n._tooltip=null,n._viewHandles=new g.Z,n.callbacks={onReshapeStart:function(){},onReshape:function(){},onReshapeStop:function(){},onMoveStart:function(){},onMove:function(){},onMoveStop:function(){},onGraphicClick:function(){}},n.enableMidpoints=!0,n.enableMovement=!0,n.enableVertices=!0,n.graphic=null,n.layer=null,n.midpointGraphics=new f.Z,n.midpointSymbol=new M.Z({style:"circle",size:6,color:[200,200,200],outline:{color:[100,100,100],width:1}}),n.selectedVertices=[],n.snappingManager=null,n.tooltipOptions=new W.Z,n.type="reshape",n.vertexGraphics=new f.Z,n.view=null,n}return(0,p.Z)(i,[{key:"initialize",value:function(){var e=this,t=this.view;this._highlightHelper=new O.Z({view:t}),this._setup(),this._handles.add([(0,k.gx)((function(){return null===t||void 0===t?void 0:t.ready}),(function(){var t=e.layer,i=e.view;(0,R.p)(i,t),e._viewHandles.add(i.on("key-down",(function(t){return e._keyDownHandler(t)}),A.f.TOOL))}),{once:!0,initial:!0}),(0,k.Wy)((function(){return e.graphic}),(function(){return e.refresh()})),(0,k.Wy)((function(){return e.layer}),(function(t,i){i&&(e._clearSelection(),e._resetGraphics(i)),e.refresh()})),(0,k.Wy)((function(){return e.enableMidpoints}),(function(){return e.refresh()})),(0,k.YP)((function(){return e.tooltipOptions.enabled}),(function(t){e._tooltip=t?new L.u({view:e.view}):(0,x.SC)(e._tooltip)}),k.tX)])}},{key:"destroy",value:function(){var e;this._reset(),null!==(e=this._mover)&&void 0!==e&&e.destroy(),this._mover=null,this._tooltip=(0,x.SC)(this._tooltip),this._handles=(0,x.SC)(this._handles),this._viewHandles=(0,x.SC)(this._viewHandles)}},{key:"highlightsEnabled",set:function(e){var t;null!==(t=this._highlightHelper)&&void 0!==t&&t.removeAll(),this._set("highlightsEnabled",e),this._setUpHighlights()}},{key:"state",get:function(){var e=!!this.get("view.ready"),t=!(!this.get("graphic")||!this.get("layer"));return e&&t?"active":e?"ready":"disabled"}},{key:"symbols",set:function(e){var t=e||{},i=t.midpoints,n=void 0===i?re.midpoints:i,r=t.vertices,o=void 0===r?re.vertices:r;this._set("symbols",{midpoints:n,vertices:o})}},{key:"isUIGraphic",value:function(e){var t=[];return this.graphic&&t.push(this.graphic),t.concat(this.vertexGraphics.items,this.midpointGraphics.items),t.length>0&&t.includes(e)}},{key:"refresh",value:function(){this._reset(),this._setup()}},{key:"reset",value:function(){this.graphic=null}},{key:"clearSelection",value:function(){this._clearSelection()}},{key:"removeSelectedVertices",value:function(){this.selectedVertices.length&&this._removeVertices(this.selectedVertices)}},{key:"_setup",value:function(){var e=this.graphic;if(this.layer&&e&&!(0,x.Wi)(e.geometry)){var t=e.geometry;"mesh"!==t.type&&"extent"!==t.type?("polygon"===t.type&&(0,C.pW)(t),this._setUpHighlights(),this._setupGraphics(),this._setupMover()):this._logGeometryTypeError()}}},{key:"_setUpHighlights",value:function(){this.highlightsEnabled&&this.graphic&&this._highlightHelper.add(this.graphic)}},{key:"_setUpGeometryHelper",value:function(){var e=this.graphic.geometry;if((0,x.Wi)(e)||"mesh"===e.type||"extent"===e.type)this._logGeometryTypeError();else{var t="multipoint"===e.type?new j.Z({paths:e.points,spatialReference:e.spatialReference}):e;this._editGeometryOperations=U.c.fromGeometry(t,S.JY.Local)}}},{key:"_saveSnappingContextForHandle",value:function(e,t){var i;this._snappingGraphicsLayer=new V.Z({listMode:"hide",internal:!0,title:"Reshape snapping layer"}),this.view.map.layers.add(this._snappingGraphicsLayer),this._snappingContext=new F.N({editGeometryOperations:this._editGeometryOperations,elevationInfo:{mode:"on-the-ground",offset:0},pointer:(null===(i=t.viewEvent)||void 0===i?void 0:i.pointerType)||"mouse",excludeFeature:this.graphic,visualizer:new I.r(this._snappingGraphicsLayer),vertexHandle:this._getVertexFromEditGeometry(e)})}},{key:"_reset",value:function(){this._clearSelection(),this._highlightHelper.removeAll(),this._updateTooltip(),this._resetGraphics(),this._resetSnappingStateVars(),this._activeOperationInfo=null,this._mover&&this._mover.destroy(),this._mover=null,this.view.cursor="default"}},{key:"_resetSnappingStateVars",value:function(){var e;(0,x.pC)(this.snappingManager)&&this.snappingManager.doneSnapping(),(0,x.pC)(this._snappingGraphicsLayer)&&(null!==(e=this.view)&&void 0!==e&&e.map&&this.view.map.layers.remove(this._snappingGraphicsLayer),this._snappingGraphicsLayer.destroy()),this._editGeometryOperations=(0,x.SC)(this._editGeometryOperations),this._snappingTask=(0,x.IM)(this._snappingTask),this._snappingTask=null,this._snappingContext=null,this._stagedVertex=null}},{key:"_resetGraphics",value:function(e){this._removeMidpointGraphics(e),this._removeVertexGraphics(e),this._set("selectedVertices",[])}},{key:"_removeMidpointGraphics",value:function(e){var t=e||this.layer;t&&t.removeMany(this.midpointGraphics.items),this.midpointGraphics.items.forEach((function(e){return e.destroy()})),this.midpointGraphics.removeAll()}},{key:"_removeVertexGraphics",value:function(e){var t=e||this.layer;t&&t.removeMany(this.vertexGraphics.items),this.vertexGraphics.items.forEach((function(e){return e.destroy()})),this.vertexGraphics.removeAll()}},{key:"_getCoordinatesForUI",value:function(e){var t=(0,C.nA)(e.clone());if("polygon"===e.type){var i,n=(0,s.Z)(t);try{for(n.s();!(i=n.n()).done;){var r=i.value,o=r[r.length-1];r[0][0]===o[0]&&r[0][1]===o[1]&&r.length>2&&r.pop()}}catch(a){n.e(a)}finally{n.f()}}return t}},{key:"_setupGraphics",value:function(){var e=this.graphic.geometry;if((0,x.pC)(e)&&("polyline"===e.type||"polygon"===e.type)){var t=this._getCoordinatesForUI(e);this.enableMidpoints&&this._setUpMidpointGraphics(t),this.enableVertices&&this._setUpVertexGraphics(t)}}},{key:"_setUpMidpointGraphics",value:function(e){this._removeMidpointGraphics();var t=this._createMidpointGraphics(e);this.midpointGraphics.addMany(t),this.layer.addMany(t)}},{key:"_setUpVertexGraphics",value:function(e){this._removeVertexGraphics();var t=this._createVertexGraphics(e);this.vertexGraphics.addMany(t),this._storeRelatedVertexIndices(),this.layer.addMany(t)}},{key:"_createVertexGraphics",value:function(e){var t=this._graphicAttributes,i=this.symbols,n=this.view.spatialReference,r=[];return null!==e&&void 0!==e&&e.forEach((function(e,s){e.forEach((function(e,l){var c,p=(0,a.Z)(e,2),h=p[0],u=p[1];r.push(new v.Z({geometry:new N.Z({x:h,y:u,spatialReference:n}),symbol:null===i||void 0===i||null===(c=i.vertices)||void 0===c?void 0:c.default,attributes:(0,o.Z)((0,o.Z)({},t),{},{pathIndex:s,pointIndex:l})}))}))})),r}},{key:"_createMidpointGraphics",value:function(e){var t=this,i=this._graphicAttributes,n=this.symbols,r=this.view.spatialReference,s=[];return null!==e&&void 0!==e&&e.forEach((function(e,l){e.forEach((function(c,p){var h=(0,a.Z)(c,2),u=h[0],d=h[1],f=e[p+1]?p+1:0;if("polygon"===(0,x.U2)(t.graphic.geometry,"type")||0!==f){var y=(0,a.Z)(e[f],2),_=y[0],g=y[1],m=(0,C.Gi)([u,d],[_,g]),b=(0,a.Z)(m,2),k=b[0],Z=b[1];s.push(new v.Z({geometry:new N.Z({x:k,y:Z,spatialReference:r}),symbol:n.midpoints.default,attributes:(0,o.Z)((0,o.Z)({},i),{},{pathIndex:l,pointIndexStart:p,pointIndexEnd:f})}))}}))})),s}},{key:"_storeRelatedVertexIndices",value:function(){var e=this.vertexGraphics.items;if(e)for(var t=e.map((function(e){var t=e.geometry;return{x:t.x,y:t.y}})),i=0;i<t.length;i++){for(var n=[],r=0;r<t.length;r++)if(i!==r){var o=t[i],a=t[r];o.x===a.x&&o.y===a.y&&n.push(r)}e[i].attributes.relatedGraphicIndices=n}}},{key:"_setupMover",value:function(){var e=this,t=this.enableMovement,i=this.graphic,n=this.midpointGraphics,r=this.vertexGraphics,o=this.view,a=r.concat(n).items;t&&a.push(i),this._mover=new T.default({enableMoveAllGraphics:!1,highlightsEnabled:!1,indicatorsEnabled:!1,graphics:a,view:o,callbacks:{onGraphicClick:function(t){return e._onGraphicClickCallback(t)},onGraphicMoveStart:function(t){return e._onGraphicMoveStartCallback(t)},onGraphicMove:function(t){return e._onGraphicMoveCallback(t)},onGraphicMoveStop:function(t){return e._onGraphicMoveStopCallback(t)},onGraphicPointerOver:function(t){return e._onGraphicPointerOverCallback(t)},onGraphicPointerOut:function(t){return e._onGraphicPointerOutCallback(t)}}})}},{key:"_onGraphicClickCallback",value:function(e){e.viewEvent.stopPropagation();var t=e.graphic;if(t===this.graphic)this.clearSelection(),this.emit("graphic-click",e),this.callbacks.onGraphicClick&&this.callbacks.onGraphicClick(e);else if(this._isMidpoint(t)){if(2===e.viewEvent.button)return;var i=this.graphic.clone(),n=this._createVertexFromMidpoint(t);this.refresh(),this._emitVertexAddEvent([t],i,n)}else this._isVertex(t)&&(e.viewEvent.stopPropagation(),2===e.viewEvent.button?this._removeVertices(t):(e.viewEvent.native.shiftKey||this._clearSelection(),this.selectedVertices.includes(t)?this._removeFromSelection(t,!0):this._addToSelection(t)))}},{key:"_setUpOperation",value:function(e){var t=e.graphic,i=e.dx,n=e.dy,r=t===this.graphic;this._resetSnappingStateVars(),this._setUpGeometryHelper(),this._saveSnappingContextForHandle(t,e),this._activeOperationInfo={target:this.graphic,mover:t,operationType:r?"move":"reshape",totalDx:i,totalDy:n}}},{key:"_onGraphicMoveStartCallback",value:function(e){var t=this,i=e.dx,n=e.dy,r=e.graphic;if(r===this.graphic){var o=r.geometry;return this._setUpOperation(e),this._emitMoveStartEvent(i,n),void((0,x.pC)(o)&&"point"===o.type&&this._onHandleMove(r,i,n,e,(function(){t._updateTooltip(t.graphic,e.viewEvent),t._emitMoveEvent(i,n)})))}if(!this.selectedVertices.includes(r)){if(this._clearSelection(),this._isMidpoint(r)){var a=this.graphic.clone(),s=this._createVertexFromMidpoint(r);this._emitVertexAddEvent([r],a,s)}this._addToSelection(r)}this._setUpOperation(e),this._emitReshapeStartEvent(r),this._onHandleMove(r,i,n,e,(function(){t._updateTooltip(r,e.viewEvent),t._emitReshapeEvent(r)}))}},{key:"_onGraphicMoveCallback",value:function(e){var t=this,i=this._activeOperationInfo;if(i){var n=e.dx,r=e.dy,o=e.graphic;i.totalDx+=n,i.totalDy+=r;var a=i.operationType,s=o.geometry;if(!(0,x.Wi)(s))if("move"!==a)this._onHandleMove(o,n,r,e,(function(){t._updateTooltip(o,e.viewEvent),t._emitReshapeEvent(o)}));else if("point"===s.type)this._onHandleMove(o,n,r,e,(function(){t._updateTooltip(t.graphic,e.viewEvent),t._emitMoveEvent(n,r)}));else if("polyline"===s.type||"polygon"===s.type){var l=this._getCoordinatesForUI(s);this._updateVertexGraphicLocations(l),this._updateTooltip(this.graphic,e.viewEvent),this._emitMoveEvent(n,r)}}}},{key:"_onGraphicMoveStopCallback",value:function(e){var t=this,i=this._activeOperationInfo;if(i){var n=e.dx,r=e.dy,o=e.graphic,a=i.operationType;i.totalDx+=n,i.totalDy+=r,this._onHandleMove(o,n,r,e,(function(){return"move"===a?t._emitMoveStopEvent():t._emitReshapeStopEvent(o)})),this._isMidpoint(o)?this.refresh():(this._updateTooltip(this._isVertex(o)?o:null),this._resetSnappingStateVars(),this._activeOperationInfo=null)}}},{key:"_updateVertexGraphicLocations",value:function(e){var t,i=this.view.spatialReference,n=(0,s.Z)(this.vertexGraphics);try{for(n.s();!(t=n.n()).done;){var r=t.value,o=r.attributes,l=o.pathIndex,c=o.pointIndex,p=(0,a.Z)(e[l][c],2),h=p[0],u=p[1];r.geometry=new N.Z({x:h,y:u,spatialReference:i})}}catch(v){n.e(v)}finally{n.f()}this._updateMidpointGraphicLocations(e)}},{key:"_updateMidpointGraphicLocations",value:function(e){var t,i=(0,s.Z)(this.midpointGraphics);try{for(i.s();!(t=i.n()).done;){var n=t.value,r=n.attributes,o=r.pathIndex,l=r.pointIndexStart,c=r.pointIndexEnd,p=(0,a.Z)(e[o][l],2),h=p[0],u=p[1],v=(0,a.Z)(e[o][c],2),d=v[0],f=v[1],y=(0,C.Gi)([h,u],[d,f]),_=(0,a.Z)(y,2),g=_[0],m=_[1];n.geometry=new N.Z({x:g,y:m,spatialReference:this.view.spatialReference})}}catch(x){i.e(x)}finally{i.f()}}},{key:"_getIndicesForVertexGraphic",value:function(e){var t=e.attributes;return[(null===t||void 0===t?void 0:t.pathIndex)||0,(null===t||void 0===t?void 0:t.pointIndex)||0]}},{key:"_getVertexFromEditGeometry",value:function(e){var t=this._getIndicesForVertexGraphic(e),i=(0,a.Z)(t,2),n=i[0],r=i[1];return this._editGeometryOperations.data.components[n].vertices[r]}},{key:"_onHandleMove",value:function(e,t,i,o,a){var s=this;(0,x.IM)(this._snappingTask);var l=this._snappingContext;if(l){var c=e.geometry,p="graphic-move-stop"===o.type;if((0,x.pC)(this.snappingManager)&&this.selectedVertices.length<2&&!p){var h=this.snappingManager;this._stagedVertex=h.update({point:c,context:l}),this._syncGeometryAfterVertexMove(e,new N.Z(this._stagedVertex),t,i,p),a(),this._snappingTask=(0,d.vr)(function(){var o=(0,r.Z)((0,n.Z)().mark((function r(o){var u;return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,h.snap({point:c,context:l,signal:o});case 2:(u=n.sent).valid&&(s._stagedVertex=u.apply(),s._syncGeometryAfterVertexMove(e,new N.Z(s._stagedVertex),t,i,p),a());case 4:case"end":return n.stop()}}),r)})));return function(e){return o.apply(this,arguments)}}())}else{var u=(0,x.pC)(this._stagedVertex)?new N.Z(this._stagedVertex):c;this._syncGeometryAfterVertexMove(e,u,t,i,p),a()}}}},{key:"_syncGeometryAfterVertexMove",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(t,i,r,o){var s,l,c,p,h,u,v,d,f,y,_,g,m,x=arguments;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=x.length>4&&void 0!==x[4]&&x[4],"point"===(l=this._editGeometryOperations.data.geometry).type?t.geometry=i:(c=i.x,p=i.y,h=this._getIndicesForVertexGraphic(t),u=(0,a.Z)(h,2),v=u[0],d=u[1],f=(0,C.nA)(l),y=f[v].length-1,f[v][d]=[c,p],"polygon"===l.type&&(0===d?f[v][y]=[c,p]:d===y&&(f[v][0]=[c,p])),this._isVertex(t)&&(f=this._moveRelatedCoordinates(f,t,c,p),f=this._moveSelectedHandleCoordinates(f,t,r,o,"polygon"===l.type),this._updateMidpointGraphicLocations(f)),this.graphic.geometry=l.clone(),_=this._getVertexFromEditGeometry(t),g=c-_.pos[0],m=p-_.pos[1],this._editGeometryOperations.moveVertices([_],g,m,0),s&&(this._mover?this._mover.updateGeometry(this._mover.graphics.indexOf(t),i):t.geometry=i));case 3:case"end":return e.stop()}}),e,this)})));return function(t,i,n,r){return e.apply(this,arguments)}}()},{key:"_moveRelatedCoordinates",value:function(e,t,i,n){var r,o=t.attributes.relatedGraphicIndices,a=(0,s.Z)(o);try{for(a.s();!(r=a.n()).done;){var l=r.value,c=this.vertexGraphics.getItemAt(l),p=c.attributes,h=p.pathIndex,u=p.pointIndex;e[h][u]=[i,n],c.geometry=t.geometry}}catch(v){a.e(v)}finally{a.f()}return e}},{key:"_moveSelectedHandleCoordinates",value:function(e,t,i,n,r){var o,a=(0,s.Z)(this.selectedVertices);try{for(a.s();!(o=a.n()).done;){var l=o.value;if(l!==t){var c=l.attributes,p=c.pathIndex,h=c.pointIndex,u=c.relatedGraphicIndices,v=(0,E.e7)(l.geometry,i,n,this.view),d=e[p].length-1;e[p][h]=[v.x,v.y],l.geometry=v,r&&(0===h?e[p][d]=[v.x,v.y]:h===d&&(e[p][0]=[v.x,v.y]));var f,y=(0,s.Z)(u);try{for(y.s();!(f=y.n()).done;){var _=f.value,g=this.vertexGraphics.getItemAt(_),m=g.attributes,x=m.pathIndex,b=m.pointIndex;e[x][b]=[v.x,v.y],g.geometry=v}}catch(k){y.e(k)}finally{y.f()}}}}catch(k){a.e(k)}finally{a.f()}return e}},{key:"_onGraphicPointerOverCallback",value:function(e){var t=e.graphic,i=this._isVertex(t);i&&!this._isSelected(t)&&(t.symbol=this.symbols.vertices.hover),this._updateTooltip(i?t:null),this._updateHoverCursor(t)}},{key:"_onGraphicPointerOutCallback",value:function(e){var t=e.graphic;this._isVertex(t)&&!this._isSelected(t)&&(t.symbol=this.symbols.vertices.default),this.view.cursor="default",this._updateTooltip()}},{key:"_createVertexFromMidpoint",value:function(e){var t=this._graphicAttributes,i=this.graphic.geometry;if((0,x.Wi)(i)||"polygon"!==i.type&&"polyline"!==i.type)return[];var n=i.clone(),r=[],a=e.attributes,s=a.pathIndex,l=a.pointIndexStart,c=a.pointIndexEnd,p=e.geometry,h=p.x,u=p.y,v=0===c?l+1:c,d=(0,C.nA)(n);return d[s].splice(v,0,[h,u]),e.attributes=(0,o.Z)((0,o.Z)({},t),{},{pathIndex:s,pointIndex:v,relatedGraphicIndices:[]}),r.push({coordinates:d[s][v],componentIndex:s,vertexIndex:v}),this.graphic.geometry=n,r}},{key:"_addToSelection",value:function(e){e instanceof v.Z&&(e=[e]);var t,i=(0,s.Z)(e);try{for(i.s();!(t=i.n()).done;){t.value.symbol=this.symbols.vertices.selected}}catch(n){i.e(n)}finally{i.f()}this._set("selectedVertices",this.selectedVertices.concat(e)),this._emitSelectEvent(e)}},{key:"_removeFromSelection",value:function(e,t){var i=this.symbols.vertices,n=t?i.hover:i.default;e instanceof v.Z&&(e=[e]);var r,o=(0,s.Z)(e);try{for(o.s();!(r=o.n()).done;){var a=r.value;this.selectedVertices.splice(this.selectedVertices.indexOf(a),1),this._set("selectedVertices",this.selectedVertices),a.set("symbol",n)}}catch(l){o.e(l)}finally{o.f()}this._emitDeselectEvent(e)}},{key:"_clearSelection",value:function(){if(this.selectedVertices.length){var e,t=this.selectedVertices,i=(0,s.Z)(this.selectedVertices);try{for(i.s();!(e=i.n()).done;){e.value.set("symbol",this.symbols.vertices.default)}}catch(n){i.e(n)}finally{i.f()}this._set("selectedVertices",[]),this._emitDeselectEvent(t)}}},{key:"_keyDownHandler",value:function(e){z.j.delete.includes(e.key)&&!e.repeat&&this.selectedVertices.length&&this._removeVertices(this.selectedVertices)}},{key:"_removeVertices",value:function(e){var t=this.graphic.geometry;if(!((0,x.Wi)(t)||"polygon"!==t.type&&"polyline"!==t.type)&&!("polygon"===t.type&&this.vertexGraphics.length<4||this.vertexGraphics.length<3)){e instanceof v.Z&&(e=[e]);var i=this.graphic.clone(),n=t.clone(),r=(0,C.nA)(n),o=[];e instanceof v.Z&&(e=[e]);var l,c=(0,s.Z)(e);try{for(c.s();!(l=c.n()).done;)for(var p=l.value.geometry,h=p.x,u=p.y,d=0;d<r.length;d++)for(var f=r[d],y=0;y<f.length;y++){var _=(0,a.Z)(f[y],2),g=_[0],m=_[1];h===g&&u===m&&(o.push({coordinates:r[d][y],componentIndex:d,vertexIndex:y}),r[d].splice(Number(y),1))}}catch(w){c.e(w)}finally{c.f()}if("polygon"===n.type)r=r.filter((function(e){if(e.length<2)return!1;var t=(0,a.Z)(e[0],2),i=t[0],n=t[1],r=(0,a.Z)(e[e.length-1],2),o=r[0],s=r[1];return(2!==e.length||i!==o||n!==s)&&(i===o&&n===s||e.push(e[0]),!0)})),n.rings=r;else{var b,k=(0,s.Z)(r);try{for(k.s();!(b=k.n()).done;){var Z=b.value;1===Z.length&&r.splice(r.indexOf(Z),1)}}catch(w){k.e(w)}finally{k.f()}n.paths=r}this.graphic.geometry=n,this.refresh(),this._emitVertexRemoveEvent(e,i,o)}}},{key:"_isVertex",value:function(e){return this.vertexGraphics.includes(e)}},{key:"_isSelected",value:function(e){return this._isVertex(e)&&this.selectedVertices.includes(e)}},{key:"_isMidpoint",value:function(e){return this.midpointGraphics.includes(e)}},{key:"_updateHoverCursor",value:function(e){this.view.cursor=this._isMidpoint(e)?"copy":"move"}},{key:"_updateTooltip",value:function(e,t){(0,x.Wi)(this._tooltip)||(e?e===this.graphic?this._updateMoveGraphicTooltip(t):this._updateMoveVertexTooltip(t):this._tooltip.clear())}},{key:"_updateMoveGraphicTooltip",value:function(e){var t=this._tooltip,i=this.tooltipOptions,n=this.view;if(!(0,x.Wi)(t)){var r=new P.$E({tooltipOptions:i});if(e){var o=e.origin,a=o.x,s=o.y,l=n.toMap(e),c=n.toMap((0,Z.vW)(a,s)),p=(0,q.Qw)(c,l);r.distance=(0,x.pC)(p)?p:b.yP}t.info=r}}},{key:"_updateMoveVertexTooltip",value:function(e){var t=this._tooltip,i=this.graphic.geometry,n=this.tooltipOptions,r=this.view;if(!(0,x.Wi)(t)){var o=new P.nk({tooltipOptions:n});if((0,x.pC)(i)&&("polygon"===i.type?o.area=(0,D.f)(i):"polyline"===i.type&&(o.totalLength=(0,q.C_)(i))),e){var a=e.origin,s=a.x,l=a.y,c=r.toMap(e),p=r.toMap((0,Z.vW)(s,l)),h=(0,q.Qw)(p,c);o.distance=(0,x.pC)(h)?h:b.yP}t.info=o}}},{key:"_emitMoveStartEvent",value:function(e,t){var i=new J(this.graphic,e,t);this.emit("move-start",i),this.callbacks.onMoveStart&&this.callbacks.onMoveStart(i)}},{key:"_emitMoveEvent",value:function(e,t){var i=new K(this.graphic,e,t);this.emit("move",i),this.callbacks.onMove&&this.callbacks.onMove(i)}},{key:"_emitMoveStopEvent",value:function(){var e=this._activeOperationInfo;if(e){var t=e.totalDx,i=e.totalDy,n=new $(this.graphic,t,i);this.emit("move-stop",n),this.callbacks.onMoveStop&&this.callbacks.onMoveStop(n)}}},{key:"_emitReshapeStartEvent",value:function(e){var t=new X(this.graphic,e,this.selectedVertices);this.emit("reshape-start",t),this.callbacks.onReshapeStart&&this.callbacks.onReshapeStart(t)}},{key:"_emitReshapeEvent",value:function(e){var t=new Y(this.graphic,e,this.selectedVertices);this.emit("reshape",t),this.callbacks.onReshape&&this.callbacks.onReshape(t)}},{key:"_emitReshapeStopEvent",value:function(e){var t=new Q(this.graphic,e,this.selectedVertices);this.emit("reshape-stop",t),this.callbacks.onReshapeStop&&this.callbacks.onReshapeStop(t)}},{key:"_emitSelectEvent",value:function(e){var t=new B(e);this.emit("select",t),this.callbacks.onVertexSelect&&this.callbacks.onVertexSelect(t)}},{key:"_emitDeselectEvent",value:function(e){var t=new ee(e);this.emit("deselect",t),this.callbacks.onVertexDeselect&&this.callbacks.onVertexDeselect(t)}},{key:"_emitVertexAddEvent",value:function(e,t,i){var n=new te(e,this.graphic,t,i);this.emit("vertex-add",n),this.callbacks.onVertexAdd&&this.callbacks.onVertexAdd(n)}},{key:"_emitVertexRemoveEvent",value:function(e,t,i){var n=new ie(e,this.graphic,t,i);this.emit("vertex-remove",n),this.callbacks.onVertexRemove&&this.callbacks.onVertexRemove(n)}},{key:"_logGeometryTypeError",value:function(){m.Z.getLogger(this.declaredClass).error(new y.Z("reshape:invalid-geometry","Reshape operation not supported for the provided graphic. The geometry type is not supported."))}}]),i}(_.Z.EventedAccessor);(0,u._)([(0,w.Cb)()],oe.prototype,"_tooltip",void 0),(0,u._)([(0,w.Cb)()],oe.prototype,"callbacks",void 0),(0,u._)([(0,w.Cb)()],oe.prototype,"enableMidpoints",void 0),(0,u._)([(0,w.Cb)()],oe.prototype,"enableMovement",void 0),(0,u._)([(0,w.Cb)()],oe.prototype,"enableVertices",void 0),(0,u._)([(0,w.Cb)()],oe.prototype,"graphic",void 0),(0,u._)([(0,w.Cb)({value:!0})],oe.prototype,"highlightsEnabled",null),(0,u._)([(0,w.Cb)()],oe.prototype,"layer",void 0),(0,u._)([(0,w.Cb)({readOnly:!0})],oe.prototype,"midpointGraphics",void 0),(0,u._)([(0,w.Cb)()],oe.prototype,"midpointSymbol",void 0),(0,u._)([(0,w.Cb)({readOnly:!0})],oe.prototype,"selectedVertices",void 0),(0,u._)([(0,w.Cb)()],oe.prototype,"snappingManager",void 0),(0,u._)([(0,w.Cb)({readOnly:!0})],oe.prototype,"state",null),(0,u._)([(0,w.Cb)({value:re})],oe.prototype,"symbols",null),(0,u._)([(0,w.Cb)({type:W.Z})],oe.prototype,"tooltipOptions",void 0),(0,u._)([(0,w.Cb)({readOnly:!0})],oe.prototype,"type",void 0),(0,u._)([(0,w.Cb)({readOnly:!0})],oe.prototype,"vertexGraphics",void 0),(0,u._)([(0,w.Cb)()],oe.prototype,"view",void 0);var ae=oe=(0,u._)([(0,G.j)("esri.views.draw.support.Reshape")],oe)},34019:function(e,t,i){i.d(t,{N:function(){return o}});var n=i(15671),r=i(43144),o=function(){function e(t){(0,n.Z)(this,e),this.vertexHandle=null,this.excludeFeature=null,this.visualizer=null,this.selfSnappingZ=null,this.editGeometryOperations=t.editGeometryOperations,this.elevationInfo=t.elevationInfo,this.pointer=t.pointer,this.vertexHandle=t.vertexHandle,this.excludeFeature=t.excludeFeature,this.visualizer=t.visualizer,this.selfSnappingZ=t.selfSnappingZ}return(0,r.Z)(e,[{key:"coordinateHelper",get:function(){return this.editGeometryOperations.data.coordinateHelper}},{key:"spatialReference",get:function(){return this.coordinateHelper.spatialReference}}]),e}()},38561:function(e,t,i){i.d(t,{a:function(){return u}});var n=i(37762),r=i(15671),o=i(43144),a=i(42537),s=i(90609),l=i(53397),c=i(5916),p=i(61309),h=i(41216),u=function(){function e(){(0,r.Z)(this,e)}return(0,o.Z)(e,[{key:"draw",value:function(e,t){var i,r=this._getUniqueHints(e),o=this.sortUniqueHints(r),u=[],v=(0,n.Z)(o);try{for(v.s();!(i=v.n()).done;){var d=i.value;d instanceof s.w&&u.push(this.visualizeIntersectionPoint(d,t)),d instanceof l.w&&u.push(this.visualizeLine(d,t)),d instanceof c.L&&u.push(this.visualizeParallelSign(d,t)),d instanceof h.y&&u.push(this.visualizeRightAngleQuad(d,t)),d instanceof p.n&&u.push(this.visualizePoint(d,t))}}catch(f){v.e(f)}finally{v.f()}return(0,a.AL)(u)}},{key:"sortUniqueHints",value:function(e){return e}},{key:"_getUniqueHints",value:function(e){var t,i=[],r=(0,n.Z)(e);try{for(r.s();!(t=r.n()).done;){var o,a=t.value,s=!0,l=(0,n.Z)(i);try{for(l.s();!(o=l.n()).done;){var c=o.value;if(a.equals(c)){s=!1;break}}}catch(p){l.e(p)}finally{l.f()}s&&i.push(a)}}catch(p){r.e(p)}finally{r.f()}return i}}]),e}()},61309:function(e,t,i){i.d(t,{n:function(){return l}});var n=i(15671),r=i(43144),o=i(60136),a=i(92572),s=i(11186),l=function(e){(0,o.Z)(i,e);var t=(0,a.Z)(i);function i(e,r,o){var a;return(0,n.Z)(this,i),(a=t.call(this,r,o)).point=e,a}return(0,r.Z)(i,[{key:"equals",value:function(e){return e instanceof i&&(0,s.k)(this.point,e.point)}}]),i}(i(55054).r)},40524:function(e,t,i){i.d(t,{$E:function(){return u},QW:function(){return v},c1:function(){return _},in:function(){return d},j:function(){return y},nk:function(){return f}});var n=i(43144),r=i(15671),o=i(60136),a=i(92572),s=i(27366),l=i(47898),c=i(49861),p=i(69912),h=i(4943),u=function(e){(0,o.Z)(i,e);var t=(0,a.Z)(i);function i(e){var n;return(0,r.Z)(this,i),(n=t.call(this,e)).type="translate-graphic",n.distance=l.yP,n}return(0,n.Z)(i)}(h.h);(0,s._)([(0,c.Cb)()],u.prototype,"type",void 0),(0,s._)([(0,c.Cb)()],u.prototype,"distance",void 0),u=(0,s._)([(0,p.j)("esri.views.interactive.tooltip.TranslateGraphicTooltipInfo")],u);var v=function(e){(0,o.Z)(i,e);var t=(0,a.Z)(i);function i(e){var n;return(0,r.Z)(this,i),(n=t.call(this,e)).type="translate-graphic-z",n.distance=l.yP,n}return(0,n.Z)(i)}(h.h);(0,s._)([(0,c.Cb)()],v.prototype,"type",void 0),(0,s._)([(0,c.Cb)()],v.prototype,"distance",void 0),v=(0,s._)([(0,p.j)("esri.views.interactive.tooltip.TranslateGraphicZTooltipInfo")],v);var d=function(e){(0,o.Z)(i,e);var t=(0,a.Z)(i);function i(e){var n;return(0,r.Z)(this,i),(n=t.call(this,e)).type="translate-graphic-xy",n.distance=l.yP,n}return(0,n.Z)(i)}(h.h);(0,s._)([(0,c.Cb)()],d.prototype,"type",void 0),(0,s._)([(0,c.Cb)()],d.prototype,"distance",void 0),d=(0,s._)([(0,p.j)("esri.views.interactive.tooltip.TranslateGraphicXYTooltipInfo")],d);var f=function(e){(0,o.Z)(i,e);var t=(0,a.Z)(i);function i(e){var n;return(0,r.Z)(this,i),(n=t.call(this,e)).type="translate-vertex",n.distance=l.yP,n.elevation=null,n.area=null,n.totalLength=null,n}return(0,n.Z)(i)}(h.h);(0,s._)([(0,c.Cb)()],f.prototype,"type",void 0),(0,s._)([(0,c.Cb)()],f.prototype,"distance",void 0),(0,s._)([(0,c.Cb)()],f.prototype,"elevation",void 0),(0,s._)([(0,c.Cb)()],f.prototype,"area",void 0),(0,s._)([(0,c.Cb)()],f.prototype,"totalLength",void 0),f=(0,s._)([(0,p.j)("esri.views.interactive.tooltip.TranslateVertexTooltipInfo")],f);var y=function(e){(0,o.Z)(i,e);var t=(0,a.Z)(i);function i(e){var n;return(0,r.Z)(this,i),(n=t.call(this,e)).type="translate-vertex-z",n.distance=l.yP,n.elevation=null,n}return(0,n.Z)(i)}(h.h);(0,s._)([(0,c.Cb)()],y.prototype,"type",void 0),(0,s._)([(0,c.Cb)()],y.prototype,"distance",void 0),(0,s._)([(0,c.Cb)()],y.prototype,"elevation",void 0),y=(0,s._)([(0,p.j)("esri.views.interactive.tooltip.TranslateVertexZTooltipInfo")],y);var _=function(e){(0,o.Z)(i,e);var t=(0,a.Z)(i);function i(e){var n;return(0,r.Z)(this,i),(n=t.call(this,e)).type="translate-vertex-xy",n.distance=l.yP,n.elevation=null,n.area=null,n.totalLength=null,n}return(0,n.Z)(i)}(h.h);(0,s._)([(0,c.Cb)()],_.prototype,"type",void 0),(0,s._)([(0,c.Cb)()],_.prototype,"distance",void 0),(0,s._)([(0,c.Cb)()],_.prototype,"elevation",void 0),(0,s._)([(0,c.Cb)()],_.prototype,"area",void 0),(0,s._)([(0,c.Cb)()],_.prototype,"totalLength",void 0),_=(0,s._)([(0,p.j)("esri.views.interactive.tooltip.TranslateVertexXYTooltipInfo")],_)},21971:function(e,t,i){i.d(t,{f:function(){return y},k:function(){return f}});var n=i(92026),r=i(12611),o=(i(59486),i(47898)),a=i(2170),s=i(79803),l=i(15559),c=i(47072),p=i(78952);function h(e){var t=e.spatialReference;return(0,c.T)(t,u,v,d,e)}function u(e){return(0,o.ne)(Math.abs((0,l.p8)([e],"square-meters")[0]),"square-meters")}function v(e){try{return(0,o.ne)(Math.abs((0,a.geodesicArea)(e,"square-meters")),"square-meters")}catch(t){return null}}function d(e){var t=[];return(0,s.K2)(e,t)?(0,o.ne)(Math.abs((0,l.p8)([{type:"polygon",rings:t,spatialReference:p.Z.WGS84}],"square-meters")[0]),"square-meters"):null}function f(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(0,r.ln)();if("on-the-ground"===t){var o=h(e);return(0,n.pC)(o)?o:(0,r.X)(e,i)}return(0,r.oN)(e,i)}function y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,r.ln)();return f(e,"on-the-ground",t)}},12611:function(e,t,i){i.d(t,{X:function(){return f},bT:function(){return x},ln:function(){return m},oN:function(){return d}});var n=i(37762),r=i(92026),o=i(47898),a=i(68860),s=i(79347),l=i(11186),c=i(71353),p=i(79803),h=i(55652),u=i(74702),v=i(25003);function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{positionsWorldCoords:[]};return y(e,t)}function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{positionsWorldCoords:[]};return y(e,t,!1)}function y(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.hasZ,s=(0,v.m)(e.spatialReference),d=(0,a.oq)(s);if((0,r.Wi)(d))return null;var f,y=function(e,t){return!(t.length<2)&&((0,l.s)(e,t[0],t[1],i&&t[2]||0),!0)},m=0,b=(0,n.Z)(e.rings);try{for(b.s();!(f=b.n()).done;){var k=f.value,Z=k.length;if(!(Z<3)){for(var w=t.positionsWorldCoords;w.length<Z;)w.push((0,c.c)());for(var G=_,C=(0,l.s)(g,0,0,0),V=1/Z,M=0;M<Z;M++){if(!y(G,k[M]))return null;if(!(0,p.SH)(G,e.spatialReference,w[M],s))return null;(0,l.z)(C,C,w[M],V)}var S=(0,h.zk)(w[0],w[1],C,(0,h.re)());if(0!==(0,l.p)((0,h.mJ)(S))){for(var I=0;I<Z;I++)(0,h.tx)(S,C,w[I],w[I]);for(var E=x(w),T=0;T<E.length;T+=3)m+=(0,u.wu)(w[E[T]],w[E[T+1]],w[E[T+2]])}}}}catch(O){b.e(O)}finally{b.f()}return(0,o.ne)(m,d)}var _=(0,c.c)(),g=(0,c.c)();function m(){return{positionsWorldCoords:[]}}function x(e){return(0,s.e)(function(e){for(var t=new Float64Array(2*e.length),i=0;i<e.length;++i){var n=e[i],r=2*i;t[r+0]=n[0],t[r+1]=n[1]}return t}(e),[],2)}}}]);
//# sourceMappingURL=34141.c36da708.chunk.js.map