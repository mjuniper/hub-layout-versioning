"use strict";(self.webpackChunkhub_layout_versioning=self.webpackChunkhub_layout_versioning||[]).push([[62923],{42069:function(e,t,n){n.d(t,{A:function(){return m}});var i=n(74165),r=n(15861),a=n(15671),o=n(43144),l=n(11752),s=n(61120),u=n(60136),c=n(92572),d=n(27366),p=n(42537),v=n(66978),h=n(94172),y=n(49861),f=(n(25243),n(63780),n(69912)),g=n(5354),m=function(e){var t=function(e){(0,u.Z)(n,e);var t=(0,c.Z)(n);function n(){var e;return(0,a.Z)(this,n),(e=t.apply(this,arguments)).slicePlaneEnabled=!1,e.supportsHeightUnitConversion=!1,e}return(0,o.Z)(n,[{key:"postscript",value:function(e){(0,l.Z)((0,s.Z)(n.prototype),"postscript",this).call(this,e),(0,g.qC)(this.layer)&&this.addResolvingPromise(this._validateHeightModelInfo())}},{key:"_validateHeightModelInfo",value:function(){var e=(0,r.Z)((0,i.Z)().mark((function e(){var t,n,r,a=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new AbortController,n=t.signal,this.handles.add((0,p.kB)((function(){return t.abort()}))),e.next=4,(0,h.N1)((function(){var e;return null===(e=a.view.defaultsFromMap)||void 0===e?void 0:e.heightModelInfoReady}),n);case 4:if((0,v.k_)(n),!(r=(0,g.Wt)(this.layer,this.view.heightModelInfo,this.supportsHeightUnitConversion))){e.next=8;break}throw r;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"canResume",value:function(){var e=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return(0,l.Z)((0,s.Z)(n.prototype),"canResume",this).call(this)&&(!e||!e.minScale||!e.maxScale||e.minScale>=e.maxScale)}},{key:"getSuspendInfo",value:function(){var e=(0,l.Z)((0,s.Z)(n.prototype),"getSuspendInfo",this).call(this),t=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return t&&t.minScale&&t.maxScale&&t.minScale<t.maxScale&&(e.outsideScaleRange=!0),e}}]),n}(e);return(0,d._)([(0,y.Cb)()],t.prototype,"view",void 0),(0,d._)([(0,y.Cb)()],t.prototype,"slicePlaneEnabled",void 0),t=(0,d._)([(0,f.j)("esri.views.3d.layers.LayerView3D")],t)}},62923:function(e,t,n){n.r(t),n.d(t,{default:function(){return M}});var i=n(74165),r=n(15861),a=n(37762),o=n(15671),l=n(43144),s=n(11752),u=n(61120),c=n(60136),d=n(92572),p=n(27366),v=n(80987),h=n(77178),y=n(92026),f=n(94172),g=n(49861),m=(n(25243),n(63780),n(69912)),b=n(40653),_=n(54889),Z=n(16406),k=n(44745),w=n(21604),C=n(99821),S=n(70491),I=n(42069),O=n(79510),R=n(61712),E=n(5198),P=n(78485),V=n(67581);var G=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(){var e;return(0,o.Z)(this,n),(e=t.apply(this,arguments)).type="route-3d",e.loadedGraphics=new E.g,e._byObjectID=new Map,e.slicePlaneEnabled=!1,e.fullExtentInLocalViewSpatialReference=null,e}return(0,l.Z)(n,[{key:"initialize",value:function(){var e=this;this._set("processor",new O.D({owner:this,scaleVisibilityEnabled:!0,frustumVisibilityEnabled:!0})),this.addResolvingPromise(this.processor.initializePromise),this.updatingHandles.addOnCollectionChange((function(){return e._routeItems}),(function(t){return e._routeItemsChanged(t)}),f.nn),this.addResolvingPromise((0,R.E)(this).then((function(t){return e.fullExtentInLocalViewSpatialReference=t}))),this.handles.add((0,f.gx)((function(){var t,n;return null===(t=e.view)||void 0===t||null===(n=t.basemapTerrain)||void 0===n?void 0:n.ready}),(function(){return function(){return e.notifyChange("updating")}}),{once:!0}))}},{key:"destroy",value:function(){var e;this.handles.removeAll(),this.updatingHandles.removeAll(),this._set("processor",(0,y.SC)(this.processor)),null===(e=this._get("_routeItems"))||void 0===e||e.destroy()}},{key:"_routeItems",get:function(){var e=this;return new h.Z({getCollections:function(){return[e.layer.pointBarriers,e.layer.polygonBarriers,e.layer.polylineBarriers,e.layer.stops,e.layer.directionLines,e.layer.directionPoints,(0,y.pC)(e.layer.routeInfo)?new v.Z([e.layer.routeInfo]):null]}})}},{key:"_routeItemsChanged",value:function(e){var t=this;if(e.removed.length){this.loadedGraphics.removeMany(e.removed.map((function(e){var n=t._byObjectID.get(e);return t._byObjectID.delete(e),n})));var n,i=(0,a.Z)(e.removed);try{for(i.s();!(n=i.n()).done;){var r=n.value;this.handles.remove(r)}}catch(u){i.e(u)}finally{i.f()}}if(e.added.length){this.loadedGraphics.addMany(e.added.map((function(e){var n=e.toGraphic();return t._byObjectID.set(e,n),n})));var o,l=(0,a.Z)(e.added);try{var s=function(){var e=o.value;t.handles.add([(0,f.YP)((function(){return e.geometry}),(function(n,i){t._updateGraphic(e,"geometry",n,i)})),(0,f.YP)((function(){return e.symbol}),(function(n,i){t._updateGraphic(e,"symbol",n,i)}))],e)};for(l.s();!(o=l.n()).done;)s()}catch(u){l.e(u)}finally{l.f()}}}},{key:"legendEnabled",get:function(){var e;return this.canResume()&&!(null!==(e=this.processor)&&void 0!==e&&e.frustumVisibilitySuspended)}},{key:"getSuspendInfo",value:function(){var e,t,i,r,a=(0,s.Z)((0,u.Z)(n.prototype),"getSuspendInfo",this).call(this);return a.outsideScaleRange=null!==(e=null===(t=this.processor)||void 0===t?void 0:t.scaleVisibilitySuspended)&&void 0!==e&&e,a.outsideOfView=null!==(i=null===(r=this.processor)||void 0===r?void 0:r.frustumVisibilitySuspended)&&void 0!==i&&i,a}},{key:"fetchPopupFeatures",value:function(){var e=(0,r.Z)((0,i.Z)().mark((function e(t,n){var r,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null!==(r=null===(a=(0,y.Wg)(n))||void 0===a?void 0:a.clientGraphics)&&void 0!==r?r:[]);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getHit",value:function(e){return this.processor.getHit(e)}},{key:"whenGraphicBounds",value:function(e,t){return this.processor.whenGraphicBounds(e,t)}},{key:"computeAttachmentOrigin",value:function(e,t){var n;return null===(n=this.processor)||void 0===n?void 0:n.computeAttachmentOrigin(e,t)}},{key:"getSymbolLayerSize",value:function(e,t){return this.processor.getSymbolLayerSize(e,t)}},{key:"queryGraphics",value:function(){var e=(0,r.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new v.Z(this.loadedGraphics.toArray()));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"maskOccludee",value:function(e){return this.processor.maskOccludee(e)}},{key:"highlight",value:function(e){return function(e){return e instanceof b.Z||e instanceof _.Z||e instanceof Z.Z||e instanceof k.Z||e instanceof w.Z||e instanceof C.Z||e instanceof S.Z}(e)&&(e=this._byObjectID.get(e)),this.processor.highlight(e)}},{key:"updatePolicy",get:function(){var e;return(null===(e=this.processor)||void 0===e?void 0:e.graphicsCore.effectiveUpdatePolicy)||P.j.SYNC}},{key:"canResume",value:function(){var e;return(0,s.Z)((0,u.Z)(n.prototype),"canResume",this).call(this)&&!(null!==(e=this.processor)&&void 0!==e&&e.scaleVisibilitySuspended)}},{key:"isUpdating",value:function(){var e,t,n;return!((null===(e=this.processor)||void 0===e||!e.updating)&&null!==(t=this.view)&&void 0!==t&&null!==(n=t.basemapTerrain)&&void 0!==n&&n.ready)}},{key:"performanceInfo",get:function(){var e,t,n;return{displayedNumberOfFeatures:this.loadedGraphics.length,maximumNumberOfFeatures:-1,totalNumberOfFeatures:-1,nodes:0,core:null,updating:this.updating,elevationUpdating:null!==(e=null===(t=this.processor)||void 0===t?void 0:t.elevationAlignment.updating)&&void 0!==e&&e,visibilityFrustum:!(null!==(n=this.processor)&&void 0!==n&&n.frustumVisibilitySuspended)}}},{key:"_updateGraphic",value:function(e,t,n,i){var r,a=this._byObjectID.get(e);a[t]=n,x.graphic=a,x.property=t,x.oldValue=i,x.newValue=n,null===(r=this.processor)||void 0===r||r.graphicsCore.graphicUpdateHandler(x)}}]),n}((0,I.A)(V.Z));(0,p._)([(0,g.Cb)()],G.prototype,"_routeItems",null),(0,p._)([(0,g.Cb)()],G.prototype,"loadedGraphics",void 0),(0,p._)([(0,g.Cb)({readOnly:!0})],G.prototype,"legendEnabled",null),(0,p._)([(0,g.Cb)()],G.prototype,"layer",void 0),(0,p._)([(0,g.Cb)({readOnly:!0})],G.prototype,"processor",void 0),(0,p._)([(0,g.Cb)({type:Boolean})],G.prototype,"slicePlaneEnabled",void 0),G=(0,p._)([(0,m.j)("esri.views.3d.layers.RouteLayerView3D")],G);var x={graphic:null,property:null,oldValue:null,newValue:null},M=G},61712:function(e,t,n){n.d(t,{E:function(){return o}});var i=n(92026),r=n(81753),a=n(67387);function o(e){var t=e.view.spatialReference,n=e.layer.fullExtent,o=(0,i.pC)(n)&&n.spatialReference;if((0,i.Wi)(n)||!o)return Promise.resolve(null);if(o.equals(t))return Promise.resolve(n.clone());var l=(0,r.iV)(n,t);return(0,i.pC)(l)?Promise.resolve(l):e.view.state.isLocal?(0,a.projectGeometry)(n,t,e.layer.portalItem).then((function(t){return!e.destroyed&&t?t:null})).catch((function(){return null})):Promise.resolve(null)}},5198:function(e,t,n){n.d(t,{g:function(){return p}});var i=n(93433),r=n(37762),a=n(15671),o=n(43144),l=n(60136),s=n(92572),u=n(91505),c=n(62314),d=n(92377),p=function(e){(0,l.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;return(0,a.Z)(this,n),(e=t.apply(this,arguments))._set=new Set,e}return(0,o.Z)(n,[{key:"clear",value:function(){if(this._set.size>0){var e=this.toArray();this._set.clear(),this.emit("after-changes",{type:c.y.REMOVE}),this.emit("change",{added:[],removed:e})}}},{key:"length",get:function(){return this._set.size}},{key:"addMany",value:function(e){if(0!==e.length){var t,n=(0,r.Z)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;this._set.add(i)}}catch(a){n.e(a)}finally{n.f()}this.emit("after-changes",{type:c.y.ADD}),this.emit("change",{added:e,removed:[]})}}},{key:"remove",value:function(e){this._set.delete(e)&&(this.emit("after-changes",{type:c.y.REMOVE}),this.emit("change",{added:[],removed:[e]}))}},{key:"removeMany",value:function(e){var t,n=[],i=(0,r.Z)(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;this._set.delete(a)&&n.push(a)}}catch(o){i.e(o)}finally{i.f()}n.length>0&&(this.emit("after-changes",{type:c.y.REMOVE}),this.emit("change",{added:[],removed:n}))}},{key:"toArray",value:function(){return(0,i.Z)(this._set)}},{key:"find",value:function(e){var t;return(0,d.f)(this._set,(function(n){return!!e(n)&&(t=n,!0)})),t}},{key:"forEach",value:function(e){this._set.forEach((function(t){return e(t)}))}}]),n}(u.Z)},67581:function(e,t,n){n.d(t,{Z:function(){return m}});var i=n(15671),r=n(43144),a=n(60136),o=n(92572),l=n(27366),s=n(85015),u=n(91505),c=n(41691),d=n(79056),p=n(32718),v=n(92026),h=n(67426),y=n(49861),f=(n(25243),n(63780),n(69912)),g=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).layer=null,r.parent=null,r}return(0,r.Z)(n,[{key:"initialize",value:function(){var e=this;this.when().catch((function(t){if("layerview:create-error"!==t.name){var n=e.layer&&e.layer.id||"no id",i=e.layer&&e.layer.title||"no title";p.Z.getLogger(e.declaredClass).error("#resolve()","Failed to resolve layer view (layer title: '".concat(i,"', id: '").concat(n,"')"),t)}}))}},{key:"fullOpacity",get:function(){return(0,v.Pt)(this.get("layer.opacity"),1)*(0,v.Pt)(this.get("parent.fullOpacity"),1)}},{key:"suspended",get:function(){return!this.canResume()}},{key:"suspendInfo",get:function(){return this.getSuspendInfo()}},{key:"legendEnabled",get:function(){var e;return!this.suspended&&!0===(null===(e=this.layer)||void 0===e?void 0:e.legendEnabled)}},{key:"updating",get:function(){var e;return!((null===(e=this.updatingHandles)||void 0===e||!e.updating)&&!this.isUpdating())}},{key:"updatingProgress",get:function(){return this.updating?0:1}},{key:"visible",get:function(){var e;return!0===(null===(e=this.layer)||void 0===e?void 0:e.visible)},set:function(e){this._overrideIfSome("visible",e)}},{key:"canResume",value:function(){var e,t,n;return this.visible&&(null===(e=this.layer)||void 0===e?void 0:e.loaded)&&!(null!==(t=this.parent)&&void 0!==t&&t.suspended)&&(null===(n=this.view)||void 0===n?void 0:n.ready)||!1}},{key:"getSuspendInfo",value:function(){var e=this.parent&&this.parent.suspended?this.parent.suspendInfo:{};return this.view&&this.view.ready||(e.viewNotReady=!0),this.layer&&this.layer.loaded||(e.layerNotLoaded=!0),this.visible||(e.layerInvisible=!0),e}},{key:"isUpdating",value:function(){return!1}}]),n}((0,c.p)((0,d.IG)((0,h.v)(u.Z.EventedMixin(s.Z)))));(0,l._)([(0,y.Cb)()],g.prototype,"fullOpacity",null),(0,l._)([(0,y.Cb)()],g.prototype,"layer",void 0),(0,l._)([(0,y.Cb)()],g.prototype,"parent",void 0),(0,l._)([(0,y.Cb)({readOnly:!0})],g.prototype,"suspended",null),(0,l._)([(0,y.Cb)({readOnly:!0})],g.prototype,"suspendInfo",null),(0,l._)([(0,y.Cb)({readOnly:!0})],g.prototype,"legendEnabled",null),(0,l._)([(0,y.Cb)({type:Boolean,readOnly:!0})],g.prototype,"updating",null),(0,l._)([(0,y.Cb)({readOnly:!0})],g.prototype,"updatingProgress",null),(0,l._)([(0,y.Cb)()],g.prototype,"visible",null),(0,l._)([(0,y.Cb)()],g.prototype,"view",void 0);var m=g=(0,l._)([(0,f.j)("esri.views.layers.LayerView")],g)}}]);
//# sourceMappingURL=62923.86f8b7bf.chunk.js.map