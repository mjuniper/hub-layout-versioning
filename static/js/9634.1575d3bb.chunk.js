"use strict";(self.webpackChunkhub_layout_versioning=self.webpackChunkhub_layout_versioning||[]).push([[9634,62078],{62078:function(e,r,t){t.r(r),t.d(r,{addOrUpdateResource:function(){return f},contentToBlob:function(){return y},fetchResources:function(){return p},getSiblingOfSameType:function(){return k},getSiblingOfSameTypeI:function(){return g},removeAllResources:function(){return m},removeResource:function(){return d},splitPrefixFileNameAndExtension:function(){return w}});var n=t(74165),a=t(29439),s=t(15861),o=t(76200),u=t(10064),c=t(92026),i=t(35995);function p(e){return l.apply(this,arguments)}function l(){return l=(0,s.Z)((0,n.Z)().mark((function e(r){var t,a,s,o,u,p,l,f,h,d,v,m,Z=arguments;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Z.length>1&&void 0!==Z[1]?Z[1]:{},a=Z.length>2?Z[2]:void 0,e.next=4,r.load(a);case 4:return s=(0,i.v_)(r.itemUrl,"resources"),o=t.start,u=void 0===o?1:o,p=t.num,l=void 0===p?10:p,f=t.sortOrder,h=void 0===f?"asc":f,d=t.sortField,v={query:{start:u,num:l,sortOrder:h,sortField:void 0===d?"created":d,token:r.apiKey},signal:(0,c.U2)(a,"signal")},e.next=16,r.portal.request(s,v);case 16:return m=e.sent,e.abrupt("return",{total:m.total,nextStart:m.nextStart,resources:m.resources.map((function(e){var t=e.created,n=e.size,a=e.resource;return{created:new Date(t),size:n,resource:r.resourceFromPath(a)}}))});case 18:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}function f(e,r,t,n){return h.apply(this,arguments)}function h(){return h=(0,s.Z)((0,n.Z)().mark((function e(r,t,s,o){var p,l,f,h,d,v,m,Z;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.hasPath()){e.next=2;break}throw new u.Z("portal-item-resource-".concat(t,":invalid-path"),"Resource does not have a valid path");case 2:return p=r.portalItem,e.next=5,p.load(o);case 5:return l=(0,i.v_)(p.userItemUrl,"add"===t?"addResources":"updateResources"),f=x(r.path),h=(0,a.Z)(f,2),d=h[0],v=h[1],e.next=12,y(s);case 12:return m=e.sent,Z=new FormData,d&&"."!==d&&Z.append("resourcesPrefix",d),(0,c.pC)(o)&&o.compress&&Z.append("compress","true"),Z.append("fileName",v),Z.append("file",m,v),Z.append("f","json"),(0,c.pC)(o)&&o.access&&Z.append("access",o.access),e.next=22,p.portal.request(l,{method:"post",body:Z,signal:(0,c.U2)(o,"signal")});case 22:return e.abrupt("return",r);case 23:case"end":return e.stop()}}),e)}))),h.apply(this,arguments)}function d(e,r,t){return v.apply(this,arguments)}function v(){return(v=(0,s.Z)((0,n.Z)().mark((function e(r,t,a){var s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.hasPath()){e.next=2;break}throw new u.Z("portal-item-resources-remove:invalid-path","Resource does not have a valid path");case 2:return e.next=4,r.load(a);case 4:return s=(0,i.v_)(r.userItemUrl,"removeResources"),e.next=7,r.portal.request(s,{method:"post",query:{resource:t.path},signal:(0,c.U2)(a,"signal")});case 7:t.portalItem=null;case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e,r){return Z.apply(this,arguments)}function Z(){return(Z=(0,s.Z)((0,n.Z)().mark((function e(r,t){var a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.load(t);case 2:return a=(0,i.v_)(r.userItemUrl,"removeResources"),e.abrupt("return",r.portal.request(a,{method:"post",query:{deleteAll:!0},signal:(0,c.U2)(t,"signal")}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e){var r=e.lastIndexOf("/");return-1===r?[".",e]:[e.slice(0,r),e.slice(r+1)]}function w(e){var r=function(e){var r=(0,i.Ml)(e);return(0,c.Wi)(r)?[e,""]:[e.slice(0,e.length-r.length-1),".".concat(r)]}(e),t=(0,a.Z)(r,2),n=t[0],s=t[1],o=x(n),u=(0,a.Z)(o,2);return[u[0],u[1],s]}function y(e){return b.apply(this,arguments)}function b(){return(b=(0,s.Z)((0,n.Z)().mark((function e(r){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r instanceof Blob)){e.next=2;break}return e.abrupt("return",r);case 2:return e.next=4,(0,o.default)(r.url,{responseType:"blob"});case 4:return e.abrupt("return",e.sent.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e,r){if(!e.hasPath())return null;var t=w(e.path),n=(0,a.Z)(t,3),s=n[0],o=n[2];return e.portalItem.resourceFromPath((0,i.v_)(s,r+o))}function g(e,r){if(!e.hasPath())return null;var t=w(e.path),n=(0,a.Z)(t,3),s=n[0],o=n[2];return e.portalItem.resourceFromPath((0,i.v_)(s,r+o))}},9634:function(e,r,t){t.r(r),t.d(r,{saveResources:function(){return h}});var n=t(1413),a=t(74165),s=t(37762),o=t(15861),u=t(14921),c=t(10064),i=t(92026),p=t(66978),l=t(71907),f=t(62078);function h(e,r,t){return d.apply(this,arguments)}function d(){return d=(0,o.Z)((0,a.Z)().mark((function e(r,t,n){var o,u,i,h,d,m,x,w,y,b,k,g,I,R,S,_,P;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.resources){e.next=2;break}return e.abrupt("return");case 2:o=t.portalItem===r.portalItem?new Set(r.paths):new Set,r.paths.length=0,r.portalItem=t.portalItem,u=new Set(t.resources.toKeep.map((function(e){return e.resource.path}))),i=new Set,h=[],u.forEach((function(e){o.delete(e),r.paths.push(e)})),d=(0,s.Z)(t.resources.toUpdate);try{for(d.s();!(m=d.n()).done;)x=m.value,o.delete(x.resource.path),u.has(x.resource.path)||i.has(x.resource.path)?(w=x.resource,y=x.content,b=x.finish,k=x.error,g=(0,f.getSiblingOfSameTypeI)(w,(0,l.D)()),r.paths.push(g.path),h.push(v({resource:g,content:y,compress:x.compress,finish:b,error:k},n))):(r.paths.push(x.resource.path),h.push(Z(x,n)),i.add(x.resource.path))}catch(a){d.e(a)}finally{d.f()}I=(0,s.Z)(t.resources.toAdd);try{for(I.s();!(R=I.n()).done;)S=R.value,h.push(v(S,n)),r.paths.push(S.resource.path)}catch(a){I.e(a)}finally{I.f()}if(o.forEach((function(e){if(t.portalItem){var r=t.portalItem.resourceFromPath(e);h.push(r.portalItem.removeResource(r).catch((function(){})))}})),0!==h.length){e.next=12;break}return e.abrupt("return");case 12:return e.next=14,(0,p.as)(h);case 14:if(_=e.sent,(0,p.k_)(n),P=_.filter((function(e){return"error"in e})).map((function(e){return e.error})),!(P.length>0)){e.next=19;break}throw new c.Z("save:resources","Failed to save one or more resources",{errors:P});case 19:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}function v(e,r){return m.apply(this,arguments)}function m(){return(m=(0,o.Z)((0,a.Z)().mark((function e(r,t){var s,o,c,p;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=(0,n.Z)((0,n.Z)({},(0,i.pC)(t)?t:{}),{},{compress:r.compress}),e.next=3,(0,u.q6)(r.resource.portalItem.addResource(r.resource,r.content,c));case 3:if(!0===(p=e.sent).ok){e.next=6;break}throw null!==(s=r.error)&&void 0!==s&&s.call(r,p.error),p.error;case 6:null===(o=r.finish)||void 0===o||o.call(r,r.resource);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(e,r){return x.apply(this,arguments)}function x(){return(x=(0,o.Z)((0,a.Z)().mark((function e(r,t){var n,s,o;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,u.q6)(r.resource.update(r.content,t));case 2:if(!0===(o=e.sent).ok){e.next=5;break}throw null!==(n=r.error)&&void 0!==n&&n.call(r,o.error),o.error;case 5:null===(s=r.finish)||void 0===s||s.call(r,r.resource);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}}]);
//# sourceMappingURL=9634.1575d3bb.chunk.js.map