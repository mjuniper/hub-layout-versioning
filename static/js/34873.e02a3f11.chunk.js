"use strict";(self.webpackChunkhub_layout_versioning=self.webpackChunkhub_layout_versioning||[]).push([[34873],{62230:function(e,t,n){n.d(t,{l:function(){return s}});var i=n(10625),r=n(19545),o=(0,i.c)((function(e,t){i.a,function(e){var t={Promise:"undefined"!==typeof window?window.Promise:void 0},n="4.25",i="next";function r(e){if(e.toLowerCase()===i)return i;var t=e&&e.match(/^(\d)\.(\d+)/);return t&&{major:parseInt(t[1],10),minor:parseInt(t[2],10)}}function o(e){return void 0===e&&(e=n),"https://js.arcgis.com/".concat(e,"/")}function a(e){void 0===e&&(e=n);var t=o(e),a=r(e);if(a!==i&&3===a.major){var s=a.minor<=10?"js/":"";return"".concat(t).concat(s,"esri/css/esri.css")}return"".concat(t,"esri/themes/light/main.css")}function s(e){var t=document.createElement("link");return t.rel="stylesheet",t.href=e,t}function c(e,t){if(t){var n=document.querySelector(t);n.parentNode.insertBefore(e,n)}else document.head.appendChild(e)}function u(e){return document.querySelector('link[href*="'.concat(e,'"]'))}function l(e){return!e||r(e)?a(e):e}function h(e,t){var n=l(e),i=u(n);return i||c(i=s(n),t),i}var d={};function v(e){var t=document.createElement("script");return t.type="text/javascript",t.src=e,t.setAttribute("data-esri-loader","loading"),t}function f(e,t,n){var i;n&&(i=g(e,n));var r=function n(){t(e),e.removeEventListener("load",n,!1),i&&e.removeEventListener("error",i,!1)};e.addEventListener("load",r,!1)}function g(e,t){var n=function n(i){t(i.error||new Error("There was an error attempting to load ".concat(e.src))),e.removeEventListener("error",n,!1)};return e.addEventListener("error",n,!1),n}function p(e){void 0===e&&(e={}),d=e}function y(){return document.querySelector("script[data-esri-loader]")}function m(){var e=window.require;return e&&e.on}function w(e){void 0===e&&(e={});var n={};[d,e].forEach((function(e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t])}));var i=n.version,r=n.url||o(i);return new t.Promise((function(e,t){var o=y();if(o){var a=o.getAttribute("src");a!==r?t(new Error("The ArcGIS API for JavaScript is already loaded (".concat(a,")."))):m()?e(o):f(o,e,t)}else if(m())t(new Error("The ArcGIS API for JavaScript is already loaded."));else{var s=n.css;s&&h(!0===s?i:s,n.insertCssBefore),f(o=v(r),(function(){o.setAttribute("data-esri-loader","loaded"),e(o)}),t),document.body.appendChild(o)}}))}function k(e){return new t.Promise((function(t,n){var i=window.require.on("error",n);window.require(e,(function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];i.remove(),t(e)}))}))}function b(e,t){if(void 0===t&&(t={}),m())return k(e);var n=y(),i=n&&n.getAttribute("src");return!t.url&&i&&(t.url=i),w(t).then((function(){return k(e)}))}e.utils=t,e.loadModules=b,e.getScript=y,e.isLoaded=m,e.loadScript=w,e.setDefaultOptions=p,e.loadCss=h,Object.defineProperty(e,"__esModule",{value:!0})}(t)})),a={themeOrUrl:"light"},s=function(){var e=document.querySelector('link[rel="stylesheet"][href*="/esri/themes"]');if(e){new RegExp(r.i8).test(e.href)||console.warn("Your ArcGIS API for JavaScript StyleSheet file should match the current hub-components version: ".concat(r.i8,"."))}else{var t=a.themeOrUrl,n=a.insertBefore,i=["light","dark"].includes(t)?"https://js.arcgis.com/".concat(r.i8,"/esri/themes/").concat(t,"/main.css"):t;o.loadCss(i,n)}}},34873:function(e,t,n){n.r(t),n.d(t,{arcgis_hub_map_widget_search:function(){return y}});var i=n(29439),r=n(74165),o=n(15861),a=n(15671),s=n(43144),c=n(72585),u=n(98410),l=n(32836),h=n(85621),d=n(12868),v=n(8537),f=n(90196),g=n(62230),p=(n(10625),n(84371),n(19545),function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}),y=function(){function e(t){(0,a.Z)(this,e),(0,c.r)(this,t),this.arcgisHubWidgetPanelToggled=(0,c.c)(this,"arcgisHubWidgetPanelToggled",7),this.hubTelemetry=(0,c.c)(this,"hubTelemetry",7),this.scale="m",this.suggestions=[],this.width="25rem",(0,l.b)(this,"handleSetInputRef","handleSetDropdownRef","searchIfEnter","toggleActive","setInputWidth")}return(0,s.Z)(e,[{key:"componentWillLoad",value:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(){var t,n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.el,n=t&&t.closest("arcgis-hub-map-widget-container"),this.viewPosition=null===n||void 0===n?void 0:n.viewPosition,e.next=5,d.i.loadIntlForComponent(t);case 5:return this.intl=e.sent,e.next=8,this.connectViewModel();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"connectedCallback",value:function(){this.connectWatch()}},{key:"disconnectedCallback",value:function(){this.removeWatch()}},{key:"componentDidLoad",value:function(){this.setInputScale(),(0,g.l)()}},{key:"componentDidRender",value:function(){var e=this.active,t=this.inputEl;e&&t&&(t.setFocus(),t.scale=this.inputScale,this.setInputWidth())}},{key:"handleViewChange",value:function(e,t){var n=this;e&&e!==t&&(this.removeWatch(),this.connectViewModel().then((function(){n.connectWatch()})))}},{key:"handleSuggestionsChange",value:function(){var e=this.dropdownEl,t=this.suggestions;e.active=Boolean(t.length)}},{key:"handleActiveChange",value:function(e){var t=this.hubTelemetry,n=e?h.d.dictionary.category.interaction.action.open.label.search:h.d.dictionary.category.interaction.action.close.label.search;t.emit(n)}},{key:"handlePanelToggled",value:function(e){var t=e.target,n=e.detail;t===this.el||n||(this.active=!1)}},{key:"onCalciteDropdownSelect",value:function(){var e=this.dropdownEl;this.selectedKey=e.selectedItems[0].dataset.value,this.value=this.selected.text,this.search()}},{key:"onCalciteInputChange",value:function(e){this.value=e.target.value}},{key:"onCalciteInputInput",value:function(e){var t=e.detail.value;this.value=t,t&&this.getSuggestions()}},{key:"handleSetDropdownRef",value:function(e){e&&(this.dropdownEl=e)}},{key:"handleSetInputRef",value:function(e){e&&(this.inputEl=e)}},{key:"getSuggestions",value:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(){var t,n,o,a,s,c,u;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.value,n=this.searchComplete,o=this.hubTelemetry,a=this.searchViewModel,o.emit(Object.assign(Object.assign({},h.d.dictionary.category.interaction.action.search.label.query),{search:t})),e.next=4,a.suggest(t);case 4:s=e.sent,c=(0,i.Z)(s.results,1),u=c[0],n?this.searchComplete=!1:this.suggestions=(null===u||void 0===u?void 0:u.results)||[];case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"search",value:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(){var t,n,i,o,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.value,n=this.hubTelemetry,i=this.searchViewModel,this.loading=!0,o=this.selected||t,e.next=5,i.search(o);case 5:a=e.sent,n.emit(Object.assign(Object.assign({},h.d.dictionary.category.interaction.action.zoom.label.to),{details:null===a||void 0===a?void 0:a.searchTerm})),this.loading=!1,this.selectedKey=null,this.suggestions=[],this.searchComplete=!0;case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"searchIfEnter",value:function(e){"Enter"===e.key&&this.search()}},{key:"toggleActive",value:function(){var e=this.active,t=this.arcgisHubWidgetPanelToggled;this.active=!e,t.emit(e)}},{key:"connectWatch",value:function(){var e=this.view;e&&(this.handle=(0,v.YP)(e,"size",this.setInputWidth))}},{key:"removeWatch",value:function(){var e=this.handle;e&&e.remove(),this.handle=void 0}},{key:"connectViewModel",value:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(){var t,n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.view,n=this.searchViewModel,!t||n){e.next=5;break}return e.next=4,t.when();case 4:this.searchViewModel=new f.Z({autoSelect:!0,suggestionsEnabled:!0,maxResults:1,maxSuggestions:5,minSuggestCharacters:3,view:t});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setInputScale",value:function(){var e=this.scale;this.inputScale="s"===e?"m":"l"}},{key:"setInputWidth",value:function(){var e=this.inputEl,t=this.view.size;if(e){var n=(0,i.Z)(t,1)[0],r=e.offsetWidth;this.width=r/n>.7?"".concat(.7*n,"px"):"25rem"}}},{key:"positionClass",get:function(){var e=this.viewPosition;if(e)return"hub-widget-search ".concat(e.split("-").join(" "))}},{key:"selected",get:function(){var e=this.suggestions,t=this.selectedKey;return e.filter((function(e){return e.key===t})).pop()}},{key:"styles",get:function(){return{"--width":this.width}}},{key:"render",value:function(){var e=this.value,t=this.loading,n=this.scale,i=this.active,r=this.styles,o=this.intl.t("textOpen"),a=this.intl.t("textClose"),s=this.intl.t("placeholder");return(0,c.h)(c.H,{"data-element":"map-widget-search",style:r},this.active&&(0,c.h)("section",{class:this.positionClass},(0,c.h)("calcite-dropdown",{ref:this.handleSetDropdownRef,scale:n},(0,c.h)("calcite-input",{clearable:!0,icon:"search",loading:t,onKeyPress:this.searchIfEnter,placeholder:s,ref:this.handleSetInputRef,scale:this.inputScale,slot:"dropdown-trigger",value:e}),(0,c.h)("calcite-dropdown-group",{selectionMode:"single"},this.suggestions.map((function(e){return(0,c.h)("calcite-dropdown-item",{"data-value":e.key,key:e.key},e.text)}))))),(0,c.h)("arcgis-hub-map-widget-generic",{active:i,icon:"search",onClick:this.toggleActive,scale:n,text:i?a:o}))}},{key:"el",get:function(){return(0,c.g)(this)}}],[{key:"assetsDirs",get:function(){return["locales"]}},{key:"watchers",get:function(){return{view:["handleViewChange"],suggestions:["handleSuggestionsChange"],active:["handleActiveChange"]}}}]),e}();p([(0,u.D)({timeout:300})],y.prototype,"getSuggestions",null),y.style=":host{display:block}calcite-dropdown{position:absolute}calcite-input{width:var(--width)}calcite-dropdown-group{width:var(--width)}.hub-widget-search.top{position:absolute;width:var(--width)}.hub-widget-search.right{right:100%;margin-right:1rem}.hub-widget-search.left{left:100%;margin-left:1rem}"},98410:function(e,t,n){n.d(t,{D:function(){return r}});var i=n(89682);function r(e){return function(t,n,r){var o=r.value,a="".concat(n.toString(),"Debounced");return Object.assign(Object.assign({},r),{value:function(){this[a]||Object.defineProperty(this,a,{value:(0,i.d)(o,e.timeout)});for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this[a].apply(this,[this].concat(n))}})}}},89682:function(e,t,n){function i(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300;return function(i){for(var r=arguments.length,o=new Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];clearTimeout(t),t=setTimeout((function(){return e.apply(i,o)}),n)}}n.d(t,{d:function(){return i}})}}]);
//# sourceMappingURL=34873.e02a3f11.chunk.js.map