"use strict";(self.webpackChunkhub_layout_versioning=self.webpackChunkhub_layout_versioning||[]).push([[63220],{67077:function(t,e,r){function n(){return[0,0,0,0]}function i(t){return[t[0],t[1],t[2],t[3]]}function o(t,e,r,n){return[t,e,r,n]}function a(t){for(var e=[0,0,0,0],r=Math.min(4,t.length),n=0;n<r;++n)e[n]=t[n];return e}function u(t,e){return new Float64Array(t,e,4)}function f(){return[0,0,0,0]}function c(){return o(1,1,1,1)}function s(){return o(1,0,0,0)}function l(){return o(0,1,0,0)}function d(){return o(0,0,1,0)}function h(){return o(0,0,0,1)}r.d(e,{O:function(){return p},Z:function(){return y},a:function(){return u},b:function(){return a},c:function(){return n},d:function(){return i},f:function(){return o}});var y=[0,0,0,0],p=c(),v=s(),w=l(),m=d(),M=h();Object.freeze(Object.defineProperty({__proto__:null,ONES:p,UNIT_W:M,UNIT_X:v,UNIT_Y:w,UNIT_Z:m,ZEROS:y,clone:i,create:n,createView:u,fromArray:a,fromValues:o,ones:c,unitW:h,unitX:s,unitY:l,unitZ:d,zeros:f},Symbol.toStringTag,{value:"Module"}))},27811:function(t,e,r){r.d(e,{AJ:function(){return s},If:function(){return p},QM:function(){return h},hy:function(){return y},k0:function(){return c},nu:function(){return f},uI:function(){return d},wx:function(){return v}});var n=r(37762),i=r(16889),o=r(17842),a=r(90045),u=r(67077),f=2.4;function c(t){return(0,o.Wz)(t*f)}function s(t){return(0,o.F2)(t)/f}function l(t,e,r,n){var o=e.color,u=e.ratio,f=r.color,c=r.ratio;if(c===u){var s=1e-6;1===c?u-=s:c+=s}var l=(0,i.uZ)((n-u)/(c-u),0,1);(0,a.l)(t,o.toArray(),f.toArray(),l)}function d(t){var e=new Uint8ClampedArray(2048);if(t=t.filter((function(t){var e=t.ratio;return e>=0&&e<=1})).sort((function(t,e){return t.ratio-e.ratio})).map((function(t){var e=t.color,r=t.ratio;return{color:e,ratio:Math.max(r,.001)}})),t.length<1)return e;for(var r=t[0],n=t[0],i=1,o=(0,u.c)(),a=0;a<512;a++){for(var f=(a+.5)/512;f>n.ratio&&i<t.length;)r=n,n=t[i++];l(o,r,n,f),e.set(o,4*a)}return e}function h(t,e,r,i){var a,u,f=e.radius,c=e.fieldOffset,s=e.field,l=Math.round((0,o.F2)(f)),d=new Float64Array(r*i),h=Number.NEGATIVE_INFINITY,y=function(t,e){return null!=t?"string"==typeof e?function(e){return-1*+e.readAttribute(t)}:function(r){return+r.readAttribute(t)+e}:function(t){return 1}}(s,c),v=new Set,w=(0,n.Z)(t);try{for(w.s();!(u=w.n()).done;)for(var m=u.value.getCursor();m.next();){var M=m.getObjectId();if(!v.has(M)){v.add(M);var _=m.readLegacyPointGeometry(),b=128;if(!(_.x<-b||_.x>=r+b||_.y<-b||_.y>i+b))for(var k=+y(m),Z=Math.max(0,Math.round(_.x)-l),g=Math.max(0,Math.round(_.y)-l),T=Math.min(i,Math.round(_.y)+l),I=Math.min(r,Math.round(_.x)+l),U=g;U<T;U++)for(var x=Z;x<I;x++){var O=U*r+x,C=p(_.x-x,_.y-U,l);(a=d[O]+=C*k)>h&&(h=a)}}}}catch(S){w.e(S)}finally{w.f()}return{matrix:d.buffer,max:h}}function y(t,e,r,n,o,a){t.canvas.width=t.canvas.height=e,t.clearRect(0,0,e,e);var u=t.getImageData(0,0,e,e);r&&n&&u.data.set(new Uint8ClampedArray(function(t,e,r,n,o){for(var a=new Uint32Array(t*t),u=("buffer"in e?e:new Float64Array(e)),f=("buffer"in r?new Uint32Array(r.buffer):new Uint32Array(new Uint8Array(r).buffer)),c=f.length/(o-n),s=0;s<u.length;s++){var l=u[s],d=Math.floor((l-n)*c);a[s]=f[(0,i.uZ)(d,0,f.length-1)]}return a.buffer}(e,r,n,o,a))),t.putImageData(u,0,0)}function p(t,e,r){var n=Math.sqrt(Math.pow(t,2)+Math.pow(e,2))/r;return n>1?0:3/(Math.PI*Math.pow(r,2))*Math.pow(1-Math.pow(n,2),2)}function v(t,e){return"function"==typeof t?t:t?"string"==typeof e?function(e){return-1*+e[t]}:function(r){return+r[t]+e}:function(){return 1}}},81735:function(t,e,r){r.d(e,{Z:function(){return d}});var n=r(15671),i=r(43144),o=r(60136),a=r(92572),u=r(27366),f=r(41691),c=r(49861),s=(r(25243),r(63780),r(69912)),l=function(t){(0,o.Z)(r,t);var e=(0,a.Z)(r);function r(){return(0,n.Z)(this,r),e.apply(this,arguments)}return(0,i.Z)(r,[{key:"initialize",value:function(){}},{key:"destroy",value:function(){}},{key:"supportsTileUpdates",get:function(){return!1}},{key:"spatialReference",get:function(){var t=this.get("tileStore.tileScheme.spatialReference");return t&&t.toJSON()||null}}]),r}(f.r);(0,u._)([(0,c.Cb)({readOnly:!0})],l.prototype,"supportsTileUpdates",null),(0,u._)([(0,c.Cb)({constructOnly:!0})],l.prototype,"remoteClient",void 0),(0,u._)([(0,c.Cb)({constructOnly:!0})],l.prototype,"service",void 0),(0,u._)([(0,c.Cb)()],l.prototype,"spatialReference",null),(0,u._)([(0,c.Cb)({constructOnly:!0})],l.prototype,"tileInfo",void 0),(0,u._)([(0,c.Cb)({constructOnly:!0})],l.prototype,"tileStore",void 0);var d=l=(0,u._)([(0,s.j)("esri.views.2d.layers.features.processors.BaseProcessor")],l)},63220:function(t,e,r){r.r(e),r.d(e,{default:function(){return Z}});var n=r(1413),i=r(29439),o=r(37762),a=r(74165),u=r(15861),f=r(60136),c=r(92572),s=r(43144),l=r(15671),d=r(27366),h=(r(93169),r(92026)),y=(r(32718),r(25243),r(63780),r(10064),r(69912)),p=r(48732),v=r(27811),w=r(94109),m=r(81735),M=r(35092),_=(0,s.Z)((function t(e,r){(0,l.Z)(this,t),this.offset=e,this.extent=r}));function b(t){var e=t.key,r=new Map,n=256,i=w.I_,o=t.tileInfoView.tileInfo.isWrappable;return r.set((0,M.M)(e,-1,-1,o).id,new _([-i,-i],[i-n,i-n,i,i])),r.set((0,M.M)(e,0,-1,o).id,new _([0,-i],[0,i-n,i,i])),r.set((0,M.M)(e,1,-1,o).id,new _([i,-i],[0,i-n,n,i])),r.set((0,M.M)(e,-1,0,o).id,new _([-i,0],[i-n,0,i,i])),r.set((0,M.M)(e,1,0,o).id,new _([i,0],[0,0,n,i])),r.set((0,M.M)(e,-1,1,o).id,new _([-i,i],[i-n,0,i,n])),r.set((0,M.M)(e,0,1,o).id,new _([0,i],[0,0,i,n])),r.set((0,M.M)(e,1,1,o).id,new _([i,i],[0,0,n,n])),r}var k=function(t){(0,f.Z)(r,t);var e=(0,c.Z)(r);function r(){var t;return(0,l.Z)(this,r),(t=e.apply(this,arguments)).type="heatmap",t._tileKeyToFeatureSets=new Map,t}return(0,s.Z)(r,[{key:"initialize",value:function(){this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this))])}},{key:"update",value:function(){var t=(0,u.Z)((0,a.Z)().mark((function t(e,r){var n;return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("heatmap"===(n=r.schema.processors[0]).type){t.next=3;break}return t.abrupt("return");case 3:(0,p.Hg)(this._schema,n)&&(e.mesh=!0,this._schema=n);case 4:case"end":return t.stop()}}),t,this)})));return function(e,r){return t.apply(this,arguments)}}()},{key:"onTileUpdate",value:function(t){var e,r=(0,o.Z)(t.removed);try{for(r.s();!(e=r.n()).done;){var n=e.value;this._tileKeyToFeatureSets.delete(n.key.id)}}catch(i){r.e(i)}finally{r.f()}}},{key:"onTileClear",value:function(t){return this._tileKeyToFeatureSets.delete(t.key.id),this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:t.id,data:{clear:!0}})}},{key:"onTileMessage",value:function(){var t=(0,u.Z)((0,a.Z)().mark((function t(e,r,o){var u,f,c,s,l,d;return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._tileKeyToFeatureSets.has(e.key.id)||this._tileKeyToFeatureSets.set(e.key.id,new Map),(u=this._tileKeyToFeatureSets.get(e.key.id))&&(0,h.pC)(r.addOrUpdate)&&r.addOrUpdate.hasFeatures&&u.set(r.addOrUpdate.instance,r),!r.end){t.next=7;break}return f=[],c=b(e),this._tileKeyToFeatureSets.forEach((function(t,r){if(r===e.key.id)t.forEach((function(t){return(0,h.yw)(t.addOrUpdate,(function(t){return f.push(t)}))}));else if(c.has(r)){var n=c.get(r),o=(0,i.Z)(n.offset,2),a=o[0],u=o[1];t.forEach((function(t){return(0,h.yw)(t.addOrUpdate,(function(t){var e=t.transform(a,u,1,1);f.push(e)}))}))}})),s=(0,v.QM)(f,this._schema.mesh,512,512),l={tileKey:e.key.id,intensityInfo:s},d=[s.matrix],t.abrupt("return",this.remoteClient.invoke("tileRenderer.onTileData",l,(0,n.Z)((0,n.Z)({},o),{},{transferList:d})));case 7:case"end":return t.stop()}}),t,this)})));return function(e,r,n){return t.apply(this,arguments)}}()},{key:"onTileError",value:function(t,e,r){return this.remoteClient.invoke("tileRenderer.onTileError",{tileKey:t.id,error:e},r)}}]),r}(m.Z),Z=k=(0,d._)([(0,y.j)("esri.views.2d.layers.features.processors.HeatmapProcessor")],k)},35092:function(t,e,r){function n(t,e,r,n){var i=t.clone(),o=1<<i.level,a=i.col+e,u=i.row+r;return n&&a<0?(i.col=a+o,i.world-=1):a>=o?(i.col=a-o,i.world+=1):i.col=a,i.row=u,i}r.d(e,{M:function(){return n}})}}]);
//# sourceMappingURL=63220.308f3007.chunk.js.map