/*! For license information please see 60870.f376cf93.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkhub_layout_versioning=self.webpackChunkhub_layout_versioning||[]).push([[60870],{45704:function(t,e,r){r.d(e,{g:function(){return o}});var n=r(84744);function o(t){var e=t&&t.hubApiUrl;return e||function(t){var e;return t.match(/(qaext|\.mapsqa)\.arcgis.com/)?e="https://hubqa.arcgis.com":t.match(/(devext|\.mapsdevext)\.arcgis.com/)?e="https://hubdev.arcgis.com":t.match(/(www|\.maps)\.arcgis.com/)&&(e="https://hub.arcgis.com"),e}((0,n.a)(t))}},80046:function(t,e,r){r.d(e,{a:function(){return o}});var n=r(77843);function o(t,e,r){var o=(0,n._)((0,n._)({params:{}},r),t);return o.params=e.reduce((function(e,r){return(t[r]||"boolean"===typeof t[r])&&(e[r]=t[r]),e}),o.params),["params","httpMethod","rawResponse","authentication","portal","fetch","maxUrlLength","headers"].reduce((function(t,e){return o[e]&&(t[e]=o[e]),t}),{})}},30678:function(t,e,r){function n(t){return"string"!==typeof t||"/"===(t=t.trim())[t.length-1]&&(t=t.slice(0,-1)),t}r.d(e,{c:function(){return n}})},90251:function(t,e,r){r.d(e,{S:function(){return u},g:function(){return s}});var n=r(98825),o=r(80046),i=r(77843);function a(t){console&&console.warn&&console.warn.apply(console,[t])}var u=function(){function t(t){void 0===t&&(t=""),this.termStack=[],this.rangeStack=[],this.openGroups=0,this.q=t}return t.prototype.match=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.termStack=this.termStack.concat(t),this},t.prototype.in=function(t){var e="`in("+(t?'"'+t+'"':"")+")`";return this.hasRange||this.hasTerms?(t&&"*"!==t&&(this.q+=t+":"),this.commit()):(a(e+" was called with no call to `match(...)` or `from(...)`/`to(...)`. Your query was not modified."),this)},t.prototype.startGroup=function(){return this.commit(),this.openGroups>0&&(this.q+=" "),this.openGroups++,this.q+="(",this},t.prototype.endGroup=function(){return this.openGroups<=0?(a("`endGroup(...)` was called without calling `startGroup(...)` first. Your query was not modified."),this):(this.commit(),this.openGroups--,this.q+=")",this)},t.prototype.and=function(){return this.addModifier("and")},t.prototype.or=function(){return this.addModifier("or")},t.prototype.not=function(){return this.addModifier("not")},t.prototype.from=function(t){return this.hasTerms?(a('`from(...)` is not allowed after `match(...)` try using `.from(...).to(...).in(...)`. Optionally, you may see this because dates are incorrectly formatted. Dates should be a primative Date value, aka a number in milliseconds or Date object, ie new Date("2020-01-01").  Your query was not modified.'),this):(this.rangeStack[0]=t,this)},t.prototype.to=function(t){return this.hasTerms?(a('`to(...)` is not allowed after `match(...)` try using `.from(...).to(...).in(...)`. Optionally, you may see this because dates are incorrectly formatted. Dates should be a primative Date value, aka a number in milliseconds or Date object, ie new Date("2020-01-01"). Your query was not modified.'),this):(this.rangeStack[1]=t,this)},t.prototype.boost=function(t){return this.commit(),this.q+="^"+t,this},t.prototype.toParam=function(){return this.commit(),this.cleanup(),this.q},t.prototype.clone=function(){return this.commit(),this.cleanup(),new t(this.q+"")},t.prototype.addModifier=function(t){return this.currentModifer?(a("You have called `"+this.currentModifer+"()` after `"+t+"()`. Your current query was not modified."),this):(this.commit(),""===this.q&&"not"!==t?(a("You have called `"+t+"()` without calling another method to modify your query first. Try calling `match()` first."),this):(this.currentModifer=t,this.q+=""===this.q?"":" ",this.q+=t.toUpperCase()+" ",this))},t.prototype.needsQuotes=function(t){return/\s|:/g.test(t)},t.prototype.formatTerm=function(t){return t instanceof Date?t.getTime():"string"===typeof t&&this.needsQuotes(t)?'"'+t+'"':t},t.prototype.commit=function(){var t=this;return this.currentModifer=void 0,this.hasRange&&(this.q+="["+this.formatTerm(this.rangeStack[0])+" TO "+this.formatTerm(this.rangeStack[1])+"]",this.rangeStack=[void 0,void 0]),this.hasTerms&&(this.q+=this.termStack.map((function(e){return t.formatTerm(e)})).join(" "),this.termStack=[]),this},Object.defineProperty(t.prototype,"hasTerms",{get:function(){return this.termStack.length>0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasRange",{get:function(){return this.rangeStack.length&&this.rangeStack[0]&&this.rangeStack[1]},enumerable:!1,configurable:!0}),t.prototype.cleanup=function(){if(this.openGroups>0)for(a("Automatically closing "+this.openGroups+" group(s). You can use `endGroup(...)` to remove this warning.");this.openGroups>0;)this.q+=")",this.openGroups--;var t=this.q;this.q=t.replace(/( AND ?| NOT ?| OR ?)*$/,""),t!==this.q&&a("`startGroup(...)` was called without calling `endGroup(...)` first. Your query was not modified."),this.q=this.q.replace(/(\(\))*/,"")},t}();function s(t,e){var r,a;switch(r="string"===typeof t||t instanceof u?{httpMethod:"GET",params:{q:t}}:(0,o.a)(t,["q","num","start","sortField","sortOrder","searchUserAccess","searchUserName","filter","countFields","countSize","categories","categoryFilters"],{httpMethod:"GET"}),e){case"item":a="/search";break;case"group":a="/community/groups";break;case"groupContent":if("string"===typeof t||t instanceof u||!t.groupId)return Promise.reject(new Error("you must pass a `groupId` option to `searchGroupContent`"));a="/content/groups/"+t.groupId+"/search";break;default:a="/portals/self/users/search"}var c=(0,n.g)(r)+a;return(0,i.r)(c,r).then((function(r){return r.nextStart&&-1!==r.nextStart&&(r.nextPage=function(){var n;return"string"===typeof t||t instanceof u?n={q:t,start:r.nextStart}:(n=t).start=r.nextStart,s(n,e)}),r}))}},41817:function(t,e,r){r.d(e,{a:function(){return u},g:function(){return a}});var n=r(63613),o=r(98825),i=r(77843);function a(t){return u(null,t)}function u(t,e){var r=t||"self",a=(0,o.g)(e)+"/portals/"+r,u=(0,n._)({httpMethod:"GET"},e);return(0,i.r)(a,u)}},84744:function(t,e,r){r.d(e,{a:function(){return i},g:function(){return o}});var n=r(98825);function o(t){if("string"===typeof t)return t.replace(/\/sharing\/rest\/?$/,"");if("object"===typeof t){var e=t.portalSelf||t,r=e.portalHostname,i=e.urlKey,a=e.customBaseUrl;if(r||i&&a)return e.isPortal?"https://".concat(e.portalHostname):"https://".concat(e.urlKey,".").concat(e.customBaseUrl)}return o((0,n.g)(t))}function i(t){return"".concat(o(t),"/sharing/rest")}},98825:function(t,e,r){r.d(e,{g:function(){return o}});var n=r(30678);function o(t){return void 0===t&&(t={}),t.portal?(0,n.c)(t.portal):t.authentication?t.authentication.portal:"https://www.arcgis.com/sharing/rest"}},60870:function(t,e,r){r.r(e),r.d(e,{hub_event:function(){return v}});var n=r(15671),o=r(43144),i=r(72585),a=r(36106),u=r(98825),s=r(77843),c=r(41817),h=r(91466),l=r(45704),f=r(46825);r(90251),r(80046);function p(t,e){return function(t,e){return(0,h.s)(Object.assign({q:"typekeywords:hubEventsLayer AND orgid:".concat(t)},e)).then((function(t){var e=t;if(e.results&&e.results.length>0){var r;if(1===e.results.length)r=e.results[0];else if(e.results.length>1){var n=e.results.reduce((function(t,e){return e.typeKeywords.includes("View Service")?"public"===e.access?t.public=e:t.org=e:t.admin=e,t}),{});r=n.admin||n.org||n.public}return r}throw Error("No events service found. Events are likely not enabled.")}))}(t,e).then((function(r){var n=(0,l.g)(e),o=r.url.match(/services\/(.*?)\/FeatureServer/);if(o[1])return"".concat(n,"/api/v3/events/").concat(t,"/").concat(o[1],"/FeatureServer/0")}))}function d(t,e,r,n){var o=[],i=[],a=[],u=(new Date).getTime(),s="";if(t.forEach((function(t){var r=t.attributes,a=t.geometry,c=null;if(r.imageAttributes){var h=JSON.parse(r.imageAttributes);h.crop&&(c="".concat(e,"/").concat(r.OBJECTID,"/attachments/").concat(h.crop,"?v=").concat(u),n&&(c+="&token=".concat(n)))}i.push({id:r.OBJECTID,type:"events",imageUrl:c,attributes:r,geometry:a});var l=r.siteId;null!=l&&-1===o.indexOf(l)&&(o.push(l),s+=s.length>0?" OR id:":"id:",s+=l)})),0===o.length)return{included:a,data:i};var c=r;return c.q=s,(0,h.s)(c).then((function(t){return t.results.forEach((function(t){a.push({id:t.id,type:"sites",attributes:{id:t.id,url:t.url}})})),{included:a,data:i}}))}function g(t){return function(t){var e=(0,u.g)(t)+"/community/groups/"+t.id+"/join";return(0,s.r)(e,t)}({id:t.groupId,authentication:t.authentication})}function m(t){return function(t){var e=(0,u.g)(t)+"/community/groups/"+t.id+"/leave";return(0,s.r)(e,t)}({id:t.groupId,authentication:t.authentication})}var v=function(){function t(e){var r=this;(0,n.Z)(this,t),(0,i.r)(this,e),this.orgurl="https://www.arcgis.com",this.callToActionText="Register to Attend",this.loading=!0,this.triggerRegister=function(){return r.session=function(){var t=document.cookie.match("(^|[^;]+)\\s*arcgis_hub_component_auth\\s*=\\s*([^;]+)");return t?t.pop():void 0}(),r.session?r.toggleRegister():a.U.beginOAuth2({clientId:r.clientid,portal:"".concat(r.orgurl,"/sharing/rest"),redirectUri:"".concat(window.location,"authenticate.html")}).then((function(t){return function(t){var e=new Date;e.setTime(e.getTime()+12096e5),document.cookie="arcgis_hub_component_auth=".concat(t.serialize()," ; expires=").concat(e.toUTCString()," path=/")}(t),r.session=t.serialize(),r.toggleRegister()}))},this.toggleRegister=function(){var t=a.U.deserialize(r.session);return r.attending?m({groupId:r.eventGroupId,authentication:t}).then((function(t){return!0===t.success?(r.callToActionText="Attend",r.attending=!1,{success:!0}):{success:!1}})):g({groupId:r.eventGroupId,authentication:t}).then((function(t){if(!0===t.success)return Promise.resolve()})).catch((function(t){if("User is already a member of group."===t.originalMessage)return Promise.resolve();throw t})).then((function(){return r.callToActionText=r.callToActionText,r.attending=!0,{success:!0}}))}}return(0,o.Z)(t,[{key:"componentDidLoad",value:function(){var t=this;(0,c.a)(null,{portal:"".concat(this.orgurl,"/sharing/rest/")}).then((function(e){p(e.id).then((function(e){t.eventServiceUrl=e,function(t){var e=Object.assign({returnGeometry:!0},t);return(0,f.q)(e).then((function(r){return r.features.length<=0?{data:[],included:[]}:e.authentication?e.authentication.getToken(e.url).then((function(n){return d(r.features,e.url,t,n)})):d(r.features,e.url,t)}))}({url:t.eventServiceUrl}).then((function(e){if(e.data.length>0)for(var r=0;r<e.data.length;r++)if(e.data[r].attributes.url===t.slug){var n=e.data[r].attributes;t.eventTitle=n.title,t.eventLocation=n.location,t.eventDate=t.convertDate(n.startDate),t.eventGroupId=n.groupId,t.eventOrganizer=t.contactInfo(n),t.eventUrl="".concat(t.hubUrl(),"/events/").concat(n.url),t.loading=!1;break}}))}))}))}},{key:"convertDate",value:function(t){var e=new Intl.DateTimeFormat("en",{weekday:"long",month:"long",day:"2-digit",year:"numeric"}),r=new Intl.DateTimeFormat("en",{hour:"numeric",minute:"numeric"}),n=new Date(t),o=e.format(n),i=r.format(n);return"".concat(o," @ ").concat(i)}},{key:"contactInfo",value:function(t){if(null!==t.organizers){var e=JSON.parse(t.organizers);if(e.length>0){var r="mailto:".concat(e[0].contact);return"organized by: <a href=".concat(r,">").concat(e[0].name,"</a>")}}return"organized by: ".concat(t.organizerName)}},{key:"description",value:function(){return(0,i.h)("div",null,(0,i.h)("p",null,this.eventDate),(0,i.h)("p",null,this.eventLocation),(0,i.h)("p",{innerHTML:this.eventOrganizer}))}},{key:"hubUrl",value:function(){return this.orgurl.slice().replace("maps","hub")}},{key:"render",value:function(){var t=this.description(),e=this.hubUrl(),r=function(t,e,r){var n=t.closest("[".concat(e,"]"));return n?n.getAttribute(e):r}(this.el,"dir","ltr");return(0,i.h)(i.H,null,(0,i.h)("calcite-card",{dir:r,loading:this.loading,selectable:!1},(0,i.h)("h3",{slot:"title"},(0,i.h)("em",null,"Event"),(0,i.h)("br",null),(0,i.h)("a",{href:"".concat(e,"/events/").concat(this.slug)},this.eventTitle)),(0,i.h)("span",{slot:"subtitle"},t),(0,i.h)("calcite-button",{onClick:this.triggerRegister.bind(this),slot:"footer-leading",width:"full"},this.callToActionText)))}},{key:"el",get:function(){return(0,i.g)(this)}}]),t}();v.style=":host{display:block}a{color:var(--calcite-ui-text-link)}"},46825:function(t,e,r){r.d(e,{g:function(){return u},q:function(){return s}});var n=r(22690),o=r(77843),i=r(30678),a=r(80046);function u(t){var e=(0,i.c)(t.url)+"/"+t.id,r=(0,n.a)({httpMethod:"GET"},t);return(0,o.r)(e,r).then((function(t){return r.rawResponse?t:t.feature}))}function s(t){var e=(0,a.a)(t,["where","objectIds","relationParam","time","distance","units","outFields","geometry","geometryType","spatialRel","returnGeometry","maxAllowableOffset","geometryPrecision","inSR","outSR","gdbVersion","returnDistinctValues","returnIdsOnly","returnCountOnly","returnExtentOnly","orderByFields","groupByFieldsForStatistics","outStatistics","returnZ","returnM","multipatchOption","resultOffset","resultRecordCount","quantizationParameters","returnCentroid","resultType","historicMoment","returnTrueCurves","sqlFormat","returnExceededLimitFeatures","f"],{httpMethod:"GET",params:(0,n.a)({where:"1=1",outFields:"*"},t.params)});return(0,o.r)((0,i.c)(t.url)+"/query",e)}},91466:function(t,e,r){r.d(e,{s:function(){return o}});var n=r(90251);function o(t){return(0,n.g)(t,"item")}},63613:function(t,e,r){r.d(e,{_:function(){return n},a:function(){return o}});var n=function(){return n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n.apply(this,arguments)};function o(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)n[o]=i[a];return n}},22690:function(t,e,r){r.d(e,{_:function(){return o},a:function(){return n}});var n=function(){return n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n.apply(this,arguments)};function o(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}}}]);
//# sourceMappingURL=60870.f376cf93.chunk.js.map