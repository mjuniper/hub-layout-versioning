{"version":3,"file":"static/js/47745.58d72565.chunk.js","mappings":"2mBAIsmEA,GAAEC,EAAAA,EAAAA,KAAQC,EAAC,0CAA8B,aAAa,MAA+N,OAA/N,gBAAC,eAASC,YAAgBC,KAAK,iBAAiB,EAAKC,sBAAsB,EAAE,EAAKC,kBAAkB,QAAQ,EAAKC,mBAAkB,EAAG,EAAKC,mBAAkB,EAAG,EAAKC,4BAA4B,IAAIC,IAAI,EAAKC,aAAa,KAAI,EAAuuM,OAAtuM,0BAAAC,IAAA,WAAe,OAAOC,KAAKC,KAAK,GAAC,qCAAeC,EAAEC,GAAE,WAAC,OAAOD,EAAEE,MAAMJ,KAAKC,MAAMG,KAAKJ,KAAKK,aAAaC,QAAQJ,EAAEK,KAAKJ,GAAGK,MAAM,WAAI,OAACC,EAAAA,EAAAA,IAAE,EAAKR,MAAMC,EAAE,EAAKG,cAAc,EAAKJ,MAAMC,EAAE,EAAKG,aAAaK,UAAU,IAAMP,EAA8B,QAA7B,EAAC,EAAKQ,KAAKC,0BAAkB,aAA5B,EAA8BC,iBAAiB,EAAKR,aAAa,IAAIS,EAAAA,EAAE,CAACH,KAAK,EAAKA,KAAKV,MAAMC,EAAEW,iBAAiBV,IAAI,EAAKY,iBAAiB,IAAI,IAAI,GAAC,yBAAAhB,IAAA,WAAwB,OAAOC,KAAKC,MAAMe,YAAY,GAAC,cAAAjB,IAAA,WAAa,OAAOC,KAAKiB,KAAK,SAAS,EAACC,IAAA,SAAWhB,GAAGF,KAAKmB,KAAK,SAASC,EAAAA,EAAAA,aAAelB,GAAGA,EAAE,KAAK,GAAC,kBAAAH,IAAA,WAAgB,WAAOG,EAAEF,KAAKqB,OAAOlB,EAAEH,KAAKsB,YAAY,IAAGC,EAAAA,EAAAA,IAAErB,KAAIqB,EAAAA,EAAAA,IAAEpB,GAAG,OAAO,KAAK,IAAMqB,EAAExB,KAAKiB,KAAK,cAAc,OAAOM,EAAAA,EAAAA,IAAEC,GAAG,IAAIJ,EAAAA,EAAE,CAACE,YAAYnB,EAAEsB,WAAWvB,EAAEwB,iBAAiB1B,KAAKC,MAAM0B,YAAYC,gBAAgB,SAAA1B,GAAC,OAAE,EAAK2B,iBAAiB3B,EAAE,EAAC4B,aAAa,SAAC5B,EAAEC,GAAC,OAAG,EAAK2B,aAAa5B,EAAEC,EAAE,EAAK4B,SAAS,KAAIP,EAAEC,WAAWvB,EAAEsB,EAAEF,YAAYnB,EAAEqB,EAAE,GAAC,sBAAAzB,IAAA,WAAoB,QAAC,OAAyC,QAAzC,EAAyB,QAAzB,EAAOC,KAAKgC,qBAAa,aAAlB,EAAoBC,sBAAc,QAAE,EAAE,GAAC,0BAAAlC,IAAA,WAAyB,IAAMG,GAAEgC,EAAAA,EAAAA,GAAElC,MAAM,OAAOmC,EAAAA,EAAAA,IAAEjC,GAAGkC,EAAAA,YAAAA,OAASlC,EAAEF,KAAKC,MAAM0B,aAAa,IAAI,GAAC,+BAAA5B,IAAA,WAA8B,IAAIG,EAAEF,KAAKC,MAAMoC,iBAAiBC,UAAU,OAAOC,EAAAA,EAAAA,OAAKvC,KAAKK,aAAamC,SAASxC,KAAKK,aAAaoC,yBAAyBC,OAAO,IAAIxC,EAAEA,EAAEyC,OAAO3C,KAAKK,aAAaoC,2BAA2BvC,EAAEwC,OAAOxC,EAAE0C,MAAM,SAAC1C,EAAEC,GAAC,OAAGD,EAAEC,CAAC,IAAG,IAAI,GAAC,8BAAAJ,IAAA,WAA4B,UAAC,OAAgB,QAAhB,EAAOC,KAAKW,YAAI,OAAiB,QAAjB,EAAT,EAAWkC,uBAAe,OAAc,QAAd,EAA1B,EAA4BC,oBAAY,WAA/B,EAAT,EAA0CC,MAAM,GAAC,iBAAAhD,IAAA,WAAe,QAAC,OAA6C,QAA7C,EAAkC,QAAlC,EAAOC,KAAKgD,8BAAsB,aAA3B,EAA6BC,iBAAS,QAAE,CAAC,GAAC,8BAAAlD,IAAA,WAA4B,MAAC,OAAyD,QAAzD,EAAOC,KAAKgD,uBAAuBE,8BAAsB,QAAE,CAAC,GAAC,+BAAAnD,IAAA,WAA6B,MAAC,OAA0D,QAA1D,EAAOC,KAAKgD,uBAAuBG,+BAAuB,QAAE,CAAC,GAAC,qCAAApD,IAAA,WAAmC,MAAC,OAAgE,QAAhE,EAAOC,KAAKgD,uBAAuBI,qCAA6B,QAAE,CAAC,GAAC,6BAAArD,IAAA,WAA2B,QAAC,OAAyC,QAAzC,EAAuB,QAAvB,EAAOC,KAAKqD,mBAAW,aAAhB,EAAkBC,wBAAgB,QAAE,CAAC,GAAC,mCAAY,WAACtD,KAAKgC,cAAc,IAAIuB,EAAAA,EAAE,CAACC,UAAUxD,OAAOA,KAAKyD,gBAAgBC,KAAK,kBAAI,EAAKzD,MAAM0D,UAAU,IAAG,SAAAzD,GAAC,OAAE,EAAK0D,mBAAmB1D,EAAE,GAAE2D,EAAAA,IAAG7D,KAAKyD,gBAAgBC,KAAK,kBAAI,EAAKzD,MAAM6D,QAAQ,IAAG,SAAA5D,GAAC,OAAE,EAAKuD,gBAAgBM,WAAW,EAAKC,gBAAgB9D,GAAG,GAAE2D,EAAAA,IAAG,IAAM3D,EAAE,WAAD,OAAK,EAAK+D,eAAe,EAACjE,KAAKyD,gBAAgBC,KAAK,kBAAI,EAAKQ,0BAA0B,GAAEhE,GAAGF,KAAKyD,gBAAgBC,KAAK,kBAAI,EAAKrC,MAAM,GAAEnB,GAAGF,KAAKyD,gBAAgBC,KAAK,kBAAI,EAAKS,kBAAkB,GAAEjE,GAAGF,KAAKyD,gBAAgBC,KAAK,kBAAI,EAAKU,uBAAuB,GAAElE,GAAGF,KAAKyD,gBAAgBC,KAAK,kBAAIvB,EAAAA,EAAAA,IAAE,EAAKV,YAAY,EAAKA,WAAW4C,gBAAgB,IAAI,GAAEnE,GAAGF,KAAKyD,gBAAgBC,KAAK,kBAAIvB,EAAAA,EAAAA,IAAE,EAAKV,YAAY,EAAKA,WAAW6C,kBAAkB,IAAI,GAAEpE,GAAGF,KAAKyD,gBAAgBC,KAAK,iBAAI,EAACvB,EAAAA,EAAAA,IAAE,EAAKV,YAAY,EAAKA,WAAW8C,eAAe,MAAKpC,EAAAA,EAAAA,IAAE,EAAKd,QAAQ,EAAKA,OAAOmD,oBAAoB,MAAKrC,EAAAA,EAAAA,IAAE,EAAKlC,MAAMoB,QAAQ,EAAKpB,MAAMoB,OAAOmD,oBAAoB,KAAK,IAAG,kBAAI,EAAKC,uBAAuB,IAAGzE,KAAK0E,QAAQhB,IAAI1D,KAAKC,MAAM0E,GAAG,eAAe,SAAAzE,GAAC,OAAE,EAAKuD,gBAAgBM,WAAW7D,EAAE0E,OAAO,KAAI5E,KAAK0E,QAAQhB,IAAI1D,KAAKC,MAAM0E,GAAG,SAAS,SAAAzE,GAAC,OAAE,EAAK2E,aAAa3E,EAAE,IAAG,GAAC,gCAAUF,KAAKgC,eAAc8C,EAAAA,EAAAA,IAAE9E,KAAKgC,cAAc,GAAC,yCAAmB9B,GAAG,MAAMA,GAAGA,EAAEwC,OAAO,GAAGlB,EAAAA,EAAAA,UAAYxB,KAAK+E,eAAeC,KAAK,qHAAqH,GAAC,oCAAc,IAAM9E,EAAE,CAAC+E,UAAU,CAAC,KAAKC,gBAAe,EAAGC,oBAAoBnF,KAAKW,KAAKyE,kBAAkB,OAAOjD,EAAAA,EAAAA,IAAEnC,KAAKqB,QAAQrB,KAAKqB,OAAOgE,YAAYnF,GAAG,IAAIoF,EAAAA,EAAEpF,EAAE,GAAC,kCAAYA,EAAEC,GAAG,OAAOH,KAAKuF,qBAAqBC,sBAAsBxF,KAAKyF,aAAavF,GAAI,OAADC,QAAC,IAADA,OAAC,EAADA,EAAGuF,OAAO,GAAC,wCAAkBxF,EAAEC,GAAG,OAAOH,KAAKuF,qBAAqBI,qBAAqB3F,KAAKyF,aAAavF,GAAI,OAADC,QAAC,IAADA,OAAC,EAADA,EAAGuF,OAAO,GAAC,oCAAcxF,EAAEC,GAAE,WAAC,OAAOH,KAAKuF,qBAAqBK,aAAa5F,KAAKyF,aAAavF,GAAI,OAADC,QAAC,IAADA,OAAC,EAADA,EAAGuF,QAAQlF,MAAM,SAAAN,GAAI,GAAK,OAADA,QAAC,IAADA,IAAAA,EAAG2F,SAAS,OAAO3F,EAAE,IAA4C,EAAtCC,EAAE,EAAKF,MAAM,UAAeC,EAAE2F,UAAQ,IAAzB,2BAA0B,KAAhBrE,EAAC,QAAeA,EAAEvB,MAAME,EAAEqB,EAAEsE,YAAY3F,CAAC,CAAC,sCAAOD,CAAC,GAAG,GAAC,qCAAeA,EAAEC,GAAG,OAAOH,KAAKuF,qBAAqBQ,mBAAmB/F,KAAKyF,aAAavF,GAAI,OAADC,QAAC,IAADA,OAAC,EAADA,EAAGuF,OAAO,GAAC,2CAAqB,OAAO1F,KAAKF,eAAeE,KAAKF,aAAaE,KAAKgG,sBAAsBhG,KAAKF,YAAY,GAAC,2CAAoB,aAAOI,GAAE+F,EAAAA,EAAAA,IAAEjG,KAAKW,KAAKyE,iBAAiBpF,KAAKW,KAAKuF,uBAAuBlG,KAAKmG,aAAa,OAAO,IAAIC,EAAAA,EAAE,CAAC5C,UAAUxD,KAAKqG,SAASC,EAAAA,GAAAA,qBAAuBC,aAAa,IAAIC,EAAAA,EAAE,CAACC,eAAe,IAAIC,EAAAA,EAAE,CAACC,cAAc3G,KAAKC,MAAM0G,cAAcC,qBAAoD,QAAhC,EAAC5G,KAAKC,MAAM2G,4BAAoB,QAAE,GAAGC,iBAAiB3G,IAAI4G,eAAe,SAAC5G,EAAEC,GAAC,OAAG,EAAK4G,iBAAiB,SAAC5G,EAAEqB,EAAED,GAAC,OAAGrB,EAAE,CAAC8G,GAAG7G,EAAE8G,MAAMzF,EAAE0F,KAAK3F,GAAG,GAAEpB,EAAEgH,EAAAA,EAAAA,qBAAuB,EAACN,iBAAiB3G,EAAEkH,wBAAuBC,EAAAA,EAAAA,IAAErH,KAAKC,OAAOqH,qBAAqBtH,KAAKW,KAAKyE,oBAAoB,GAAC,gCAAUlF,GAAG,IAAMC,EAAEH,KAAKuH,YAAY,GAAGrH,aAAaoF,EAAAA,EAAE,CAAC,MAAsBnF,EAAEqH,aAAdhG,EAAC,EAALN,IAAaK,EAAC,EAARkG,OAAyB,OAAOzH,KAAK0H,eAAexH,GAAGM,MAAM,SAAAN,GAAC,OAAEC,EAAEwH,cAAcnG,EAAEtB,EAAE,IAAGqB,CAAC,CAAC,OAAO,wDAAgBrB,EAAE,GAAC,mDAA6BA,GAAG,OAAO0H,EAAAA,EAAAA,IAAE5H,KAAK6H,yBAAyB3H,EAAE,GAAC,0CAAoBA,GAAG,IAAMsB,EAAE,IAAIrB,EAAAA,EAAE,KAAK,KAAKD,GAAG,OAAOsB,EAAEvB,MAAMD,KAAKC,MAAMuB,EAAEsE,YAAY9F,KAAKC,MAAMuB,CAAC,GAAC,kCAAY,OAAO,4DAAqBxB,KAAKqD,aAAarD,KAAKqD,YAAYyE,gBAAgB,GAAC,mCAAa,IAAM5H,GAAC,0DAAoBC,EAAEH,KAAKoE,wBAAwB,OAAOjC,EAAAA,EAAAA,IAAEhC,IAAID,EAAE6H,MAAM,SAAA7H,GAAC,OAAE8H,EAAAA,EAAAA,IAAE7H,GAAE,EAAGD,EAAE,IAAGF,KAAKmE,oBAAoBnE,KAAK8B,aAAa5B,EAAEF,KAAKmE,mBAAmBnE,KAAK+B,UAAU/B,KAAK8B,aAAa5B,EAAEF,KAAKkE,2BAA2BlE,KAAK+B,WAAUI,EAAAA,EAAAA,IAAEnC,KAAKyB,aAAazB,KAAKyB,WAAWwG,WAAW/H,EAAEF,KAAKW,KAAKX,KAAKqD,YAAY6E,SAASlI,KAAKmG,aAAajG,CAAC,GAAC,mCAAa,OAAO,2DAAoBF,KAAKmI,sBAAqBhG,EAAAA,EAAAA,IAAEnC,KAAKyB,aAAazB,KAAKyB,WAAW2G,WAAUjG,EAAAA,EAAAA,IAAEnC,KAAKK,eAAeL,KAAKK,aAAa+H,QAAQ,GAAC,mCAAalI,GAAG,OAAOF,KAAKqI,iCAAgC9G,EAAAA,EAAAA,IAAErB,GAAGF,KAAKqF,cAAcC,EAAAA,EAAAA,KAAOpF,GAAG,GAAC,gCAAAH,IAAA,WAA8B,aAAC,MAAM,CAACuI,SAAStI,KAAKJ,4BAA4B+B,YAAY3B,KAAKC,MAAM0B,YAAYgF,cAAc3G,KAAKuI,oBAAoBC,YAAY,SAAAtI,GAAC,OAAE,EAAKuI,cAAc,SAAAtI,GAAC,OAAEgC,EAAAA,EAAAA,IAAEhC,GAAGD,EAAEC,EAAEuI,KAAKvI,EAAEwI,YAAY,IAAI,GAAE,EAAC/B,qBAAuD,QAAnC,EAAC5G,KAAK4I,SAAShC,4BAAoB,QAAE,GAAGvG,aAAaL,KAAKK,aAAawI,iBAAiB,SAAA3I,GAAC,OAAE,EAAK2I,iBAAiB3I,EAAE,EAAC4I,iBAAiB,SAAC5I,EAAEC,GAAC,OAAG,EAAK2I,iBAAiB5I,EAAEC,EAAE,EAAC4I,cAAc,kBAAI,EAAKA,eAAe,EAAC,GAAC,mCAAa7I,IAAGqC,EAAAA,EAAAA,QAAKyG,EAAAA,EAAAA,IAAEhJ,KAAK6H,yBAAyB3H,IAAG+I,EAAAA,EAAAA,IAAEjJ,KAAK6H,yBAAyB3H,EAAE,GAAC,yBAAAH,IAAA,WAAwB,IAAMG,EAAEF,KAAKyB,WAAW,OAAOU,EAAAA,EAAAA,IAAEjC,KAAIiC,EAAAA,EAAAA,IAAEjC,EAAEqE,eAAe,GAAC,2CAAqBrE,GAAG,IAAMC,EAAEH,KAAKyB,WAAW,OAAOF,EAAAA,EAAAA,IAAEpB,KAAKH,KAAKW,KAAKyE,kBAAkBjF,EAAE+I,qBAAqBhJ,EAAEF,KAAKW,KAAKyE,iBAAiBpF,KAAKqD,YAAY6E,UAAUiB,EAAAA,GAAAA,WAAaA,EAAAA,GAAAA,MAAQ,KAAC,EAAj/M,EAAeC,EAAAA,EAAAA,IAAEC,EAAAA,EAAAA,IAAEC,EAAAA,EAAAA,IAAEC,EAAAA,EAAAA,GAAEC,EAAAA,QAA49MtJ,EAAAA,EAAAA,GAAE,EAACuJ,EAAAA,EAAAA,OAAKpK,EAAEqK,UAAU,WAAW,OAAMxJ,EAAAA,EAAAA,GAAE,EAACuJ,EAAAA,EAAAA,IAAEE,EAAAA,IAAItK,EAAEqK,UAAU,wBAAmB,IAAQxJ,EAAAA,EAAAA,GAAE,EAACuJ,EAAAA,EAAAA,IAAE,CAAClK,KAAKqK,EAAAA,KAAKvK,EAAEqK,UAAU,SAAS,OAAMxJ,EAAAA,EAAAA,GAAE,EAACuJ,EAAAA,EAAAA,IAAE,CAACI,UAAS,KAAMxK,EAAEqK,UAAU,aAAa,OAAMxJ,EAAAA,EAAAA,GAAE,EAACuJ,EAAAA,EAAAA,IAAEtK,EAAE8C,iBAAiB5C,EAAEqK,UAAU,iBAAiB,OAAMxJ,EAAAA,EAAAA,GAAE,EAACuJ,EAAAA,EAAAA,IAAEtK,EAAE2K,kBAAkBzK,EAAEqK,UAAU,uBAAkB,IAAQxJ,EAAAA,EAAAA,GAAE,EAACuJ,EAAAA,EAAAA,OAAKpK,EAAEqK,UAAU,qBAAgB,IAAQxJ,EAAAA,EAAAA,GAAE,EAACuJ,EAAAA,EAAAA,OAAKpK,EAAEqK,UAAU,qBAAqB,OAAMxJ,EAAAA,EAAAA,GAAE,EAACuJ,EAAAA,EAAAA,OAAKpK,EAAEqK,UAAU,0BAA0B,OAAMxJ,EAAAA,EAAAA,GAAE,EAACuJ,EAAAA,EAAAA,OAAKpK,EAAEqK,UAAU,yBAAyB,OAAMxJ,EAAAA,EAAAA,GAAE,EAACuJ,EAAAA,EAAAA,OAAKpK,EAAEqK,UAAU,YAAY,OAAMxJ,EAAAA,EAAAA,GAAE,EAACuJ,EAAAA,EAAAA,OAAKpK,EAAEqK,UAAU,wBAAwB,MAA0D,IAAMK,EAA1D1K,GAAEa,EAAAA,EAAAA,GAAE,EAAC8J,EAAAA,EAAAA,GAAE,0CAA0C3K,E","sources":["../node_modules/@arcgis/core/views/3d/layers/SceneLayerView3D.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../Graphic.js\";import r from\"../../../core/Logger.js\";import{isNone as i,isSome as s,destroyMaybe as o}from\"../../../core/maybe.js\";import{initial as l}from\"../../../core/reactiveUtils.js\";import{property as n}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import{subclass as a}from\"../../../core/accessorSupport/decorators/subclass.js\";import{WhereClause as u}from\"../../../core/sql/WhereClause.js\";import d from\"../../../layers/support/FeatureFilter.js\";import{getFloorFilterClause as h}from\"../../../layers/support/floorFilterUtils.js\";import p from\"../../../rest/support/Query.js\";import{sceneLayerEditingEnabled as c}from\"../../../support/featureFlags.js\";import{I3SMeshView3D as y}from\"./I3SMeshView3D.js\";import{ForAllFeaturesVisibilityMode as g}from\"./II3SMeshView3D.js\";import{LayerView3D as f}from\"./LayerView3D.js\";import{createInteractiveEditSession as m,processGeometryEdits as _,processAttributeEdits as F}from\"./i3s/attributeEditing.js\";import{createGetFeatureExtent as v}from\"./i3s/I3SGeometryUtil.js\";import{I3SMeshViewFilter as j}from\"./i3s/I3SMeshViewFilter.js\";import{NodeFilterImpact as w}from\"./i3s/I3SNode.js\";import{I3SOverrides as I}from\"./i3s/I3SOverrides.js\";import{I3SQueryEngine as S}from\"./i3s/I3SQueryEngine.js\";import{I3SQueryFeatureAdapter as b}from\"./i3s/I3SQueryFeatureAdapter.js\";import{I3SQueryFeatureStore as E}from\"./i3s/I3SQueryFeatureStore.js\";import{checkRecyclable as C,getIndexCrs as x,objectIdFilter as Q}from\"./i3s/I3SUtil.js\";import{DefinitionExpressionSceneLayerView as O}from\"./support/DefinitionExpressionSceneLayerView.js\";import{defineFieldProperties as q}from\"./support/fieldProperties.js\";import{PopupSceneLayerView as D}from\"./support/PopupSceneLayerView.js\";import{SceneLayerViewRequiredFields as R}from\"./support/SceneLayerViewRequiredFields.js\";import{updatingProgress as H}from\"../support/updatingProperties.js\";import L from\"../../layers/SceneLayerView.js\";import{TaskPriority as A}from\"../../support/Scheduler.js\";const V=q();let U=class extends(y(O(D(f(L))))){constructor(){super(...arguments),this.type=\"scene-layer-3d\",this.progressiveLoadFactor=1,this._elevationContext=\"scene\",this._isIntegratedMesh=!1,this._supportsLabeling=!0,this._interactiveEditingSessions=new Map,this._queryEngine=null}get i3slayer(){return this.layer}tryRecycleWith(e,t){return e.url===this.layer.url&&this.i3sOverrides.isEmpty?e.load(t).then((()=>{C(this.layer,e,this.i3sOverrides),this.layer=e,this.i3sOverrides.destroy();const t=this.view.resourceController?.memoryController;this.i3sOverrides=new I({view:this.view,layer:e,memoryController:t}),this.resetHighlights()})):null}get layerPopupEnabled(){return this.layer.popupEnabled}get filter(){return this._get(\"filter\")}set filter(e){this._set(\"filter\",j.checkSupport(e)?e:null)}get viewFilter(){const e=this.filter,t=this.layerFilter;if(i(e)&&i(t))return null;const r=this._get(\"viewFilter\");return i(r)?new j({layerFilter:t,viewFilter:e,layerFieldsIndex:this.layer.fieldsIndex,loadAsyncModule:e=>this._loadAsyncModule(e),addSqlFilter:(e,t)=>this.addSqlFilter(e,t,this.logError)}):(r.viewFilter=e,r.layerFilter=t,r)}get requiredFields(){return this._fieldsHelper?.requiredFields??[]}get _floorFilterClause(){const e=h(this);return s(e)?u.create(e,this.layer.fieldsIndex):null}get _excludeObjectIdsSorted(){let e=this.layer.excludeObjectIds.toArray();return c()&&this.i3sOverrides.is3DOFL&&this.i3sOverrides.geometryChangedObjectIds.length>0&&(e=e.concat(this.i3sOverrides.geometryChangedObjectIds)),e.length?e.sort(((e,t)=>e-t)):null}get _objectQualitySettings(){return this.view?.qualitySettings?.sceneService?.object}get lodFactor(){return this._objectQualitySettings?.lodFactor??1}get lodCrossfadeinDuration(){return this._objectQualitySettings.lodCrossfadeinDuration??0}get lodCrossfadeoutDuration(){return this._objectQualitySettings.lodCrossfadeoutDuration??0}get lodCrossfadeUncoveredDuration(){return this._objectQualitySettings.lodCrossfadeUncoveredDuration??0}get updatingProgressValue(){return this._controller?.updatingProgress??0}initialize(){this._fieldsHelper=new R({layerView:this}),this.updatingHandles.add((()=>this.layer.rangeInfos),(e=>this._rangeInfosChanged(e)),l),this.updatingHandles.add((()=>this.layer.renderer),(e=>this.updatingHandles.addPromise(this._rendererChange(e))),l);const e=()=>this._filterChange();this.updatingHandles.add((()=>this.parsedDefinitionExpression),e),this.updatingHandles.add((()=>this.filter),e),this.updatingHandles.add((()=>this._floorFilterClause),e),this.updatingHandles.add((()=>this._excludeObjectIdsSorted),e),this.updatingHandles.add((()=>s(this.viewFilter)?this.viewFilter.sortedObjectIds:null),e),this.updatingHandles.add((()=>s(this.viewFilter)?this.viewFilter.parsedWhereClause:null),e),this.updatingHandles.add((()=>[s(this.viewFilter)?this.viewFilter.parsedGeometry:null,s(this.filter)?this.filter.spatialRelationship:null,s(this.layer.filter)?this.layer.filter.spatialRelationship:null]),(()=>this._geometryFilterChange())),this.handles.add(this.layer.on(\"apply-edits\",(e=>this.updatingHandles.addPromise(e.result)))),this.handles.add(this.layer.on(\"edits\",(e=>this._handleEdits(e))))}destroy(){this._fieldsHelper=o(this._fieldsHelper)}_rangeInfosChanged(e){null!=e&&e.length>0&&r.getLogger(this.declaredClass).warn(\"Unsupported property: rangeInfos are currently only serialized to and from web scenes but do not affect rendering.\")}createQuery(){const e={outFields:[\"*\"],returnGeometry:!1,outSpatialReference:this.view.spatialReference};return s(this.filter)?this.filter.createQuery(e):new p(e)}queryExtent(e,t){return this._ensureQueryEngine().executeQueryForExtent(this._ensureQuery(e),t?.signal)}queryFeatureCount(e,t){return this._ensureQueryEngine().executeQueryForCount(this._ensureQuery(e),t?.signal)}queryFeatures(e,t){return this._ensureQueryEngine().executeQuery(this._ensureQuery(e),t?.signal).then((e=>{if(!e?.features)return e;const t=this.layer;for(const r of e.features)r.layer=t,r.sourceLayer=t;return e}))}queryObjectIds(e,t){return this._ensureQueryEngine().executeQueryForIds(this._ensureQuery(e),t?.signal)}_ensureQueryEngine(){return this._queryEngine||(this._queryEngine=this._createQueryEngine()),this._queryEngine}_createQueryEngine(){const e=v(this.view.spatialReference,this.view.renderSpatialReference,this._collection);return new S({layerView:this,priority:A.FEATURE_QUERY_ENGINE,spatialIndex:new E({featureAdapter:new b({objectIdField:this.layer.objectIdField,attributeStorageInfo:this.layer.attributeStorageInfo??[],getFeatureExtent:e}),forAllFeatures:(e,t)=>this._forAllFeatures(((t,r,i)=>e({id:t,index:r,meta:i})),t,g.ALL_IN_CLIPPING_AREA),getFeatureExtent:e,sourceSpatialReference:x(this.layer),viewSpatialReference:this.view.spatialReference})})}highlight(e){const t=this._highlights;if(e instanceof p){const{set:r,handle:i}=t.acquireSet();return this.queryObjectIds(e).then((e=>t.setFeatureIds(r,e))),i}return super.highlight(e)}createInteractiveEditSession(e){return m(this._attributeEditingContext,e)}_createLayerGraphic(e){const r=new t(null,null,e);return r.layer=this.layer,r.sourceLayer=this.layer,r}canResume(){return super.canResume()&&(!this._controller||this._controller.rootNodeVisible)}getFilters(){const e=super.getFilters(),t=this._excludeObjectIdsSorted;return s(t)&&e.push((e=>Q(t,!1,e))),this._floorFilterClause&&this.addSqlFilter(e,this._floorFilterClause,this.logError),this.addSqlFilter(e,this.parsedDefinitionExpression,this.logError),s(this.viewFilter)&&this.viewFilter.addFilters(e,this.view,this._controller.crsIndex,this._collection),e}isUpdating(){return super.isUpdating()||this.layerFilterUpdating||s(this.viewFilter)&&this.viewFilter.updating||s(this.i3sOverrides)&&this.i3sOverrides.updating}_ensureQuery(e){return this._addDefinitionExpressionToQuery(i(e)?this.createQuery():p.from(e))}get _attributeEditingContext(){return{sessions:this._interactiveEditingSessions,fieldsIndex:this.layer.fieldsIndex,objectIdField:this._getObjectIdField(),forEachNode:e=>this._forAllNodes((t=>s(t)?e(t.node,t.featureIds):null)),attributeStorageInfo:this.i3slayer.attributeStorageInfo??[],i3sOverrides:this.i3sOverrides,getAttributeData:e=>this.getAttributeData(e),setAttributeData:(e,t)=>this.setAttributeData(e,t),clearMemCache:()=>this.clearMemCache()}}_handleEdits(e){c()&&_(this._attributeEditingContext,e),F(this._attributeEditingContext,e)}get hasGeometryFilter(){const e=this.viewFilter;return s(e)&&s(e.parsedGeometry)}computeNodeFiltering(e){const t=this.viewFilter;return i(t)||!this.view.spatialReference||t.isMBSGeometryVisible(e,this.view.spatialReference,this._controller.crsIndex)?w.Unmodified:w.Culled}};e([n()],U.prototype,\"i3slayer\",null),e([n(H)],U.prototype,\"updatingProgress\",void 0),e([n({type:d})],U.prototype,\"filter\",null),e([n({readOnly:!0})],U.prototype,\"viewFilter\",null),e([n(V.requiredFields)],U.prototype,\"requiredFields\",null),e([n(V.availableFields)],U.prototype,\"availableFields\",void 0),e([n()],U.prototype,\"_fieldsHelper\",void 0),e([n()],U.prototype,\"_floorFilterClause\",null),e([n()],U.prototype,\"_excludeObjectIdsSorted\",null),e([n()],U.prototype,\"_objectQualitySettings\",null),e([n()],U.prototype,\"lodFactor\",null),e([n()],U.prototype,\"updatingProgressValue\",null),U=e([a(\"esri.views.3d.layers.SceneLayerView3D\")],U);const P=U;export{P as default};\n"],"names":["V","q","U","arguments","type","progressiveLoadFactor","_elevationContext","_isIntegratedMesh","_supportsLabeling","_interactiveEditingSessions","Map","_queryEngine","get","this","layer","e","t","url","i3sOverrides","isEmpty","load","then","C","destroy","view","resourceController","memoryController","I","resetHighlights","popupEnabled","_get","set","_set","j","filter","layerFilter","i","r","viewFilter","layerFieldsIndex","fieldsIndex","loadAsyncModule","_loadAsyncModule","addSqlFilter","logError","_fieldsHelper","requiredFields","h","s","u","excludeObjectIds","toArray","c","is3DOFL","geometryChangedObjectIds","length","concat","sort","qualitySettings","sceneService","object","_objectQualitySettings","lodFactor","lodCrossfadeinDuration","lodCrossfadeoutDuration","lodCrossfadeUncoveredDuration","_controller","updatingProgress","R","layerView","updatingHandles","add","rangeInfos","_rangeInfosChanged","l","renderer","addPromise","_rendererChange","_filterChange","parsedDefinitionExpression","_floorFilterClause","_excludeObjectIdsSorted","sortedObjectIds","parsedWhereClause","parsedGeometry","spatialRelationship","_geometryFilterChange","handles","on","result","_handleEdits","o","declaredClass","warn","outFields","returnGeometry","outSpatialReference","spatialReference","createQuery","p","_ensureQueryEngine","executeQueryForExtent","_ensureQuery","signal","executeQueryForCount","executeQuery","features","sourceLayer","executeQueryForIds","_createQueryEngine","v","renderSpatialReference","_collection","S","priority","A","spatialIndex","E","featureAdapter","b","objectIdField","attributeStorageInfo","getFeatureExtent","forAllFeatures","_forAllFeatures","id","index","meta","g","sourceSpatialReference","x","viewSpatialReference","_highlights","acquireSet","handle","queryObjectIds","setFeatureIds","m","_attributeEditingContext","rootNodeVisible","push","Q","addFilters","crsIndex","layerFilterUpdating","updating","_addDefinitionExpressionToQuery","sessions","_getObjectIdField","forEachNode","_forAllNodes","node","featureIds","i3slayer","getAttributeData","setAttributeData","clearMemCache","_","F","isMBSGeometryVisible","w","y","O","D","f","L","n","prototype","H","d","readOnly","availableFields","P","a"],"sourceRoot":""}