"use strict";(self.webpackChunkhub_layout_versioning=self.webpackChunkhub_layout_versioning||[]).push([[94924,37567],{97879:function(e,t,r){r.d(t,{Z:function(){return u}});var n=r(74165),a=r(15861),i=r(15671),s=r(43144),u=function(){function e(){(0,i.Z)(this,e),this.declaredRootClass="esri.arcade.featureSetCollection",this._layerById={},this._layerByName={}}return(0,s.Z)(e,[{key:"add",value:function(e,t,r){this._layerById[t]=r,this._layerByName[e]=r}},{key:"featureSetByName",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var r=arguments;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!(r.length>1&&void 0!==r[1])||r[1],r.length>2&&void 0!==r[2]?r[2]:["*"],e.abrupt("return",void 0===this._layerByName[t]?null:this._layerByName[t]);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"featureSetById",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var r=arguments;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!(r.length>1&&void 0!==r[1])||r[1],r.length>2&&void 0!==r[2]?r[2]:["*"],e.abrupt("return",void 0===this._layerById[t]?null:this._layerById[t]);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"castToText",value:function(){return"object, FeatureSetCollection"}}]),e}()},31786:function(e,t,r){r.r(t),r.d(t,{constructAssociationMetaDataFeatureSetFromUrl:function(){return he},constructFeatureSet:function(){return se},constructFeatureSetFromPortalItem:function(){return we},constructFeatureSetFromRelationship:function(){return ye},constructFeatureSetFromUrl:function(){return ae},convertToFeatureSet:function(){return ke},createFeatureSetCollectionFromMap:function(){return me},createFeatureSetCollectionFromService:function(){return be},initialiseMetaDataCache:function(){return te}});var n=r(37762),a=r(74165),i=r(1413),s=r(15671),u=r(43144),l=r(60136),o=r(92572),c=r(15861),d=r(76200),f=r(97879),h=r(67820),p=r(52639),y=r(44715),v=r(12829),_=r(89066),g=r(34333),m=r(74066),b=r(82279),k=r(29876),w=r(65247),x=r(869),Z=r(45280),S=r(48562);var F=function(){function e(){(0,s.Z)(this,e),this.field="",this.tofieldname="",this.typeofstat="MIN",this.workingexpr=null}return(0,u.Z)(e,[{key:"clone",value:function(){var t=new e;return t.field=this.field,t.tofieldname=this.tofieldname,t.typeofstat=this.typeofstat,t.workingexpr=this.workingexpr,t}},{key:"toStatisticsName",value:function(){switch(this.typeofstat.toUpperCase()){case"MIN":return"min";case"MAX":return"max";case"SUM":return"sum";case"COUNT":default:return"count";case"VAR":return"var";case"STDDEV":return"stddev";case"AVG":return"avg"}}}],[{key:"parseStatField",value:function(t,r,n){var a=new e;a.field=t;var i=S.WhereClause.create(r,n),s=function(e){if("function"===e.parseTree.type){if(0===e.parseTree.args.value.length)return{name:e.parseTree.name,expr:null};if(e.parseTree.args.value.length>1)throw new Z.eS(Z.f.MissingStatisticParameters);var t=S.WhereClause.create((0,w.XF)(e.parseTree.args.value[0],k.Bj.Standardised,e.parameters),e.fieldsIndex);return{name:e.parseTree.name,expr:t}}return null}(i);if(null===s)throw new Z.eS(Z.f.UnsupportedSqlFunction,{function:""});var u=s.name.toUpperCase().trim();if("MIN"===u){if(a.typeofstat="MIN",a.workingexpr=s.expr,null===i)throw new Z.eS(Z.f.InvalidFunctionParameters,{function:"min"})}else if("MAX"===u){if(a.typeofstat="MAX",a.workingexpr=s.expr,null===i)throw new Z.eS(Z.f.InvalidFunctionParameters,{function:"max"})}else if("COUNT"===u)a.typeofstat="COUNT",a.workingexpr=s.expr;else if("STDEV"===u){if(a.typeofstat="STDDEV",a.workingexpr=s.expr,null===i)throw new Z.eS(Z.f.InvalidFunctionParameters,{function:"stdev"})}else if("SUM"===u){if(a.typeofstat="SUM",a.workingexpr=s.expr,null===i)throw new Z.eS(Z.f.InvalidFunctionParameters,{function:"sum"})}else if("MEAN"===u){if(a.typeofstat="AVG",a.workingexpr=s.expr,null===i)throw new Z.eS(Z.f.InvalidFunctionParameters,{function:u})}else if("AVG"===u){if(a.typeofstat="AVG",a.workingexpr=s.expr,null===i)throw new Z.eS(Z.f.InvalidFunctionParameters,{function:"avg"})}else{if("VAR"!==u)throw new Z.eS(Z.f.UnsupportedSqlFunction,{function:u});if(a.typeofstat="VAR",a.workingexpr=s.expr,null===i)throw new Z.eS(Z.f.InvalidFunctionParameters,{function:"var"})}return a}}]),e}(),I=r(9997),C=r(78952),R=r(83040),D=r(52410);function T(e){if(!e)return"COUNT";switch(e.toLowerCase()){case"max":return"MAX";case"var":case"variance":return"VAR";case"avg":case"average":case"mean":return"AVG";case"min":return"MIN";case"sum":return"SUM";case"stdev":case"stddev":return"STDDEV";case"count":return"COUNT"}return"COUNT"}var N=function(e){(0,l.Z)(r,e);var t=(0,o.Z)(r);function r(e){var n;return(0,s.Z)(this,r),(n=t.call(this,e))._decodedStatsfield=[],n._decodedGroupbyfield=[],n._candosimplegroupby=!0,n.phsyicalgroupbyfields=[],n.objectIdField="ROW__ID",n._internalObjectIdField="ROW__ID",n._adaptedFields=[],n.declaredClass="esri.arcade.featureset.actions.Aggregate",n._uniqueIds=1,n._maxQuery=10,n._maxProcessing=10,n._parent=e.parentfeatureset,n._config=e,n}return(0,u.Z)(r,[{key:"isTable",value:function(){return!0}},{key:"_getSet",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t){var r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this._wset){e.next=5;break}return e.next=3,this._getFilteredSet("",null,null,null,t);case 3:return r=e.sent,e.abrupt("return",(this._wset=r,this._wset));case 5:return e.abrupt("return",this._wset);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_isInFeatureSet",value:function(){return k.dj.InFeatureSet}},{key:"_nextUniqueName",value:function(e){for(;1===e["T"+this._uniqueIds.toString()];)this._uniqueIds++;var t="T"+this._uniqueIds.toString();return e[t]=1,t}},{key:"_convertToEsriFieldType",value:function(e){return e}},{key:"_initialiseFeatureSet",value:function(){var e={},t=!1,r=1,a=this._parent?this._parent.getFieldsIndex():new D.Z([]);for(this.objectIdField="ROW__ID",this.globalIdField="";!1===t;){for(var i=!1,s=0;s<this._config.groupbyfields.length;s++)if(this._config.groupbyfields[s].name.toLowerCase()===this.objectIdField.toLowerCase()){i=!0;break}if(!1===i)for(var u=0;u<this._config.statsfields.length;u++)if(this._config.statsfields[u].name.toLowerCase()===this.objectIdField.toLowerCase()){i=!0;break}!1===i?t=!0:(this.objectIdField="ROW__ID"+r.toString(),r++)}var l,o=(0,n.Z)(this._config.statsfields);try{for(o.s();!(l=o.n()).done;){var c=l.value,d=new F;d.field=c.name,d.tofieldname=c.name,d.workingexpr=c.expression instanceof S.WhereClause?c.expression:S.WhereClause.create(c.expression,a),d.typeofstat=T(c.statistic),this._decodedStatsfield.push(d)}}catch(z){o.e(z)}finally{o.f()}this._decodedGroupbyfield=[];var f,h=(0,n.Z)(this._config.groupbyfields);try{for(h.s();!(f=h.n()).done;){var p=f.value,y={name:p.name,singlefield:null,tofieldname:p.name,expression:p.expression instanceof S.WhereClause?p.expression:S.WhereClause.create(p.expression,a)};this._decodedGroupbyfield.push(y)}}catch(z){h.e(z)}finally{h.f()}if(null!==this._parent){this.geometryType=this._parent.geometryType,this.spatialReference=this._parent.spatialReference,this.hasM=this._parent.hasM,this.hasZ=this._parent.hasZ,this.typeIdField="";var _,g=(0,n.Z)(this._parent.fields);try{for(g.s();!(_=g.n()).done;){e[_.value.name.toUpperCase()]=1}}catch(z){g.e(z)}finally{g.f()}this.types=null}else this.geometryType=k.Qk.point,this.typeIdField="",this.types=null,this.spatialReference=new C.Z({wkid:4326});this.fields=[];var m=new F;m.field=this._nextUniqueName(e),m.tofieldname=this.objectIdField,m.workingexpr=S.WhereClause.create(this._parent.objectIdField,this._parent.getFieldsIndex()),m.typeofstat="MIN",this._decodedStatsfield.push(m);var b,x=(0,n.Z)(this._decodedGroupbyfield);try{for(x.s();!(b=x.n()).done;){var I=b.value,N=new R.Z;if(I.name=this._nextUniqueName(e),N.name=I.tofieldname,N.alias=N.name,(0,w.y5)(I.expression)){var E=this._parent.getField((0,w.zR)(I.expression,k.Bj.Standardised));if(!E)throw new Z.EN(Z.H9.AggregationFieldNotFound);I.name=E.name,I.singlefield=E.name,this.phsyicalgroupbyfields.push(E.name),N.type=E.type}else{N.type=this._convertToEsriFieldType((0,w.DT)(I.expression,this._parent.fields));var L=new R.Z;L.name=I.name,L.alias=L.name,this.phsyicalgroupbyfields.push(I.name),this._adaptedFields.push(new v.yN(L,I.expression)),this._candosimplegroupby=!1}this.fields.push(N)}}catch(z){x.e(z)}finally{x.f()}if(this._adaptedFields.length>0){var O,A=(0,n.Z)(this._parent.fields);try{for(A.s();!(O=A.n()).done;){var j=O.value;this._adaptedFields.push(new v.$X(j))}}catch(z){A.e(z)}finally{A.f()}}for(var P=0;P<this._decodedStatsfield.length;P++){var q=new R.Z,G=null,B=this._decodedStatsfield[P];B.field=this._nextUniqueName(e),B.tofieldname===this.objectIdField&&(this._internalObjectIdField=B.field),q.name=B.tofieldname,q.alias=q.name;var U=null!==B.workingexpr&&(0,w.y5)(B.workingexpr)?(0,w.zR)(B.workingexpr,k.Bj.Standardised):"";switch(this._decodedStatsfield[P].typeofstat){case"SUM":if(""!==U){if(!(G=this._parent.getField(U)))throw new Z.EN(Z.H9.AggregationFieldNotFound);q.type=G.type}else q.type="double";break;case"MIN":case"MAX":if(""!==U){if(!(G=this._parent.getField(U)))throw new Z.EN(Z.H9.AggregationFieldNotFound);q.type=G.type}else q.type="double";break;case"COUNT":q.type="integer";break;case"STDDEV":case"VAR":case"AVG":if(""!==U&&!(G=this._parent.getField(U)))throw new Z.EN(Z.H9.AggregationFieldNotFound);q.type="double"}this.fields.push(q)}}},{key:"_canDoAggregates",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"_getFeatures",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t,r,n,i){var s;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(-1!==r&&this._featureCache[r],s=this._maxQuery,!0!==this._checkIfNeedToExpandKnownPage(t,s)){e.next=8;break}return e.next=5,this._expandPagedSet(t,s,0,0,i);case 5:e.t0=this._getFeatures(t,r,n,i),e.next=9;break;case 8:e.t0="success";case 9:return e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a){return e.apply(this,arguments)}}()},{key:"_getFilteredSet",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t,r,i,s,u){var l,o,c,d,f,p,y,g,k,x,Z,S,F;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===t){e.next=2;break}return e.abrupt("return",new m.Z([],[],!0,null));case 2:return l=null,o={ordered:!1,nowhereclause:!1},e.next=6,this._ensureLoaded();case 6:if(null===i){e.next=15;break}c=0;case 8:if(!(c<this._decodedStatsfield.length)){e.next=15;break}if(!0!==(0,w.hq)(i,this._decodedStatsfield[c].tofieldname)){e.next=12;break}return o.nowhereclause=!0,i=null,e.abrupt("break",15);case 12:c++,e.next=8;break;case 15:if(null===s){e.next=44;break}o.ordered=!0,d=0;case 18:if(!(d<this._decodedStatsfield.length)){e.next=25;break}if(!0!==s.scanForField(this._decodedStatsfield[d].tofieldname)){e.next=22;break}return s=null,o.ordered=!1,e.abrupt("break",25);case 22:d++,e.next=18;break;case 25:if(null===s){e.next=44;break}f=(0,n.Z)(this._decodedGroupbyfield),e.prev=27,f.s();case 29:if((p=f.n()).done){e.next=36;break}if(null!==(y=p.value).singlefield||!0!==s.scanForField(y.tofieldname)){e.next=34;break}return s=null,o.ordered=!1,e.abrupt("break",36);case 34:e.next=29;break;case 36:e.next=41;break;case 38:e.prev=38,e.t0=e.catch(27),f.e(e.t0);case 41:return e.prev=41,f.f(),e.finish(41);case 44:if(e.t1=!1!==this._candosimplegroupby,!e.t1){e.next=49;break}return e.next=48,this._parent._canDoAggregates(this.phsyicalgroupbyfields,this._decodedStatsfield,"",null,null);case 48:e.t1=e.sent;case 49:if(!e.t1){e.next=58;break}return g=null,i&&(g=this._reformulateWhereClauseWithoutGroupByFields(i)),k=null,s&&(k=this._reformulateOrderClauseWithoutGroupByFields(s)),e.next=56,this._parent._getAggregatePagesDataSourceDefinition(this.phsyicalgroupbyfields,this._decodedStatsfield,"",null,g,k,this._internalObjectIdField);case 56:return x=e.sent,e.abrupt("return",(this._checkCancelled(u),l=!0===o.nowhereclause?new m.Z(x._candidates.slice(0).concat(x._known.slice(0)),[],!0===o.ordered&&x._ordered,this._clonePageDefinition(x.pagesDefinition)):new m.Z(x._candidates.slice(0),x._known.slice(0),!0===o.ordered&&x._ordered,this._clonePageDefinition(x.pagesDefinition))));case 58:return Z=this._parent,this._adaptedFields.length>0&&(Z=new v.Xx({parentfeatureset:this._parent,adaptedFields:this._adaptedFields,extraFilter:null})),!0===o.nowhereclause?l=new m.Z(["GETPAGES"],[],!1,{aggregatefeaturesetpagedefinition:!0,resultOffset:0,resultRecordCount:this._maxQuery,internal:{fullyResolved:!1,workingItem:null,type:"manual",iterator:null,set:[],subfeatureset:new _.Z({parentfeatureset:Z,orderbyclause:new b.Z(this.phsyicalgroupbyfields.join(",")+","+this._parent.objectIdField+" ASC")})}}):(S=Z,null!==i&&(F=null,i&&(F=this._reformulateWhereClauseWithoutGroupByFields(i)),S=new h.Z({parentfeatureset:S,whereclause:F})),l=new m.Z(["GETPAGES"],[],!1,{aggregatefeaturesetpagedefinition:!0,resultOffset:0,resultRecordCount:this._maxQuery,internal:{fullyResolved:!1,workingItem:null,type:"manual",iterator:null,set:[],subfeatureset:new _.Z({parentfeatureset:S,orderbyclause:new b.Z(this.phsyicalgroupbyfields.join(",")+","+this._parent.objectIdField+" ASC")})}})),e.abrupt("return",l);case 61:case"end":return e.stop()}}),e,this,[[27,38,41,44]])})));return function(t,r,n,a,i){return e.apply(this,arguments)}}()},{key:"_reformulateWhereClauseWithoutStatsFields",value:function(e){var t,r=(0,n.Z)(this._decodedStatsfield);try{for(r.s();!(t=r.n()).done;){var a=t.value;e=(0,w.bB)(e,a.tofieldname,(0,w.zR)(a.workingexpr,k.Bj.Standardised),this._parent.getFieldsIndex())}}catch(i){r.e(i)}finally{r.f()}return e}},{key:"_reformulateWhereClauseWithoutGroupByFields",value:function(e){var t,r=(0,n.Z)(this._decodedGroupbyfield);try{for(r.s();!(t=r.n()).done;){var a=t.value;a.tofieldname!==a.name&&(e=(0,w.bB)(e,a.tofieldname,(0,w.zR)(a.expression,k.Bj.Standardised),this._parent.getFieldsIndex()))}}catch(i){r.e(i)}finally{r.f()}return e}},{key:"_reformulateOrderClauseWithoutGroupByFields",value:function(e){var t,r=[],a=(0,n.Z)(this._decodedGroupbyfield);try{for(a.s();!(t=a.n()).done;){var i=t.value;i.tofieldname!==i.name&&r.push({field:i.tofieldname,newfield:i.name})}}catch(s){a.e(s)}finally{a.f()}return r.length>0?e.replaceFields(r):e}},{key:"_clonePageDefinition",value:function(e){return null===e?null:!0===e.aggregatefeaturesetpagedefinition?{aggregatefeaturesetpagedefinition:!0,resultRecordCount:e.resultRecordCount,resultOffset:e.resultOffset,internal:e.internal}:this._parent._clonePageDefinition(e)}},{key:"_refineSetBlock",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t,r,n){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==this._checkIfNeedToExpandCandidatePage(t,this._maxQuery)){e.next=4;break}return e.next=3,this._expandPagedSet(t,this._maxQuery,0,0,n);case 3:return e.abrupt("return",this._refineSetBlock(t,r,n));case 4:return this._checkCancelled(n),t._candidates.length,this._refineKnowns(t,r),t._candidates.length,e.abrupt("return",(t._candidates.length,t));case 9:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_expandPagedSet",value:function(e,t,r,n,a){return this._expandPagedSetFeatureSet(e,t,r,n,a)}},{key:"_getPhysicalPage",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t,r,i){var s,u,l,o,c,d,f,h,y,v,_;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==t.pagesDefinition.aggregatefeaturesetpagedefinition){e.next=2;break}return e.abrupt("return",this._sequentialGetPhysicalItem(t,t.pagesDefinition.resultRecordCount,i,[]));case 2:return e.next=4,this._getAgregagtePhysicalPage(t,r,i);case 4:s=e.sent,u=(0,n.Z)(s);try{for(u.s();!(l=u.n()).done;){o=l.value,c={geometry:o.geometry,attributes:{}},d=(0,n.Z)(this._decodedGroupbyfield);try{for(d.s();!(f=d.n()).done;)h=f.value,c.attributes[h.tofieldname]=o.attributes[h.name]}catch(a){d.e(a)}finally{d.f()}y=(0,n.Z)(this._decodedStatsfield);try{for(y.s();!(v=y.n()).done;)_=v.value,c.attributes[_.tofieldname]=o.attributes[_.field]}catch(a){y.e(a)}finally{y.f()}this._featureCache[c.attributes[this.objectIdField]]=new p.Z(c)}}catch(a){u.e(a)}finally{u.f()}return e.abrupt("return",s.length);case 8:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_sequentialGetPhysicalItem",value:function(e,t,r,n){var a=this;return new Promise((function(i,s){null===e.pagesDefinition.internal.iterator&&(e.pagesDefinition.internal.iterator=e.pagesDefinition.internal.subfeatureset.iterator(r)),!0===e.pagesDefinition.internal.fullyResolved||0===t?i(n.length):a._nextAggregateItem(e,t,r,n,(function(s){null===s?i(n.length):(t-=1,i(a._sequentialGetPhysicalItem(e,t,r,n)))}),s)}))}},{key:"_nextAggregateItem",value:function(e,t,r,n,a,i){var s=this;try{(0,y.W)(e.pagesDefinition.internal.iterator.next()).then((function(u){if(null===u)if(null!==e.pagesDefinition.internal.workingItem){var l=s._calculateAndAppendAggregateItem(e.pagesDefinition.internal.workingItem);n.push(l),e.pagesDefinition.internal.workingItem=null,e.pagesDefinition.internal.set.push(l.attributes[s.objectIdField]),e.pagesDefinition.internal.fullyResolved=!0,a(null)}else e.pagesDefinition.internal.fullyResolved=!0,a(null);else{var o=s._generateAggregateHash(u);if(null===e.pagesDefinition.internal.workingItem)e.pagesDefinition.internal.workingItem={features:[u],id:o};else{if(o!==e.pagesDefinition.internal.workingItem.id){var c=s._calculateAndAppendAggregateItem(e.pagesDefinition.internal.workingItem);return n.push(c),e.pagesDefinition.internal.workingItem=null,e.pagesDefinition.internal.set.push(c.attributes[s.objectIdField]),t-=1,e.pagesDefinition.internal.workingItem={features:[u],id:o},void a(c)}e.pagesDefinition.internal.workingItem.features.push(u)}s._nextAggregateItem(e,t,r,n,a,i)}}),i)}catch(u){i(u)}}},{key:"_calculateFieldStat",value:function(e,t,r){for(var n=[],a=0;a<e.features.length;a++)if(null!==t.workingexpr){var i=t.workingexpr.calculateValue(e.features[a]);null!==i&&n.push(i)}else n.push(null);switch(t.typeofstat){case"MIN":r.attributes[t.tofieldname]=(0,x.tj)("min",n,-1);break;case"MAX":r.attributes[t.tofieldname]=(0,x.tj)("max",n,-1);break;case"SUM":r.attributes[t.tofieldname]=(0,x.tj)("sum",n,-1);break;case"COUNT":r.attributes[t.tofieldname]=n.length;break;case"VAR":r.attributes[t.tofieldname]=(0,x.tj)("var",n,-1);break;case"STDDEV":r.attributes[t.tofieldname]=(0,x.tj)("stddev",n,-1);break;case"AVG":r.attributes[t.tofieldname]=(0,x.tj)("avg",n,-1)}return!0}},{key:"_calculateAndAppendAggregateItem",value:function(e){var t,r={attributes:{},geometry:null},a=(0,n.Z)(this._decodedGroupbyfield);try{for(a.s();!(t=a.n()).done;){var i=t.value,s=i.singlefield?e.features[0].attributes[i.singlefield]:i.expression.calculateValue(e.features[0]);r.attributes[i.tofieldname]=s}}catch(f){a.e(f)}finally{a.f()}var u,l=(0,n.Z)(this._decodedStatsfield);try{for(l.s();!(u=l.n()).done;){var o=u.value;this._calculateFieldStat(e,o,r)}}catch(f){l.e(f)}finally{l.f()}for(var c=[],d=0;d<this._decodedStatsfield.length;d++)c.push(this._calculateFieldStat(e,this._decodedStatsfield[d],r));return this._featureCache[r.attributes[this.objectIdField]]=new p.Z({attributes:r.attributes,geometry:r.geometry}),r}},{key:"_generateAggregateHash",value:function(e){var t,r="",a=(0,n.Z)(this._decodedGroupbyfield);try{for(a.s();!(t=a.n()).done;){var i=t.value,s=i.singlefield?e.attributes[i.singlefield]:i.expression.calculateValue(e);r+=null==s?":":":"+s.toString()}}catch(u){a.e(u)}finally{a.f()}return(0,I.F)(r,I.M.String)}},{key:"_stat",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{calculated:!1});case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getFeatureByObjectId",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}],[{key:"registerAction",value:function(){g.Z._featuresetFunctions.groupby=function(e,t){return new r({parentfeatureset:this,groupbyfields:e,statsfields:t})}}}]),r}(g.Z),E=r(28113),L=r(45184),O=r(19191),A=r(19545),j=r(77981),P=r(64326),q=r(83406),G=(r(10064),r(93169),r(32718),r(64020),r(77946)),B=(r(42265),r(63780),r(35995),r(68860),r(92975),r(5192)),U=r(49818),z=r(21149),M=(r(11812),r(99837),r(34211)),W=(r(59486),r(24246)),V=r(99086),Q=(r(91340),r(54307),r(70436)),J=r(33997),H=r(62357),K=function(e){(0,l.Z)(r,e);var t=(0,o.Z)(r);function r(e){var n;return(0,s.Z)(this,r),(n=t.call(this,e)).declaredClass="esri.arcade.featureset.sources.FeatureLayerDynamic",n._removeGeometry=!1,n._overrideFields=null,n.formulaCredential=null,n._pageJustIds=!1,n._requestStandardised=!1,n._useDefinitionExpression=!0,n._cachedDateMetaData={},e.spatialReference&&(n.spatialReference=e.spatialReference),n._transparent=!0,n._maxProcessing=1e3,n._layer=e.layer,n._wset=null,void 0!==e.outFields&&(n._overrideFields=e.outFields),void 0!==e.includeGeometry&&(n._removeGeometry=!1===e.includeGeometry),n}return(0,u.Z)(r,[{key:"_maxQueryRate",value:function(){return k.tI}},{key:"end",value:function(){return this._layer}},{key:"optimisePagingFeatureQueries",value:function(e){this._pageJustIds=e}},{key:"urlQueryPath",get:function(){return this._layer.parsedUrl.path||""}},{key:"convertQueryToLruCacheKey",value:function(e){var t=this.urlQueryPath+","+(0,k.hd)(e.toJSON());return(0,I.F)(t,I.M.String)}},{key:"loadImpl",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==this._layer.loaded){e.next=4;break}e.t0=(this._initialiseFeatureSet(),this),e.next=8;break;case 4:return e.next=6,this._layer.load();case 6:this._initialiseFeatureSet(),e.t0=this;case 8:return e.abrupt("return",e.t0);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_initialiseFeatureSet",value:function(){var e;if(null==this.spatialReference&&(this.spatialReference=this._layer.spatialReference),this.geometryType=this._layer.geometryType,this.fields=this._layer.fields.slice(0),this._layer.outFields)if(1===this._layer.outFields.length&&"*"===this._layer.outFields[0]);else{var t,r=[],a=(0,n.Z)(this.fields);try{for(a.s();!(t=a.n()).done;){var i=t.value;if("oid"===i.type)r.push(i);else{var s,u=(0,n.Z)(this._layer.outFields);try{for(u.s();!(s=u.n()).done;){if(s.value.toLowerCase()===i.name.toLowerCase()){r.push(i);break}}}catch(m){u.e(m)}finally{u.f()}}}}catch(m){a.e(m)}finally{a.f()}this.fields=r}if(null!==this._overrideFields)if(1===this._overrideFields.length&&"*"===this._overrideFields[0])this._overrideFields=null;else{var l,o=[],c=[],d=(0,n.Z)(this.fields);try{for(d.s();!(l=d.n()).done;){var f=l.value;if("oid"===f.type)o.push(f),c.push(f.name);else{var h,p=(0,n.Z)(this._overrideFields);try{for(p.s();!(h=p.n()).done;){if(h.value.toLowerCase()===f.name.toLowerCase()){o.push(f),c.push(f.name);break}}}catch(m){p.e(m)}finally{p.f()}}}}catch(m){d.e(m)}finally{d.f()}this.fields=o,this._overrideFields=c}if(this._layer.source&&this._layer.source.sourceJSON){var y=this._layer.source.sourceJSON.currentVersion;!0===this._layer.source.sourceJSON.useStandardizedQueries?(this._databaseType=k.Bj.StandardisedNoInterval,null!=y&&y>=10.61&&(this._databaseType=k.Bj.Standardised)):null!=y&&(y>=10.5&&(this._databaseType=k.Bj.StandardisedNoInterval,this._requestStandardised=!0),y>=10.61&&(this._databaseType=k.Bj.Standardised))}this.objectIdField=this._layer.objectIdField;var v,_=(0,n.Z)(this.fields);try{for(_.s();!(v=_.n()).done;){var g=v.value;"global-id"===g.type&&(this.globalIdField=g.name)}}catch(m){_.e(m)}finally{_.f()}this.hasM=this._layer.supportsM,this.hasZ=this._layer.supportsZ,this.typeIdField=null!==(e=this._layer.typeIdField)&&void 0!==e?e:"",this.types=this._layer.types}},{key:"_isInFeatureSet",value:function(){return k.dj.InFeatureSet}},{key:"_refineSetBlock",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"_candidateIdTransform",value:function(e){return e}},{key:"_getSet",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t){var r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this._wset){e.next=7;break}return e.next=3,this._ensureLoaded();case 3:return e.next=5,this._getFilteredSet("",null,null,null,t);case 5:return r=e.sent,e.abrupt("return",(this._wset=r,r));case 7:return e.abrupt("return",this._wset);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_runDatabaseProbe",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t){var r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ensureLoaded();case 2:return r=new z.Z,this.datesInUnknownTimezone&&(r.timeReferenceUnknownClient=!0),r.where=t.replace("OBJECTID",this._layer.objectIdField),e.prev=4,e.next=7,this._layer.queryObjectIds(r);case 7:return e.abrupt("return",!0);case 10:return e.prev=10,e.t0=e.catch(4),e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,this,[[4,10]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_canUsePagination",value:function(){return!(!this._layer.capabilities||!this._layer.capabilities.query||!0!==this._layer.capabilities.query.supportsPagination)}},{key:"_cacheableFeatureSetSourceKey",value:function(){return this._layer.url}},{key:"pbfSupportedForQuery",value:function(e){var t,r,n=null===(t=this._layer)||void 0===t||null===(r=t.capabilities)||void 0===r?void 0:r.query;return!e.outStatistics&&!0===(null===n||void 0===n?void 0:n.supportsFormatPBF)&&!0===(null===n||void 0===n?void 0:n.supportsQuantizationEditMode)}},{key:"queryPBF",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t){var r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.quantizationParameters={mode:"edit"},e.next=3,(0,B.qp)(this._layer.parsedUrl,t,new Q.J({}));case 3:return r=e.sent,e.abrupt("return",U.Z.fromJSON((0,q.cn)(r.data)).unquantize());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"gdbVersion",get:function(){return this._layer&&this._layer.capabilities&&this._layer.capabilities.data&&this._layer.capabilities.data.isVersioned?this._layer.gdbVersion?this._layer.gdbVersion:"SDE.DEFAULT":""}},{key:"nativeCapabilities",value:function(){var e;return{title:null!==(e=this._layer.title)&&void 0!==e?e:"",source:this,canQueryRelated:!0,capabilities:this._layer.capabilities,databaseType:this._databaseType,requestStandardised:this._requestStandardised}}},{key:"executeQuery",value:function(e,t){var r=this,n="execute"===t?G.e:"executeForCount"===t?M.P:W.G,a="execute"===t&&this.pbfSupportedForQuery(e),i=null;if(this.recentlyUsedQueries){var s=this.convertQueryToLruCacheKey(e);null===(i=this.recentlyUsedQueries.getFromCache(s))&&(i=!0!==a?n(this._layer.parsedUrl.path,e):this.queryPBF(e),this.recentlyUsedQueries.addToCache(s,i),i=i.catch((function(e){var t;throw null!==(t=r.recentlyUsedQueries)&&void 0!==t&&t.removeFromCache(s),e})))}return this.featureSetQueryInterceptor&&this.featureSetQueryInterceptor.preLayerQueryCallback({layer:this._layer,query:e,method:t}),null===i&&(i=!0!==a?n(this._layer.parsedUrl.path,e):this.queryPBF(e)),i}},{key:"_getFilteredSet",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t,r,n,i,s){var u,l,o,c,d;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.databaseType();case 2:if(u=e.sent,!this.isTable()||!r||null===t||""===t){e.next=5;break}return e.abrupt("return",new m.Z([],[],!0,null));case 5:if(!this._canUsePagination()){e.next=7;break}return e.abrupt("return",this._getFilteredSetUsingPaging(t,r,n,i,s));case 7:return l="",o=!1,null!==i&&this._layer.capabilities&&this._layer.capabilities.query&&!0===this._layer.capabilities.query.supportsOrderBy&&(l=i.constructClause(),o=!0),c=new z.Z,this.datesInUnknownTimezone&&(c.timeReferenceUnknownClient=!0),c.where=null===n?null===r?"1=1":"":(0,w.zR)(n,u),this._requestStandardised&&(c.sqlFormat="standard"),c.spatialRelationship=this._makeRelationshipEnum(t),c.outSpatialReference=this.spatialReference,c.orderByFields=""!==l?l.split(","):null,c.geometry=null===r?null:r,c.relationParameter=this._makeRelationshipParam(t),e.next=13,this.executeQuery(c,"executeForIds");case 13:return null===(d=e.sent)&&(d=[]),this._checkCancelled(s),e.abrupt("return",new m.Z([],d,o,null));case 16:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a,i){return e.apply(this,arguments)}}()},{key:"_expandPagedSet",value:function(e,t,r,n,a){return this._expandPagedSetFeatureSet(e,t,r,n,a)}},{key:"_getFilteredSetUsingPaging",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t,r,n,i,s){var u,l,o,c,d,f,h,p,y,v;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l="",o=!1,null!==i&&this._layer.capabilities&&this._layer.capabilities.query&&!0===this._layer.capabilities.query.supportsOrderBy&&(l=i.constructClause(),o=!0),e.next=4,this.databaseType();case 4:return c=e.sent,d=null===n?null===r?"1=1":"":(0,w.zR)(n,c),this._layer.definitionExpression&&this._useDefinitionExpression&&(d=""!==d?"(("+this._layer.definitionExpression+") AND ("+d+"))":this._layer.definitionExpression),f=this._maxQueryRate(),null!=(h=null===(u=this._layer.capabilities)||void 0===u?void 0:u.query.maxRecordCount)&&h<f&&(f=h),p=null,!0===this._pageJustIds?p=new m.Z([],["GETPAGES"],o,{spatialRel:this._makeRelationshipEnum(t),relationParam:this._makeRelationshipParam(t),outFields:this._layer.objectIdField,resultRecordCount:f,resultOffset:0,geometry:null===r?null:r,where:d,orderByFields:l,returnGeometry:!1,returnIdsOnly:"false",internal:{set:[],lastRetrieved:0,lastPage:0,fullyResolved:!1}}):(y=!0,!0===this._removeGeometry&&(y=!1),v=null!==this._overrideFields?this._overrideFields:this._fieldsIncludingObjectId(this._layer.outFields?this._layer.outFields:["*"]),p=new m.Z([],["GETPAGES"],o,{spatialRel:this._makeRelationshipEnum(t),relationParam:this._makeRelationshipParam(t),outFields:v.join(","),resultRecordCount:f,resultOffset:0,geometry:null===r?null:r,where:d,orderByFields:l,returnGeometry:y,returnIdsOnly:"false",internal:{set:[],lastRetrieved:0,lastPage:0,fullyResolved:!1}})),e.next=14,this._expandPagedSet(p,f,0,1,s);case 14:return e.abrupt("return",p);case 15:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a,i){return e.apply(this,arguments)}}()},{key:"_clonePageDefinition",value:function(e){return null===e?null:!0!==e.groupbypage?{groupbypage:!1,spatialRel:e.spatialRel,relationParam:e.relationParam,outFields:e.outFields,resultRecordCount:e.resultRecordCount,resultOffset:e.resultOffset,geometry:e.geometry,where:e.where,orderByFields:e.orderByFields,returnGeometry:e.returnGeometry,returnIdsOnly:e.returnIdsOnly,internal:e.internal}:{groupbypage:!0,spatialRel:e.spatialRel,relationParam:e.relationParam,outFields:e.outFields,resultRecordCount:e.resultRecordCount,useOIDpagination:e.useOIDpagination,generatedOid:e.generatedOid,groupByFieldsForStatistics:e.groupByFieldsForStatistics,resultOffset:e.resultOffset,outStatistics:e.outStatistics,geometry:e.geometry,where:e.where,orderByFields:e.orderByFields,returnGeometry:e.returnGeometry,returnIdsOnly:e.returnIdsOnly,internal:e.internal}}},{key:"_getPhysicalPage",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t,r,n){var i,s,u,l,o,c,d,f;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.pagesDefinition.internal.lastRetrieved,s=i,u=t.pagesDefinition.internal.lastPage,l=new z.Z,this._requestStandardised&&(l.sqlFormat="standard"),this.datesInUnknownTimezone&&(l.timeReferenceUnknownClient=!0),l.spatialRelationship=t.pagesDefinition.spatialRel,l.relationParameter=t.pagesDefinition.relationParam,l.outFields=t.pagesDefinition.outFields.split(","),l.num=t.pagesDefinition.resultRecordCount,l.start=t.pagesDefinition.internal.lastPage,l.geometry=t.pagesDefinition.geometry,l.where=t.pagesDefinition.where,l.orderByFields=""!==t.pagesDefinition.orderByFields?t.pagesDefinition.orderByFields.split(","):null,l.returnGeometry=t.pagesDefinition.returnGeometry,l.outSpatialReference=this.spatialReference,e.next=4,this.executeQuery(l,"execute");case 4:if(o=e.sent,this._checkCancelled(n),t.pagesDefinition.internal.lastPage===u){e.next=7;break}return e.abrupt("return","done");case 7:for(c=this._layer.objectIdField,d=0;d<o.features.length;d++)t.pagesDefinition.internal.set[s+d]=o.features[d].attributes[c];if(!1===this._pageJustIds)for(f=0;f<o.features.length;f++)this._featureCache[o.features[f].attributes[c]]=o.features[f];return e.abrupt("return",((void 0===o.exceededTransferLimit&&o.features.length!==t.pagesDefinition.resultRecordCount||!1===o.exceededTransferLimit)&&(t.pagesDefinition.internal.fullyResolved=!0),t.pagesDefinition.internal.lastRetrieved=i+o.features.length,t.pagesDefinition.internal.lastPage+=t.pagesDefinition.resultRecordCount,"done"));case 11:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_fieldsIncludingObjectId",value:function(e){if(null===e)return[this.objectIdField];var t=e.slice(0);if(t.includes("*"))return t;var r,a=!1,i=(0,n.Z)(t);try{for(i.s();!(r=i.n()).done;){if(r.value.toUpperCase()===this.objectIdField.toUpperCase()){a=!0;break}}}catch(s){i.e(s)}finally{i.f()}return!1===a&&t.push(this.objectIdField),t}},{key:"_getFeatures",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t,r,n,i){var s,u,l,o,c,d,f,h,p,y;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=[],-1!==r&&void 0===this._featureCache[r]&&s.push(r),!0!==this._checkIfNeedToExpandKnownPage(t,this._maxProcessingRate())){e.next=5;break}return e.next=4,this._expandPagedSet(t,this._maxProcessingRate(),0,0,i);case 4:return e.abrupt("return",this._getFeatures(t,r,n,i));case 5:u=0,l=t._lastFetchedIndex;case 7:if(!(l<t._known.length)){e.next=18;break}if(t._lastFetchedIndex+=1,u++,void 0!==this._featureCache[t._known[l]]){e.next=13;break}if(o=!1,null!==this._layer._mode&&void 0!==this._layer._mode&&void 0!==(c=this._layer._mode)._featureMap[t._known[l]]&&null!==(d=c._featureMap[t._known[l]])&&(o=!0,this._featureCache[t._known[l]]=d),!(!1===o&&(t._known[l]!==r&&s.push(t._known[l]),s.length>=this._maxProcessingRate()-1))){e.next=13;break}return e.abrupt("break",18);case 13:if(!(u>=n&&0===s.length)){e.next=15;break}return e.abrupt("break",18);case 15:l++,e.next=7;break;case 18:if(0!==s.length){e.next=20;break}return e.abrupt("return","success");case 20:return f=new z.Z,this._requestStandardised&&(f.sqlFormat="standard"),this.datesInUnknownTimezone&&(f.timeReferenceUnknownClient=!0),f.objectIds=s,f.outFields=null!==this._overrideFields?this._overrideFields:this._fieldsIncludingObjectId(this._layer.outFields?this._layer.outFields:["*"]),f.returnGeometry=!0,!0===this._removeGeometry&&(f.returnGeometry=!1),f.outSpatialReference=this.spatialReference,e.next=24,this.executeQuery(f,"execute");case 24:if(h=e.sent,this._checkCancelled(i),void 0===h.error){e.next=27;break}throw new Z.EN(Z.H9.RequestFailed,{reason:h.error});case 27:for(p=this._layer.objectIdField,y=0;y<h.features.length;y++)this._featureCache[h.features[y].attributes[p]]=h.features[y];return e.abrupt("return","success");case 30:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a){return e.apply(this,arguments)}}()},{key:"_getDistinctPages",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t,r,n,i,s,u,l,o,c){var d,f,h,p,y,v,_,g,m,b,k,x,S;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ensureLoaded();case 2:return e.next=4,this.databaseType();case 4:h=e.sent,p=n.parseTree.column,y=null!==(d=this._layer.fields)&&void 0!==d?d:[],v=0;case 8:if(!(v<y.length)){e.next=15;break}if(y[v].name.toLowerCase()!==p.toLowerCase()){e.next=12;break}return p=y[v].name,e.abrupt("break",15);case 12:v++,e.next=8;break;case 15:return _=new z.Z,this._requestStandardised&&(_.sqlFormat="standard"),this.datesInUnknownTimezone&&(_.timeReferenceUnknownClient=!0),g=null===u?null===s?"1=1":"":(0,w.zR)(u,h),this._layer.definitionExpression&&this._useDefinitionExpression&&(g=""!==g?"(("+this._layer.definitionExpression+") AND ("+g+"))":this._layer.definitionExpression),_.where=g,_.spatialRelationship=this._makeRelationshipEnum(i),_.relationParameter=this._makeRelationshipParam(i),_.geometry=null===s?null:s,_.returnDistinctValues=!0,_.returnGeometry=!1,_.outFields=[p],e.next=21,this.executeQuery(_,"execute");case 21:if(m=e.sent,this._checkCancelled(c),m.hasOwnProperty("features")){e.next=24;break}throw new Z.EN(Z.H9.InvalidStatResponse);case 24:b=!1,k=0;case 26:if(!(k<y.length)){e.next=33;break}if(y[k].name!==p){e.next=30;break}return"date"===y[k].type&&(b=!0),e.abrupt("break",33);case 30:k++,e.next=26;break;case 33:x=0;case 34:if(!(x<m.features.length)){e.next=41;break}if(b?null!==(S=m.features[x].attributes[p])?o.push(new Date(S)):o.push(S):o.push(m.features[x].attributes[p]),!(o.length>=l)){e.next=38;break}return e.abrupt("break",41);case 38:x++,e.next=34;break;case 41:if(0!==m.features.length){e.next=43;break}return e.abrupt("return",o);case 43:if(!(m.features.length===(null===(f=this._layer.capabilities)||void 0===f?void 0:f.query.maxRecordCount)&&o.length<l)){e.next=49;break}return e.t0=!0,e.next=47,this._getDistinctPages(t+m.features.length,r,n,i,s,u,l,o,c);case 47:return e.t1=e.sent,e.abrupt("return",{calculated:e.t0,result:e.t1});case 49:return e.abrupt("return",o);case 50:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a,i,s,u,l,o){return e.apply(this,arguments)}}()},{key:"_distinctStat",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t,r,n,i,s,u,l){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=!0,e.next=3,this._getDistinctPages(0,t,r,n,i,s,u,[],l);case 3:return e.t1=e.sent,e.abrupt("return",{calculated:e.t0,result:e.t1});case 5:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a,i,s,u){return e.apply(this,arguments)}}()},{key:"isTable",value:function(){return this._layer.isTable||null===this._layer.geometryType||"table"===this._layer.type||""===this._layer.geometryType||"esriGeometryNull"===this._layer.geometryType}},{key:"_countstat",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t,r,n,i){var s,u,l;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.databaseType();case 2:if(s=e.sent,u=new z.Z,this._requestStandardised&&(u.sqlFormat="standard"),!this.isTable()||!n||null===r||""===r){e.next=6;break}return e.abrupt("return",{calculated:!0,result:0});case 6:return l=null===i?null===n?"1=1":"":(0,w.zR)(i,s),this._layer.definitionExpression&&this._useDefinitionExpression&&(l=""!==l?"(("+this._layer.definitionExpression+") AND ("+l+"))":this._layer.definitionExpression),u.where=l,this.datesInUnknownTimezone&&(u.timeReferenceUnknownClient=!0),u.where=l,u.spatialRelationship=this._makeRelationshipEnum(r),u.relationParameter=this._makeRelationshipParam(r),u.geometry=null===n?null:n,u.returnGeometry=!1,e.t0=!0,e.next=11,this.executeQuery(u,"executeForCount");case 11:return e.t1=e.sent,e.abrupt("return",{calculated:e.t0,result:e.t1});case 13:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a){return e.apply(this,arguments)}}()},{key:"_stats",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t,r,n,i,s,u,l){var o,c,d,f,h,p,y,v,_,g,m,b,k,S;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ensureLoaded();case 2:if(c=this._layer.capabilities&&this._layer.capabilities.query&&!0===this._layer.capabilities.query.supportsSqlExpression,d=this._layer.capabilities&&this._layer.capabilities.query&&!0===this._layer.capabilities.query.supportsStatistics,f=this._layer.capabilities&&this._layer.capabilities.query&&!0===this._layer.capabilities.query.supportsDistinct,"count"!==t){e.next=5;break}return e.abrupt("return",f?this._countstat(t,n,i,s):{calculated:!1});case 5:if(!1!==d&&(!1!==(0,w.y5)(r)||!1!==c)&&!1!==r.isStandardized){e.next=7;break}return e.abrupt("return",""!==n||null!==s?{calculated:!1}:this._manualStat(t,r,u,l));case 7:if("distinct"!==t){e.next=9;break}return e.abrupt("return",!1===f?""!==n||null!==s?{calculated:!1}:this._manualStat(t,r,u,l):this._distinctStat(t,r,n,i,s,u,l));case 9:return e.next=11,this.databaseType();case 11:if(h=e.sent,!this.isTable()||!i||null===n||""===n){e.next=14;break}return e.abrupt("return",{calculated:!0,result:null});case 14:return p=new z.Z,this._requestStandardised&&(p.sqlFormat="standard"),y=null===s?null===i?"1=1":"":(0,w.zR)(s,h),this._layer.definitionExpression&&this._useDefinitionExpression&&(y=""!==y?"(("+this._layer.definitionExpression+") AND ("+y+"))":this._layer.definitionExpression),p.where=y,p.spatialRelationship=this._makeRelationshipEnum(n),p.relationParameter=this._makeRelationshipParam(n),p.geometry=null===i?null:i,this.datesInUnknownTimezone&&(p.timeReferenceUnknownClient=!0),(v=new J.Z).statisticType=(0,x.g3)(t),v.onStatisticField=(0,w.zR)(r,h),v.outStatisticFieldName="ARCADE_STAT_RESULT",p.returnGeometry=!1,_="ARCADE_STAT_RESULT",p.outStatistics=[v],e.next=24,this.executeQuery(p,"execute");case 24:if((g=e.sent).hasOwnProperty("features")&&0!==g.features.length){e.next=27;break}throw new Z.EN(Z.H9.InvalidStatResponse);case 27:m=!1,b=null!==(o=g.fields)&&void 0!==o?o:[],k=0;case 30:if(!(k<b.length)){e.next=37;break}if("ARCADE_STAT_RESULT"!==b[k].name.toUpperCase()){e.next=34;break}return _=b[k].name,"date"===b[k].type&&(m=!0),e.abrupt("break",37);case 34:k++,e.next=30;break;case 37:if(!m){e.next=40;break}return S=g.features[0].attributes[_],e.abrupt("return",(null!==S&&(S=new Date(g.features[0].attributes[_])),{calculated:!0,result:S}));case 40:return e.abrupt("return",{calculated:!0,result:g.features[0].attributes[_]});case 41:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a,i,s,u){return e.apply(this,arguments)}}()},{key:"_stat",value:function(e,t,r,n,a,i,s){return this._stats(e,t,r,n,a,i,s)}},{key:"_canDoAggregates",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t,r){var n,i,s,u,l,o;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ensureLoaded();case 2:if(i=!1,s=null===(n=this._layer.capabilities)||void 0===n?void 0:n.query,u=!0===(null===s||void 0===s?void 0:s.supportsSqlExpression),null!=s&&!0===s.supportsStatistics&&!0===s.supportsOrderBy&&(i=!0),i)for(l=0;l<r.length-1;l++)(!1===(null===(o=r[l].workingexpr)||void 0===o?void 0:o.isStandardized)||!1===(0,w.y5)(r[l].workingexpr)&&!1===u)&&(i=!1);return e.abrupt("return",!1!==i);case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_makeRelationshipEnum",value:function(e){if(e.includes("esriSpatialRelRelation"))return"relation";switch(e){case"esriSpatialRelRelation":return"relation";case"esriSpatialRelIntersects":return"intersects";case"esriSpatialRelContains":return"contains";case"esriSpatialRelOverlaps":return"overlaps";case"esriSpatialRelWithin":return"within";case"esriSpatialRelTouches":return"touches";case"esriSpatialRelCrosses":return"crosses";case"esriSpatialRelEnvelopeIntersects":return"envelope-intersects"}return e}},{key:"_makeRelationshipParam",value:function(e){return e.includes("esriSpatialRelRelation")?e.split(":")[1]:""}},{key:"_getAggregatePagesDataSourceDefinition",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t,r,n,i,s,u,l){var o,c,d,f,h,p,y,v,_,g,b;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ensureLoaded();case 2:return e.next=4,this.databaseType();case 4:for(c=e.sent,d="",f=!1,h=!1,null!==u&&this._layer.capabilities&&this._layer.capabilities.query&&!0===this._layer.capabilities.query.supportsOrderBy&&(d=u.constructClause(),h=!0),this._layer.capabilities&&this._layer.capabilities.query&&!1===this._layer.capabilities.query.supportsPagination&&(h=!1,f=!0,d=this._layer.objectIdField),p=[],y=0;y<r.length;y++)(v=new J.Z).onStatisticField=null!==r[y].workingexpr?(0,w.zR)(r[y].workingexpr,c):"",v.outStatisticFieldName=r[y].field,v.statisticType=r[y].toStatisticsName(),p.push(v);return""===d&&(d=t.join(",")),_=this._maxQueryRate(),null!=(g=null===(o=this._layer.capabilities)||void 0===o?void 0:o.query.maxRecordCount)&&g<_&&(_=g),b=null===s?null===i?"1=1":"":(0,w.zR)(s,c),this._layer.definitionExpression&&this._useDefinitionExpression&&(b=""!==b?"(("+this._layer.definitionExpression+") AND ("+b+"))":this._layer.definitionExpression),e.abrupt("return",new m.Z([],["GETPAGES"],h,{groupbypage:!0,spatialRel:this._makeRelationshipEnum(n),relationParam:this._makeRelationshipParam(n),outFields:["*"],useOIDpagination:f,generatedOid:l,resultRecordCount:_,resultOffset:0,groupByFieldsForStatistics:t,outStatistics:p,geometry:null===i?null:i,where:b,orderByFields:d,returnGeometry:!1,returnIdsOnly:!1,internal:{lastMaxId:-1,set:[],lastRetrieved:0,lastPage:0,fullyResolved:!1}}));case 16:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a,i,s,u){return e.apply(this,arguments)}}()},{key:"_getAgregagtePhysicalPage",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t,r,n){var i,s,u,l,o,c,d,f,h;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.pagesDefinition.where,!0===t.pagesDefinition.useOIDpagination&&(i=""!==i?"("+i+") AND ("+t.pagesDefinition.generatedOid+">"+t.pagesDefinition.internal.lastMaxId.toString()+")":t.pagesDefinition.generatedOid+">"+t.pagesDefinition.internal.lastMaxId.toString()),s=t.pagesDefinition.internal.lastRetrieved,u=s,l=t.pagesDefinition.internal.lastPage,o=new z.Z,this._requestStandardised&&(o.sqlFormat="standard"),o.where=i,o.spatialRelationship=t.pagesDefinition.spatialRel,o.relationParameter=t.pagesDefinition.relationParam,o.outFields=t.pagesDefinition.outFields,o.outStatistics=t.pagesDefinition.outStatistics,o.geometry=t.pagesDefinition.geometry,o.groupByFieldsForStatistics=t.pagesDefinition.groupByFieldsForStatistics,o.num=t.pagesDefinition.resultRecordCount,o.start=t.pagesDefinition.internal.lastPage,o.returnGeometry=t.pagesDefinition.returnGeometry,this.datesInUnknownTimezone&&(o.timeReferenceUnknownClient=!0),o.orderByFields=""!==t.pagesDefinition.orderByFields?t.pagesDefinition.orderByFields.split(","):null,!(this.isTable()&&o.geometry&&o.spatialRelationship)){e.next=5;break}return e.abrupt("return",[]);case 5:return e.next=7,this.executeQuery(o,"execute");case 7:if(c=e.sent,this._checkCancelled(n),c.hasOwnProperty("features")){e.next=10;break}throw new Z.EN(Z.H9.InvalidStatResponse);case 10:if(d=[],t.pagesDefinition.internal.lastPage===l){e.next=13;break}return e.abrupt("return",[]);case 13:for(f=0;f<c.features.length;f++)t.pagesDefinition.internal.set[u+f]=c.features[f].attributes[t.pagesDefinition.generatedOid];for(h=0;h<c.features.length;h++)d.push(new p.Z({attributes:c.features[h].attributes,geometry:null}));return e.abrupt("return",(!0===t.pagesDefinition.useOIDpagination?0===c.features.length?t.pagesDefinition.internal.fullyResolved=!0:t.pagesDefinition.internal.lastMaxId=c.features[c.features.length-1].attributes[t.pagesDefinition.generatedOid]:(void 0===c.exceededTransferLimit&&c.features.length!==t.pagesDefinition.resultRecordCount||!1===c.exceededTransferLimit)&&(t.pagesDefinition.internal.fullyResolved=!0),t.pagesDefinition.internal.lastRetrieved=s+c.features.length,t.pagesDefinition.internal.lastPage+=t.pagesDefinition.resultRecordCount,d));case 16:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"relationshipMetaData",value:function(){return this._layer&&this._layer.source&&this._layer.source.sourceJSON&&this._layer.source.sourceJSON.relationships?this._layer.source.sourceJSON.relationships:[]}},{key:"serviceUrl",value:function(){return(0,k.US)(this._layer.parsedUrl.path)}},{key:"queryAttachments",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t,r,n,i,s){var u,l,o,c,d=this;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(u=this._layer.capabilities)||void 0===u||!u.data.supportsAttachment||null===u||void 0===u||!u.operations.supportsQueryAttachments){e.next=9;break}return l={objectIds:[t],returnMetadata:s},(r&&r>0||n&&n>0)&&(l.size=[r&&r>0?r:0,n&&n>0?n:r+1]),i&&i.length>0&&(l.attachmentTypes=i),this.featureSetQueryInterceptor&&this.featureSetQueryInterceptor.preLayerQueryCallback({layer:this._layer,query:l,method:"attachments"}),e.next=6,this._layer.queryAttachments(l);case 6:return o=e.sent,c=[],e.abrupt("return",(o&&o[t]&&o[t].forEach((function(e){var r=d._layer.parsedUrl.path+"/"+t.toString()+"/attachments/"+e.id.toString(),n=null;s&&e.exifInfo&&(n=H.Z.convertJsonToArcade(e.exifInfo,"system",!0)),c.push(new O.Z(e.id,e.name,e.contentType,e.size,r,n))})),c));case 9:return e.abrupt("return",[]);case 10:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a,i){return e.apply(this,arguments)}}()},{key:"queryRelatedFeatures",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t){var r,i,s,u,l,o,c,f,h,y,v,_,g,m,b;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={f:"json",relationshipId:t.relationshipId.toString(),definitionExpression:t.where,outFields:null===(r=t.outFields)||void 0===r?void 0:r.join(","),returnGeometry:t.returnGeometry.toString()},void 0!==t.resultOffset&&null!==t.resultOffset&&(i.resultOffset=t.resultOffset.toString()),void 0!==t.resultRecordCount&&null!==t.resultRecordCount&&(i.resultRecordCount=t.resultRecordCount.toString()),t.orderByFields&&(i.orderByFields=t.orderByFields.join(",")),t.objectIds&&t.objectIds.length>0&&(i.objectIds=t.objectIds.join(",")),t.outSpatialReference&&(i.outSR=JSON.stringify(t.outSpatialReference.toJSON())),this.featureSetQueryInterceptor&&this.featureSetQueryInterceptor.preRequestCallback({layer:this._layer,queryPayload:i,method:"relatedrecords",url:this._layer.parsedUrl.path+"/queryRelatedRecords"}),e.next=4,(0,d.default)(this._layer.parsedUrl.path+"/queryRelatedRecords",{responseType:"json",query:i});case 4:if(!(s=e.sent).data){e.next=9;break}if(u={},(l=s.data)&&l.relatedRecordGroups){o=l.spatialReference,c=(0,n.Z)(l.relatedRecordGroups);try{for(c.s();!(f=c.n()).done;){h=f.value,y=h.objectId,v=[],_=(0,n.Z)(h.relatedRecords);try{for(_.s();!(g=_.n()).done;)(m=g.value).geometry&&(m.geometry.spatialReference=o),b=new p.Z({geometry:m.geometry?(0,j.im)(m.geometry):null,attributes:m.attributes}),v.push(b)}catch(a){_.e(a)}finally{_.f()}u[y]={features:v,exceededTransferLimit:!0===l.exceededTransferLimit}}}catch(a){c.e(a)}finally{c.f()}}return e.abrupt("return",u);case 9:throw new Z.EN(Z.H9.InvalidRequest);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getFeatureByObjectId",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t,r){var n,i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new z.Z).outFields=r,n.returnGeometry=!1,n.outSpatialReference=this.spatialReference,n.where=this.objectIdField+"="+t.toString(),this.datesInUnknownTimezone&&(n.timeReferenceUnknownClient=!0),this.featureSetQueryInterceptor&&this.featureSetQueryInterceptor.preLayerQueryCallback({layer:this._layer,query:n,method:"execute"}),e.next=4,(0,G.e)(this._layer.parsedUrl.path,n);case 4:return i=e.sent,e.abrupt("return",1===i.features.length?i.features[0]:null);case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getIdentityUser",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return t=null===A.id||void 0===A.id?void 0:A.id.findCredential(this._layer.url),e.abrupt("return",t?t.userId:null);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getOwningSystemUrl",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(){var t,r,n,i,s;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:if(!(t=null===A.id||void 0===A.id?void 0:A.id.findServerInfo(this._layer.url))){e.next=5;break}return e.abrupt("return",t.owningSystemUrl);case 5:if(r=this._layer.url,n=r.toLowerCase().indexOf("/rest/services"),!(r=n>-1?r.substring(0,n):r)){e.next=20;break}return r+="/rest/info",e.prev=9,e.next=12,(0,d.default)(r,{query:{f:"json"}});case 12:return i=e.sent,s="",e.abrupt("return",(i.data&&i.data.owningSystemUrl&&(s=i.data.owningSystemUrl),s));case 17:return e.prev=17,e.t0=e.catch(9),e.abrupt("return","");case 20:return e.abrupt("return","");case 21:case"end":return e.stop()}}),e,this,[[9,17]])})));return function(){return e.apply(this,arguments)}}()},{key:"getDataSourceFeatureSet",value:function(){var e,t,n,a,i=new r({layer:this._layer,spatialReference:null!==(e=this.spatialReference)&&void 0!==e?e:void 0,outFields:null!==(t=this._overrideFields)&&void 0!==t?t:void 0,includeGeometry:!this._removeGeometry,lrucache:null!==(n=this.recentlyUsedQueries)&&void 0!==n?n:void 0,interceptor:null!==(a=this.featureSetQueryInterceptor)&&void 0!==a?a:void 0});return i._useDefinitionExpression=!1,i}},{key:"preferredTimeReference",get:function(){var e,t,r;return void 0===this._cachedDateMetaData.preferredTimeReference&&(this._cachedDateMetaData.preferredTimeReference=null!==(e=null===(t=this._layer)||void 0===t||null===(r=t.preferredTimeReference)||void 0===r?void 0:r.toJSON())&&void 0!==e?e:null),this._cachedDateMetaData.preferredTimeReference}},{key:"dateFieldsTimeReference",get:function(){var e,t,r;return void 0===this._cachedDateMetaData.dateFieldsTimeReference&&(this._cachedDateMetaData.dateFieldsTimeReference=null!==(e=null===(t=this._layer)||void 0===t||null===(r=t.dateFieldsTimeReference)||void 0===r?void 0:r.toJSON())&&void 0!==e?e:null),this._cachedDateMetaData.dateFieldsTimeReference}},{key:"datesInUnknownTimezone",get:function(){return this._layer.datesInUnknownTimezone}},{key:"editFieldsInfo",get:function(){var e,t,r;return void 0===this._cachedDateMetaData.editFieldsInfo&&(this._cachedDateMetaData.editFieldsInfo=null!==(e=null===(t=this._layer)||void 0===t||null===(r=t.editFieldsInfo)||void 0===r?void 0:r.toJSON())&&void 0!==e?e:null),this._cachedDateMetaData.editFieldsInfo}},{key:"timeInfo",get:function(){var e,t,r;return void 0===this._cachedDateMetaData.timeInfo&&(this._cachedDateMetaData.timeInfo=null!==(e=null===(t=this._layer)||void 0===t||null===(r=t.timeInfo)||void 0===r?void 0:r.toJSON())&&void 0!==e?e:null),this._cachedDateMetaData.timeInfo}}],[{key:"create",value:function(e,t,n,a,i){return new r({layer:new P.default({url:e,outFields:null===t?["*"]:t}),spatialReference:n,lrucache:a,interceptor:i})}}]),r}(g.Z),X=r(84272),$=function(e){(0,l.Z)(r,e);var t=(0,o.Z)(r);function r(e){var n;return(0,s.Z)(this,r),(n=t.call(this,e)).declaredClass="esri.arcade.featureset.sources.FeatureLayerRelated",n._findObjectId=-1,n._requestStandardised=!1,n._removeGeometry=!1,n._overrideFields=null,n.featureObjectId=null,e.spatialReference&&(n.spatialReference=e.spatialReference),n._transparent=!0,n._maxProcessing=1e3,n._layer=e.layer,n._wset=null,n._findObjectId=e.objectId,n.featureObjectId=e.objectId,n.relationship=e.relationship,n._relatedLayer=e.relatedLayer,void 0!==e.outFields&&(n._overrideFields=e.outFields),void 0!==e.includeGeometry&&(n._removeGeometry=!1===e.includeGeometry),n}return(0,u.Z)(r,[{key:"_maxQueryRate",value:function(){return k.tI}},{key:"end",value:function(){return this._layer}},{key:"optimisePagingFeatureQueries",value:function(){}},{key:"loadImpl",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this._layer.load(),null===(t=this._relatedLayer)||void 0===t?void 0:t.load()]);case 2:return this._initialiseFeatureSet(),e.abrupt("return",this);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"nativeCapabilities",value:function(){return this._relatedLayer.nativeCapabilities()}},{key:"_initialiseFeatureSet",value:function(){if(null==this.spatialReference&&(this.spatialReference=this._layer.spatialReference),this.geometryType=this._relatedLayer.geometryType,this.fields=this._relatedLayer.fields.slice(0),null!==this._overrideFields)if(1===this._overrideFields.length&&"*"===this._overrideFields[0])this._overrideFields=null;else{var e,t=[],r=[],a=(0,n.Z)(this.fields);try{for(a.s();!(e=a.n()).done;){var i=e.value;if("oid"===i.type)t.push(i),r.push(i.name);else{var s,u=(0,n.Z)(this._overrideFields);try{for(u.s();!(s=u.n()).done;){if(s.value.toLowerCase()===i.name.toLowerCase()){t.push(i),r.push(i.name);break}}}catch(o){u.e(o)}finally{u.f()}}}}catch(o){a.e(o)}finally{a.f()}this.fields=t,this._overrideFields=r}var l=this._layer.nativeCapabilities();l&&(this._databaseType=l.databaseType,this._requestStandardised=l.requestStandardised),this.objectIdField=this._relatedLayer.objectIdField,this.globalIdField=this._relatedLayer.globalIdField,this.hasM=this._relatedLayer.supportsM,this.hasZ=this._relatedLayer.supportsZ,this.typeIdField=this._relatedLayer.typeIdField,this.types=this._relatedLayer.types}},{key:"databaseType",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._relatedLayer.databaseType();case 2:return this._databaseType=this._relatedLayer._databaseType,e.abrupt("return",this._databaseType);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isTable",value:function(){return this._relatedLayer.isTable()}},{key:"_isInFeatureSet",value:function(){return k.dj.InFeatureSet}},{key:"_candidateIdTransform",value:function(e){return e}},{key:"_getSet",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t){var r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this._wset){e.next=7;break}return e.next=3,this._ensureLoaded();case 3:return e.next=5,this._getFilteredSet("",null,null,null,t);case 5:return r=e.sent,e.abrupt("return",(this._wset=r,r));case 7:return e.abrupt("return",this._wset);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_changeFeature",value:function(e){var t,r={},a=(0,n.Z)(this.fields);try{for(a.s();!(t=a.n()).done;){var i=t.value;r[i.name]=e.attributes[i.name]}}catch(s){a.e(s)}finally{a.f()}return new p.Z({geometry:!0===this._removeGeometry?null:e.geometry,attributes:r})}},{key:"_getFilteredSet",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t,r,n,i,s){var u,l,o,c,d,f,h,p,y,v,_,g,b;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.databaseType();case 2:if(!this.isTable()||!r||null===t||""===t){e.next=4;break}return e.abrupt("return",new m.Z([],[],!0,null));case 4:if(!1!==(l=this._layer.nativeCapabilities()).canQueryRelated){e.next=7;break}return e.abrupt("return",new m.Z([],[],!0,null));case 7:if(null===(u=l.capabilities)||void 0===u||!u.queryRelated||!l.capabilities.queryRelated.supportsPagination){e.next=9;break}return e.abrupt("return",this._getFilteredSetUsingPaging(t,r,n,i,s));case 9:return o="",c=!1,null!==i&&l.capabilities&&l.capabilities.queryRelated&&!0===l.capabilities.queryRelated.supportsOrderBy&&(o=i.constructClause(),c=!0),(d=new V.default).objectIds=[this._findObjectId],f=null!==this._overrideFields?this._overrideFields:this._fieldsIncludingObjectId(this._relatedLayer.fields?this._relatedLayer.fields.map((function(e){return e.name})):["*"]),d.outFields=f,d.relationshipId=this.relationship.id,d.where="1=1",h=!0,!0===this._removeGeometry&&(h=!1),d.returnGeometry=h,this._requestStandardised&&(d.sqlFormat="standard"),d.outSpatialReference=this.spatialReference,d.orderByFields=""!==o?o.split(","):null,e.next=19,l.source.queryRelatedFeatures(d);case 19:for(p=e.sent,this._checkCancelled(s),y=p[this._findObjectId]?p[this._findObjectId].features:[],v=[],_=0;_<y.length;_++)this._featureCache[y[_].attributes[this._relatedLayer.objectIdField]]=y[_],v.push(y[_].attributes[this._relatedLayer.objectIdField]);return g=r&&null!==t&&""!==t,b=null!=n,e.abrupt("return",new m.Z(g||b?v:[],g||b?[]:v,c,null));case 25:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a,i){return e.apply(this,arguments)}}()},{key:"_fieldsIncludingObjectId",value:function(e){if(null===e)return[this.objectIdField];var t=e.slice(0);if(t.includes("*"))return t;var r,a=!1,i=(0,n.Z)(t);try{for(i.s();!(r=i.n()).done;){if(r.value.toUpperCase()===this.objectIdField.toUpperCase()){a=!0;break}}}catch(s){i.e(s)}finally{i.f()}return!1===a&&t.push(this.objectIdField),t}},{key:"_getFilteredSetUsingPaging",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t,r,n,i,s){var u,l,o,c,d,f,h,p,y,v,_,g;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o="",c=!1,d=this._layer.nativeCapabilities(),null!==i&&d&&null!==(u=d.capabilities)&&void 0!==u&&u.queryRelated&&!0===d.capabilities.queryRelated.supportsOrderBy&&(o=i.constructClause(),c=!0),e.next=5,this.databaseType();case 5:return"1=1",f=this._maxQueryRate(),null!=(h=null===(l=d.capabilities)||void 0===l?void 0:l.query.maxRecordCount)&&h<f&&(f=h),p=r&&null!==t&&""!==t,y=null!=n,v=null,_=!0,!0===this._removeGeometry&&(_=!1),g=null!==this._overrideFields?this._overrideFields:this._fieldsIncludingObjectId(this._relatedLayer.fields?this._relatedLayer.fields.map((function(e){return e.name})):["*"]),v=new m.Z(p||y?["GETPAGES"]:[],p||y?[]:["GETPAGES"],c,{outFields:g.join(","),resultRecordCount:f,resultOffset:0,objectIds:[this._findObjectId],where:"1=1",orderByFields:o,returnGeometry:_,returnIdsOnly:"false",internal:{set:[],lastRetrieved:0,lastPage:0,fullyResolved:!1}}),e.next=16,this._expandPagedSet(v,f,0,0,s);case 16:return e.abrupt("return",v);case 17:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a,i){return e.apply(this,arguments)}}()},{key:"_expandPagedSet",value:function(e,t,r,n,a){return this._expandPagedSetFeatureSet(e,t,r,n,a)}},{key:"_clonePageDefinition",value:function(e){return null===e?null:!0!==e.groupbypage?{groupbypage:!1,outFields:e.outFields,resultRecordCount:e.resultRecordCount,resultOffset:e.resultOffset,where:e.where,objectIds:e.objectIds,orderByFields:e.orderByFields,returnGeometry:e.returnGeometry,returnIdsOnly:e.returnIdsOnly,internal:e.internal}:{groupbypage:!0,outFields:e.outFields,resultRecordCount:e.resultRecordCount,useOIDpagination:e.useOIDpagination,generatedOid:e.generatedOid,groupByFieldsForStatistics:e.groupByFieldsForStatistics,resultOffset:e.resultOffset,outStatistics:e.outStatistics,geometry:e.geometry,where:e.where,objectIds:e.objectIds,orderByFields:e.orderByFields,returnGeometry:e.returnGeometry,returnIdsOnly:e.returnIdsOnly,internal:e.internal}}},{key:"_getPhysicalPage",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t,r,n){var i,s,u,l,o,c,d,f,h,p;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.pagesDefinition.internal.lastRetrieved,s=i,u=t.pagesDefinition.internal.lastPage,l=this._layer.nativeCapabilities(),o=new V.default,!0===this._requestStandardised&&(o.sqlFormat="standard"),o.relationshipId=this.relationship.id,o.objectIds=t.pagesDefinition.objectIds,o.resultOffset=t.pagesDefinition.internal.lastPage,o.resultRecordCount=t.pagesDefinition.resultRecordCount,o.outFields=t.pagesDefinition.outFields.split(","),o.where=t.pagesDefinition.where,o.orderByFields=""!==t.pagesDefinition.orderByFields?t.pagesDefinition.orderByFields.split(","):null,o.returnGeometry=t.pagesDefinition.returnGeometry,o.outSpatialReference=this.spatialReference,e.next=4,l.source.queryRelatedFeatures(o);case 4:if(c=e.sent,this._checkCancelled(n),t.pagesDefinition.internal.lastPage===u){e.next=7;break}return e.abrupt("return",0);case 7:for(d=c[this._findObjectId]?c[this._findObjectId].features:[],f=0;f<d.length;f++)t.pagesDefinition.internal.set[s+f]=d[f].attributes[this._relatedLayer.objectIdField];for(h=0;h<d.length;h++)this._featureCache[d[h].attributes[this._relatedLayer.objectIdField]]=d[h];return p=!c[this._findObjectId]||!1===c[this._findObjectId].exceededTransferLimit,e.abrupt("return",(d.length!==t.pagesDefinition.resultRecordCount&&p&&(t.pagesDefinition.internal.fullyResolved=!0),t.pagesDefinition.internal.lastRetrieved=i+d.length,t.pagesDefinition.internal.lastPage+=t.pagesDefinition.resultRecordCount,d.length));case 12:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_getFeatures",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t,r,n,i){var s,u,l,o;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=[],-1!==r&&void 0===this._featureCache[r]&&s.push(r),u=this._maxQueryRate(),!0!==this._checkIfNeedToExpandKnownPage(t,u)){e.next=7;break}return e.next=6,this._expandPagedSet(t,u,0,0,i);case 6:return e.abrupt("return",this._getFeatures(t,r,n,i));case 7:for(l=0,o=t._lastFetchedIndex;o<t._known.length&&(++l<=n&&(t._lastFetchedIndex+=1),!("GETPAGES"!==t._known[o]&&void 0===this._featureCache[t._known[o]]&&(t._known[o]!==r&&s.push(t._known[o]),s.length>n)))&&!(l>=n&&0===s.length);o++);if(0!==s.length){e.next=11;break}return e.abrupt("return","success");case 11:throw new Z.EN(Z.H9.MissingFeatures);case 12:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a){return e.apply(this,arguments)}}()},{key:"_refineSetBlock",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t,r,n){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t);case 1:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_stat",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t,r,n,i,s,u,l){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{calculated:!1});case 1:case"end":return e.stop()}}),e)})));return function(t,r,n,a,i,s,u){return e.apply(this,arguments)}}()},{key:"gdbVersion",get:function(){return this._relatedLayer.gdbVersion}},{key:"_canDoAggregates",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t,r,n,i,s){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)})));return function(t,r,n,a,i){return e.apply(this,arguments)}}()},{key:"relationshipMetaData",value:function(){return this._relatedLayer.relationshipMetaData()}},{key:"serviceUrl",value:function(){return this._relatedLayer.serviceUrl()}},{key:"queryAttachments",value:function(e,t,r,n,a){return this._relatedLayer.queryAttachments(e,t,r,n,a)}},{key:"getFeatureByObjectId",value:function(e,t){return this._relatedLayer.getFeatureByObjectId(e,t)}},{key:"getOwningSystemUrl",value:function(){return this._relatedLayer.getOwningSystemUrl()}},{key:"getIdentityUser",value:function(){return this._relatedLayer.getIdentityUser()}},{key:"getDataSourceFeatureSet",value:function(){return this._relatedLayer}},{key:"preferredTimeReference",get:function(){var e,t;return null!==(e=null===(t=this._relatedLayer)||void 0===t?void 0:t.preferredTimeReference)&&void 0!==e?e:null}},{key:"dateFieldsTimeReference",get:function(){var e,t;return null!==(e=null===(t=this._relatedLayer)||void 0===t?void 0:t.dateFieldsTimeReference)&&void 0!==e?e:null}},{key:"datesInUnknownTimezone",get:function(){var e;return null===(e=this._relatedLayer)||void 0===e?void 0:e.datesInUnknownTimezone}},{key:"editFieldsInfo",get:function(){var e,t;return null!==(e=null===(t=this._relatedLayer)||void 0===t?void 0:t.editFieldsInfo)&&void 0!==e?e:null}},{key:"timeInfo",get:function(){var e,t;return null!==(e=null===(t=this._relatedLayer)||void 0===t?void 0:t.timeInfo)&&void 0!==e?e:null}}]),r}(g.Z),Y=r(26609),ee=r(98995);function te(){null===Y.Z.applicationCache&&(Y.Z.applicationCache=new Y.Z)}function re(e,t){return ne.apply(this,arguments)}function ne(){return(ne=(0,c.Z)((0,a.Z)().mark((function e(t,r){var n,i,s,u;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Y.Z.applicationCache){e.next=22;break}if(!(n=Y.Z.applicationCache.getLayerInfo(t))){e.next=7;break}return e.next=5,n;case 5:return i=e.sent,e.abrupt("return",new P.default({url:t,outFields:r,sourceJSON:i}));case 7:if(s=new P.default({url:t,outFields:r}),u=(0,c.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.load();case 2:return e.abrupt("return",s.sourceJSON);case 3:case"end":return e.stop()}}),e)})))(),!Y.Z.applicationCache){e.next=19;break}return Y.Z.applicationCache.setLayerInfo(t,u),e.prev=10,e.next=13,u;case 13:case 21:return e.abrupt("return",s);case 16:throw e.prev=16,e.t0=e.catch(10),Y.Z.applicationCache.clearLayerInfo(t),e.t0;case 19:return e.next=21,u;case 22:return e.abrupt("return",new P.default({url:t,outFields:r}));case 23:case"end":return e.stop()}}),e,null,[[10,16]])})))).apply(this,arguments)}function ae(e,t,r,n,a){return ie.apply(this,arguments)}function ie(){return ie=(0,c.Z)((0,a.Z)().mark((function e(t,r,n,i,s){var u,l=arguments;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=l.length>5&&void 0!==l[5]?l[5]:null,e.t0=se,e.next=4,re(t,["*"]);case 4:return e.t1=e.sent,e.t2=r,e.t3=n,e.t4=i,e.t5=s,e.t6=u,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3,e.t4,e.t5,e.t6));case 11:case"end":return e.stop()}}),e)}))),ie.apply(this,arguments)}function se(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s={layer:e,spatialReference:t,outFields:r,includeGeometry:n,lrucache:a,interceptor:i};return!0===e._hasMemorySource()?new X.Z(s):new K(s)}function ue(e){return le.apply(this,arguments)}function le(){return(le=(0,c.Z)((0,a.Z)().mark((function e(t){var r,n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===Y.Z.applicationCache){e.next=4;break}if(null===(r=Y.Z.applicationCache.getLayerInfo(t))){e.next=4;break}return e.abrupt("return",r);case 4:if(n=(0,c.Z)((0,a.Z)().mark((function e(){var r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.default)(t,{responseType:"json",query:{f:"json"}});case 2:return r=e.sent,e.abrupt("return",r.data?r.data:null);case 4:case"end":return e.stop()}}),e)})))(),null===Y.Z.applicationCache){e.next=16;break}return Y.Z.applicationCache.setLayerInfo(t,n),e.prev=7,e.next=10,n;case 10:return e.abrupt("return",e.sent);case 13:throw e.prev=13,e.t0=e.catch(7),Y.Z.applicationCache.clearLayerInfo(t),e.t0;case 16:return e.abrupt("return",n);case 17:case"end":return e.stop()}}),e,null,[[7,13]])})))).apply(this,arguments)}function oe(e,t){return ce.apply(this,arguments)}function ce(){return(ce=(0,c.Z)((0,a.Z)().mark((function e(t,r){var n,i,s;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n="QUERYDATAELEMTS:"+r.toString()+":"+t,null===Y.Z.applicationCache){e.next=5;break}if(null===(i=Y.Z.applicationCache.getLayerInfo(n))){e.next=5;break}return e.abrupt("return",i);case 5:if(s=(0,c.Z)((0,a.Z)().mark((function e(){var n,i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.default)(t+"/queryDataElements",{method:"post",responseType:"json",query:{layers:JSON.stringify([r.toString()]),f:"json"}});case 2:if(!(n=e.sent).data){e.next=7;break}if(!(i=n.data).layerDataElements||!i.layerDataElements[0]){e.next=7;break}return e.abrupt("return",i.layerDataElements[0]);case 7:throw new Z.EN(Z.H9.DataElementsNotFound);case 8:case"end":return e.stop()}}),e)})))(),null===Y.Z.applicationCache){e.next=17;break}return Y.Z.applicationCache.setLayerInfo(n,s),e.prev=8,e.next=11,s;case 11:return e.abrupt("return",e.sent);case 14:throw e.prev=14,e.t0=e.catch(8),Y.Z.applicationCache.clearLayerInfo(n),e.t0;case 17:return e.abrupt("return",s);case 18:case"end":return e.stop()}}),e,null,[[8,14]])})))).apply(this,arguments)}function de(e){return fe.apply(this,arguments)}function fe(){return(fe=(0,c.Z)((0,a.Z)().mark((function e(t){var r,n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===Y.Z.applicationCache){e.next=4;break}if(null===(r=Y.Z.applicationCache.getLayerInfo(t))){e.next=4;break}return e.abrupt("return",r);case 4:if(n=(0,c.Z)((0,a.Z)().mark((function e(){var r,n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.default)(t,{responseType:"json",query:{f:"json"}});case 2:if(!(r=e.sent).data){e.next=6;break}return n=r.data,e.abrupt("return",(n.layers||(n.layers=[]),n.tables||(n.tables=[]),n));case 6:return e.abrupt("return",{layers:[],tables:[]});case 7:case"end":return e.stop()}}),e)})))(),null===Y.Z.applicationCache){e.next=16;break}return Y.Z.applicationCache.setLayerInfo(t,n),e.prev=7,e.next=10,n;case 10:return e.abrupt("return",e.sent);case 13:throw e.prev=13,e.t0=e.catch(7),Y.Z.applicationCache.clearLayerInfo(t),e.t0;case 16:return e.abrupt("return",n);case 17:case"end":return e.stop()}}),e,null,[[7,13]])})))).apply(this,arguments)}function he(e,t){return pe.apply(this,arguments)}function pe(){return(pe=(0,c.Z)((0,a.Z)().mark((function e(t,r){var i,s,u,l,o,c,d,f,h,p,y,v,_,g,m,b,k,w,x,Z,F,I,C,R,D,T,N,E,L,O;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={metadata:null,networkId:-1,unVersion:3,terminals:[],queryelem:null,layerNameLkp:{},lkp:null},e.next=3,de(t);case 3:if(s=e.sent,i.metadata=s,!s.controllerDatasetLayers||void 0===s.controllerDatasetLayers.utilityNetworkLayerId||null===s.controllerDatasetLayers.utilityNetworkLayerId){e.next=36;break}if(s.layers){u=(0,n.Z)(s.layers);try{for(u.s();!(l=u.n()).done;)o=l.value,i.layerNameLkp[o.id]=o.name}catch(a){u.e(a)}finally{u.f()}}if(s.tables){c=(0,n.Z)(s.tables);try{for(c.s();!(d=c.n()).done;)f=d.value,i.layerNameLkp[f.id]=f.name}catch(a){c.e(a)}finally{c.f()}}return h=s.controllerDatasetLayers.utilityNetworkLayerId,i.networkId=h,e.next=11,oe(t,h);case 11:if(!(p=e.sent)){e.next=35;break}i.queryelem=p,i.queryelem&&i.queryelem.dataElement&&void 0!==i.queryelem.dataElement.schemaGeneration&&(i.unVersion=i.queryelem.dataElement.schemaGeneration),i.lkp={},i.queryelem.dataElement.domainNetworks||(i.queryelem.dataElement.domainNetworks=[]),y=(0,n.Z)(i.queryelem.dataElement.domainNetworks);try{for(y.s();!(v=y.n()).done;){_=v.value,g=(0,n.Z)(_.edgeSources?_.edgeSources:[]);try{for(g.s();!(m=g.n()).done;)b=m.value,(k={layerId:b.layerId,sourceId:b.sourceId,className:i.layerNameLkp[b.layerId]?i.layerNameLkp[b.layerId]:null}).className&&(i.lkp[k.className]=k)}catch(a){g.e(a)}finally{g.f()}w=(0,n.Z)(_.junctionSources?_.junctionSources:[]);try{for(w.s();!(x=w.n()).done;)Z=x.value,(F={layerId:Z.layerId,sourceId:Z.sourceId,className:i.layerNameLkp[Z.layerId]?i.layerNameLkp[Z.layerId]:null}).className&&(i.lkp[F.className]=F)}catch(a){w.e(a)}finally{w.f()}}}catch(a){y.e(a)}finally{y.f()}if(i.queryelem.dataElement.terminalConfigurations){I=(0,n.Z)(i.queryelem.dataElement.terminalConfigurations);try{for(I.s();!(C=I.n()).done;){R=C.value,D=(0,n.Z)(R.terminals);try{for(D.s();!(T=D.n()).done;)N=T.value,i.terminals.push({terminalId:N.terminalId,terminalName:N.terminalName})}catch(a){D.e(a)}finally{D.f()}}}catch(a){I.e(a)}finally{I.f()}}return e.next=19,ue(t+"/"+h);case 19:if(!(E=e.sent).systemLayers||void 0===E.systemLayers.associationsTableId||null===E.systemLayers.associationsTableId){e.next=34;break}return L=[],i.unVersion>=4&&(L.push("STATUS"),L.push("PERCENTALONG")),e.next=25,ae(t+"/"+E.systemLayers.associationsTableId.toString(),r,["OBJECTID","FROMNETWORKSOURCEID","TONETWORKSOURCEID","FROMGLOBALID","TOGLOBALID","TOTERMINALID","FROMTERMINALID","ASSOCIATIONTYPE","ISCONTENTVISIBLE","GLOBALID"].concat(L),!1,null,null);case 25:return O=e.sent,e.next=28,O.load();case 28:if(e.t0=i.unVersion>=4,!e.t0){e.next=33;break}return O=O.filter(S.WhereClause.create("STATUS NOT IN (1, 2, 3, 4, 5, 6, 7, 9, 10, 11, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37, 38, 39, 41, 42, 43, 44, 45, 46, 47, 49, 50, 51, 52, 53, 54, 55, 57, 58, 59, 60, 61, 62,63)",O.getFieldsIndex())),e.next=33,O.load();case 33:return e.abrupt("return",{lkp:i.lkp,associations:O,unVersion:i.unVersion,terminals:i.terminals});case 34:case 35:case 36:return e.abrupt("return",{associations:null,unVersion:i.unVersion,lkp:null,terminals:[]});case 37:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ye(e,t,r){return ve.apply(this,arguments)}function ve(){return ve=(0,c.Z)((0,a.Z)().mark((function e(t,r,n){var i,s,u,l,o,c,d,f=arguments;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=f.length>3&&void 0!==f[3]?f[3]:null,s=f.length>4&&void 0!==f[4]?f[4]:null,u=!(f.length>5&&void 0!==f[5])||f[5],l=f.length>6&&void 0!==f[6]?f[6]:null,o=f.length>7&&void 0!==f[7]?f[7]:null,c=t.serviceUrl()){e.next=8;break}return e.abrupt("return",null);case 8:return c="/"===c.charAt(c.length-1)?c+r.relatedTableId.toString():c+"/"+r.relatedTableId.toString(),e.next=11,ae(c,i,s,u,l,o);case 11:return d=e.sent,e.abrupt("return",new $({layer:t,relatedLayer:d,relationship:r,objectId:n,spatialReference:i,outFields:s,includeGeometry:u,lrucache:l,interceptor:o}));case 13:case"end":return e.stop()}}),e)}))),ve.apply(this,arguments)}h.Z.registerAction(),N.registerAction(),_.Z.registerAction(),E.Z.registerAction(),L.Z.registerAction();var _e=function(e){(0,l.Z)(r,e);var t=(0,o.Z)(r);function r(e){var n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return(0,s.Z)(this,r),(n=t.call(this))._map=e,n._overridespref=a,n._lrucache=i,n._interceptor=u,n._instantLayers=[],n}return(0,u.Z)(r,[{key:"_makeAndAddFeatureSet",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=se(e,this._overridespref,null===r?["*"]:r,t,this._lrucache,this._interceptor);return this._instantLayers.push({featureset:n,opitem:e,includeGeometry:t,outFields:JSON.stringify(r)}),n}},{key:"featureSetByName",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t){var r,n,s,u,l,o,c,d,f=arguments;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!(f.length>1&&void 0!==f[1])||f[1],n=f.length>2&&void 0!==f[2]?f[2]:null,void 0===this._map.loaded||void 0===this._map.load||!1!==this._map.loaded){e.next=6;break}return e.next=5,this._map.load();case 5:return e.abrupt("return",this.featureSetByName(t,r,n));case 6:null===n&&(n=["*"]),n=(n=n.slice(0)).sort(),s=JSON.stringify(n),u=0;case 9:if(!(u<this._instantLayers.length)){e.next=16;break}if((l=this._instantLayers[u]).opitem.title!==t||l.includeGeometry!==r||l.outFields!==s){e.next=13;break}return e.abrupt("return",this._instantLayers[u].featureset);case 13:u++,e.next=9;break;case 16:if(o=this._map.allLayers.find((function(e){return e instanceof P.default&&e.title===t})),!o){e.next=19;break}return e.abrupt("return",this._makeAndAddFeatureSet(o,r,n));case 19:if(!this._map.tables){e.next=28;break}if(c=this._map.tables.find((function(e){return!!(e.title&&e.title===t||e.title&&e.title===t)})),!c){e.next=28;break}if(!(c instanceof P.default)){e.next=24;break}return e.abrupt("return",this._makeAndAddFeatureSet(c,r,n));case 24:return c._materializedTable||(d=c.outFields?c:(0,i.Z)((0,i.Z)({},c),{},{outFields:["*"]}),c._materializedTable=new P.default(d)),e.next=27,c._materializedTable.load();case 27:return e.abrupt("return",this._makeAndAddFeatureSet(c._materializedTable,r,n));case 28:return e.abrupt("return",null);case 29:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"featureSetById",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t){var r,n,s,u,l,o,c,d,f=arguments;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!(f.length>1&&void 0!==f[1])||f[1],n=f.length>2&&void 0!==f[2]?f[2]:["*"],void 0===this._map.loaded||void 0===this._map.load||!1!==this._map.loaded){e.next=6;break}return e.next=5,this._map.load();case 5:return e.abrupt("return",this.featureSetById(t,r,n));case 6:null===n&&(n=["*"]),n=(n=n.slice(0)).sort(),s=JSON.stringify(n),u=0;case 9:if(!(u<this._instantLayers.length)){e.next=16;break}if((l=this._instantLayers[u]).opitem.id!==t||l.includeGeometry!==r||l.outFields!==s){e.next=13;break}return e.abrupt("return",this._instantLayers[u].featureset);case 13:u++,e.next=9;break;case 16:if(o=this._map.allLayers.find((function(e){return e instanceof P.default&&e.id===t})),!o){e.next=19;break}return e.abrupt("return",this._makeAndAddFeatureSet(o,r,n));case 19:if(!this._map.tables){e.next=28;break}if(c=this._map.tables.find((function(e){return e.id===t})),!c){e.next=28;break}if(!(c instanceof P.default)){e.next=24;break}return e.abrupt("return",this._makeAndAddFeatureSet(c,r,n));case 24:return c._materializedTable||(d=(0,i.Z)((0,i.Z)({},c),{},{outFields:["*"]}),c._materializedTable=new P.default(d)),e.next=27,c._materializedTable.load();case 27:return e.abrupt("return",this._makeAndAddFeatureSet(c._materializedTable,r,n));case 28:return e.abrupt("return",null);case 29:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),r}(f.Z),ge=function(e){(0,l.Z)(r,e);var t=(0,o.Z)(r);function r(e){var n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return(0,s.Z)(this,r),(n=t.call(this))._url=e,n._overridespref=a,n._lrucache=i,n._interceptor=u,n.metadata=null,n._instantLayers=[],n}return(0,u.Z)(r,[{key:"url",get:function(){return this._url}},{key:"_makeAndAddFeatureSet",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=se(e,this._overridespref,null===r?["*"]:r,t,this._lrucache);return this._instantLayers.push({featureset:n,opitem:e,includeGeometry:t,outFields:JSON.stringify(r)}),n}},{key:"_loadMetaData",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,de(this._url);case 2:return t=e.sent,e.abrupt("return",(this.metadata=t,t));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"load",value:function(){return this._loadMetaData()}},{key:"clone",value:function(){return new r(this._url,this._overridespref,this._lrucache,this._interceptor)}},{key:"featureSetByName",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t){var r,i,s,u,l,o,c,d,f,h,p,y,v,_,g=arguments;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=!(g.length>1&&void 0!==g[1])||g[1],null===(i=g.length>2&&void 0!==g[2]?g[2]:null)&&(i=["*"]),i=(i=i.slice(0)).sort(),s=JSON.stringify(i),u=0;case 5:if(!(u<this._instantLayers.length)){e.next=12;break}if((l=this._instantLayers[u]).opitem.title!==t||l.includeGeometry!==r||l.outFields!==s){e.next=9;break}return e.abrupt("return",this._instantLayers[u].featureset);case 9:u++,e.next=5;break;case 12:return e.next=14,this._loadMetaData();case 14:o=e.sent,c=null,d=(0,n.Z)(o.layers?o.layers:[]);try{for(d.s();!(f=d.n()).done;)(h=f.value).name===t&&(c=h)}catch(a){d.e(a)}finally{d.f()}if(!c){p=(0,n.Z)(o.tables?o.tables:[]);try{for(p.s();!(y=p.n()).done;)(v=y.value).name===t&&(c=v)}catch(a){p.e(a)}finally{p.f()}}if(!c){e.next=24;break}return e.next=22,re(this._url+"/"+c.id,["*"]);case 22:return _=e.sent,e.abrupt("return",this._makeAndAddFeatureSet(_,r,i));case 24:return e.abrupt("return",null);case 25:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"featureSetById",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t){var r,i,s,u,l,o,c,d,f,h,p,y,v,_,g=arguments;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=!(g.length>1&&void 0!==g[1])||g[1],null===(i=g.length>2&&void 0!==g[2]?g[2]:["*"])&&(i=["*"]),i=(i=i.slice(0)).sort(),s=JSON.stringify(i),t=null!=t?t.toString():"",u=0;case 6:if(!(u<this._instantLayers.length)){e.next=13;break}if((l=this._instantLayers[u]).opitem.id!==t||l.includeGeometry!==r||l.outFields!==s){e.next=10;break}return e.abrupt("return",this._instantLayers[u].featureset);case 10:u++,e.next=6;break;case 13:return e.next=15,this._loadMetaData();case 15:o=e.sent,c=null,d=(0,n.Z)(o.layers?o.layers:[]);try{for(d.s();!(f=d.n()).done;)null!==(h=f.value).id&&void 0!==h.id&&h.id.toString()===t&&(c=h)}catch(a){d.e(a)}finally{d.f()}if(!c){p=(0,n.Z)(o.tables?o.tables:[]);try{for(p.s();!(y=p.n()).done;)null!==(v=y.value).id&&void 0!==v.id&&v.id.toString()===t&&(c=v)}catch(a){p.e(a)}finally{p.f()}}if(!c){e.next=25;break}return e.next=23,re(this._url+"/"+c.id,["*"]);case 23:return _=e.sent,e.abrupt("return",this._makeAndAddFeatureSet(_,r,i));case 25:return e.abrupt("return",null);case 26:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),r}(f.Z);function me(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new _e(e,t,r,n)}function be(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new ge(e,t,r,n)}function ke(e,t,r,n,a){if(null===e)return null;if(e instanceof P.default){switch(t){case"datasource":return se(e,a,e.outFields,!0,r,n).getDataSourceFeatureSet();case"parent":case"root":return se(e,a,e.outFields,!0,r,n)}return null}if(e instanceof g.Z)switch(t){case"datasource":return e.getDataSourceFeatureSet();case"parent":return e;case"root":return e.getRootFeatureSet()}return null}function we(e,t,r,n,a,i,s){return xe.apply(this,arguments)}function xe(){return xe=(0,c.Z)((0,a.Z)().mark((function e(t,r,n,i,s,u,l){var o,c,d,f,h,p,y=arguments;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=y.length>7&&void 0!==y[7]?y[7]:null,!Y.Z.applicationCache){e.next=8;break}if(!(c=Y.Z.applicationCache.getLayerInfo(t+":"+u.url))){e.next=8;break}return e.next=6,c;case 6:return d=e.sent,e.abrupt("return",se(new P.default({url:(0,k.US)(d.url)+"/"+r,outFields:["*"]}),n,i,s,l,o));case 8:return f=new ee.default({id:t,portal:u}).load(),Y.Z.applicationCache&&Y.Z.applicationCache.setLayerInfo(t+":"+u.url,f),e.prev=10,e.next=13,f;case 13:return p=e.sent,e.abrupt("return",se(new P.default({url:(0,k.US)(null!==(h=p.url)&&void 0!==h?h:"")+"/"+r,outFields:["*"]}),n,i,s,l,o));case 17:throw e.prev=17,e.t0=e.catch(10),Y.Z.applicationCache&&Y.Z.applicationCache.clearLayerInfo(t+":"+u.url),e.t0;case 20:case"end":return e.stop()}}),e,null,[[10,17]])}))),xe.apply(this,arguments)}},12829:function(e,t,r){r.d(t,{$X:function(){return w},QP:function(){return x},TO:function(){return Z},Xx:function(){return F},yN:function(){return S}});var n=r(74165),a=r(15861),i=r(37762),s=r(60136),u=r(92572),l=r(15671),o=r(43144),c=r(52639),d=r(51064),f=r(47238),h=r(45280),p=r(34333),y=r(74066),v=r(29876),_=r(65247),g=r(92026),m=r(48562),b=r(78952),k=function(){function e(t){(0,l.Z)(this,e),this.field=t,this.sqlRewritable=!1}return(0,o.Z)(e,[{key:"postInitialization",value:function(e,t){}}]),e}(),w=function(e){(0,s.Z)(r,e);var t=(0,u.Z)(r);function r(e){var n;return(0,l.Z)(this,r),(n=t.call(this,e)).sqlRewritable=!0,n}return(0,o.Z)(r,[{key:"extractValue",value:function(e){return e.attributes[this.field.name]}},{key:"rewriteSql",value:function(e){return{rewritten:this.sqlRewritable,where:e}}}]),r}(k),x=function(e){(0,s.Z)(r,e);var t=(0,u.Z)(r);function r(e,n,a){var i;return(0,l.Z)(this,r),(i=t.call(this,(0,v.JW)(e))).originalField=e,i.sqlRewritable=!0,i.field.name=n,i.field.alias=a,i}return(0,o.Z)(r,[{key:"rewriteSql",value:function(e,t){return{rewritten:this.sqlRewritable,where:(0,_.bB)(e,this.field.name,this.originalField.name,t.getFieldsIndex())}}},{key:"extractValue",value:function(e){return e.attributes[this.originalField.name]}}]),r}(k),Z=function(e){(0,s.Z)(r,e);var t=(0,u.Z)(r);function r(e,n,a){var i;for(var s in(0,l.Z)(this,r),(i=t.call(this,e)).codefield=n,i.lkp=a,i.reverseLkp={},a)i.reverseLkp[a[s]]=s;return i.sqlRewritable=!0,i}return(0,o.Z)(r,[{key:"rewriteSql",value:function(e,t){var n=this.evaluateNodeToWhereClause(e.parseTree,v.Bj.Standardised,this.field.name,this.codefield instanceof m.WhereClause?(0,_.zR)(this.codefield,v.Bj.Standardised):this.codefield,e.parameters);return n.includes(r.BADNESS)?{rewritten:!1,where:e}:{rewritten:this.sqlRewritable,where:m.WhereClause.create(n,(0,g.s3)(t._parent).getFieldsIndex())}}},{key:"evaluateNodeToWhereClause",value:function(e,t){var n,a,s,u,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,c=arguments.length>4?arguments[4]:void 0;switch(e.type){case"interval":return(0,_.TE)(this.evaluateNodeToWhereClause(e.value,t,l,o,c),e.qualifier,e.op);case"case-expression":var f=" CASE ";"simple"===e.format&&(f+=this.evaluateNodeToWhereClause(e.operand,t,l,r.BADNESS,c));for(var p=0;p<e.clauses.length;p++)f+=" WHEN "+this.evaluateNodeToWhereClause(e.clauses[p].operand,t,l,r.BADNESS,c)+" THEN "+this.evaluateNodeToWhereClause(e.clauses[p].value,t,l,r.BADNESS,c);return null!==e.else&&(f+=" ELSE "+this.evaluateNodeToWhereClause(e.else,t,l,r.BADNESS,c)),f+=" END ";case"parameter":var y=c[e.value.toLowerCase()];if("string"==typeof y)return"'"+y.toString().replace(/'/g,"''")+"'";if(y instanceof Date)return(0,_.oX)(y,t,null);if(y instanceof d.iG)return(0,_.mA)(y,t,null);if(y instanceof Array){for(var v=[],g=0;g<y.length;g++)"string"==typeof y[g]?v.push("'"+y[g].toString().replace(/'/g,"''")+"'"):y[g]instanceof Date?v.push((0,_.oX)(y[g],t,null)):y[g]instanceof d.iG?v.push((0,_.mA)(y[g],t,null)):v.push(y[g].toString());return v}return y.toString();case"expression-list":a=[];var m,b=(0,i.Z)(e.value);try{for(b.s();!(m=b.n()).done;){var k=m.value;a.push(this.evaluateNodeToWhereClause(k,t,l,o,c))}}catch(E){b.e(E)}finally{b.f()}return a;case"unary-expression":return" ( NOT "+this.evaluateNodeToWhereClause(e.expr,t,l,r.BADNESS,c)+" ) ";case"binary-expression":switch(e.operator){case"AND":return" ("+this.evaluateNodeToWhereClause(e.left,t,l,o,c)+" AND "+this.evaluateNodeToWhereClause(e.right,t,l,o,c)+") ";case"OR":return" ("+this.evaluateNodeToWhereClause(e.left,t,l,o,c)+" OR "+this.evaluateNodeToWhereClause(e.right,t,l,o,c)+") ";case"IS":if("null"!==e.right.type)throw new h.eS(h.f.UnsupportedIsRhs);return" ("+this.evaluateNodeToWhereClause(e.left,t,l,o,c)+" IS NULL )";case"ISNOT":if("null"!==e.right.type)throw new h.eS(h.f.UnsupportedIsRhs);return" ("+this.evaluateNodeToWhereClause(e.left,t,l,o,c)+" IS NOT NULL )";case"IN":if(n=[],"expression-list"===e.right.type){if("column-reference"===e.left.type&&e.left.column.toUpperCase()===this.field.name.toUpperCase()){var w,x=[],Z=!0,S=(0,i.Z)(e.right.value);try{for(S.s();!(w=S.n()).done;){var F=w.value;if("string"!==F.type){Z=!1;break}if(void 0===this.lkp[F.value]){Z=!1;break}x.push(this.lkp[F.value].toString())}}catch(E){S.e(E)}finally{S.f()}if(Z)return" ("+this.evaluateNodeToWhereClause(e.left,t,l,o,c)+" IN ("+x.join(",")+")) "}return n=this.evaluateNodeToWhereClause(e.right,t,l,o,c)," ("+this.evaluateNodeToWhereClause(e.left,t,l,o,c)+" IN ("+n.join(",")+")) "}return(u=this.evaluateNodeToWhereClause(e.right,t,l,o,c))instanceof Array?" ("+this.evaluateNodeToWhereClause(e.left,t,l,o,c)+" IN ("+u.join(",")+")) ":" ("+this.evaluateNodeToWhereClause(e.left,t,l,o,c)+" IN ("+u+")) ";case"NOT IN":if(n=[],"expression-list"===e.right.type){if("column-reference"===e.left.type&&e.left.column.toUpperCase()===this.field.name.toUpperCase()){var I,C=[],R=!0,D=(0,i.Z)(e.right.value);try{for(D.s();!(I=D.n()).done;){var T=I.value;if("string"!==T.type){R=!1;break}if(void 0===this.lkp[T.value]){R=!1;break}C.push(this.lkp[T.value].toString())}}catch(E){D.e(E)}finally{D.f()}if(R)return" ("+this.evaluateNodeToWhereClause(e.left,t,l,o,c)+" NOT IN ("+C.join(",")+")) "}return n=this.evaluateNodeToWhereClause(e.right,t,l,o,c)," ("+this.evaluateNodeToWhereClause(e.left,t,l,o,c)+" NOT IN ("+n.join(",")+")) "}return(u=this.evaluateNodeToWhereClause(e.right,t,l,o,c))instanceof Array?" ("+this.evaluateNodeToWhereClause(e.left,t,l,o,c)+" NOT IN ("+u.join(",")+")) ":" ("+this.evaluateNodeToWhereClause(e.left,t,l,o,c)+" NOT IN ("+u+")) ";case"BETWEEN":return s=this.evaluateNodeToWhereClause(e.right,t,l,r.BADNESS,c)," ("+this.evaluateNodeToWhereClause(e.left,t,l,r.BADNESS,c)+" BETWEEN "+s[0]+" AND "+s[1]+" ) ";case"NOTBETWEEN":return s=this.evaluateNodeToWhereClause(e.right,t,l,r.BADNESS,c)," ("+this.evaluateNodeToWhereClause(e.left,t,l,r.BADNESS,c)+" NOT BETWEEN "+s[0]+" AND "+s[1]+" ) ";case"LIKE":return""!==e.escape?" ("+this.evaluateNodeToWhereClause(e.left,t,l,r.BADNESS,c)+" LIKE "+this.evaluateNodeToWhereClause(e.right,t,l,r.BADNESS,c)+" ESCAPE '"+e.escape+"') ":" ("+this.evaluateNodeToWhereClause(e.left,t,l,r.BADNESS,c)+" LIKE "+this.evaluateNodeToWhereClause(e.right,t,l,r.BADNESS,c)+") ";case"NOT LIKE":return""!==e.escape?" ("+this.evaluateNodeToWhereClause(e.left,t,l,r.BADNESS,c)+" NOT LIKE "+this.evaluateNodeToWhereClause(e.right,t,l,r.BADNESS,c)+" ESCAPE '"+e.escape+"') ":" ("+this.evaluateNodeToWhereClause(e.left,t,l,r.BADNESS,c)+" NOT LIKE "+this.evaluateNodeToWhereClause(e.right,t,l,r.BADNESS,c)+") ";case"<>":case"=":if("column-reference"===e.left.type&&"string"===e.right.type){if(e.left.column.toUpperCase()===this.field.name.toUpperCase()&&void 0!==this.lkp[e.right.value.toString()])return" ("+o+" "+e.operator+" "+this.lkp[e.right.value.toString()].toString()+") "}else if("column-reference"===e.right.type&&"string"===e.left.type&&e.right.column.toUpperCase()===this.field.name.toUpperCase())return" ("+this.lkp[e.right.value.toString()].toString()+" "+e.operator+" "+o+") ";return" ("+this.evaluateNodeToWhereClause(e.left,t,l,r.BADNESS,c)+" "+e.operator+" "+this.evaluateNodeToWhereClause(e.right,t,l,r.BADNESS,c)+") ";case"<":case">":case">=":case"<=":case"*":case"-":case"+":case"/":case"||":return" ("+this.evaluateNodeToWhereClause(e.left,t,l,r.BADNESS,c)+" "+e.operator+" "+this.evaluateNodeToWhereClause(e.right,t,l,r.BADNESS,c)+") "}case"null":return"null";case"boolean":return!0===e.value?"1":"0";case"string":return"'"+e.value.toString().replace(/'/g,"''")+"'";case"timestamp":case"date":return(0,_.oX)(e.value,t,null);case"number":return e.value.toString();case"current-time":return(0,_.vR)("date"===e.mode,t);case"column-reference":return l&&l.toLowerCase()===e.column.toLowerCase()?"("+o+")":e.column;case"data-type":return e.value;case"function":var N=this.evaluateNodeToWhereClause(e.args,t,l,r.BADNESS,c);return(0,_.fz)(e.name,N,t)}throw new h.eS(h.f.UnsupportedSyntax,{node:e.type})}},{key:"extractValue",value:function(e){return this.codefield instanceof m.WhereClause?this.reverseLkp[this.codefield.calculateValueCompiled(e)]:this.reverseLkp[e.attributes[this.codefield]]}}]),r}(k);Z.BADNESS="_!!!_BAD_LKP_!!!!";var S=function(e){(0,s.Z)(r,e);var t=(0,u.Z)(r);function r(e,n){var a;return(0,l.Z)(this,r),(a=t.call(this,e))._sql=n,a}return(0,o.Z)(r,[{key:"rewriteSql",value:function(e,t){return{rewritten:!0,where:(0,_.bB)(e,this.field.name,(0,_.zR)(this._sql,v.Bj.Standardised),t.getFieldsIndex())}}},{key:"extractValue",value:function(e){return this._sql.calculateValueCompiled(e)}}]),r}(k),F=function(e){(0,s.Z)(r,e);var t=(0,u.Z)(r);function r(e){var n;return(0,l.Z)(this,r),(n=t.call(this,e))._calcFunc=null,n.declaredClass="esri.arcade.featureset.actions.Adapted",n.adaptedFields=[],n._extraFilter=null,n._extraFilter=e.extraFilter,n._parent=e.parentfeatureset,n._maxProcessing=30,n.adaptedFields=e.adaptedFields,n}return(0,o.Z)(r,[{key:"_initialiseFeatureSet",value:function(){null!==this._parent?(this.geometryType=this._parent.geometryType,this.objectIdField=this._parent.objectIdField,this.globalIdField=this._parent.globalIdField,this.spatialReference=this._parent.spatialReference,this.hasM=this._parent.hasM,this.hasZ=this._parent.hasZ,this.typeIdField=this._parent.typeIdField,this.types=this._parent.types):(this.spatialReference=new b.Z({wkid:4326}),this.objectIdField="",this.globalIdField="",this.geometryType=v.Qk.point,this.typeIdField="",this.types=null),this.fields=[];var e,t=(0,i.Z)(this.adaptedFields);try{for(t.s();!(e=t.n()).done;){var r=e.value;r.postInitialization(this,this._parent),this.fields.push(r.field)}}catch(n){t.e(n)}finally{t.f()}}},{key:"_getSet",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var r,a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this._wset){e.next=18;break}return e.next=3,this._ensureLoaded();case 3:if(a=null,!this._extraFilter){e.next=10;break}return e.next=7,this._getFilteredSet("",null,null,null,t);case 7:e.t0=e.sent,e.next=13;break;case 10:return e.next=12,null===(r=this._parent)||void 0===r?void 0:r._getSet(t);case 12:e.t0=e.sent;case 13:return a=e.t0,this._checkCancelled(t),(0,g.O3)(a),this._wset=new y.Z(a._candidates.slice(0),a._known.slice(0),a._ordered,this._clonePageDefinition(a.pagesDefinition)),e.abrupt("return",this._wset);case 18:return e.abrupt("return",this._wset);case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_isInFeatureSet",value:function(e){return(0,g.s3)(this._parent)._isInFeatureSet(e)}},{key:"_getFeatures",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t,r,a,s){var u,l,o,d,h,p,v,_,g,m,b,k,w,x,Z,S,F;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=[],-1!==r&&void 0===this._featureCache[r]&&l.push(r),o=this._maxQueryRate(),!0!==this._checkIfNeedToExpandKnownPage(t,o)){e.next=7;break}return e.next=6,this._expandPagedSet(t,o,0,0,s);case 6:return e.abrupt("return",this._getFeatures(t,r,a,s));case 7:for(d=0,h=t._lastFetchedIndex;h<t._known.length&&(++d<=a&&(t._lastFetchedIndex+=1),!(void 0===this._featureCache[t._known[h]]&&(t._known[h]!==r&&l.push(t._known[h]),l.length>=o)));h++);if(0!==l.length){e.next=11;break}return e.abrupt("return","success");case 11:return t=new y.Z([],l,t._ordered,null),p=Math.min(l.length,a),e.next=15,null===(u=this._parent)||void 0===u?void 0:u._getFeatures(t,-1,p,s);case 15:for(this._checkCancelled(s),v=[],_=0;_<p;_++)void 0!==(m=null===(g=this._parent)||void 0===g?void 0:g._featureFromCache(l[_]))&&v.push({geometry:m.geometry,attributes:m.attributes,id:l[_]});for(b=0,k=v;b<k.length;b++){w=k[b],x=[],Z=(0,i.Z)(this.adaptedFields);try{for(Z.s();!(S=Z.n()).done;)F=S.value,x[F.field.name]=F.extractValue(w)}catch(n){Z.e(n)}finally{Z.f()}this._featureCache[w.id]=new c.Z({attributes:x,geometry:(0,f.r1)(w.geometry)})}return e.abrupt("return","success");case 20:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a){return e.apply(this,arguments)}}()},{key:"_fetchAndRefineFeatures",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new h.EN(h.H9.NeverReach);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"_getFilteredSet",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t,r,a,s,u){var l,o,c,d,f,h,p,v;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=!1,o=this._reformulateWithoutAdaptions(a),l=o.cannot,a=o.where,c=!1,null===s){e.next=28;break}c=!0,d=[],f=(0,i.Z)(this.adaptedFields),e.prev=8,f.s();case 10:if((h=f.n()).done){e.next=19;break}if((p=h.value)instanceof w||!0!==s.scanForField(p.field.name)){e.next=17;break}if(p instanceof x){e.next=16;break}return s=null,c=!1,e.abrupt("break",19);case 16:d.push({field:p.field.name,newfield:p.originalField.name});case 17:e.next=10;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(8),f.e(e.t0);case 24:return e.prev=24,f.f(),e.finish(24);case 27:s&&d.length>0&&(s=s.replaceFields(d));case 28:return null!==a?null!==this._extraFilter&&(a=(0,_.$e)(this._extraFilter,a)):a=this._extraFilter,e.next=31,this._ensureLoaded();case 31:return e.next=33,(0,g.s3)(this._parent)._getFilteredSet(t,r,a,s,u);case 33:return v=e.sent,e.abrupt("return",(this._checkCancelled(u),!0===l?new y.Z(v._candidates.slice(0).concat(v._known.slice(0)),[],!0===c&&v._ordered,this._clonePageDefinition(v.pagesDefinition)):new y.Z(v._candidates.slice(0),v._known.slice(0),!0===c&&v._ordered,this._clonePageDefinition(v.pagesDefinition))));case 35:case"end":return e.stop()}}),e,this,[[8,21,24,27]])})));return function(t,r,n,a,i){return e.apply(this,arguments)}}()},{key:"_reformulateWithoutAdaptions",value:function(e){var t={cannot:!1,where:e};if(null!==e){var r,n=(0,i.Z)(this.adaptedFields);try{for(n.s();!(r=n.n()).done;){var a=r.value;if(!0===(0,_.hq)(e,a.field.name)){var s=a.rewriteSql(e,this);if(!0!==s.rewritten){t.cannot=!0,t.where=null;break}t.where=s.where}}}catch(u){n.e(u)}finally{n.f()}}return t}},{key:"_stat",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t,r,a,i,s,u,l){var o,c,d;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=!1,c=this._reformulateWithoutAdaptions(r),o=c.cannot,r=c.where,c=this._reformulateWithoutAdaptions(s),o=o||c.cannot,null!==(s=c.where)?null!==this._extraFilter&&(s=(0,_.$e)(this._extraFilter,s)):s=this._extraFilter,!0!==o){e.next=3;break}return e.abrupt("return",null===s&&""===a&&null===i?this._manualStat(t,r,u,l):{calculated:!1});case 3:return e.next=5,(0,g.s3)(this._parent)._stat(t,r,a,i,s,u,l);case 5:return d=e.sent,e.abrupt("return",!1===d.calculated?null===s&&""===a&&null===i?this._manualStat(t,r,u,l):{calculated:!1}:d);case 7:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a,i,s,u){return e.apply(this,arguments)}}()},{key:"_canDoAggregates",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t,r,a,s,u){var l,o,c,d,f,h,p,y,v,g;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this._parent){e.next=2;break}return e.abrupt("return",!1);case 2:l=0;case 3:if(!(l<t.length)){e.next=24;break}o=(0,i.Z)(this.adaptedFields),e.prev=5,o.s();case 7:if((c=o.n()).done){e.next=13;break}if(d=c.value,t[l].toLowerCase()!==d.field.name.toLowerCase()||d instanceof w){e.next=11;break}return e.abrupt("return",!1);case 11:e.next=7;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(5),o.e(e.t0);case 18:return e.prev=18,o.f(),e.finish(18);case 21:l++,e.next=3;break;case 24:f=[],h=0;case 26:if(!(h<r.length)){e.next=40;break}if(null===(p=r[h]).workingexpr){e.next=36;break}if(!(y=this._reformulateWithoutAdaptions(p.workingexpr)).cannot){e.next=32;break}return e.abrupt("return",!1);case 32:(v=p.clone()).workingexpr=y.where,f.push(v),e.next=37;break;case 36:f.push(p);case 37:h++,e.next=26;break;case 40:return g=this._reformulateWithoutAdaptions(u),e.abrupt("return",!g.cannot&&(null!==(u=g.where)?null!==this._extraFilter&&(u=(0,_.$e)(this._extraFilter,u)):u=this._extraFilter,this._parent._canDoAggregates(t,f,a,s,u)));case 42:case"end":return e.stop()}}),e,this,[[5,15,18,21]])})));return function(t,r,n,a,i){return e.apply(this,arguments)}}()},{key:"_getAggregatePagesDataSourceDefinition",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t,r,a,i,s,u,l){var o,c,d,f,p,y;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this._parent){e.next=2;break}throw new h.EN(h.H9.NeverReach);case 2:o=[],c=0;case 4:if(!(c<r.length)){e.next=18;break}if(null===(d=r[c]).workingexpr){e.next=14;break}if(!(f=this._reformulateWithoutAdaptions(d.workingexpr)).cannot){e.next=10;break}throw new h.EN(h.H9.NeverReach);case 10:(p=d.clone()).workingexpr=f.where,o.push(p),e.next=15;break;case 14:o.push(d);case 15:c++,e.next=4;break;case 18:if(!(y=this._reformulateWithoutAdaptions(s)).cannot){e.next=21;break}throw new h.EN(h.H9.NeverReach);case 21:return e.abrupt("return",(null!==(s=y.where)?null!==this._extraFilter&&(s=(0,_.$e)(this._extraFilter,s)):s=this._extraFilter,this._parent._getAggregatePagesDataSourceDefinition(t,o,a,i,s,u,l)));case 22:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a,i,s,u){return e.apply(this,arguments)}}()}],[{key:"findField",value:function(e,t){var r,n=(0,i.Z)(e);try{for(n.s();!(r=n.n()).done;){var a=r.value;if(a.name.toLowerCase()===t.toString().toLowerCase())return a}}catch(s){n.e(s)}finally{n.f()}return null}}]),r}(p.Z)},67820:function(e,t,r){r.d(t,{Z:function(){return _}});var n=r(74165),a=r(15861),i=r(15671),s=r(43144),u=r(60136),l=r(92572),o=r(45280),c=r(34333),d=r(74066),f=r(29876),h=r(65247),p=r(66978),y=r(48562),v=r(78952),_=function(e){(0,u.Z)(r,e);var t=(0,l.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).declaredClass="esri.arcade.featureset.actions.AttributeFilter",n._maxProcessing=1e3,n._parent=e.parentfeatureset,e.whereclause instanceof y.WhereClause?(n._whereclause=e.whereclause,n._whereClauseFunction=null):(n._whereClauseFunction=e.whereclause,n._whereclause=null),n}return(0,s.Z)(r,[{key:"_initialiseFeatureSet",value:function(){null!==this._parent?(this.fields=this._parent.fields.slice(0),this.geometryType=this._parent.geometryType,this.objectIdField=this._parent.objectIdField,this.globalIdField=this._parent.globalIdField,this.spatialReference=this._parent.spatialReference,this.hasM=this._parent.hasM,this.hasZ=this._parent.hasZ,this.typeIdField=this._parent.typeIdField,this.types=this._parent.types):(this.fields=[],this.typeIdField="",this.objectIdField="",this.globalIdField="",this.spatialReference=new v.Z({wkid:4326}),this.geometryType=f.Qk.point)}},{key:"_getSet",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this._wset){e.next=7;break}return e.next=3,this._ensureLoaded();case 3:return e.next=5,this._parent._getFilteredSet("",null,this._whereclause,null,t);case 5:return r=e.sent,e.abrupt("return",(this._checkCancelled(t),null!==this._whereClauseFunction?this._wset=new d.Z(r._candidates.slice(0).concat(r._known.slice(0)),[],r._ordered,this._clonePageDefinition(r.pagesDefinition)):this._wset=new d.Z(r._candidates.slice(0),r._known.slice(0),r._ordered,this._clonePageDefinition(r.pagesDefinition)),this._wset));case 7:return e.abrupt("return",this._wset);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_isInFeatureSet",value:function(e){var t,r=null===(t=this._parent)||void 0===t?void 0:t._isInFeatureSet(e);return r===f.dj.NotInFeatureSet?r:void 0===(r=this._idstates[e])?f.dj.Unknown:r}},{key:"_getFeature",value:function(e,t,r){return this._parent._getFeature(e,t,r)}},{key:"_getFeatures",value:function(e,t,r,n){return this._parent._getFeatures(e,t,r,n)}},{key:"_featureFromCache",value:function(e){return this._parent._featureFromCache(e)}},{key:"executeWhereClause",value:function(e){var t,r;return null!==(t=null===(r=this._whereclause)||void 0===r?void 0:r.testFeature(e))&&void 0!==t&&t}},{key:"executeWhereClauseDeferred",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===this._whereClauseFunction){e.next=3;break}return r=this._whereClauseFunction(t),e.abrupt("return",((0,p.y8)(r),r));case 3:return e.abrupt("return",this.executeWhereClause(t));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_fetchAndRefineFeatures",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t,r,a){var i,s,u,l,o,c,h,p,y,v,_;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=new d.Z([],t,!1,null),u=Math.min(r,t.length),e.next=3,null===(i=this._parent)||void 0===i?void 0:i._getFeatures(s,-1,u,a);case 3:if(this._checkCancelled(a),null!=this._whereClauseFunction){e.next=7;break}for(l=0;l<u;l++)c=null===(o=this._parent)||void 0===o?void 0:o._featureFromCache(t[l]),!0===this.executeWhereClause(c)?this._idstates[t[l]]=f.dj.InFeatureSet:this._idstates[t[l]]=f.dj.NotInFeatureSet;return e.abrupt("return","success");case 7:h=[],p=0;case 9:if(!(p<u)){e.next=19;break}return v=null===(y=this._parent)||void 0===y?void 0:y._featureFromCache(t[p]),e.t0=h,e.next=14,this.executeWhereClauseDeferred(v);case 14:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 16:p++,e.next=9;break;case 19:for(_=0;_<r;_++)!0===h[_]?this._idstates[t[_]]=f.dj.InFeatureSet:this._idstates[t[_]]=f.dj.NotInFeatureSet;return e.abrupt("return","success");case 21:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_getFilteredSet",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t,r,a,i,s){var u;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null!==this._whereClauseFunction||(null!==a?null!==this._whereclause&&(a=(0,h.$e)(this._whereclause,a)):a=this._whereclause),e.next=3,this._ensureLoaded();case 3:return e.next=5,this._parent._getFilteredSet(t,r,a,i,s);case 5:return u=e.sent,e.abrupt("return",(this._checkCancelled(s),null!==this._whereClauseFunction?new d.Z(u._candidates.slice(0).concat(u._known.slice(0)),[],u._ordered,this._clonePageDefinition(u.pagesDefinition)):new d.Z(u._candidates.slice(0),u._known.slice(0),u._ordered,this._clonePageDefinition(u.pagesDefinition))));case 7:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a,i){return e.apply(this,arguments)}}()},{key:"_stat",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t,r,a,i,s,u,l){var o,c;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===this._whereClauseFunction){e.next=2;break}return e.abrupt("return",null===s&&""===a&&null===i?this._manualStat(t,r,u,l):{calculated:!1});case 2:return o=this._whereclause,null!==s&&null!==this._whereclause&&(o=(0,h.$e)(this._whereclause,s)),e.next=6,this._parent._stat(t,r,a,i,o,u,l);case 6:return c=e.sent,e.abrupt("return",!1===c.calculated?null===s&&""===a&&null===i?this._manualStat(t,r,u,l):{calculated:!1}:c);case 8:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a,i,s,u){return e.apply(this,arguments)}}()},{key:"_canDoAggregates",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t,r,a,i,s){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===this._whereClauseFunction&&(null!==s?null!==this._whereclause&&(s=(0,h.$e)(this._whereclause,s)):s=this._whereclause,null!==this._parent&&this._parent._canDoAggregates(t,r,a,i,s)));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a,i){return e.apply(this,arguments)}}()},{key:"_getAggregatePagesDataSourceDefinition",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t,r,a,i,s,u,l){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this._parent){e.next=2;break}throw new o.EN(o.H9.NeverReach);case 2:return e.abrupt("return",(null!==s?null!==this._whereclause&&(s=(0,h.$e)(this._whereclause,s)):s=this._whereclause,this._parent._getAggregatePagesDataSourceDefinition(t,r,a,i,s,u,l)));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a,i,s,u){return e.apply(this,arguments)}}()}],[{key:"registerAction",value:function(){c.Z._featuresetFunctions.filter=function(e){if("function"==typeof e)return new r({parentfeatureset:this,whereclause:e});var t=null;return e instanceof y.WhereClause&&(t=e),new r({parentfeatureset:this,whereclause:t})}}}]),r}(c.Z)},89066:function(e,t,r){r.d(t,{Z:function(){return y}});var n=r(37762),a=r(74165),i=r(15861),s=r(15671),u=r(43144),l=r(60136),o=r(92572),c=r(44715),d=r(45280),f=r(34333),h=r(74066),p=r(82279),y=function(e){(0,l.Z)(r,e);var t=(0,o.Z)(r);function r(e){var n;return(0,s.Z)(this,r),(n=t.call(this,e))._orderbyclause=null,n.declaredClass="esri.arcade.featureset.actions.OrderBy",n._maxProcessing=100,n._orderbyclause=e.orderbyclause,n._parent=e.parentfeatureset,n}return(0,u.Z)(r,[{key:"_getSet",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t){var r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this._wset){e.next=7;break}return e.next=3,this._ensureLoaded();case 3:return e.next=5,this._getFilteredSet("",null,null,this._orderbyclause,t);case 5:return r=e.sent,e.abrupt("return",(this._checkCancelled(t),this._wset=r,this._wset));case 7:return e.abrupt("return",this._wset);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"manualOrderSet",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t,r){var n,i,s,u;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getIdColumnDictionary(t,[],-1,r);case 2:for(i=e.sent,null===(n=this._orderbyclause)||void 0===n||n.order(i),s=new h.Z([],[],!0,null),u=0;u<i.length;u++)s._known.push(i[u].id);return e.abrupt("return",s);case 7:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getIdColumnDictionary",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t,r,i,s){var u,l,o,d,f,h,p;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i<t._known.length-1)){e.next=17;break}if(u=this._maxQueryRate(),"GETPAGES"!==t._known[i+1]){e.next=6;break}return e.next=5,(0,c.W)(this._parent._expandPagedSet(t,u,0,0,s));case 5:return e.abrupt("return",this.getIdColumnDictionary(t,r,i,s));case 6:for(l=i+1,o=[];l<t._known.length&&"GETPAGES"!==t._known[l];)o.push(t._known[l]),l++;return i+=o.length,e.next=12,(0,c.W)(this._parent._getFeatureBatch(o,s));case 12:d=e.sent,this._checkCancelled(s),f=(0,n.Z)(d);try{for(f.s();!(h=f.n()).done;)p=h.value,r.push({id:p.attributes[this.objectIdField],feature:p})}catch(a){f.e(a)}finally{f.f()}return e.abrupt("return",this.getIdColumnDictionary(t,r,i,s));case 17:if(!(t._candidates.length>0)){e.next=24;break}return e.next=20,(0,c.W)(this._refineSetBlock(t,this._maxProcessingRate(),s));case 20:this._checkCancelled(s),e.t0=this.getIdColumnDictionary(t,r,i,s),e.next=25;break;case 24:e.t0=r;case 25:return e.abrupt("return",e.t0);case 26:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a){return e.apply(this,arguments)}}()},{key:"_isInFeatureSet",value:function(e){return this._parent._isInFeatureSet(e)}},{key:"_getFeatures",value:function(e,t,r,n){return this._parent._getFeatures(e,t,r,n)}},{key:"_featureFromCache",value:function(e){if(void 0===this._featureCache[e]){var t=this._parent._featureFromCache(e);if(void 0===t)return;return null===t?null:(this._featureCache[e]=t,t)}return this._featureCache[e]}},{key:"_fetchAndRefineFeatures",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new d.EN(d.H9.NeverReach);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"_getFilteredSet",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t,r,n,i,s){var u,l,o,c;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ensureLoaded();case 2:return e.next=4,this._parent._getFilteredSet(t,r,n,null===i?this._orderbyclause:i,s);case 4:if(u=e.sent,this._checkCancelled(s),l=new h.Z(u._candidates.slice(0),u._known.slice(0),u._ordered,this._clonePageDefinition(u.pagesDefinition)),o=!0,u._candidates.length>0&&(o=!1),!1!==l._ordered){e.next=13;break}return e.next=11,this.manualOrderSet(l,s);case 11:return c=e.sent,e.abrupt("return",(!1===o&&(null===r&&null===n||(c=new h.Z(c._candidates.slice(0).concat(c._known.slice(0)),[],c._ordered,this._clonePageDefinition(c.pagesDefinition)))),c));case 13:return e.abrupt("return",l);case 14:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a,i){return e.apply(this,arguments)}}()}],[{key:"registerAction",value:function(){f.Z._featuresetFunctions.orderBy=function(e){return""===e?this:new r({parentfeatureset:this,orderbyclause:new p.Z(e)})}}}]),r}(f.Z)},45184:function(e,t,r){r.d(t,{Z:function(){return h}});var n=r(74165),a=r(15861),i=r(15671),s=r(43144),u=r(60136),l=r(92572),o=r(45280),c=r(34333),d=r(74066),f=r(29876),h=function(e){(0,u.Z)(r,e);var t=(0,l.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e))._topnum=0,n.declaredClass="esri.arcade.featureset.actions.Top",n._countedin=0,n._maxProcessing=100,n._topnum=e.topnum,n._parent=e.parentfeatureset,n}return(0,s.Z)(r,[{key:"_getSet",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this._wset){e.next=7;break}return e.next=3,this._ensureLoaded();case 3:return e.next=5,this._parent._getSet(t);case 5:return r=e.sent,e.abrupt("return",(this._wset=new d.Z(r._candidates.slice(0),r._known.slice(0),!1,this._clonePageDefinition(r.pagesDefinition)),this._setKnownLength(this._wset)>this._topnum&&(this._wset._known=this._wset._known.slice(0,this._topnum)),this._setKnownLength(this._wset)>=this._topnum&&(this._wset._candidates=[]),this._wset));case 7:return e.abrupt("return",this._wset);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_setKnownLength",value:function(e){return e._known.length>0&&"GETPAGES"===e._known[e._known.length-1]?e._known.length-1:e._known.length}},{key:"_isInFeatureSet",value:function(e){var t=this._parent._isInFeatureSet(e);if(t===f.dj.NotInFeatureSet)return t;var r=this._idstates[e];return r===f.dj.InFeatureSet||r===f.dj.NotInFeatureSet?r:t===f.dj.InFeatureSet&&void 0===r?this._countedin<this._topnum?(this._idstates[e]=f.dj.InFeatureSet,this._countedin++,f.dj.InFeatureSet):(this._idstates[e]=f.dj.NotInFeatureSet,f.dj.NotInFeatureSet):f.dj.Unknown}},{key:"_expandPagedSet",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t,r,a,i,s){var u,l;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this._parent){e.next=2;break}throw new o.EN(o.H9.NotImplemented);case 2:if(r>this._topnum&&(r=this._topnum),!(this._countedin>=this._topnum&&t.pagesDefinition.internal.set.length<=t.pagesDefinition.resultOffset)){e.next=5;break}return u=t._known.length,e.abrupt("return",(u>0&&"GETPAGES"===t._known[u-1]&&(t._known.length=u-1),(u=t._candidates.length)>0&&"GETPAGES"===t._candidates[u-1]&&(t._candidates.length=u-1),"success"));case 5:return e.next=7,this._parent._expandPagedSet(t,r,a,i,s);case 7:return l=e.sent,e.abrupt("return",(this._setKnownLength(t)>this._topnum&&(t._known.length=this._topnum),this._setKnownLength(t)>=this._topnum&&(t._candidates.length=0),l));case 9:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a,i){return e.apply(this,arguments)}}()},{key:"_getFeatures",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t,r,a,i){var s,u,l,o,c,f,h,p;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=[],u=this._maxQueryRate(),!0!==this._checkIfNeedToExpandKnownPage(t,u)){e.next=5;break}return e.next=4,this._expandPagedSet(t,u,0,0,i);case 4:return e.abrupt("return",this._getFeatures(t,r,a,i));case 5:for(-1!==r&&void 0===this._featureCache[r]&&s.push(r),l=0,o=t._lastFetchedIndex;o<t._known.length&&(++l<=a&&(t._lastFetchedIndex+=1),!(void 0===this._featureCache[t._known[o]]&&(t._known[o]!==r&&s.push(t._known[o]),s.length>u)));o++);if(0!==s.length){e.next=10;break}return e.abrupt("return","success");case 10:return c=new d.Z([],s,!1,null),f=Math.min(s.length,a),e.next=13,this._parent._getFeatures(c,-1,f,i);case 13:for(h=0;h<f;h++)void 0!==(p=this._parent._featureFromCache(s[h]))&&(this._featureCache[s[h]]=p);return e.abrupt("return","success");case 15:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a){return e.apply(this,arguments)}}()},{key:"_getFilteredSet",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t,r,a,i,s){var u;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ensureLoaded();case 2:return e.next=4,this._getSet(s);case 4:return u=e.sent,e.abrupt("return",new d.Z(u._candidates.slice(0).concat(u._known.slice(0)),[],!1,this._clonePageDefinition(u.pagesDefinition)));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a,i){return e.apply(this,arguments)}}()},{key:"_refineKnowns",value:function(e,t){for(var r=0,n=null,a=[],i=0;i<e._candidates.length;i++){var s=this._isInFeatureSet(e._candidates[i]);if(s===f.dj.InFeatureSet){if(e._known.push(e._candidates[i]),r+=1,null===n?n={start:i,end:i}:n.end===i-1?n.end=i:(a.push(n),n={start:i,end:i}),e._known.length>=this._topnum)break}else if(s===f.dj.NotInFeatureSet)null===n?n={start:i,end:i}:n.end===i-1?n.end=i:(a.push(n),n={start:i,end:i}),r+=1;else if(s===f.dj.Unknown)break;if(r>=t)break}null!==n&&a.push(n);for(var u=a.length-1;u>=0;u--)e._candidates.splice(a[u].start,a[u].end-a[u].start+1);this._setKnownLength(e)>this._topnum&&(e._known=e._known.slice(0,this._topnum)),this._setKnownLength(e)>=this._topnum&&(e._candidates=[])}},{key:"_stat",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{calculated:!1});case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"_canDoAggregates",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}],[{key:"registerAction",value:function(){c.Z._featuresetFunctions.top=function(e){return new r({parentfeatureset:this,topnum:e})}}}]),r}(c.Z)},84272:function(e,t,r){r.d(t,{Z:function(){return k}});var n=r(37762),a=r(74165),i=r(15861),s=r(15671),u=r(43144),l=r(60136),o=r(92572),c=r(52639),d=r(45280),f=r(34333),h=r(74066),p=r(29876),y=r(65247),v=r(32238),_=r(64326),g=r(87165),m=r(83040),b=r(21149),k=function(e){(0,l.Z)(r,e);var t=(0,o.Z)(r);function r(e){var n;return(0,s.Z)(this,r),(n=t.call(this,e)).declaredClass="esri.arcade.featureset.sources.FeatureLayerMemory",n._removeGeometry=!1,n._overrideFields=null,n._forceIsTable=!1,e.spatialReference&&(n.spatialReference=e.spatialReference),n._transparent=!0,n._maxProcessing=1e3,n._layer=e.layer,n._wset=null,!0===e.isTable&&(n._forceIsTable=!0),void 0!==e.outFields&&(n._overrideFields=e.outFields),void 0!==e.includeGeometry&&(n._removeGeometry=!1===e.includeGeometry),n}return(0,u.Z)(r,[{key:"_maxQueryRate",value:function(){return p.tI}},{key:"end",value:function(){return this._layer}},{key:"optimisePagingFeatureQueries",value:function(){}},{key:"loadImpl",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==this._layer.loaded){e.next=4;break}e.t0=(this._initialiseFeatureSet(),this),e.next=8;break;case 4:return e.next=6,this._layer.load();case 6:this._initialiseFeatureSet(),e.t0=this;case 8:return e.abrupt("return",e.t0);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"gdbVersion",get:function(){return""}},{key:"_initialiseFeatureSet",value:function(){if(null==this.spatialReference&&(this.spatialReference=this._layer.spatialReference),this.geometryType=this._layer.geometryType,this.fields=this._layer.fields.slice(0),this._layer.outFields)if(1===this._layer.outFields.length&&"*"===this._layer.outFields[0]);else{var e,t=[],r=(0,n.Z)(this.fields);try{for(r.s();!(e=r.n()).done;){var a=e.value;if("oid"===a.type)t.push(a);else{var i,s=(0,n.Z)(this._layer.outFields);try{for(s.s();!(i=s.n()).done;){if(i.value.toLowerCase()===a.name.toLowerCase()){t.push(a);break}}}catch(g){s.e(g)}finally{s.f()}}}}catch(g){r.e(g)}finally{r.f()}this.fields=t}if(null!==this._overrideFields)if(1===this._overrideFields.length&&"*"===this._overrideFields[0])this._overrideFields=null;else{var u,l=[],o=[],c=(0,n.Z)(this.fields);try{for(c.s();!(u=c.n()).done;){var d=u.value;if("oid"===d.type)l.push(d),o.push(d.name);else{var f,h=(0,n.Z)(this._overrideFields);try{for(h.s();!(f=h.n()).done;){if(f.value.toLowerCase()===d.name.toLowerCase()){l.push(d),o.push(d.name);break}}}catch(g){h.e(g)}finally{h.f()}}}}catch(g){c.e(g)}finally{c.f()}this.fields=l,this._overrideFields=o}this.objectIdField=this._layer.objectIdField;var y,v=(0,n.Z)(this.fields);try{for(v.s();!(y=v.n()).done;){var _=y.value;"global-id"===_.type&&(this.globalIdField=_.name)}}catch(g){v.e(g)}finally{v.f()}this.hasM=this._layer.supportsM,this.hasZ=this._layer.supportsZ,this._databaseType=p.Bj.Standardised,this.typeIdField=this._layer.typeIdField,this.types=this._layer.types}},{key:"isTable",value:function(){return this._forceIsTable||this._layer.isTable||"table"===this._layer.type||!this._layer.geometryType}},{key:"_isInFeatureSet",value:function(){return p.dj.InFeatureSet}},{key:"_candidateIdTransform",value:function(e){return e}},{key:"_getSet",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t){var r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this._wset){e.next=7;break}return e.next=3,this._ensureLoaded();case 3:return e.next=5,this._getFilteredSet("",null,null,null,t);case 5:return r=e.sent,e.abrupt("return",(this._wset=r,r));case 7:return e.abrupt("return",this._wset);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_changeFeature",value:function(e){var t,r={},a=(0,n.Z)(this.fields);try{for(a.s();!(t=a.n()).done;){var i=t.value;r[i.name]=e.attributes[i.name]}}catch(s){a.e(s)}finally{a.f()}return new c.Z({geometry:!0===this._removeGeometry?null:e.geometry,attributes:r})}},{key:"_getFilteredSet",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t,r,n,i,s){var u,l,o,c,d,f=this;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u="",l=!1,null!==i&&(u=i.constructClause(),l=!0),!this.isTable()||!r||null===t||""===t){e.next=3;break}return e.abrupt("return",new h.Z([],[],!0,null));case 3:return(o=new b.Z).where=null===n?null===r?"1=1":"":(0,y.zR)(n,p.Bj.Standardised),o.spatialRelationship=this._makeRelationshipEnum(t),o.outSpatialReference=this.spatialReference,o.orderByFields=""!==u?u.split(","):null,o.geometry=null===r?null:r,o.returnGeometry=!0,o.relationParameter=this._makeRelationshipParam(t),e.next=7,this._layer.queryFeatures(o);case 7:if(null!==(c=e.sent)){e.next=10;break}return e.abrupt("return",new h.Z([],[],l,null));case 10:return this._checkCancelled(s),d=[],c.features.forEach((function(e){var t=e.attributes[f._layer.objectIdField];d.push(t),f._featureCache[t]=f._changeFeature(e)})),e.abrupt("return",new h.Z([],d,l,null));case 14:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a,i){return e.apply(this,arguments)}}()},{key:"_makeRelationshipEnum",value:function(e){if(e.includes("esriSpatialRelRelation"))return"relation";switch(e){case"esriSpatialRelRelation":return"relation";case"esriSpatialRelIntersects":return"intersects";case"esriSpatialRelContains":return"contains";case"esriSpatialRelOverlaps":return"overlaps";case"esriSpatialRelWithin":return"within";case"esriSpatialRelTouches":return"touches";case"esriSpatialRelCrosses":return"crosses";case"esriSpatialRelEnvelopeIntersects":return"envelope-intersects"}return e}},{key:"_makeRelationshipParam",value:function(e){return e.includes("esriSpatialRelRelation")?e.split(":")[1]:""}},{key:"_queryAllFeatures",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(){var t,r,n,i,s=this;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._wset){e.next=2;break}return e.abrupt("return",this._wset);case 2:return(t=new b.Z).where="1=1",e.next=6,this._ensureLoaded();case 6:if(!this._layer.source||!this._layer.source.items){e.next=9;break}return r=[],e.abrupt("return",(this._layer.source.items.forEach((function(e){var t=e.attributes[s._layer.objectIdField];r.push(t),s._featureCache[t]=s._changeFeature(e)})),this._wset=new h.Z([],r,!1,null),this._wset));case 9:return e.next=11,this._layer.queryFeatures(t);case 11:return n=e.sent,i=[],e.abrupt("return",(n.features.forEach((function(e){var t=e.attributes[s._layer.objectIdField];i.push(t),s._featureCache[t]=s._changeFeature(e)})),this._wset=new h.Z([],i,!1,null),this._wset));case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getFeatures",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t,r,n){var i,s;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i=[],-1!==r&&void 0===this._featureCache[r]&&i.push(r),s=t._lastFetchedIndex;s<t._known.length&&(t._lastFetchedIndex+=1,!(void 0===this._featureCache[t._known[s]]&&(t._known[s]!==r&&i.push(t._known[s]),i.length>n)));s++);if(0!==i.length){e.next=5;break}return e.abrupt("return","success");case 5:throw new d.EN(d.H9.MissingFeatures);case 6:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_refineSetBlock",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"_stat",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{calculated:!1});case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"_canDoAggregates",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"relationshipMetaData",value:function(){return[]}},{key:"nativeCapabilities",value:function(){var e;return{title:null!==(e=this._layer.title)&&void 0!==e?e:"",canQueryRelated:!1,source:this,capabilities:this._layer.capabilities,databaseType:this._databaseType,requestStandardised:!0}}},{key:"queryAttachments",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",[]);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getFeatureByObjectId",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t){var r,n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new b.Z).where=this.objectIdField+"="+t.toString(),e.next=4,this._layer.queryFeatures(r);case 4:return n=e.sent,e.abrupt("return",1===n.features.length?n.features[0]:null);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getOwningSystemUrl",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return","");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getIdentityUser",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return","");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"preferredTimeReference",get:function(){var e,t,r;return null!==(e=null===(t=this._layer)||void 0===t||null===(r=t.preferredTimeReference)||void 0===r?void 0:r.toJSON())&&void 0!==e?e:null}},{key:"dateFieldsTimeReference",get:function(){var e,t,r;return null!==(e=null===(t=this._layer)||void 0===t||null===(r=t.dateFieldsTimeReference)||void 0===r?void 0:r.toJSON())&&void 0!==e?e:null}},{key:"datesInUnknownTimezone",get:function(){var e;return null===(e=this._layer)||void 0===e?void 0:e.datesInUnknownTimezone}},{key:"editFieldsInfo",get:function(){var e,t,r;return null!==(e=null===(t=this._layer)||void 0===t||null===(r=t.editFieldsInfo)||void 0===r?void 0:r.toJSON())&&void 0!==e?e:null}},{key:"timeInfo",get:function(){var e,t,r;return null!==(e=null===(t=this._layer)||void 0===t||null===(r=t.timeInfo)||void 0===r?void 0:r.toJSON())&&void 0!==e?e:null}}],[{key:"_cloneAttr",value:function(e){var t={};for(var r in e)t[r]=e[r];return t}},{key:"create",value:function(e,t){var a=e.layerDefinition.objectIdField,i=e.layerDefinition.typeIdField?e.layerDefinition.typeIdField:"",s=[];if(e.layerDefinition.types){var u,l=(0,n.Z)(e.layerDefinition.types);try{for(l.s();!(u=l.n()).done;){var o=u.value;s.push(g.Z.fromJSON(o))}}catch(B){l.e(B)}finally{l.f()}}var c=e.layerDefinition.geometryType;void 0===c&&(c=e.featureSet.geometryType||"");var d=e.featureSet.features,f=t.toJSON();if(""===a||void 0===a){var h,p=!1,y=(0,n.Z)(e.layerDefinition.fields);try{for(y.s();!(h=y.n()).done;){var b=h.value;if("oid"===b.type||"esriFieldTypeOID"===b.type){a=b.name,p=!0;break}}}catch(B){y.e(B)}finally{y.f()}if(!1===p){for(var k="FID",w=!0,x=0;w;){var Z,S=!0,F=(0,n.Z)(e.layerDefinition.fields);try{for(F.s();!(Z=F.n()).done;){if(Z.value.name===k){S=!1;break}}}catch(B){F.e(B)}finally{F.f()}!0===S?w=!1:k="FID"+(++x).toString()}e.layerDefinition.fields.push({type:"esriFieldTypeOID",name:k,alias:k});for(var I=[],C=0;C<d.length;C++)I.push({geometry:e.featureSet.features[C].geometry,attributes:e.featureSet.features[C].attributes?this._cloneAttr(e.featureSet.features[C].attributes):{}}),I[C].attributes[k]=C;d=I,a=k}}var R,D=[],T=(0,n.Z)(e.layerDefinition.fields);try{for(T.s();!(R=T.n()).done;){var N=R.value;N instanceof m.Z?D.push(N):D.push(m.Z.fromJSON(N))}}catch(B){T.e(B)}finally{T.f()}var E=c;switch(E||(E=""),E){case"esriGeometryPoint":E="point";break;case"esriGeometryPolyline":E="polyline";break;case"esriGeometryPolygon":E="polygon";break;case"esriGeometryExtent":E="extent";break;case"esriGeometryMultipoint":E="multipoint";break;case"":case"esriGeometryNull":E="esriGeometryNull"}if("esriGeometryNull"!==E){var L,O=(0,n.Z)(d);try{for(O.s();!(L=O.n()).done;){var A=L.value;A.geometry&&A.geometry instanceof v.Z==0&&(A.geometry.type=E,void 0===A.geometry.spatialReference&&(A.geometry.spatialReference=f))}}catch(B){O.e(B)}finally{O.f()}}else{var j,P=(0,n.Z)(d);try{for(P.s();!(j=P.n()).done;){var q=j.value;q.geometry&&(q.geometry=null)}}catch(B){P.e(B)}finally{P.f()}}var G={outFields:["*"],source:d,fields:D,types:s,typeIdField:i,objectIdField:a,spatialReference:t};return""!==E&&"esriGeometryNull"!==E&&null!==E&&(G.geometryType=E),new r({layer:new _.default(G),spatialReference:t,isTable:null===E||""===E||"esriGeometryNull"===E})}}]),r}(f.Z)},82279:function(e,t,r){r.d(t,{Z:function(){return u}});var n=r(37762),a=r(15671),i=r(43144);function s(e,t){return e===t?0:null===e?-1:null===t?1:e<t?-1:1}var u=function(){function e(t){(0,a.Z)(this,e);var r=t.split(",");this._fields=[],this._directions=[];for(var n=0;n<r.length;n++){var i=r[n].match(/\S+/g);this._fields.push(i[0]),2===i.length?"asc"===i[1].toLowerCase()?this._directions.push(1):this._directions.push(0):this._directions.push(1)}}return(0,i.Z)(e,[{key:"constructClause",value:function(){for(var e="",t=0;t<this._fields.length;t++)0!==t&&(e+=","),e+=this._fields[t],1===this._directions[t]?e+=" ASC":e+=" DESC";return e}},{key:"order",value:function(e){var t=this;e.sort((function(e,r){for(var n=0;n<t._fields.length;n++){var a,i=t.featureValue(e.feature,t._fields[n],n),u=t.featureValue(r.feature,t._fields[n],n);if(0!==(a=1===t._directions[n]?s(i,u):-1*s(i,u)))return a}return 0}))}},{key:"scanForField",value:function(e){for(var t=0;t<this._fields.length;t++)if(this._fields[t].toLowerCase().trim()===e.toLowerCase().trim())return!0;return!1}},{key:"replaceFields",value:function(t){for(var r="",a=0;a<this._fields.length;a++){0!==a&&(r+=",");var i,s=this._fields[a],u=(0,n.Z)(t);try{for(u.s();!(i=u.n()).done;){var l=i.value;if(s.toLowerCase()===l.field.toLowerCase()){s=l.newfield;break}}}catch(o){u.e(o)}finally{u.f()}r+=s,1===this._directions[a]?r+=" ASC":r+=" DESC"}return new e(r)}},{key:"featureValue",value:function(e,t,r){var n=e.attributes[t];if(void 0!==n)return n;for(var a in e.attributes)if(t.toLowerCase()===a.toLowerCase())return this._fields[r]=a,e.attributes[a];return null}}]),e}()},18759:function(e,t,r){r.d(t,{WJ:function(){return h},Xq:function(){return f},an:function(){return d},lN:function(){return n}});var n,a,i=r(29439),s=r(37762),u=r(15671),l=r(43144),o=r(92026),c=r(27546),d=-3;(a=n||(n={}))[a.ALL=0]="ALL",a[a.SOME=1]="SOME";var f=function(){function e(t,r,n){(0,u.Z)(this,e),this._namespace=t,this._storage=r,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),this._namespace+=":",n&&(this._storage.registerRemoveFunc(this._namespace,n),this._removeFunc=!0)}return(0,l.Z)(e,[{key:"destroy",value:function(){this._storage.clear(this._namespace),this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace),this._storage.deregister(this),this._storage=null}},{key:"namespace",get:function(){return this._namespace.slice(0,-1)}},{key:"hitRate",get:function(){return this._hit/(this._hit+this._miss)}},{key:"size",get:function(){return this._storage.size}},{key:"maxSize",get:function(){return this._storage.maxSize}},{key:"resetHitRate",value:function(){this._hit=this._miss=0}},{key:"put",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this._storage.put(this._namespace+e,t,r,n)}},{key:"get",value:function(e){var t=this._storage.get(this._namespace+e);return void 0===t?++this._miss:++this._hit,t}},{key:"pop",value:function(e){var t=this._storage.pop(this._namespace+e);return void 0===t?++this._miss:++this._hit,t}},{key:"updateSize",value:function(e,t,r){this._storage.updateSize(this._namespace+e,t,r)}},{key:"clear",value:function(){this._storage.clear(this._namespace)}},{key:"clearAll",value:function(){this._storage.clearAll()}},{key:"getStats",value:function(){return this._storage.getStats()}},{key:"resetStats",value:function(){this._storage.resetStats()}}]),e}(),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10485760;(0,u.Z)(this,e),this._maxSize=t,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new c.Z,this._users=new c.Z}return(0,l.Z)(e,[{key:"destroy",value:function(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}},{key:"register",value:function(e){this._users.push(e)}},{key:"deregister",value:function(e){this._users.removeUnordered(e)}},{key:"registerRemoveFunc",value:function(e,t){this._removeFuncs.push([e,t])}},{key:"deregisterRemoveFunc",value:function(e){this._removeFuncs.filterInPlace((function(t){return t[0]!==e}))}},{key:"size",get:function(){return this._size}},{key:"maxSize",get:function(){return this._maxSize},set:function(e){this._maxSize=Math.max(e,0),this._checkSizeLimit()}},{key:"put",value:function(e,t,r,a){var i=this._db.get(e);if(i&&(this._size-=i.size,this._db.delete(e),i.entry!==t&&this._notifyRemove(e,i.entry,n.ALL)),r>this._maxSize)this._notifyRemove(e,t,n.ALL);else if(void 0!==t)if(!r||r<0)console.warn("Refusing to cache entry with invalid size "+r);else{var s=1+Math.max(a,d)-d;this._db.set(e,{entry:t,size:r,lifetime:s,lives:s}),this._size+=r,this._checkSizeLimit()}else console.warn("Refusing to cache undefined entry ")}},{key:"updateSize",value:function(e,t,r){var a=this._db.get(e);if(a&&a.entry===t){for(this._size-=a.size;r>this._maxSize;){var i=this._notifyRemove(e,t,n.SOME);if(!((0,o.pC)(i)&&i>0))return void this._db.delete(e);r=i}a.size=r,this._size+=r,this._checkSizeLimit()}}},{key:"pop",value:function(e){var t=this._db.get(e);if(t)return this._size-=t.size,this._db.delete(e),++this._hit,t.entry;++this._miss}},{key:"get",value:function(e){var t=this._db.get(e);if(void 0!==t)return this._db.delete(e),t.lives=t.lifetime,this._db.set(e,t),++this._hit,t.entry;++this._miss}},{key:"getStats",value:function(){var e=this,t={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},r={},n=new Array;this._db.forEach((function(t,a){var i=t.lifetime;n[i]=(n[i]||0)+t.size,e._users.forAll((function(e){var n=e.namespace;if(a.startsWith(n)){var i=r[n]||0;r[n]=i+t.size}}))}));var a={};this._users.forAll((function(e){var t=e.namespace;if(!isNaN(e.hitRate)&&e.hitRate>0){var n=r[t]||0;r[t]=n,a[t]=Math.round(100*e.hitRate)+"%"}else a[t]="0%"}));var i=Object.keys(r);i.sort((function(e,t){return r[t]-r[e]})),i.forEach((function(e){return t[e]=Math.round(r[e]/Math.pow(2,20))+"MB / "+a[e]}));for(var s=n.length-1;s>=0;--s){var u=n[s];u&&(t["Priority "+(s+d-1)]=Math.round(u/this.size*100)+"%")}return t}},{key:"resetStats",value:function(){this._hit=this._miss=0,this._users.forAll((function(e){return e.resetHitRate()}))}},{key:"clear",value:function(e){var t=this;this._db.forEach((function(r,a){a.startsWith(e)&&(t._size-=r.size,t._db.delete(a),t._notifyRemove(a,r.entry,n.ALL))}))}},{key:"clearAll",value:function(){var e=this;this._db.forEach((function(t,r){return e._notifyRemove(r,t.entry,n.ALL)})),this._size=0,this._db.clear()}},{key:"_getHitRate",value:function(){return this._hit/(this._hit+this._miss)}},{key:"_notifyRemove",value:function(e,t,r){var n;return this._removeFuncs.some((function(a){if(e.startsWith(a[0])){var i=a[1](t,r);return"number"==typeof i&&(n=i),!0}return!1})),n}},{key:"_checkSizeLimit",value:function(){if(!(this._size<=this._maxSize)){var e,t=(0,s.Z)(this._db);try{for(t.s();!(e=t.n()).done;){var r=(0,i.Z)(e.value,2),a=r[0],u=r[1];if(this._db.delete(a),u.lives<=1){this._size-=u.size;var l=this._notifyRemove(a,u.entry,n.SOME);(0,o.pC)(l)&&l>0&&(this._size+=l,u.lives=u.lifetime,u.size=l,this._db.set(a,u))}else--u.lives,this._db.set(a,u);if(this._size<=.9*this.maxSize)return}}catch(c){t.e(c)}finally{t.f()}}}}]),e}()},48732:function(e,t,r){r.d(t,{Hg:function(){return _},V7:function(){return v},uD:function(){return y},xb:function(){return g}});var n=r(4942),a=r(37762),i=r(85015),s=r(80987),u=r(92026),l=r(23879),o=["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"];function c(e){return e instanceof i.Z}function d(e){return e instanceof s.Z?Object.keys(e.items):c(e)?(0,l.vw)(e).keys():e?Object.keys(e):[]}function f(e,t){return e instanceof s.Z?e.items[t]:e[t]}function h(e){return e?e.declaredClass:null}function p(e,t){var r=e.diff;if(r&&"function"==typeof r)return r(e,t);var i=d(e),s=d(t);if(0!==i.length||0!==s.length){if(!i.length||!s.length||function(e,t){return!(!Array.isArray(e)||!Array.isArray(t))&&e.length!==t.length}(e,t))return{type:"complete",oldValue:e,newValue:t};var l,y=s.filter((function(e){return!i.includes(e)})),v=i.filter((function(e){return!s.includes(e)})),_=i.filter((function(r){return s.includes(r)&&f(e,r)!==f(t,r)})).concat(y,v).sort(),g=h(e);if(g&&o.includes(g)&&_.length)return{type:"complete",oldValue:e,newValue:t};var m,b=c(e)&&c(t),k=(0,a.Z)(_);try{for(k.s();!(m=k.n()).done;){var w=m.value,x=f(e,w),Z=f(t,w),S=void 0;if((b||"function"!=typeof x&&"function"!=typeof Z)&&x!==Z&&(null!=x||null!=Z)){if(r&&r[w]&&"function"==typeof r[w])S=r[w](x,Z);else if(x instanceof Date&&Z instanceof Date){if(x.getTime()===Z.getTime())continue;S={type:"complete",oldValue:x,newValue:Z}}else S="object"==typeof x&&"object"==typeof Z&&h(x)===h(Z)?p(x,Z):{type:"complete",oldValue:x,newValue:Z};(0,u.pC)(S)&&((0,u.pC)(l)?l.diff[w]=S:l={type:"partial",diff:(0,n.Z)({},w,S)})}}}catch(F){k.e(F)}finally{k.f()}return l}}function y(e,t){if((0,u.Wi)(e))return!1;var r,n=t.split("."),i=e,s=(0,a.Z)(n);try{for(s.s();!(r=s.n()).done;){var l=r.value;if("complete"===i.type)return!0;if("partial"!==i.type)return!1;var o=i.diff[l];if(!o)return!1;i=o}}catch(c){s.e(c)}finally{s.f()}return!0}function v(e,t){var r,n=(0,a.Z)(t);try{for(n.s();!(r=n.n()).done;){if(y(e,r.value))return!0}}catch(i){n.e(i)}finally{n.f()}return!1}function _(e,t){if(!("function"==typeof e||"function"==typeof t||(0,u.Wi)(e)&&(0,u.Wi)(t)))return(0,u.Wi)(e)||(0,u.Wi)(t)||"object"==typeof e&&"object"==typeof t&&h(e)!==h(t)?{type:"complete",oldValue:e,newValue:t}:p(e,t)}function g(e){if((0,u.Wi)(e))return!0;switch(e.type){case"complete":return!1;case"collection":var t,r=e,n=(0,a.Z)(r.added);try{for(n.s();!(t=n.n()).done;){if(!g(t.value))return!1}}catch(d){n.e(d)}finally{n.f()}var i,s=(0,a.Z)(r.removed);try{for(s.s();!(i=s.n()).done;){if(!g(i.value))return!1}}catch(d){s.e(d)}finally{s.f()}var l,o=(0,a.Z)(r.changed);try{for(o.s();!(l=o.n()).done;){if(!g(l.value))return!1}}catch(d){o.e(d)}finally{o.f()}return!0;case"partial":for(var c in e.diff)if(!g(e.diff[c]))return!1;return!0}}},30651:function(e,t,r){r.d(t,{Z:function(){return F}});var n=r(74165),a=r(15861),i=r(15671),s=r(43144),u=r(60136),l=r(92572),o=r(27366),c=(r(59486),r(76200)),d=r(10064),f=r(91505),h=r(79056),p=r(54472),y=r(32718),v=r(66978),_=r(35995),g=r(49861),m=(r(25243),r(63780),r(69912)),b=r(42265);function k(){return k=(0,a.Z)((0,n.Z)().mark((function e(t){var a,i,s,u,l;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="portalItem"in t?t:{portalItem:t},e.next=3,Promise.all([r.e(79803),r.e(98995),r.e(46727),r.e(43139),r.e(6356)]).then(r.bind(r,43139));case 3:return i=e.sent,e.prev=4,e.next=7,i.fromItem(a);case 7:return e.abrupt("return",e.sent);case 10:throw e.prev=10,e.t0=e.catch(4),s=a&&a.portalItem,u=s&&s.id||"unset",l=s&&s.portal&&s.portal.url||b.Z.portalUrl,y.Z.getLogger("esri.layers.support.fromPortalItem").error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+l+"', id: '"+u+"')",e.t0),e.t0;case 14:case"end":return e.stop()}}),e,null,[[4,10]])}))),k.apply(this,arguments)}var w=r(53866),x=r(78952),Z=0,S=function(e){(0,u.Z)(o,e);var t=(0,l.Z)(o);function o(){var e;return(0,i.Z)(this,o),(e=t.apply(this,arguments)).attributionDataUrl=null,e.fullExtent=new w.Z(-180,-90,180,90,x.Z.WGS84),e.id=Date.now().toString(16)+"-layer-"+Z++,e.legendEnabled=!0,e.listMode="show",e.opacity=1,e.parent=null,e.popupEnabled=!0,e.attributionVisible=!0,e.spatialReference=x.Z.WGS84,e.title=null,e.type=null,e.url=null,e.visible=!0,e}return(0,s.Z)(o,[{key:"initialize",value:function(){var e=this;this.when().catch((function(t){var r,n;(0,v.D_)(t)||y.Z.getLogger(e.declaredClass).error("#load()","Failed to load layer (title: '".concat(null!==(r=e.title)&&void 0!==r?r:"no title","', id: '").concat(null!==(n=e.id)&&void 0!==n?n:"no id","')"),{error:t})}))}},{key:"destroy",value:function(){if(this.parent){var e=this,t=this.parent;"layers"in t&&t.layers.includes(e)?t.layers.remove(e):"tables"in t&&t.tables.includes(e)?t.tables.remove(e):"baseLayers"in t&&t.baseLayers.includes(e)?t.baseLayers.remove(e):"baseLayers"in t&&t.referenceLayers.includes(e)&&t.referenceLayers.remove(e)}}},{key:"hasAttributionData",get:function(){return null!=this.attributionDataUrl}},{key:"parsedUrl",get:function(){return(0,_.mN)(this.url)}},{key:"fetchAttributionData",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.attributionDataUrl,!this.hasAttributionData||!t){e.next=5;break}return e.next=4,(0,c.default)(t,{query:{f:"json"},responseType:"json"});case 4:return e.abrupt("return",e.sent.data);case 5:throw new d.Z("layer:no-attribution-data","Layer does not have attribution data");case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}],[{key:"fromArcGISServerUrl",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="string"==typeof t?{url:t}:t,e.next=3,Promise.all([r.e(46727),r.e(94650)]).then(r.bind(r,94650));case 3:return e.abrupt("return",e.sent.fromUrl(a));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"fromPortalItem",value:function(e){return function(e){return k.apply(this,arguments)}(e)}}]),o}(f.Z.EventedMixin((0,h.IG)(p.Z)));(0,o._)([(0,g.Cb)({type:String})],S.prototype,"attributionDataUrl",void 0),(0,o._)([(0,g.Cb)({type:w.Z})],S.prototype,"fullExtent",void 0),(0,o._)([(0,g.Cb)({readOnly:!0})],S.prototype,"hasAttributionData",null),(0,o._)([(0,g.Cb)({type:String,clonable:!1})],S.prototype,"id",void 0),(0,o._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],S.prototype,"legendEnabled",void 0),(0,o._)([(0,g.Cb)({type:["show","hide","hide-children"]})],S.prototype,"listMode",void 0),(0,o._)([(0,g.Cb)({type:Number,range:{min:0,max:1},nonNullable:!0})],S.prototype,"opacity",void 0),(0,o._)([(0,g.Cb)({clonable:!1})],S.prototype,"parent",void 0),(0,o._)([(0,g.Cb)({readOnly:!0})],S.prototype,"parsedUrl",null),(0,o._)([(0,g.Cb)({type:Boolean})],S.prototype,"popupEnabled",void 0),(0,o._)([(0,g.Cb)({type:Boolean})],S.prototype,"attributionVisible",void 0),(0,o._)([(0,g.Cb)({type:x.Z})],S.prototype,"spatialReference",void 0),(0,o._)([(0,g.Cb)({type:String})],S.prototype,"title",void 0),(0,o._)([(0,g.Cb)({readOnly:!0,json:{read:!1}})],S.prototype,"type",void 0),(0,o._)([(0,g.Cb)()],S.prototype,"url",void 0),(0,o._)([(0,g.Cb)({type:Boolean,nonNullable:!0})],S.prototype,"visible",void 0);var F=S=(0,o._)([(0,m.j)("esri.layers.Layer")],S)},87165:function(e,t,r){r.d(t,{Z:function(){return _}});var n=r(15671),a=r(43144),i=r(60136),s=r(92572),u=r(27366),l=r(11582),o=r(46784),c=r(49861),d=(r(25243),r(63780),r(38511)),f=r(69912),h=r(31201),p=r(67755),y=r(12224),v=function(e){(0,i.Z)(r,e);var t=(0,s.Z)(r);function r(e){var a;return(0,n.Z)(this,r),(a=t.call(this,e)).id=null,a.name=null,a.domains=null,a.templates=null,a}return(0,a.Z)(r,[{key:"readDomains",value:function(e){for(var t={},r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];t[a]=(0,p.im)(e[a])}return t}},{key:"writeDomains",value:function(e,t){for(var r={},n=0,a=Object.keys(e);n<a.length;n++){var i,s=a[n];e[s]&&(r[s]=null===(i=e[s])||void 0===i?void 0:i.toJSON())}t.domains=r}}]),r}((0,l.J)(o.wq));(0,u._)([(0,c.Cb)({json:{write:!0}})],v.prototype,"id",void 0),(0,u._)([(0,c.Cb)({json:{write:!0}})],v.prototype,"name",void 0),(0,u._)([(0,c.Cb)({json:{write:!0}})],v.prototype,"domains",void 0),(0,u._)([(0,d.r)("domains")],v.prototype,"readDomains",null),(0,u._)([(0,h.c)("domains")],v.prototype,"writeDomains",null),(0,u._)([(0,c.Cb)({type:[y.Z],json:{write:!0}})],v.prototype,"templates",void 0);var _=v=(0,u._)([(0,f.j)("esri.layers.support.FeatureType")],v)},25899:function(e,t,r){r.d(t,{B5:function(){return f},DR:function(){return p},G:function(){return k},M8:function(){return _},Nm:function(){return g},Qc:function(){return h},XG:function(){return m},a7:function(){return v},h3:function(){return w},ld:function(){return y},wH:function(){return b}});var n=r(29439),a=r(92026),i=r(35995),s=r(53283),u={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer"},l=Object.values(u),o=new RegExp("^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(".concat(l.join("|"),"))(?:\\/(?:layers\\/)?(\\d+))?"),"i"),c=new RegExp("^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(".concat(l.join("|"),"))(?:\\/(?:layers\\/)?(\\d+))?"),"i"),d=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function f(e){return!!o.test(e)}function h(e){if((0,a.Wi)(e))return null;var t=(0,i.mN)(e),r=t.path.match(o)||t.path.match(c);if(!r)return null;var s=(0,n.Z)(r,5),l=s[1],d=s[2],f=s[3],h=s[4],p=d.indexOf("/");return{title:y(-1!==p?d.slice(p+1):d),serverType:u[f.toLowerCase()],sublayer:null!=h&&""!==h?parseInt(h,10):null,url:{path:l}}}function p(e){var t=(0,i.mN)(e).path.match(d);return t?{serviceUrl:t[1],sublayerId:Number(t[2])}:null}function y(e){return(e=e.replace(/\s*[/_]+\s*/g," "))[0].toUpperCase()+e.slice(1)}function v(e,t){var r=[];if(e){var n=h(e);(0,a.pC)(n)&&n.title&&r.push(n.title)}if(t){var i=y(t);r.push(i)}if(2===r.length){if(r[0].toLowerCase().includes(r[1].toLowerCase()))return r[0];if(r[1].toLowerCase().includes(r[0].toLowerCase()))return r[1]}return r.join(" - ")}function _(e){if(!e)return!1;var t=(e=e.toLowerCase()).includes(".arcgis.com/"),r=e.includes("//services")||e.includes("//tiles")||e.includes("//features");return t&&r}function g(e,t){return e?(0,i.Qj)((0,i.Hu)(e,t)):e}function m(e){var t=e.url;if(!t)return{url:t};t=(0,i.Hu)(t,e.logger);var r,n=(0,i.mN)(t),s=h(n.path);if((0,a.pC)(s))null!=s.sublayer&&null==e.layer.layerId&&(r=s.sublayer),t=s.url.path;else if(e.nonStandardUrlAllowed){var u=p(n.path);(0,a.pC)(u)&&(t=u.serviceUrl,r=u.sublayerId)}return{url:(0,i.Qj)(t),layerId:r}}function b(e,t,r,n,a){(0,s.w)(t,n,"url",a),n.url&&null!=e.layerId&&(n.url=(0,i.v_)(n.url,r,e.layerId.toString()))}function k(e){if(!e)return!1;var t=e.toLowerCase(),r=t.includes("/services/"),n=t.includes("/mapserver/wmsserver"),a=t.includes("/imageserver/wmsserver"),i=t.includes("/wmsserver");return r&&(n||a||i)}function w(e){var t;if(!e)return!1;var r=null===(t=new i.R9((0,i.hF)(e)).authority)||void 0===t?void 0:t.toLowerCase();return"server.arcgisonline.com"===r||"services.arcgisonline.com"===r}},37933:function(e,t,r){r.d(t,{A2:function(){return d},Am:function(){return h},CY:function(){return o},S1:function(){return b},Tv:function(){return f},fb:function(){return c},iC:function(){return l},ln:function(){return k},mt:function(){return _},oP:function(){return g},rQ:function(){return y},sy:function(){return p},y2:function(){return v}});var n=r(74165),a=r(15861),i=r(19545),s=r(76200),u=r(92026);function l(e){var t=null===e||void 0===e?void 0:e.type;return"base-tile"===t||"tile"===t||"elevation"===t||"imagery-tile"===t||"base-elevation"===t||"open-street-map"===t||"wcs"===t||"web-tile"===t||"wmts"===t||"vector-tile"===t}function o(e){return null!=e&&"type"in e&&"group"===e.type}var c={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};function d(e){var t=null===e||void 0===e?void 0:e.type;return"building-scene"===t||"integrated-mesh"===t||"point-cloud"===t||"scene"===t}function f(e){return"voxel"===(null===e||void 0===e?void 0:e.type)}function h(e){return"imagery-tile"===(null===e||void 0===e?void 0:e.type)}function p(e){return null!=e&&null!=e.parent&&"declaredClass"in e.parent&&"esri.Basemap"===e.parent.declaredClass&&e.parent.baseLayers.includes(e)}function y(e){var t;return"feature"===(null===e||void 0===e?void 0:e.type)&&!e.url&&"memory"===(null===(t=e.source)||void 0===t?void 0:t.type)}function v(e){var t;return"feature"===(null===e||void 0===e?void 0:e.type)&&"feature-layer"===(null===(t=e.source)||void 0===t?void 0:t.type)}function _(e){if(e.activeLayer){var t=e.activeLayer.tileMatrixSet;if(t)return t;var r=e.activeLayer.tileMatrixSets;if(r)return r}return null}function g(e,t){return m.apply(this,arguments)}function m(){return m=(0,a.Z)((0,n.Z)().mark((function e(t,r){var a,l,o,c,d,f;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(null===(a=null===i.id||void 0===i.id?void 0:i.id.findServerInfo(t))||void 0===a?void 0:a.currentVersion)){e.next=3;break}return e.abrupt("return",a.owningSystemUrl||null);case 3:if(-1!==(l=t.toLowerCase().indexOf("/rest/services"))){e.next=6;break}return e.abrupt("return",null);case 6:return o="".concat(t.substring(0,l),"/rest/info"),c=(0,u.pC)(r)?r.signal:null,e.next=10,(0,s.default)(o,{query:{f:"json"},responseType:"json",signal:c});case 10:return d=e.sent,f=d.data,e.abrupt("return",(null===f||void 0===f?void 0:f.owningSystemUrl)||null);case 13:case"end":return e.stop()}}),e)}))),m.apply(this,arguments)}function b(e){return function(e){if(!("capabilities"in e))return!1;switch(e.type){case"csv":case"feature":case"geojson":case"imagery":case"knowledge-graph-sublayer":case"ogc-feature":case"oriented-imagery":case"scene":case"subtype-group":case"subtype-sublayer":case"wfs":return!0;default:return!1}}(e)?"effectiveCapabilities"in e?e.effectiveCapabilities:e.capabilities:null}function k(e){return!!function(e){if(!("editingEnabled"in e))return!1;switch(e.type){case"csv":case"feature":case"geojson":case"oriented-imagery":case"scene":case"subtype-group":case"subtype-sublayer":return!0;default:return!1}}(e)&&("effectiveEditingEnabled"in e?e.effectiveEditingEnabled:e.editingEnabled)}},22585:function(e,t,r){function n(e){var t={};for(var r in e)if("declaredClass"!==r){var a=e[r];if(null!=a&&"function"!=typeof a)if(Array.isArray(a)){t[r]=[];for(var i=0;i<a.length;i++)t[r][i]=n(a[i])}else"object"==typeof a?a.toJSON&&(t[r]=JSON.stringify(a)):t[r]=a}return t}r.d(t,{A:function(){return n}})},34211:function(e,t,r){r.d(t,{P:function(){return o}});var n=r(74165),a=r(1413),i=r(15861),s=r(23084),u=r(5192),l=r(21149);function o(e,t,r){return c.apply(this,arguments)}function c(){return c=(0,i.Z)((0,n.Z)().mark((function e(t,r,i){var o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=(0,s.en)(t),e.abrupt("return",(0,u.hH)(o,l.Z.from(r),(0,a.Z)({},i)).then((function(e){return e.data.count})));case 2:case"end":return e.stop()}}),e)}))),c.apply(this,arguments)}},24246:function(e,t,r){r.d(t,{G:function(){return o}});var n=r(74165),a=r(1413),i=r(15861),s=r(23084),u=r(5192),l=r(21149);function o(e,t,r){return c.apply(this,arguments)}function c(){return c=(0,i.Z)((0,n.Z)().mark((function e(t,r,i){var o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=(0,s.en)(t),e.abrupt("return",(0,u.Ev)(o,l.Z.from(r),(0,a.Z)({},i)).then((function(e){return e.data.objectIds})));case 2:case"end":return e.stop()}}),e)}))),c.apply(this,arguments)}},77946:function(e,t,r){r.d(t,{F:function(){return f},e:function(){return c}});var n=r(1413),a=r(74165),i=r(15861),s=r(23084),u=r(5192),l=r(49818),o=r(21149);function c(e,t,r){return d.apply(this,arguments)}function d(){return d=(0,i.Z)((0,a.Z)().mark((function e(t,r,n){var i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f(t,r,n);case 2:return i=e.sent,e.abrupt("return",l.Z.fromJSON(i));case 4:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}function f(e,t,r){return h.apply(this,arguments)}function h(){return h=(0,i.Z)((0,a.Z)().mark((function e(t,r,i){var l,c,d,f,h;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=(0,s.en)(t),c=(0,n.Z)({},i),d=o.Z.from(r),e.next=5,(0,u.JT)(l,d,d.sourceSpatialReference,c);case 5:return f=e.sent,h=f.data,e.abrupt("return",h);case 8:case"end":return e.stop()}}),e)}))),h.apply(this,arguments)}},5192:function(e,t,r){r.d(t,{Ev:function(){return k},JT:function(){return v},Vn:function(){return Z},Vr:function(){return x},hH:function(){return w},n7:function(){return b},qp:function(){return g}});var n=r(74165),a=r(1413),i=r(15861),s=r(76200),u=r(92026),l=r(35995),o=r(77981),c=r(91340),d=r(22585),f=r(27607),h=r(68620),p="Layer does not support extent calculation.";function y(e,t){var r=e.geometry,n=e.toJSON();delete n.compactGeometryEnabled,delete n.defaultSpatialReferenceEnabled;var a,i,s,l=n;if((0,u.pC)(r)&&(i=r.spatialReference,s=r.spatialReference.wkid||JSON.stringify(r.spatialReference),l.geometryType=(0,o.Ji)(r),l.geometry=function(e,t){if(t&&"extent"===e.type)return"".concat(e.xmin,",").concat(e.ymin,",").concat(e.xmax,",").concat(e.ymax);if(t&&"point"===e.type)return"".concat(e.x,",").concat(e.y);var r=e.toJSON();return delete r.spatialReference,JSON.stringify(r)}(r,e.compactGeometryEnabled),l.inSR=s),n.groupByFieldsForStatistics&&(l.groupByFieldsForStatistics=n.groupByFieldsForStatistics.join(",")),n.objectIds&&(l.objectIds=n.objectIds.join(",")),n.orderByFields&&(l.orderByFields=n.orderByFields.join(",")),!n.outFields||!n.returnDistinctValues&&(null!==t&&void 0!==t&&t.returnCountOnly||null!==t&&void 0!==t&&t.returnExtentOnly||null!==t&&void 0!==t&&t.returnIdsOnly)?delete l.outFields:n.outFields.includes("*")?l.outFields="*":l.outFields=n.outFields.join(","),n.outSR?(l.outSR=n.outSR.wkid||JSON.stringify(n.outSR),a=e.outSpatialReference):r&&(n.returnGeometry||n.returnCentroid)&&(l.outSR=l.inSR,a=i),n.returnGeometry&&delete n.returnGeometry,n.outStatistics&&(l.outStatistics=JSON.stringify(n.outStatistics)),n.fullText&&(l.fullText=JSON.stringify(n.fullText)),n.pixelSize&&(l.pixelSize=JSON.stringify(n.pixelSize)),n.quantizationParameters&&(e.defaultSpatialReferenceEnabled&&(0,u.pC)(i)&&(0,u.pC)(e.quantizationParameters)&&(0,u.pC)(e.quantizationParameters.extent)&&i.equals(e.quantizationParameters.extent.spatialReference)&&delete n.quantizationParameters.extent.spatialReference,l.quantizationParameters=JSON.stringify(n.quantizationParameters)),n.parameterValues&&(l.parameterValues=JSON.stringify(n.parameterValues)),n.rangeValues&&(l.rangeValues=JSON.stringify(n.rangeValues)),n.dynamicDataSource&&(l.layer=JSON.stringify({source:n.dynamicDataSource}),delete n.dynamicDataSource),n.timeExtent){var c=n.timeExtent,d=c.start,f=c.end;null==d&&null==f||(l.time=d===f?d:"".concat(null!==d&&void 0!==d?d:"null",",").concat(null!==f&&void 0!==f?f:"null")),delete n.timeExtent}return e.defaultSpatialReferenceEnabled&&(0,u.pC)(i)&&(0,u.pC)(a)&&i.equals(a)&&(l.defaultSR=l.inSR,delete l.inSR,delete l.outSR),l}function v(e,t,r,n){return _.apply(this,arguments)}function _(){return(_=(0,i.Z)((0,n.Z)().mark((function e(t,r,a,i){var s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,u.pC)(r.timeExtent)||!r.timeExtent.isEmpty){e.next=4;break}e.t0={data:{features:[]}},e.next=7;break;case 4:return e.next=6,Z(t,r,"json",i);case 6:e.t0=e.sent;case 7:return s=e.t0,e.abrupt("return",((0,h.p)(r,a,s.data),s));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e,t,r,n){return m.apply(this,arguments)}function m(){return(m=(0,i.Z)((0,n.Z)().mark((function e(t,r,a,i){var s,l;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,u.pC)(r.timeExtent)||!r.timeExtent.isEmpty){e.next=2;break}return e.abrupt("return",{data:a.createFeatureResult()});case 2:return e.next=4,b(t,r,i);case 4:return s=e.sent,l=s,e.abrupt("return",(l.data=(0,f.C)(s.data,a),l));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e,t,r){return Z(e,t,"pbf",r)}function k(e,t,r){return(0,u.pC)(t.timeExtent)&&t.timeExtent.isEmpty?Promise.resolve({data:{objectIds:[]}}):Z(e,t,"json",r,{returnIdsOnly:!0})}function w(e,t,r){return(0,u.pC)(t.timeExtent)&&t.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):Z(e,t,"json",r,{returnIdsOnly:!0,returnCountOnly:!0})}function x(e,t,r){return(0,u.pC)(t.timeExtent)&&t.timeExtent.isEmpty?Promise.resolve({data:{count:0,extent:null}}):Z(e,t,"json",r,{returnExtentOnly:!0,returnCountOnly:!0}).then((function(e){var t=e.data;if(t.hasOwnProperty("extent"))return e;if(t.features)throw new Error(p);if(t.hasOwnProperty("count"))throw new Error(p);return e}))}function Z(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o="string"==typeof e?(0,l.mN)(e):e,f=t.geometry?[t.geometry]:[];return n.responseType="pbf"===r?"array-buffer":"json",(0,c.aX)(f,null,n).then((function(e){var c=e&&e[0];(0,u.pC)(c)&&((t=t.clone()).geometry=c);var f=(0,d.A)((0,a.Z)((0,a.Z)((0,a.Z)({},o.query),{},{f:r},i),y(t,i)));return(0,s.default)((0,l.v_)(o.path,"query"),(0,a.Z)((0,a.Z)({},n),{},{query:(0,a.Z)((0,a.Z)({},f),n.query)}))}))}},68620:function(e,t,r){r.d(t,{p:function(){return s}});var n=r(37762),a=r(92026),i=r(93501);function s(e,t,r){if(r&&r.features&&r.hasZ){var s=(0,i.k)(r.geometryType,t,e.outSpatialReference);if(!(0,a.Wi)(s)){var u,l=(0,n.Z)(r.features);try{for(l.s();!(u=l.n()).done;){s(u.value.geometry)}}catch(o){l.e(o)}finally{l.f()}}}}},11812:function(e,t,r){r.d(t,{Z:function(){return v}});var n,a=r(15671),i=r(43144),s=r(60136),u=r(92572),l=r(27366),o=r(46784),c=r(49861),d=r(25243),f=(r(63780),r(69912));function h(e){var t=e.exifInfo,r=e.exifName,n=e.tagName;if(!t||!r||!n)return null;var a=t.find((function(e){return e.name===r}));return a?function(e){var t=e.tagName,r=e.tags;if(!r||!t)return null;var n=r.find((function(e){return e.name===t}));return n&&n.value||null}({tagName:n,tags:a.tags}):null}var p={1:{id:1,rotation:0,mirrored:!1},2:{id:2,rotation:0,mirrored:!0},3:{id:3,rotation:180,mirrored:!1},4:{id:4,rotation:180,mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}},y=n=function(e){(0,s.Z)(r,e);var t=(0,u.Z)(r);function r(e){var n;return(0,a.Z)(this,r),(n=t.call(this,e)).contentType=null,n.exifInfo=null,n.id=null,n.globalId=null,n.keywords=null,n.name=null,n.parentGlobalId=null,n.parentObjectId=null,n.size=null,n.url=null,n}return(0,i.Z)(r,[{key:"orientationInfo",get:function(){var e=h({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:this.exifInfo});return p[e]||null}},{key:"clone",value:function(){return new n({contentType:this.contentType,exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})}}]),r}(o.wq);(0,l._)([(0,c.Cb)({type:String})],y.prototype,"contentType",void 0),(0,l._)([(0,c.Cb)()],y.prototype,"exifInfo",void 0),(0,l._)([(0,c.Cb)({readOnly:!0})],y.prototype,"orientationInfo",null),(0,l._)([(0,c.Cb)({type:d.z8})],y.prototype,"id",void 0),(0,l._)([(0,c.Cb)({type:String})],y.prototype,"globalId",void 0),(0,l._)([(0,c.Cb)({type:String})],y.prototype,"keywords",void 0),(0,l._)([(0,c.Cb)({type:String})],y.prototype,"name",void 0),(0,l._)([(0,c.Cb)({json:{read:!1}})],y.prototype,"parentGlobalId",void 0),(0,l._)([(0,c.Cb)({json:{read:!1}})],y.prototype,"parentObjectId",void 0),(0,l._)([(0,c.Cb)({type:d.z8})],y.prototype,"size",void 0),(0,l._)([(0,c.Cb)({json:{read:!1}})],y.prototype,"url",void 0);var v=y=n=(0,l._)([(0,f.j)("esri.layers.support.AttachmentInfo")],y)},49818:function(e,t,r){r.d(t,{Z:function(){return F}});var n,a=r(29439),i=r(37762),s=r(15671),u=r(43144),l=r(60136),o=r(92572),c=r(27366),d=r(59486),f=r(52639),h=r(43404),p=r(46784),y=r(84652),v=r(92026),_=r(49861),g=(r(25243),r(38511)),m=r(69912),b=r(31201),k=r(78952),w=r(77981),x=r(83040),Z=new h.X({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null}),S=n=function(e){(0,l.Z)(r,e);var t=(0,o.Z)(r);function r(e){var n;return(0,s.Z)(this,r),(n=t.call(this,e)).displayFieldName=null,n.exceededTransferLimit=!1,n.features=[],n.fields=null,n.geometryType=null,n.hasM=!1,n.hasZ=!1,n.queryGeometry=null,n.spatialReference=null,n}return(0,u.Z)(r,[{key:"readFeatures",value:function(e,t){for(var r=k.Z.fromJSON(t.spatialReference),n=[],a=0;a<e.length;a++){var i=e[a],s=f.Z.fromJSON(i),u=i.geometry&&i.geometry.spatialReference;(0,v.pC)(s.geometry)&&!u&&(s.geometry.spatialReference=r);var l=i.aggregateGeometries,o=s.aggregateGeometries;if(l&&(0,v.pC)(o))for(var c in o){var d,h=o[c],p=null===(d=l[c])||void 0===d?void 0:d.spatialReference;(0,v.pC)(h)&&!p&&(h.spatialReference=r)}n.push(s)}return n}},{key:"writeGeometryType",value:function(e,t,r,n){if(e)Z.write(e,t,r,n);else{var a=this.features;if(a){var s,u=(0,i.Z)(a);try{for(u.s();!(s=u.n()).done;){var l=s.value;if(l&&(0,v.pC)(l.geometry))return void Z.write(l.geometry.type,t,r,n)}}catch(o){u.e(o)}finally{u.f()}}}}},{key:"readQueryGeometry",value:function(e,t){if(!e)return null;var r=!!e.spatialReference,n=(0,w.im)(e);return n&&!r&&t.spatialReference&&(n.spatialReference=k.Z.fromJSON(t.spatialReference)),n}},{key:"writeSpatialReference",value:function(e,t){if(e)t.spatialReference=e.toJSON();else{var r=this.features;if(r){var n,a=(0,i.Z)(r);try{for(a.s();!(n=a.n()).done;){var s=n.value;if(s&&(0,v.pC)(s.geometry)&&s.geometry.spatialReference)return void(t.spatialReference=s.geometry.spatialReference.toJSON())}}catch(u){a.e(u)}finally{a.f()}}}}},{key:"clone",value:function(){return new n(this.cloneProperties())}},{key:"cloneProperties",value:function(){return(0,y.d9)({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}},{key:"toJSON",value:function(e){var t=this.write();if(t.features&&Array.isArray(e)&&e.length>0)for(var r=0;r<t.features.length;r++){var n=t.features[r];if(n.geometry){var a=e&&e[r];n.geometry=a&&a.toJSON()||n.geometry}}return t}},{key:"quantize",value:function(e){for(var t=(0,a.Z)(e.scale,2),r=t[0],n=t[1],i=(0,a.Z)(e.translate,2),s=i[0],u=i[1],l=this.features,o=this._getQuantizationFunction(this.geometryType,(function(e){return Math.round((e-s)/r)}),(function(e){return Math.round((u-e)/n)})),c=0,d=l.length;c<d;c++)(null===o||void 0===o?void 0:o((0,v.Wg)(l[c].geometry)))||(l.splice(c,1),c--,d--);return this.transform=e,this}},{key:"unquantize",value:function(){var e=this.geometryType,t=this.features,r=this.transform;if(!r)return this;var n,s=(0,a.Z)(r.translate,2),u=s[0],l=s[1],o=(0,a.Z)(r.scale,2),c=o[0],d=o[1],f=this._getHydrationFunction(e,(function(e){return e*c+u}),(function(e){return l-e*d})),h=(0,i.Z)(t);try{for(h.s();!(n=h.n()).done;){var p=n.value.geometry;(0,v.pC)(p)&&f&&f(p)}}catch(y){h.e(y)}finally{h.f()}return this.transform=null,this}},{key:"_quantizePoints",value:function(e,t,r){for(var n,a,i=[],s=0,u=e.length;s<u;s++){var l=e[s];if(s>0){var o=t(l[0]),c=r(l[1]);o===n&&c===a||(i.push([o-n,c-a]),n=o,a=c)}else n=t(l[0]),a=r(l[1]),i.push([n,a])}return i.length>0?i:null}},{key:"_getQuantizationFunction",value:function(e,t,r){var n=this;return"point"===e?function(e){return e.x=t(e.x),e.y=r(e.y),e}:"polyline"===e||"polygon"===e?function(e){for(var a=(0,w.oU)(e)?e.rings:e.paths,i=[],s=0,u=a.length;s<u;s++){var l=a[s],o=n._quantizePoints(l,t,r);o&&i.push(o)}return i.length>0?((0,w.oU)(e)?e.rings=i:e.paths=i,e):null}:"multipoint"===e?function(e){var a=n._quantizePoints(e.points,t,r);return a&&a.length>0?(e.points=a,e):null}:"extent"===e?function(e){return e}:null}},{key:"_getHydrationFunction",value:function(e,t,r){return"point"===e?function(e){e.x=t(e.x),e.y=r(e.y)}:"polyline"===e||"polygon"===e?function(e){for(var n,a,i=(0,w.oU)(e)?e.rings:e.paths,s=0,u=i.length;s<u;s++)for(var l=i[s],o=0,c=l.length;o<c;o++){var d=l[o];o>0?(n+=d[0],a+=d[1]):(n=d[0],a=d[1]),d[0]=t(n),d[1]=r(a)}}:"extent"===e?function(e){e.xmin=t(e.xmin),e.ymin=r(e.ymin),e.xmax=t(e.xmax),e.ymax=r(e.ymax)}:"multipoint"===e?function(e){for(var n,a,i=e.points,s=0,u=i.length;s<u;s++){var l=i[s];s>0?(n+=l[0],a+=l[1]):(n=l[0],a=l[1]),l[0]=t(n),l[1]=r(a)}}:null}}]),r}(p.wq);(0,c._)([(0,_.Cb)({type:String,json:{write:!0}})],S.prototype,"displayFieldName",void 0),(0,c._)([(0,_.Cb)({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],S.prototype,"exceededTransferLimit",void 0),(0,c._)([(0,_.Cb)({type:[f.Z],json:{write:!0}})],S.prototype,"features",void 0),(0,c._)([(0,g.r)("features")],S.prototype,"readFeatures",null),(0,c._)([(0,_.Cb)({type:[x.Z],json:{write:!0}})],S.prototype,"fields",void 0),(0,c._)([(0,_.Cb)({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:Z.read}}})],S.prototype,"geometryType",void 0),(0,c._)([(0,b.c)("geometryType")],S.prototype,"writeGeometryType",null),(0,c._)([(0,_.Cb)({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],S.prototype,"hasM",void 0),(0,c._)([(0,_.Cb)({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],S.prototype,"hasZ",void 0),(0,c._)([(0,_.Cb)({types:d.qM,json:{write:!0}})],S.prototype,"queryGeometry",void 0),(0,c._)([(0,g.r)("queryGeometry")],S.prototype,"readQueryGeometry",null),(0,c._)([(0,_.Cb)({type:k.Z,json:{write:!0}})],S.prototype,"spatialReference",void 0),(0,c._)([(0,b.c)("spatialReference")],S.prototype,"writeSpatialReference",null),(0,c._)([(0,_.Cb)({json:{write:!0}})],S.prototype,"transform",void 0),(S=n=(0,c._)([(0,m.j)("esri.rest.support.FeatureSet")],S)).prototype.toJSON.isDefaultToJSON=!0;var F=S},76115:function(e,t,r){r.d(t,{ET:function(){return s},I4:function(){return i},SQ:function(){return n},X1:function(){return a},eG:function(){return o},lF:function(){return u},lj:function(){return d},qP:function(){return l},wW:function(){return c}});var n=[252,146,31,255],a=[153,153,153,255],i={type:"esriSMS",style:"esriSMSCircle",size:6,color:n,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},s={type:"esriSLS",style:"esriSLSSolid",width:.75,color:n},u={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},l={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},o={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},c={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},d={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null}}}]);
//# sourceMappingURL=94924.a158e73b.chunk.js.map