"use strict";(self.webpackChunkhub_layout_versioning=self.webpackChunkhub_layout_versioning||[]).push([[9892],{21391:function(e,t,a){a.d(t,{EE:function(){return r},R:function(){return n},_5:function(){return s},aF:function(){return l},f2:function(){return v},fD:function(){return f},fR:function(){return i},nR:function(){return u},r1:function(){return m},vL:function(){return o}});var i,r,n,l,o,u,s,f,m,c,d=a(43144),p=a(15671),y=a(48202);(c=i||(i={}))[c.BACKGROUND=0]="BACKGROUND",c[c.FILL=1]="FILL",c[c.LINE=2]="LINE",c[c.SYMBOL=3]="SYMBOL",c[c.CIRCLE=4]="CIRCLE",function(e){e[e.VISIBLE=0]="VISIBLE",e[e.NONE=1]="NONE"}(r||(r={})),function(e){e[e.POINT=0]="POINT",e[e.LINE=1]="LINE",e[e.LINE_CENTER=2]="LINE_CENTER"}(n||(n={})),function(e){e[e.MAP=0]="MAP",e[e.VIEWPORT=1]="VIEWPORT",e[e.AUTO=2]="AUTO"}(l||(l={})),function(e){e[e.AUTO=0]="AUTO",e[e.LEFT=1]="LEFT",e[e.CENTER=2]="CENTER",e[e.RIGHT=3]="RIGHT"}(o||(o={})),function(e){e[e.CENTER=0]="CENTER",e[e.LEFT=1]="LEFT",e[e.RIGHT=2]="RIGHT",e[e.TOP=3]="TOP",e[e.BOTTOM=4]="BOTTOM",e[e.TOP_LEFT=5]="TOP_LEFT",e[e.TOP_RIGHT=6]="TOP_RIGHT",e[e.BOTTOM_LEFT=7]="BOTTOM_LEFT",e[e.BOTTOM_RIGHT=8]="BOTTOM_RIGHT"}(u||(u={})),function(e){e[e.NONE=0]="NONE",e[e.UPPERCASE=1]="UPPERCASE",e[e.LOWERCASE=2]="LOWERCASE"}(s||(s={})),function(e){e[e.MAP=0]="MAP",e[e.VIEWPORT=1]="VIEWPORT"}(f||(f={})),function(e){e[e.HORIZONTAL=0]="HORIZONTAL",e[e.VERTICAL=1]="VERTICAL"}(m||(m={}));var v=(0,d.Z)((function e(){(0,p.Z)(this,e)}));v.backgroundLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:r.VISIBLE}},v.fillLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:r.VISIBLE}},v.lineLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:r.VISIBLE},"line-cap":{type:"enum",values:["butt","round","square"],default:y.RL.BUTT},"line-join":{type:"enum",values:["bevel","round","miter"],default:y.AH.MITER},"line-miter-limit":{type:"number",default:2},"line-round-limit":{type:"number",default:1.05}},v.symbolLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:r.VISIBLE},"symbol-avoid-edges":{type:"boolean",default:!1},"symbol-placement":{type:"enum",values:["point","line","line-center"],default:n.POINT},"symbol-sort-key":{type:"number",default:-1},"symbol-spacing":{type:"number",minimum:1,default:250},"icon-allow-overlap":{type:"boolean",default:!1},"icon-anchor":{type:"enum",values:["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"],default:u.CENTER},"icon-ignore-placement":{type:"boolean",default:!1},"icon-image":{type:"string"},"icon-keep-upright":{type:"boolean",default:!1},"icon-offset":{type:"array",value:"number",length:2,default:[0,0]},"icon-optional":{type:"boolean",default:!1},"icon-padding":{type:"number",minimum:0,default:2},"icon-rotate":{type:"number",default:0},"icon-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:l.AUTO},"icon-size":{type:"number",minimum:0,default:1},"text-allow-overlap":{type:"boolean",default:!1},"text-anchor":{type:"enum",values:["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"],default:u.CENTER},"text-field":{type:"string"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"]},"text-ignore-placement":{type:"boolean",default:!1},"text-justify":{type:"enum",values:["auto","left","center","right"],default:o.CENTER},"text-keep-upright":{type:"boolean",default:!0},"text-letter-spacing":{type:"number",default:0},"text-line-height":{type:"number",default:1.2},"text-max-angle":{type:"number",minimum:0,default:45},"text-max-width":{type:"number",minimum:0,default:10},"text-offset":{type:"array",value:"number",length:2,default:[0,0]},"text-optional":{type:"boolean",default:!1},"text-padding":{type:"number",minimum:0,default:2},"text-rotate":{type:"number",default:0},"text-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:l.AUTO},"text-size":{type:"number",minimum:0,default:16},"text-transform":{type:"enum",values:["none","uppercase","lowercase"],default:s.NONE},"text-writing-mode":{type:"array",value:"enum",values:["horizontal","vertical"],default:[m.HORIZONTAL]}},v.circleLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:r.VISIBLE}},v.backgroundPaintDefinition={"background-color":{type:"color",default:[0,0,0,1]},"background-opacity":{type:"number",minimum:0,maximum:1,default:1},"background-pattern":{type:"string"}},v.fillPaintDefinition={"fill-antialias":{type:"boolean",default:!0},"fill-color":{type:"color",default:[0,0,0,1]},"fill-opacity":{type:"number",minimum:0,maximum:1,default:1},"fill-outline-color":{type:"color",default:[0,0,0,0]},"fill-pattern":{type:"string"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0]},"fill-translate-anchor":{type:"enum",values:["map","viewport"],default:f.MAP}},v.linePaintDefinition={"line-blur":{type:"number",minimum:0,default:0},"line-color":{type:"color",default:[0,0,0,1]},"line-dasharray":{type:"array",value:"number",default:[]},"line-gap-width":{type:"number",minimum:0,default:0},"line-offset":{type:"number",default:0},"line-opacity":{type:"number",minimum:0,maximum:1,default:1},"line-pattern":{type:"string"},"line-translate":{type:"array",value:"number",length:2,default:[0,0]},"line-translate-anchor":{type:"enum",values:["map","viewport"],default:f.MAP},"line-width":{type:"number",minimum:0,default:1}},v.symbolPaintDefinition={"icon-color":{type:"color",default:[0,0,0,1]},"icon-halo-blur":{type:"number",minimum:0,default:0},"icon-halo-color":{type:"color",default:[0,0,0,0]},"icon-halo-width":{type:"number",minimum:0,default:0},"icon-opacity":{type:"number",minimum:0,maximum:1,default:1},"icon-translate":{type:"array",value:"number",length:2,default:[0,0]},"icon-translate-anchor":{type:"enum",values:["map","viewport"],default:f.MAP},"text-color":{type:"color",default:[0,0,0,1]},"text-halo-blur":{type:"number",minimum:0,default:0},"text-halo-color":{type:"color",default:[0,0,0,0]},"text-halo-width":{type:"number",minimum:0,default:0},"text-opacity":{type:"number",minimum:0,maximum:1,default:1},"text-translate":{type:"array",value:"number",length:2,default:[0,0]},"text-translate-anchor":{type:"enum",values:["map","viewport"],default:f.MAP}},v.rasterPaintDefinition={"raster-opacity":{type:"number",minimum:0,maximum:1,default:1},"raster-hue-rotate":{type:"number",default:0},"raster-brightness-min":{type:"number",minimum:0,maximum:1,default:0},"raster-brightness-max":{type:"number",minimum:0,maximum:1,default:1},"raster-saturation":{type:"number",minimum:-1,maximum:1,default:0},"raster-contrast":{type:"number",minimum:-1,maximum:1,default:0},"raster-fade-duration":{type:"number",minimum:0,default:300}},v.circlePaintDefinition={"circle-blur":{type:"number",minimum:0,default:0},"circle-color":{type:"color",default:[0,0,0,1]},"circle-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-radius":{type:"number",minimum:0,default:5},"circle-stroke-color":{type:"color",default:[0,0,0,1]},"circle-stroke-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-stroke-width":{type:"number",minimum:0,default:0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0]},"circle-translate-anchor":{type:"enum",values:["map","viewport"],default:f.MAP}}},13200:function(e,t,a){a.d(t,{k3:function(){return l},s5:function(){return n}});Math.PI;var i=1/Math.LN2;function r(e,t){return(e%=t)>=0?e:e+t}function n(e){return r(.7111111111111111*e,256)}function l(e){return Math.log(e)*i}},3886:function(e,t,a){a.d(t,{Z:function(){return l}});var i=a(37762),r=a(15671),n=a(43144),l=function(){function e(){(0,r.Z)(this,e),this.name=this.constructor.name||"UnnamedBrush",this.brushEffect=null}return(0,n.Z)(e,[{key:"prepareState",value:function(e,t){}},{key:"draw",value:function(e,t,a){}},{key:"drawMany",value:function(e,t,a){var r,n=(0,i.Z)(t);try{for(n.s();!(r=n.n()).done;){var l=r.value;l.visible&&this.draw(e,l,a)}}catch(o){n.e(o)}finally{n.f()}}}]),e}()},17538:function(e,t,a){a.d(t,{J:function(){return E}});var i=a(37762),r=a(15671),n=a(43144),l=a(60136),o=a(92572),u=a(16889),s=a(92026),f=a(23588),m=a(151),c=a(94109),d=a(80613),p=a(73271),y=a(3886),v=a(44070),g=a(8548),h=a(45412),E=function(e){(0,l.Z)(a,e);var t=(0,o.Z)(a);function a(){var e;return(0,r.Z)(this,a),(e=t.apply(this,arguments))._color=(0,m.f)(1,0,0,1),e._patternMatrix=(0,f.c)(),e._programOptions={id:!1,pattern:!1},e}return(0,n.Z)(a,[{key:"dispose",value:function(){this._vao&&(this._vao.dispose(),this._vao=null)}},{key:"drawMany",value:function(e,t){var a=e.context,r=e.painter,n=e.styleLayerUID,l=e.requestRender,o=e.allowDelayedRender;this._loadWGLResources(e);var f,m,y=e.displayLevel,v=e.styleLayer,h=v.backgroundMaterial,E=r.vectorTilesMaterialManager,_=v.getPaintValue("background-color",y),T=v.getPaintValue("background-opacity",y),M=v.getPaintValue("background-pattern",y),P=void 0!==M,x=_[3]*T,I=1|window.devicePixelRatio,b=e.spriteMosaic,U=I>c.a?2:1,R=e.drawPhase===d.jx.HITTEST,L=this._programOptions;L.id=R,L.pattern=P;var w=E.getMaterialProgram(a,h,L);if(o&&(0,s.pC)(l)&&!w.compiled)l();else{if(a.bindVAO(this._vao),a.useProgram(w),P){var O=b.getMosaicItemPosition(M,!0);if((0,s.pC)(O)){var D=O.tl,A=O.br,S=O.page;f=A[0]-D[0],m=A[1]-D[1];var N=b.getPageSize(S);(0,s.pC)(N)&&(b.bind(a,g.cw.LINEAR,S,c.V4),w.setUniform4f("u_tlbr",D[0],D[1],A[0],A[1]),w.setUniform2fv("u_mosaicSize",N),w.setUniform1i("u_texture",c.V4))}w.setUniform1f("u_opacity",T)}else this._color[0]=x*_[0],this._color[1]=x*_[1],this._color[2]=x*_[2],this._color[3]=x,w.setUniform4fv("u_color",this._color);if(w.setUniform1f("u_depth",v.z||0),R){var V=(0,p.Au)(n+1);w.setUniform4fv("u_id",V)}var k,C=(0,i.Z)(t);try{for(C.s();!(k=C.n()).done;){var Z=k.value;if(w.setUniform1f("u_coord_range",Z.rangeX),w.setUniformMatrix3fv("u_dvsMat3",Z.transforms.dvs),P){var F=Math.max(Math.pow(2,Math.round(y)-Z.key.level),1),G=U*Z.width*F,z=G/(0,u.fp)(f),B=G/(0,u.fp)(m);this._patternMatrix[0]=z,this._patternMatrix[4]=B,w.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix)}a.setStencilFunction(g.wb.EQUAL,0,255),a.drawArrays(g.MX.TRIANGLE_STRIP,0,4)}}catch(W){C.e(W)}finally{C.f()}}}},{key:"_loadWGLResources",value:function(e){if(!this._vao){var t=e.context,a=e.styleLayer.backgroundMaterial,i=new Int8Array([0,0,1,0,0,1,1,1]),r=v.f.createVertex(t,g.l1.STATIC_DRAW,i),n=new h.U(t,a.getAttributeLocations(),a.getLayoutInfo(),{geometry:r});this._vao=n}}}]),a}(y.Z)},5562:function(e,t,a){a.d(t,{j:function(){return p}});var i=a(37762),r=a(15671),n=a(43144),l=a(60136),o=a(92572),u=a(92026),s=a(21391),f=a(80613),m=a(73271),c=a(3886),d=a(8548),p=function(e){(0,l.Z)(a,e);var t=(0,o.Z)(a);function a(){var e;return(0,r.Z)(this,a),(e=t.apply(this,arguments))._programOptions={id:!1},e}return(0,n.Z)(a,[{key:"dispose",value:function(){}},{key:"drawMany",value:function(e,t){var a=e.context,r=e.displayLevel,n=e.requiredLevel,l=e.state,o=e.drawPhase,c=e.painter,p=e.spriteMosaic,y=e.styleLayerUID,v=e.requestRender,g=e.allowDelayedRender;if(t.some((function(e){var t,a;return null!==(t=null===(a=e.layerData.get(y))||void 0===a?void 0:a.circleIndexCount)&&void 0!==t&&t}))){var h=e.styleLayer,E=h.circleMaterial,_=c.vectorTilesMaterialManager,T=h.getPaintValue("circle-translate",r),M=h.getPaintValue("circle-translate-anchor",r),P=o===f.jx.HITTEST,x=this._programOptions;x.id=P;var I=_.getMaterialProgram(a,E,x);if(g&&(0,u.pC)(v)&&!I.compiled)v();else{a.useProgram(I),I.setUniformMatrix3fv("u_displayMat3",M===s.fD.VIEWPORT?l.displayMat3:l.displayViewMat3),I.setUniform2fv("u_circleTranslation",T),I.setUniform1f("u_depth",h.z),I.setUniform1f("u_antialiasingWidth",1.2);var b=-1;if(P){var U=(0,m.Au)(y+1);I.setUniform4fv("u_id",U)}var R,L=(0,i.Z)(t);try{for(L.s();!(R=L.n()).done;){var w=R.value;if(w.layerData.has(y)){w.key.level!==b&&(b=w.key.level,E.setDataUniforms(I,r,h,b,p));var O=w.layerData.get(y);if(O.circleIndexCount){O.prepareForRendering(a);var D=O.circleVertexArrayObject;(0,u.Wi)(D)||(a.bindVAO(D),I.setUniformMatrix3fv("u_dvsMat3",w.transforms.dvs),n!==w.key.level?a.setStencilFunction(d.wb.EQUAL,w.stencilRef,255):a.setStencilFunction(d.wb.GREATER,255,255),a.drawElements(d.MX.TRIANGLES,O.circleIndexCount,d.g.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*O.circleIndexStart),w.triangleCount+=O.circleIndexCount/3)}}}}catch(A){L.e(A)}finally{L.f()}}}}}]),a}(c.Z)},54410:function(e,t,a){a.d(t,{R:function(){return g}});var i=a(29439),r=a(37762),n=a(15671),l=a(43144),o=a(60136),u=a(92572),s=a(92026),f=a(21391),m=a(94109),c=a(80613),d=a(73271),p=a(3886),y=a(8548),v=1/65536,g=function(e){(0,o.Z)(a,e);var t=(0,u.Z)(a);function a(){var e;return(0,n.Z)(this,a),(e=t.apply(this,arguments))._fillProgramOptions={id:!1,pattern:!1},e._outlineProgramOptions={id:!1},e}return(0,l.Z)(a,[{key:"dispose",value:function(){}},{key:"drawMany",value:function(e,t){var a,i=e.displayLevel,n=e.drawPhase,l=e.renderPass,o=e.spriteMosaic,u=e.styleLayerUID,s=!1,f=(0,r.Z)(t);try{for(f.s();!(a=f.n()).done;){var m=a.value;if(m.layerData.has(u)){var p=m.layerData.get(u);if(p.fillIndexCount>0||p.outlineIndexCount>0){s=!0;break}}}}catch(O){f.e(O)}finally{f.f()}if(s){var y,v=e.styleLayer,g=v.getPaintProperty("fill-pattern"),h=void 0!==g,E=h&&g.isDataDriven;if(h&&!E){var _=g.getValue(i);y=o.getMosaicItemPosition(_,!0)}var T=!h&&v.getPaintValue("fill-antialias",i),M=!0,P=1;if(!h){var x=v.getPaintProperty("fill-color"),I=v.getPaintProperty("fill-opacity");if((null===x||void 0===x||!x.isDataDriven)&&(null===I||void 0===I||!I.isDataDriven)){var b=v.getPaintValue("fill-color",i);(P=v.getPaintValue("fill-opacity",i)*b[3])>=1&&(M=!1)}}if(!M||"opaque"!==l){var U;n===c.jx.HITTEST&&(U=(0,d.Au)(u+1));var R=v.getPaintValue("fill-translate",i),L=v.getPaintValue("fill-translate-anchor",i);(M||"translucent"!==l)&&this._drawFill(e,u,v,t,R,L,h,y,E,U);var w=!v.hasDataDrivenOutlineColor&&v.outlineUsesFillColor&&P<1;T&&"opaque"!==l&&!w&&this._drawOutline(e,u,v,t,R,L,U)}}}},{key:"_drawFill",value:function(e,t,a,n,l,o,u,d,p,g){if(!u||p||!(0,s.Wi)(d)){var h=e.context,E=e.displayLevel,_=e.state,T=e.drawPhase,M=e.painter,P=e.pixelRatio,x=e.spriteMosaic,I=e.requestRender,b=e.allowDelayedRender,U=a.fillMaterial,R=M.vectorTilesMaterialManager,L=P>m.a?2:1,w=T===c.jx.HITTEST,O=this._fillProgramOptions;O.id=w,O.pattern=u;var D=R.getMaterialProgram(h,U,O);if(b&&(0,s.pC)(I)&&!D.compiled)I();else{if(h.useProgram(D),(0,s.pC)(d)){var A=d.page,S=x.getPageSize(A);(0,s.pC)(S)&&(x.bind(h,y.cw.LINEAR,A,m.V4),D.setUniform2fv("u_mosaicSize",S),D.setUniform1i("u_texture",m.V4))}D.setUniformMatrix3fv("u_displayMat3",o===f.fD.VIEWPORT?_.displayMat3:_.displayViewMat3),D.setUniform2fv("u_fillTranslation",l),D.setUniform1f("u_depth",a.z+v),w&&D.setUniform4fv("u_id",g);var N,V=-1,k=(0,r.Z)(n);try{for(k.s();!(N=k.n()).done;){var C=N.value;if(C.layerData.has(t)){C.key.level!==V&&(V=C.key.level,U.setDataUniforms(D,E,a,V,x));var Z=C.layerData.get(t);if(Z.fillIndexCount){Z.prepareForRendering(h);var F=Z.fillVertexArrayObject;if(!(0,s.Wi)(F)){if(h.bindVAO(F),D.setUniformMatrix3fv("u_dvsMat3",C.transforms.dvs),h.setStencilFunction(y.wb.EQUAL,C.stencilRef,255),u){var G=Math.max(Math.pow(2,Math.round(E)-C.key.level),1),z=C.rangeX/(L*C.width*G);D.setUniform1f("u_patternFactor",z)}if(p){var B=Z.patternMap;if(!B)continue;var W,H=(0,r.Z)(B);try{for(H.s();!(W=H.n()).done;){var j=(0,i.Z)(W.value,2),X=j[0],q=j[1],Y=x.getPageSize(X);(0,s.pC)(Y)&&(x.bind(h,y.cw.LINEAR,X,m.V4),D.setUniform2fv("u_mosaicSize",Y),D.setUniform1i("u_texture",m.V4),h.drawElements(y.MX.TRIANGLES,q[1],y.g.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*q[0]))}}catch(Q){H.e(Q)}finally{H.f()}}else h.drawElements(y.MX.TRIANGLES,Z.fillIndexCount,y.g.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*Z.fillIndexStart);C.triangleCount+=Z.fillIndexCount/3}}}}}catch(Q){k.e(Q)}finally{k.f()}}}}},{key:"_drawOutline",value:function(e,t,a,i,n,l,o){var u=e.context,m=e.displayLevel,d=e.state,p=e.drawPhase,g=e.painter,h=e.pixelRatio,E=e.spriteMosaic,_=e.requestRender,T=e.allowDelayedRender,M=a.outlineMaterial,P=g.vectorTilesMaterialManager,x=.75/h,I=p===c.jx.HITTEST,b=this._outlineProgramOptions;b.id=I;var U=P.getMaterialProgram(u,M,b);if(T&&(0,s.pC)(_)&&!U.compiled)_();else{u.useProgram(U),U.setUniformMatrix3fv("u_displayMat3",l===f.fD.VIEWPORT?d.displayMat3:d.displayViewMat3),U.setUniform2fv("u_fillTranslation",n),U.setUniform1f("u_depth",a.z+v),U.setUniform1f("u_outline_width",x),I&&U.setUniform4fv("u_id",o);var R,L=-1,w=(0,r.Z)(i);try{for(w.s();!(R=w.n()).done;){var O=R.value;if(O.layerData.has(t)){O.key.level!==L&&(L=O.key.level,M.setDataUniforms(U,m,a,L,E));var D=O.layerData.get(t);if(D.prepareForRendering(u),D.outlineIndexCount){var A=D.outlineVertexArrayObject;(0,s.Wi)(A)||(u.bindVAO(A),U.setUniformMatrix3fv("u_dvsMat3",O.transforms.dvs),u.setStencilFunction(y.wb.EQUAL,O.stencilRef,255),u.drawElements(y.MX.TRIANGLES,D.outlineIndexCount,y.g.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*D.outlineIndexStart),O.triangleCount+=D.outlineIndexCount/3)}}}}catch(S){w.e(S)}finally{w.f()}}}}]),a}(p.Z)},93509:function(e,t,a){a.d(t,{z:function(){return v}});var i=a(29439),r=a(37762),n=a(15671),l=a(43144),o=a(60136),u=a(92572),s=a(92026),f=a(21391),m=a(94109),c=a(80613),d=a(73271),p=a(3886),y=a(8548),v=function(e){(0,o.Z)(a,e);var t=(0,u.Z)(a);function a(){var e;return(0,n.Z)(this,a),(e=t.apply(this,arguments))._programOptions={id:!1,pattern:!1,sdf:!1},e}return(0,l.Z)(a,[{key:"dispose",value:function(){}},{key:"drawMany",value:function(e,t){var a=e.context,n=e.displayLevel,l=e.state,o=e.drawPhase,u=e.painter,p=e.pixelRatio,v=e.spriteMosaic,g=e.styleLayerUID,h=e.requestRender,E=e.allowDelayedRender;if(t.some((function(e){var t,a;return null!==(t=null===(a=e.layerData.get(g))||void 0===a?void 0:a.lineIndexCount)&&void 0!==t&&t}))){var _,T,M=e.styleLayer,P=M.lineMaterial,x=u.vectorTilesMaterialManager,I=M.getPaintValue("line-translate",n),b=M.getPaintValue("line-translate-anchor",n),U=M.getPaintProperty("line-pattern"),R=void 0!==U,L=R&&U.isDataDriven;if(R&&!L){var w=U.getValue(n);_=v.getMosaicItemPosition(w)}var O=!1;if(!R){var D=M.getPaintProperty("line-dasharray");if(O=(T=void 0!==D)&&D.isDataDriven,T&&!O){var A=D.getValue(n),S=M.getDashKey(A,M.getLayoutValue("line-cap",n));_=v.getMosaicItemPosition(S)}}var N=1/p,V=o===c.jx.HITTEST,k=this._programOptions;k.id=V,k.pattern=R,k.sdf=T;var C=x.getMaterialProgram(a,P,k);if(E&&(0,s.pC)(h)&&!C.compiled)h();else{if(a.useProgram(C),C.setUniformMatrix3fv("u_displayViewMat3",l.displayViewMat3),C.setUniformMatrix3fv("u_displayMat3",b===f.fD.VIEWPORT?l.displayMat3:l.displayViewMat3),C.setUniform2fv("u_lineTranslation",I),C.setUniform1f("u_depth",M.z),C.setUniform1f("u_antialiasing",N),V){var Z=(0,d.Au)(g+1);C.setUniform4fv("u_id",Z)}if(_&&(0,s.pC)(_)){var F=_.page,G=v.getPageSize(F);(0,s.pC)(G)&&(v.bind(a,y.cw.LINEAR,F,m.V4),C.setUniform2fv("u_mosaicSize",G),C.setUniform1i("u_texture",m.V4))}var z,B=-1,W=(0,r.Z)(t);try{for(W.s();!(z=W.n()).done;){var H=z.value;if(H.layerData.has(g)){H.key.level!==B&&(B=H.key.level,P.setDataUniforms(C,n,M,B,v));var j=Math.pow(2,n-B)/p;C.setUniform1f("u_zoomFactor",j);var X=H.layerData.get(g);if(X.lineIndexCount){X.prepareForRendering(a);var q=X.lineVertexArrayObject;if(!(0,s.Wi)(q)){if(a.bindVAO(q),C.setUniformMatrix3fv("u_dvsMat3",H.transforms.dvs),a.setStencilFunction(y.wb.EQUAL,H.stencilRef,255),L||O){var Y=X.patternMap;if(!Y)continue;var Q,K=(0,r.Z)(Y);try{for(K.s();!(Q=K.n()).done;){var J=(0,i.Z)(Q.value,2),$=J[0],ee=J[1],te=v.getPageSize($);(0,s.pC)(te)&&(v.bind(a,y.cw.LINEAR,$,m.V4),C.setUniform2fv("u_mosaicSize",te),C.setUniform1i("u_texture",m.V4),a.drawElements(y.MX.TRIANGLES,ee[1],y.g.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*ee[0]))}}catch(ae){K.e(ae)}finally{K.f()}}else a.drawElements(y.MX.TRIANGLES,X.lineIndexCount,y.g.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*X.lineIndexStart);H.triangleCount+=X.lineIndexCount/3}}}}}catch(ae){W.e(ae)}finally{W.f()}}}}}]),a}(p.Z)},11640:function(e,t,a){a.d(t,{e:function(){return E}});var i=a(29439),r=a(37762),n=a(15671),l=a(43144),o=a(60136),u=a(92572),s=a(92026),f=a(15245),m=a(46618),c=a(21391),d=a(94109),p=a(80613),y=a(13200),v=a(73271),g=a(3886),h=a(8548),E=function(e){(0,o.Z)(a,e);var t=(0,u.Z)(a);function a(){var e;return(0,n.Z)(this,a),(e=t.apply(this,arguments))._iconProgramOptions={id:!1,sdf:!1},e._sdfProgramOptions={id:!1},e._spritesTextureSize=(0,f.c)(),e}return(0,l.Z)(a,[{key:"dispose",value:function(){}},{key:"drawMany",value:function(e,t){var a,i=e.drawPhase,r=e.styleLayerUID,n=e.styleLayer;i===p.jx.HITTEST&&(a=(0,v.Au)(r+1)),this._drawIcons(e,n,t,a),this._drawText(e,n,t,a)}},{key:"_drawIcons",value:function(e,t,a,n){var l,o,u=e.context,f=e.displayLevel,v=e.drawPhase,g=e.painter,h=e.spriteMosaic,E=e.state,_=e.styleLayerUID,T=e.requestRender,M=e.allowDelayedRender,P=t.iconMaterial,x=g.vectorTilesMaterialManager,I=!1,b=(0,r.Z)(a);try{for(b.s();!(o=b.n()).done;){var U=o.value;if(U.layerData.has(_)&&(l=U.layerData.get(_)).iconPerPageElementsMap.size>0){I=!0;break}}}catch(X){b.e(X)}finally{b.f()}if(I){var R=t.getPaintValue("icon-translate",f),L=t.getPaintValue("icon-translate-anchor",f),w=t.getLayoutValue("icon-rotation-alignment",f);w===c.aF.AUTO&&(w=t.getLayoutValue("symbol-placement",f)===c.R.POINT?c.aF.VIEWPORT:c.aF.MAP);var O=w===c.aF.MAP,D=t.getLayoutValue("icon-keep-upright",f)&&O,A=l.isIconSDF,S=v===p.jx.HITTEST,N=this._iconProgramOptions;N.id=S,N.sdf=A;var V=x.getMaterialProgram(u,P,N);if(M&&(0,s.pC)(T)&&!V.compiled)T();else{u.useProgram(V),V.setUniformMatrix3fv("u_displayViewMat3",w===c.aF.MAP?E.displayViewMat3:E.displayMat3),V.setUniformMatrix3fv("u_displayMat3",L===c.fD.VIEWPORT?E.displayMat3:E.displayViewMat3),V.setUniform2fv("u_iconTranslation",R),V.setUniform1f("u_depth",t.z),V.setUniform1f("u_mapRotation",(0,y.s5)(E.rotation)),V.setUniform1f("u_keepUpright",D?1:0),V.setUniform1f("u_level",10*f),V.setUniform1i("u_texture",d.V4),V.setUniform1f("u_fadeDuration",m.nN/1e3),S&&V.setUniform4fv("u_id",n);var k,C=-1,Z=(0,r.Z)(a);try{for(Z.s();!(k=Z.n()).done;){var F=k.value;if(F.layerData.has(_)&&(F.key.level!==C&&(C=F.key.level,P.setDataUniforms(V,f,t,C,h)),0!==(l=F.layerData.get(_)).iconPerPageElementsMap.size)){l.prepareForRendering(u),l.updateOpacityInfo();var G=l.iconVertexArrayObject;if(!(0,s.Wi)(G)){u.bindVAO(G),V.setUniformMatrix3fv("u_dvsMat3",F.transforms.dvs),V.setUniform1f("u_time",(performance.now()-l.lastOpacityUpdate)/1e3);var z,B=(0,r.Z)(l.iconPerPageElementsMap);try{for(B.s();!(z=B.n()).done;){var W=(0,i.Z)(z.value,2),H=W[0],j=W[1];this._renderIconRange(e,V,j,H,F)}}catch(X){B.e(X)}finally{B.f()}}}}}catch(X){Z.e(X)}finally{Z.f()}}}}},{key:"_renderIconRange",value:function(e,t,a,i,r){var n=e.context,l=e.spriteMosaic;this._spritesTextureSize[0]=l.getWidth(i)/4,this._spritesTextureSize[1]=l.getHeight(i)/4,t.setUniform2fv("u_mosaicSize",this._spritesTextureSize),l.bind(n,h.cw.LINEAR,i,d.V4),n.setStencilTestEnabled(!0),n.setStencilFunction(h.wb.GREATER,255,255),n.setStencilWriteMask(0),n.drawElements(h.MX.TRIANGLES,a[1],h.g.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*a[0]),r.triangleCount+=a[1]/3}},{key:"_drawText",value:function(e,t,a,i){var n,l,o=this,u=e.context,v=e.displayLevel,g=e.drawPhase,E=e.glyphMosaic,_=e.painter,T=e.pixelRatio,M=e.spriteMosaic,P=e.state,x=e.styleLayerUID,I=e.requestRender,b=e.allowDelayedRender,U=t.textMaterial,R=_.vectorTilesMaterialManager,L=!1,w=(0,r.Z)(a);try{for(w.s();!(l=w.n()).done;){var O=l.value;if(O.layerData.has(x)&&(n=O.layerData.get(x)).glyphPerPageElementsMap.size>0){L=!0;break}}}catch(K){w.e(K)}finally{w.f()}if(L){var D=t.getPaintProperty("text-opacity");if(!D||D.isDataDriven||0!==D.getValue(v)){var A=t.getPaintProperty("text-color"),S=!A||A.isDataDriven||A.getValue(v)[3]>0,N=t.getPaintProperty("text-halo-width"),V=t.getPaintProperty("text-halo-color"),k=(!N||N.isDataDriven||N.getValue(v)>0)&&(!V||V.isDataDriven||V.getValue(v)[3]>0);if(S||k){var C=t.getLayoutValue("text-rotation-alignment",v);C===c.aF.AUTO&&(C=t.getLayoutValue("symbol-placement",v)===c.R.POINT?c.aF.VIEWPORT:c.aF.MAP);var Z=C===c.aF.MAP,F=t.getLayoutValue("text-keep-upright",v)&&Z,G=g===p.jx.HITTEST,z=.8*3/T;this._glyphTextureSize||(this._glyphTextureSize=(0,f.f)(E.width/4,E.height/4));var B=t.getPaintValue("text-translate",v),W=t.getPaintValue("text-translate-anchor",v),H=this._sdfProgramOptions;H.id=G;var j=R.getMaterialProgram(u,U,H);if(b&&(0,s.pC)(I)&&!j.compiled)I();else{u.useProgram(j),j.setUniformMatrix3fv("u_displayViewMat3",C===c.aF.MAP?P.displayViewMat3:P.displayMat3),j.setUniformMatrix3fv("u_displayMat3",W===c.fD.VIEWPORT?P.displayMat3:P.displayViewMat3),j.setUniform2fv("u_textTranslation",B),j.setUniform1f("u_depth",t.z+152587890625e-16),j.setUniform2fv("u_mosaicSize",this._glyphTextureSize),j.setUniform1f("u_mapRotation",(0,y.s5)(P.rotation)),j.setUniform1f("u_keepUpright",F?1:0),j.setUniform1f("u_level",10*v),j.setUniform1i("u_texture",d.CU),j.setUniform1f("u_antialiasingWidth",z),j.setUniform1f("u_fadeDuration",m.nN/1e3),G&&j.setUniform4fv("u_id",i);var X,q=-1,Y=(0,r.Z)(a);try{var Q=function(){var e=X.value;if(!e.layerData.has(x))return"continue";if(e.key.level!==q&&(q=e.key.level,U.setDataUniforms(j,v,t,q,M)),0===(n=e.layerData.get(x)).glyphPerPageElementsMap.size)return"continue";n.prepareForRendering(u),n.updateOpacityInfo();var a=n.textVertexArrayObject;if((0,s.Wi)(a))return"continue";u.bindVAO(a),j.setUniformMatrix3fv("u_dvsMat3",e.transforms.dvs),u.setStencilTestEnabled(!0),u.setStencilFunction(h.wb.GREATER,255,255),u.setStencilWriteMask(0);var i=(performance.now()-n.lastOpacityUpdate)/1e3;j.setUniform1f("u_time",i),n.glyphPerPageElementsMap.forEach((function(t,a){o._renderGlyphRange(u,t,a,E,j,k,S,e)}))};for(Y.s();!(X=Y.n()).done;)Q()}catch(K){Y.e(K)}finally{Y.f()}}}}}}},{key:"_renderGlyphRange",value:function(e,t,a,i,r,n,l,o){i.bind(e,h.cw.LINEAR,a,d.CU),n&&(r.setUniform1f("u_halo",1),e.drawElements(h.MX.TRIANGLES,t[1],h.g.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*t[0]),o.triangleCount+=t[1]/3),l&&(r.setUniform1f("u_halo",0),e.drawElements(h.MX.TRIANGLES,t[1],h.g.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*t[0]),o.triangleCount+=t[1]/3)}}]),a}(g.Z)},56648:function(e,t,a){a.d(t,{B:function(){return n}});var i=a(15671),r=a(43144),n=function(){function e(t){(0,i.Z)(this,e),this._readFile=t}return(0,r.Z)(e,[{key:"resolveIncludes",value:function(e){return this._resolve(e)}},{key:"_resolve",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map;if(a.has(e))return a.get(e);var i=this._read(e);if(!i)throw new Error("cannot find shader file ".concat(e));for(var r=/^[^\S\n]*#include\s+<(\S+)>[^\S\n]?/gm,n=r.exec(i),l=[];null!=n;)l.push({path:n[1],start:n.index,length:n[0].length}),n=r.exec(i);var o=0,u="";return l.forEach((function(e){u+=i.slice(o,e.start),u+=a.has(e.path)?"":t._resolve(e.path,a),o=e.start+e.length})),u+=i.slice(o),a.set(e,u),u}},{key:"_read",value:function(e){return this._readFile(e)}}]),e}()}}]);
//# sourceMappingURL=9892.989757b7.chunk.js.map