{"version":3,"file":"static/js/75465.94072222.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/renderers/support/DictionaryLoader.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport e from\"../../Color.js\";import t from\"../../request.js\";import s from\"../../core/Error.js\";import o from\"../../core/Logger.js\";import i from\"../../core/LRUCache.js\";import{isSome as r,isNone as n}from\"../../core/maybe.js\";import{isAbortError as l}from\"../../core/promiseUtils.js\";import{numericHash as a}from\"../../core/string.js\";import{loadArcade as c,createDictionaryExpression as m}from\"../../support/arcadeOnDemand.js\";import f from\"../../symbols/CIMSymbol.js\";const h=\"esri.renderers.support.DictionaryLoader\",y={type:\"CIMSimpleLineCallout\",lineSymbol:{type:\"CIMLineSymbol\",symbolLayers:[{type:\"CIMSolidStroke\",width:.5,color:[0,0,0,255]}]}};class u{constructor(e,t,s){this.config=null,this.fieldMap=null,this.url=null,this._ongoingRequests=new Map,this._symbolCache=new i(100),this._dictionaryPromise=null,this.url=e,this.config=t,this.fieldMap=s}getSymbolFields(){return this._symbolFields}async getSymbolAsync(t,s){let o;this._dictionaryPromise||(this._dictionaryPromise=this.fetchResources(s));try{o=await this._dictionaryPromise}catch(g){if(l(g))return this._dictionaryPromise=null,null}const i={};if(this.fieldMap)for(const e of this._symbolFields){const s=this.fieldMap[e];if(s&&null!=t.attributes[s]){const o=\"\"+t.attributes[s];i[e]=o}else i[e]=\"\"}const n=o?.(i,s);if(!n||\"string\"!=typeof n)return null;const c=a(n).toString(),m=this._symbolCache.get(c);if(m)return m.catch((()=>{this._symbolCache.pop(c)})),m;const f=n.split(\";\"),h=[],y=[];for(const r of f)if(r)if(r.includes(\"po:\")){const t=r.substr(3).split(\"|\");if(3===t.length){const s=t[0],o=t[1];let i=t[2];if(\"DashTemplate\"===o)i=i.split(\" \").map((e=>Number(e)));else if(\"Color\"===o){const t=new e(i).toRgba();i=[t[0],t[1],t[2],255*t[3]]}else i=Number(i);y.push({primitiveName:s,propertyName:o,value:i})}}else if(r.includes(\"|\")){for(const e of r.split(\"|\"))if(this._itemNames.has(e)){h.push(e);break}}else this._itemNames.has(r)&&h.push(r);const u=!r(t.geometry)||!t.geometry.hasZ&&\"point\"===t.geometry.type,p=this._cimPartsToCIMSymbol(h,y,u,s);return this._symbolCache.put(c,p,1),p}async fetchResources(e){if(this._dictionaryPromise)return this._dictionaryPromise;if(!this.url)return void o.getLogger(h).error(\"no valid URL!\");const i=t(this.url+\"/resources/styles/dictionary-info.json\",{responseType:\"json\",query:{f:\"json\"},signal:r(e)?e.signal:null}),[{data:l}]=await Promise.all([i,c()]);if(!l)throw this._dictionaryPromise=null,new s(\"esri.renderers.DictionaryRenderer\",\"Bad dictionary data!\");const a=l.expression,f=l.authoringInfo;this._refSymbolUrlTemplate=this.url+\"/\"+l.cimRefTemplateUrl,this._itemNames=new Set(l.itemsNames),this._symbolFields=f.symbol;const y={};if(this.config){const e=this.config;for(const t in e)y[t]=e[t]}if(f.configuration)for(const t of f.configuration)y.hasOwnProperty(t.name)||(y[t.name]=t.value);const u=[];if(r(e)&&e.fields&&this.fieldMap)for(const t of this._symbolFields){const s=this.fieldMap[t],o=e.fields.filter((e=>e.name===s));o.length>0&&u.push({...o[0],name:t})}const p=m(a,r(e)?e.spatialReference:null,u,y).then((e=>{const t={scale:0};return(s,o)=>{if(n(e))return null;const i=e.repurposeFeature({geometry:null,attributes:s});return t.scale=r(o)?o.scale??void 0:void 0,e.evaluate({$feature:i,$view:t})}})).catch((e=>(o.getLogger(h).error(\"Creating dictinoary expression failed:\",e),null)));return this._dictionaryPromise=p,p}async _cimPartsToCIMSymbol(e,t,s,o){const i=new Array(e.length);for(let l=0;l<e.length;l++)i[l]=this._getSymbolPart(e[l],o);const r=await Promise.all(i),n=this.fieldMap;if(n)for(const l of r)p(l,n);return new f({data:this._combineSymbolParts(r,t,s)})}async _getSymbolPart(e,s){if(this._ongoingRequests.has(e))return this._ongoingRequests.get(e).then((e=>e.data));const o=this._refSymbolUrlTemplate.replace(/\\{itemName\\}/gi,e),i=t(o,{responseType:\"json\",query:{f:\"json\"},...s});this._ongoingRequests.set(e,i);try{return(await i).data}catch(r){throw this._ongoingRequests.delete(e),r}}_combineSymbolParts(e,t,s){if(!e||0===e.length)return null;const o={...e[0]};if(e.length>1){o.symbolLayers=[];for(const t of e){const e=t;o.symbolLayers.unshift(...e.symbolLayers)}}return s&&(o.callout=y),{type:\"CIMSymbolReference\",symbol:o,primitiveOverrides:t}}}function p(e,t){if(!e)return;const s=e.symbolLayers;if(!s)return;let o=s.length;for(;o--;){const e=s[o];if(e&&!1!==e.enable&&\"CIMVectorMarker\"===e.type)g(e,t)}}function g(e,t){const s=e.markerGraphics;if(s)for(const o of s){if(!o)continue;const e=o.symbol;if(e)switch(e.type){case\"CIMPointSymbol\":case\"CIMLineSymbol\":case\"CIMPolygonSymbol\":p(e,t);break;case\"CIMTextSymbol\":e.fieldMap=t}}}export{u as DictionaryLoader};\n"],"names":["h","y","type","lineSymbol","symbolLayers","width","color","u","e","t","s","this","config","fieldMap","url","_ongoingRequests","Map","_symbolCache","i","_dictionaryPromise","_symbolFields","fetchResources","o","l","attributes","n","c","a","toString","m","get","catch","pop","f","split","r","includes","substr","length","map","Number","toRgba","push","primitiveName","propertyName","value","_itemNames","has","geometry","hasZ","p","_cimPartsToCIMSymbol","put","error","responseType","query","signal","Promise","all","data","expression","authoringInfo","_refSymbolUrlTemplate","cimRefTemplateUrl","Set","itemsNames","symbol","configuration","hasOwnProperty","name","fields","filter","spatialReference","then","scale","repurposeFeature","evaluate","$feature","$view","Array","_getSymbolPart","_combineSymbolParts","replace","set","delete","unshift","callout","primitiveOverrides","enable","g","markerGraphics"],"sourceRoot":""}